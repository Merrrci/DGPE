[2025-05-19 18:26:40 det.util.misc] INFO: Rank of current process: 0, World size: 1
[2025-05-19 18:26:40 det.util.misc] INFO: Environment info: 
-------------------------------  ------------------------------------------------------------------------------------------------
sys.platform                     win32
Python                           3.11.11 | packaged by Anaconda, Inc. | (main, Dec 11 2024, 16:34:19) [MSC v.1929 64 bit (AMD64)]
numpy                            2.2.6
PyTorch                          2.6.0+cu118 @C:\Users\Lenovo\.conda\envs\nnUnet\Lib\site-packages\torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA GeForce RTX 3090 (arch=8.6)
Driver version                   572.42
CUDA_HOME                        E:\CUDA
Pillow                           11.0.0
torchvision                      0.21.0+cu118 @C:\Users\Lenovo\.conda\envs\nnUnet\Lib\site-packages\torchvision
torchvision arch flags           C:\Users\Lenovo\.conda\envs\nnUnet\Lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                           0.1.5.post20221221
iopath                           0.1.10
cv2                              4.11.0
-------------------------------  ------------------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 201703
  - MSVC 192930157
  - Intel(R) oneAPI Math Kernel Library Version 2025.0.1-Product Build 20241031 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.5.3 (Git Hash 66f0cb9eb66affd2da3bf5f8d897376f04aae6af)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 90.1
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, COMMIT_SHA=2236df1770800ffea5697b11b0bb0d910b2e59e1, CUDA_VERSION=11.8, CUDNN_VERSION=9.1.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/pytorch/.ci/pytorch/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /Zc:__cplusplus /bigobj /FS /utf-8 -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DLIBKINETO_NOROCTRACER -DLIBKINETO_NOXPUPTI=ON -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE /wd4624 /wd4068 /wd4067 /wd4267 /wd4661 /wd4717 /wd4244 /wd4804 /wd4273, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, TORCH_VERSION=2.6.0, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=OFF, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[2025-05-19 18:26:40 det.util.misc] INFO: Command line arguments: Namespace(config_file='configs/train_config.py', mixed_precision=None, accumulate_steps=1, seed=None, use_deterministic_algorithms=False, dynamo_backend='no')
[2025-05-19 18:26:40 det.util.misc] INFO: Contents of args.config_file=configs/train_config.py:
from torch import optim

from datasets.coco import CocoDetection
from transforms import presets
from optimizer import param_dict

# Commonly changed training configurations
num_epochs = 60   # train epochs
batch_size = 1   # total_batch_size = #GPU x batch_size
num_workers = 4   # workers for pytorch DataLoader
pin_memory = True # whether pin_memory for pytorch DataLoader
print_freq = 5000   # frequency to print logs
starting_epoch = 0
max_norm = 0.1    # clip gradient norm

output_dir = None  # path to save checkpoints, default for None: checkpoints/{model_name}
find_unused_parameters = False  # useful for debugging distributed training

# define dataset for train
#"E:/YZL/data/Han_jie/GC10_coco_num_E_paddle"
coco_path = "E:/YZL/data/Han_jie/GC10_coco_num_E_paddle"  # /PATH/TO/YOUR/COCODIR
train_dataset = CocoDetection(
    img_folder=f"{coco_path}/train2017",
    ann_file=f"{coco_path}/annotations/instances_train2017.json",
    transforms=presets.detr,  # see transforms/presets to choose a transform
    train=True,
)
test_dataset = CocoDetection(
    img_folder=f"{coco_path}/val2017",
    ann_file=f"{coco_path}/annotations/instances_val2017.json",
    transforms=None,  # the eval_transform is integrated in the model
)

# model config to train
model_path = "configs/relation_detr/relation_detr_resnet50_800_1333.py"

# specify a checkpoint folder to resume, or a pretrained ".pth" to finetune, for example:
# checkpoints/relation_detr_resnet50_800_1333/train/2025-03-020-21_42_59
# checkpoints/relation_detr_resnet50_800_1333/train/2025-03-020-21_42_59/best_ap.pth
#'checkpoints/relation_detr_resnet50_800_1333/train/2025-03-029-15_54_31/best_ap.pth'
resume_from_checkpoint = None

learning_rate = 1e-4  # initial learning rate
optimizer = optim.AdamW(lr=learning_rate, weight_decay=1e-4, betas=(0.9, 0.999))
lr_scheduler = optim.lr_scheduler.MultiStepLR(milestones=[10], gamma=0.1)

# This define parameter groups with different learning rate
param_dicts = param_dict.finetune_backbone_and_linear_projection(lr=learning_rate)

[2025-05-19 18:26:40 det.util.misc] INFO: Using the random seed: 40998361
[2025-05-19 18:26:41 py.warnings] WARNING: E:\YZL\RRR\models\bricks\ms_deform_attn.py:24: UserWarning: Failed to load MultiScaleDeformableAttention C++ extension: Ninja is required to load C++ extensions
  warnings.warn(f"Failed to load MultiScaleDeformableAttention C++ extension: {e}")

[2025-05-19 18:26:41 det.models.backbones.base_backbone] INFO: Backbone architecture: resnet50
[2025-05-19 18:26:41 det.util.utils] INFO: <All keys matched successfully>
[2025-05-19 18:26:42 det.__main__] INFO: model parameters: 45135256
[2025-05-19 18:26:42 det.__main__] INFO: optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0001

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.0001

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0

Parameter Group 3
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.0001

Parameter Group 4
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0

Parameter Group 5
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)
[2025-05-19 18:26:42 det.__main__] INFO: lr_scheduler: {'_get_lr_called_within_step': False,
 '_last_lr': [0.0001, 1e-05, 1e-05, 1e-05, 1e-05, 0.0001],
 '_step_count': 1,
 'base_lrs': [0.0001, 1e-05, 1e-05, 1e-05, 1e-05, 0.0001],
 'gamma': 0.1,
 'last_epoch': 0,
 'milestones': Counter({10: 1}),
 'verbose': False}
[2025-05-19 18:26:42 det.__main__] INFO: Label names is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\label_names.txt
[2025-05-19 18:26:42 det.__main__] INFO: Start training
[2025-05-19 18:26:58 det.util.engine] INFO: Epoch: [0]  [0/1834]  eta: 0:46:19  lr: 0.000000  data_time: 0.0023  iter_time: 1.5154  loss: 128.4004 (128.4004)  loss_class: 0.3687 (0.3687)  loss_bbox: 5.1023 (5.1023)  loss_giou: 1.9307 (1.9307)  loss_class_0: 0.2771 (0.2771)  loss_bbox_0: 5.2233 (5.2233)  loss_giou_0: 1.9307 (1.9307)  loss_class_1: 0.3824 (0.3824)  loss_bbox_1: 5.1023 (5.1023)  loss_giou_1: 1.9307 (1.9307)  loss_class_2: 0.4370 (0.4370)  loss_bbox_2: 5.1023 (5.1023)  loss_giou_2: 1.9307 (1.9307)  loss_class_3: 0.3080 (0.3080)  loss_bbox_3: 5.1023 (5.1023)  loss_giou_3: 1.9307 (1.9307)  loss_class_4: 0.2546 (0.2546)  loss_bbox_4: 5.1023 (5.1023)  loss_giou_4: 1.9307 (1.9307)  loss_class_enc: 0.4203 (0.4203)  loss_bbox_enc: 5.2233 (5.2233)  loss_giou_enc: 1.9307 (1.9307)  loss_class_dn: 1.4505 (1.4505)  loss_bbox_dn: 1.7597 (1.7597)  loss_giou_dn: 1.0969 (1.0969)  loss_class_dn_0: 1.3680 (1.3680)  loss_bbox_dn_0: 1.7597 (1.7597)  loss_giou_dn_0: 1.0969 (1.0969)  loss_class_dn_1: 1.5326 (1.5326)  loss_bbox_dn_1: 1.7597 (1.7597)  loss_giou_dn_1: 1.0969 (1.0969)  loss_class_dn_2: 1.5804 (1.5804)  loss_bbox_dn_2: 1.7597 (1.7597)  loss_giou_dn_2: 1.0969 (1.0969)  loss_class_dn_3: 1.4472 (1.4472)  loss_bbox_dn_3: 1.7597 (1.7597)  loss_giou_dn_3: 1.0969 (1.0969)  loss_class_dn_4: 1.4752 (1.4752)  loss_bbox_dn_4: 1.7597 (1.7597)  loss_giou_dn_4: 1.0969 (1.0969)  loss_class_hybrid: 0.1130 (0.1130)  loss_bbox_hybrid: 5.0685 (5.0685)  loss_giou_hybrid: 2.0392 (2.0392)  loss_class_0_hybrid: 0.0830 (0.0830)  loss_bbox_0_hybrid: 5.1157 (5.1157)  loss_giou_0_hybrid: 2.0266 (2.0266)  loss_class_1_hybrid: 0.1116 (0.1116)  loss_bbox_1_hybrid: 5.0685 (5.0685)  loss_giou_1_hybrid: 2.0392 (2.0392)  loss_class_2_hybrid: 0.1237 (0.1237)  loss_bbox_2_hybrid: 5.0685 (5.0685)  loss_giou_2_hybrid: 2.0392 (2.0392)  loss_class_3_hybrid: 0.0858 (0.0858)  loss_bbox_3_hybrid: 5.0685 (5.0685)  loss_giou_3_hybrid: 2.0392 (2.0392)  loss_class_4_hybrid: 0.0760 (0.0760)  loss_bbox_4_hybrid: 5.1105 (5.1105)  loss_giou_4_hybrid: 1.9813 (1.9813)  loss_class_enc_hybrid: 0.0893 (0.0893)  loss_bbox_enc_hybrid: 5.1694 (5.1694)  loss_giou_enc_hybrid: 1.9686 (1.9686)  mem: 730  max mem: 18612
[2025-05-19 18:26:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 18:44:20 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0006  iter_time: 0.5389  loss: 45.6865 (56.3072)  loss_class: 1.2910 (1.4256)  loss_bbox: 0.1788 (0.8188)  loss_giou: 0.3696 (0.7609)  loss_class_0: 0.8751 (1.0610)  loss_bbox_0: 0.2105 (0.9812)  loss_giou_0: 0.4778 (0.8555)  loss_class_1: 1.1341 (1.2205)  loss_bbox_1: 0.1886 (0.9027)  loss_giou_1: 0.4354 (0.8056)  loss_class_2: 1.6673 (1.3257)  loss_bbox_2: 0.1563 (0.8623)  loss_giou_2: 0.3659 (0.7797)  loss_class_3: 1.6757 (1.3807)  loss_bbox_3: 0.1384 (0.8400)  loss_giou_3: 0.3510 (0.7677)  loss_class_4: 1.4313 (1.3952)  loss_bbox_4: 0.1847 (0.8269)  loss_giou_4: 0.3808 (0.7656)  loss_class_enc: 1.0786 (0.9449)  loss_bbox_enc: 0.1945 (1.0977)  loss_giou_enc: 0.3863 (0.9074)  loss_class_dn: 0.6528 (0.6013)  loss_bbox_dn: 0.3849 (1.1594)  loss_giou_dn: 0.8577 (1.0142)  loss_class_dn_0: 0.4296 (0.4890)  loss_bbox_dn_0: 0.4437 (1.1870)  loss_giou_dn_0: 1.0246 (1.0216)  loss_class_dn_1: 0.4625 (0.5143)  loss_bbox_dn_1: 0.3977 (1.1621)  loss_giou_dn_1: 0.9205 (1.0060)  loss_class_dn_2: 0.4930 (0.5673)  loss_bbox_dn_2: 0.3858 (1.1534)  loss_giou_dn_2: 0.8641 (1.0023)  loss_class_dn_3: 0.5524 (0.5934)  loss_bbox_dn_3: 0.3809 (1.1525)  loss_giou_dn_3: 0.8497 (1.0057)  loss_class_dn_4: 0.6255 (0.6004)  loss_bbox_dn_4: 0.3893 (1.1549)  loss_giou_dn_4: 0.8702 (1.0084)  loss_class_hybrid: 0.9324 (0.9639)  loss_bbox_hybrid: 0.2343 (0.9034)  loss_giou_hybrid: 0.4631 (0.8307)  loss_class_0_hybrid: 0.7260 (0.8266)  loss_bbox_0_hybrid: 0.3173 (1.0471)  loss_giou_0_hybrid: 0.5025 (0.9068)  loss_class_1_hybrid: 0.7969 (0.8877)  loss_bbox_1_hybrid: 0.2027 (0.9805)  loss_giou_1_hybrid: 0.4744 (0.8657)  loss_class_2_hybrid: 0.8608 (0.9209)  loss_bbox_2_hybrid: 0.1773 (0.9432)  loss_giou_2_hybrid: 0.4549 (0.8436)  loss_class_3_hybrid: 0.9651 (0.9406)  loss_bbox_3_hybrid: 0.1963 (0.9226)  loss_giou_3_hybrid: 0.4402 (0.8343)  loss_class_4_hybrid: 0.8994 (0.9524)  loss_bbox_4_hybrid: 0.2218 (0.9115)  loss_giou_4_hybrid: 0.4533 (0.8313)  loss_class_enc_hybrid: 0.5641 (0.7778)  loss_bbox_enc_hybrid: 0.3787 (1.1363)  loss_giou_enc_hybrid: 0.6065 (0.9614)
[2025-05-19 18:44:20 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\pytorch_model.bin
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\optimizer.bin
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\scheduler.bin
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\sampler.bin
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\sampler_1.bin
[2025-05-19 18:44:20 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_0\random_states_0.pkl
[2025-05-19 18:44:20 det.__main__] INFO: Start evaluation
[2025-05-19 18:44:35 det.util.utils] INFO: Test:  [  0/458]  eta: 1:50:39  model_time: 0.4201 (0.4201)  evaluator_time: 0.0030 (0.0030)  time: 14.4977  data: 14.0746  mem: 726  max mem: 19846
[2025-05-19 18:44:36 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:10:59  model_time: 0.1665 (0.1896)  evaluator_time: 0.0030 (0.0029)  time: 1.4727  data: 1.2801  mem: 726  max mem: 19846
[2025-05-19 18:44:38 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:06:13  model_time: 0.1665 (0.1786)  evaluator_time: 0.0030 (0.0027)  time: 0.1700  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:40 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:04:30  model_time: 0.1664 (0.1747)  evaluator_time: 0.0030 (0.0027)  time: 0.1698  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:42 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:03:37  model_time: 0.1660 (0.1727)  evaluator_time: 0.0030 (0.0028)  time: 0.1702  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:43 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:03:04  model_time: 0.1666 (0.1715)  evaluator_time: 0.0030 (0.0028)  time: 0.1705  data: 0.0008  mem: 726  max mem: 19846
[2025-05-19 18:44:45 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:02:41  model_time: 0.1666 (0.1707)  evaluator_time: 0.0030 (0.0028)  time: 0.1702  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:47 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:02:24  model_time: 0.1670 (0.1701)  evaluator_time: 0.0030 (0.0028)  time: 0.1701  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:44:48 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:02:11  model_time: 0.1670 (0.1698)  evaluator_time: 0.0030 (0.0028)  time: 0.1708  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:44:50 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:02:00  model_time: 0.1671 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1714  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:52 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:51  model_time: 0.1680 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1722  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:44:54 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:44  model_time: 0.1685 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:44:55 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:37  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1733  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:44:57 det.util.utils] INFO: Test:  [130/458]  eta: 0:01:32  model_time: 0.1693 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1730  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:44:59 det.util.utils] INFO: Test:  [140/458]  eta: 0:01:26  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:00 det.util.utils] INFO: Test:  [150/458]  eta: 0:01:22  model_time: 0.1692 (0.1695)  evaluator_time: 0.0030 (0.0030)  time: 0.1739  data: 0.0004  mem: 726  max mem: 19846
[2025-05-19 18:45:02 det.util.utils] INFO: Test:  [160/458]  eta: 0:01:17  model_time: 0.1706 (0.1696)  evaluator_time: 0.0030 (0.0030)  time: 0.1749  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:04 det.util.utils] INFO: Test:  [170/458]  eta: 0:01:13  model_time: 0.1705 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1748  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:06 det.util.utils] INFO: Test:  [180/458]  eta: 0:01:09  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1736  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:07 det.util.utils] INFO: Test:  [190/458]  eta: 0:01:06  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0004  mem: 726  max mem: 19846
[2025-05-19 18:45:09 det.util.utils] INFO: Test:  [200/458]  eta: 0:01:02  model_time: 0.1690 (0.1696)  evaluator_time: 0.0040 (0.0031)  time: 0.1736  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:11 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:59  model_time: 0.1691 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1737  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:13 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:56  model_time: 0.1694 (0.1696)  evaluator_time: 0.0030 (0.0035)  time: 0.1775  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:14 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:53  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1776  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:16 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:50  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:18 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:47  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:20 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:45  model_time: 0.1697 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:21 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:42  model_time: 0.1700 (0.1696)  evaluator_time: 0.0020 (0.0034)  time: 0.1737  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:23 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:39  model_time: 0.1698 (0.1696)  evaluator_time: 0.0020 (0.0033)  time: 0.1731  data: 0.0008  mem: 726  max mem: 19846
[2025-05-19 18:45:25 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:37  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0008  mem: 726  max mem: 19846
[2025-05-19 18:45:27 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:34  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:28 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:32  model_time: 0.1694 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:30 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:30  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:32 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:27  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:34 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:25  model_time: 0.1703 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1747  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:35 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:23  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:37 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:20  model_time: 0.1697 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:39 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:18  model_time: 0.1694 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0008  mem: 726  max mem: 19846
[2025-05-19 18:45:41 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:16  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0009  mem: 726  max mem: 19846
[2025-05-19 18:45:42 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:14  model_time: 0.1688 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1744  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:44 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:12  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1747  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:46 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:09  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:47 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:07  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0007  mem: 726  max mem: 19846
[2025-05-19 18:45:49 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:05  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:51 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1687 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:53 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1684 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 726  max mem: 19846
[2025-05-19 18:45:54 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1682 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0006  mem: 726  max mem: 19846
[2025-05-19 18:45:54 det.util.engine] INFO: Averaged stats: model_time: 0.1682 (0.1696)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 18:45:54 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.038
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.081
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.031
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.018
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.063
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.160
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.256
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.187
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.351

[2025-05-19 18:45:54 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 15659 | 0.706  | 0.002 |
| Crescent_gap  | 48   | 48  | 180   | 0.271  | 0.084 |
| Inclusion     | 41   | 82  | 7635  | 0.280  | 0.009 |
| Oil_spot      | 58   | 125 | 18944 | 0.600  | 0.039 |
| Punching      | 74   | 74  | 4333  | 0.892  | 0.147 |
| Rolled_pit    | 10   | 25  | 932   | 0.040  | 0.050 |
| Silk_spot     | 134  | 150 | 40756 | 0.547  | 0.028 |
| Waist_folding | 24   | 26  | 2615  | 0.769  | 0.089 |
| Water_spot    | 68   | 78  | 26537 | 0.833  | 0.055 |
| Welding_line  | 99   | 99  | 19793 | 0.980  | 0.311 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.592  | 0.081 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 18:45:54 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 18:45:55 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 18:45:55 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 18:45:55 det.util.engine] INFO: Epoch: [1]  [0/1834]  eta: 0:19:16  lr: 0.000100  data_time: 0.0007  iter_time: 0.6307  loss: 52.0104 (52.0104)  loss_class: 1.8268 (1.8268)  loss_bbox: 0.1862 (0.1862)  loss_giou: 0.4385 (0.4385)  loss_class_0: 1.8058 (1.8058)  loss_bbox_0: 0.7681 (0.7681)  loss_giou_0: 0.4784 (0.4784)  loss_class_1: 0.7901 (0.7901)  loss_bbox_1: 0.9504 (0.9504)  loss_giou_1: 0.8532 (0.8532)  loss_class_2: 1.9147 (1.9147)  loss_bbox_2: 0.2912 (0.2912)  loss_giou_2: 0.4019 (0.4019)  loss_class_3: 1.4789 (1.4789)  loss_bbox_3: 0.1924 (0.1924)  loss_giou_3: 0.4617 (0.4617)  loss_class_4: 1.4676 (1.4676)  loss_bbox_4: 0.2580 (0.2580)  loss_giou_4: 0.4645 (0.4645)  loss_class_enc: 0.9380 (0.9380)  loss_bbox_enc: 1.3006 (1.3006)  loss_giou_enc: 0.8486 (0.8486)  loss_class_dn: 1.1169 (1.1169)  loss_bbox_dn: 0.8791 (0.8791)  loss_giou_dn: 0.8635 (0.8635)  loss_class_dn_0: 0.4077 (0.4077)  loss_bbox_dn_0: 1.1901 (1.1901)  loss_giou_dn_0: 1.1070 (1.1070)  loss_class_dn_1: 0.5105 (0.5105)  loss_bbox_dn_1: 0.9940 (0.9940)  loss_giou_dn_1: 0.9728 (0.9728)  loss_class_dn_2: 0.7063 (0.7063)  loss_bbox_dn_2: 0.9335 (0.9335)  loss_giou_dn_2: 0.8981 (0.8981)  loss_class_dn_3: 0.8393 (0.8393)  loss_bbox_dn_3: 0.9112 (0.9112)  loss_giou_dn_3: 0.9026 (0.9026)  loss_class_dn_4: 0.9621 (0.9621)  loss_bbox_dn_4: 0.8836 (0.8836)  loss_giou_dn_4: 0.8588 (0.8588)  loss_class_hybrid: 1.7043 (1.7043)  loss_bbox_hybrid: 0.1886 (0.1886)  loss_giou_hybrid: 0.4007 (0.4007)  loss_class_0_hybrid: 1.4566 (1.4566)  loss_bbox_0_hybrid: 0.6813 (0.6813)  loss_giou_0_hybrid: 0.8080 (0.8080)  loss_class_1_hybrid: 1.0198 (1.0198)  loss_bbox_1_hybrid: 0.6112 (0.6112)  loss_giou_1_hybrid: 0.7928 (0.7928)  loss_class_2_hybrid: 1.6750 (1.6750)  loss_bbox_2_hybrid: 0.3586 (0.3586)  loss_giou_2_hybrid: 0.4394 (0.4394)  loss_class_3_hybrid: 1.4815 (1.4815)  loss_bbox_3_hybrid: 0.2771 (0.2771)  loss_giou_3_hybrid: 0.4292 (0.4292)  loss_class_4_hybrid: 1.5328 (1.5328)  loss_bbox_4_hybrid: 0.2246 (0.2246)  loss_giou_4_hybrid: 0.3790 (0.3790)  loss_class_enc_hybrid: 0.3726 (0.3726)  loss_bbox_enc_hybrid: 1.7410 (1.7410)  loss_giou_enc_hybrid: 1.3834 (1.3834)  mem: 738  max mem: 19846
[2025-05-19 18:45:55 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:03:13 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5981  loss: 55.2978 (46.3123)  loss_class: 2.1168 (1.7953)  loss_bbox: 0.2304 (0.3585)  loss_giou: 0.4497 (0.4802)  loss_class_0: 1.3794 (1.1934)  loss_bbox_0: 0.2896 (0.4736)  loss_giou_0: 0.4803 (0.5970)  loss_class_1: 1.6238 (1.3527)  loss_bbox_1: 0.2456 (0.4217)  loss_giou_1: 0.3947 (0.5452)  loss_class_2: 2.0826 (1.5471)  loss_bbox_2: 0.2486 (0.3920)  loss_giou_2: 0.4170 (0.5149)  loss_class_3: 2.0339 (1.6801)  loss_bbox_3: 0.2214 (0.3753)  loss_giou_3: 0.4173 (0.4968)  loss_class_4: 2.0846 (1.7525)  loss_bbox_4: 0.2403 (0.3646)  loss_giou_4: 0.4140 (0.4878)  loss_class_enc: 1.3547 (1.1730)  loss_bbox_enc: 0.3136 (0.5614)  loss_giou_enc: 0.5444 (0.6856)  loss_class_dn: 0.8425 (0.6950)  loss_bbox_dn: 1.1210 (0.8582)  loss_giou_dn: 0.8167 (0.7764)  loss_class_dn_0: 0.4894 (0.4493)  loss_bbox_dn_0: 1.5725 (1.0283)  loss_giou_dn_0: 0.9621 (0.9038)  loss_class_dn_1: 0.5331 (0.5019)  loss_bbox_dn_1: 1.3319 (0.9207)  loss_giou_dn_1: 0.8801 (0.8241)  loss_class_dn_2: 0.5568 (0.5769)  loss_bbox_dn_2: 1.2169 (0.8819)  loss_giou_dn_2: 0.8189 (0.7931)  loss_class_dn_3: 0.5796 (0.6379)  loss_bbox_dn_3: 1.1770 (0.8683)  loss_giou_dn_3: 0.8138 (0.7844)  loss_class_dn_4: 0.7702 (0.6877)  loss_bbox_dn_4: 1.1347 (0.8606)  loss_giou_dn_4: 0.8200 (0.7763)  loss_class_hybrid: 1.6162 (1.2309)  loss_bbox_hybrid: 0.2574 (0.4085)  loss_giou_hybrid: 0.4357 (0.5266)  loss_class_0_hybrid: 1.3868 (1.0186)  loss_bbox_0_hybrid: 0.3131 (0.5112)  loss_giou_0_hybrid: 0.7160 (0.6371)  loss_class_1_hybrid: 1.5255 (1.0786)  loss_bbox_1_hybrid: 0.2912 (0.4635)  loss_giou_1_hybrid: 0.5087 (0.5863)  loss_class_2_hybrid: 1.6521 (1.1335)  loss_bbox_2_hybrid: 0.2809 (0.4387)  loss_giou_2_hybrid: 0.4980 (0.5626)  loss_class_3_hybrid: 1.5991 (1.1774)  loss_bbox_3_hybrid: 0.2678 (0.4223)  loss_giou_3_hybrid: 0.4644 (0.5432)  loss_class_4_hybrid: 1.5918 (1.2139)  loss_bbox_4_hybrid: 0.2592 (0.4125)  loss_giou_4_hybrid: 0.4471 (0.5343)  loss_class_enc_hybrid: 1.5312 (0.9859)  loss_bbox_enc_hybrid: 0.4420 (0.6149)  loss_giou_enc_hybrid: 0.7188 (0.7383)
[2025-05-19 19:03:13 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\pytorch_model.bin
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\optimizer.bin
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\scheduler.bin
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\sampler.bin
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\sampler_1.bin
[2025-05-19 19:03:14 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_1\random_states_0.pkl
[2025-05-19 19:03:14 det.__main__] INFO: Start evaluation
[2025-05-19 19:03:14 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:32  model_time: 0.1688 (0.1688)  evaluator_time: 0.0050 (0.0050)  time: 0.2024  data: 0.0286  mem: 729  max mem: 19986
[2025-05-19 19:03:16 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:19  model_time: 0.1700 (0.1703)  evaluator_time: 0.0030 (0.0031)  time: 0.1767  data: 0.0031  mem: 729  max mem: 19986
[2025-05-19 19:03:18 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1700 (0.1701)  evaluator_time: 0.0030 (0.0029)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:19 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1697 (0.1700)  evaluator_time: 0.0030 (0.0061)  time: 0.1784  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:21 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:13  model_time: 0.1694 (0.1699)  evaluator_time: 0.0030 (0.0054)  time: 0.1785  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:23 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:11  model_time: 0.1690 (0.1699)  evaluator_time: 0.0030 (0.0050)  time: 0.1741  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:25 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1690 (0.1698)  evaluator_time: 0.0030 (0.0047)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:26 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0045)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:28 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:06  model_time: 0.1699 (0.1697)  evaluator_time: 0.0030 (0.0043)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:30 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0042)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:32 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1693 (0.1697)  evaluator_time: 0.0030 (0.0041)  time: 0.1737  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:33 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1691 (0.1697)  evaluator_time: 0.0030 (0.0040)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 19:03:35 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:59  model_time: 0.1695 (0.1697)  evaluator_time: 0.0030 (0.0039)  time: 0.1732  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:37 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0039)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 19:03:39 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0038)  time: 0.1739  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 19:03:40 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0037)  time: 0.1739  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:42 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0037)  time: 0.1744  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:44 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1696 (0.1698)  evaluator_time: 0.0030 (0.0037)  time: 0.1743  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:45 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0037)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:47 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0037)  time: 0.1741  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:49 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1698 (0.1698)  evaluator_time: 0.0040 (0.0037)  time: 0.1740  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 19:03:51 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:52 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0036)  time: 0.1728  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:03:54 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1696)  evaluator_time: 0.0030 (0.0036)  time: 0.1722  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:03:56 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1680 (0.1696)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:03:58 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1680 (0.1695)  evaluator_time: 0.0030 (0.0036)  time: 0.1726  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:03:59 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1685 (0.1695)  evaluator_time: 0.0030 (0.0036)  time: 0.1732  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:04:01 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1694 (0.1695)  evaluator_time: 0.0030 (0.0036)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:03 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1691 (0.1695)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:05 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0035)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:06 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1691 (0.1695)  evaluator_time: 0.0030 (0.0035)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:08 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0035)  time: 0.1728  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:10 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:11 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1685 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:13 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1687 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 19:04:15 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1691 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1734  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:17 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1698 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1739  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:18 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1686 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 19:04:20 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1684 (0.1694)  evaluator_time: 0.0030 (0.0035)  time: 0.1721  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:22 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1693)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:04:24 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1693)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 19:04:25 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1681 (0.1693)  evaluator_time: 0.0030 (0.0035)  time: 0.1719  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:27 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1683 (0.1693)  evaluator_time: 0.0030 (0.0035)  time: 0.1721  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 19:04:29 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1681 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1721  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 19:04:30 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1681 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1720  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 19:04:32 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1723  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 19:04:33 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1722  data: 0.0008  mem: 730  max mem: 19986
[2025-05-19 19:04:33 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0035)
[2025-05-19 19:04:34 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.27s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.035
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.070
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.031
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.019
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.064
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.249
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.350
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.451
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.477

[2025-05-19 19:04:34 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 993   | 0.176  | 0.004 |
| Crescent_gap  | 48   | 48  | 10596 | 1.000  | 0.127 |
| Inclusion     | 41   | 82  | 12529 | 0.634  | 0.059 |
| Oil_spot      | 58   | 125 | 9594  | 0.600  | 0.022 |
| Punching      | 74   | 74  | 3778  | 0.932  | 0.132 |
| Rolled_pit    | 10   | 25  | 2739  | 0.240  | 0.003 |
| Silk_spot     | 134  | 150 | 44836 | 0.773  | 0.056 |
| Waist_folding | 24   | 26  | 18507 | 0.885  | 0.083 |
| Water_spot    | 68   | 78  | 27249 | 0.872  | 0.059 |
| Welding_line  | 99   | 99  | 6579  | 0.990  | 0.157 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.710  | 0.070 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 19:04:34 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:04:35 det.util.engine] INFO: Epoch: [2]  [0/1834]  eta: 0:19:41  lr: 0.000100  data_time: 0.0073  iter_time: 0.6444  loss: 37.0375 (37.0375)  loss_class: 1.2896 (1.2896)  loss_bbox: 0.1206 (0.1206)  loss_giou: 0.6347 (0.6347)  loss_class_0: 0.8455 (0.8455)  loss_bbox_0: 0.1592 (0.1592)  loss_giou_0: 0.7824 (0.7824)  loss_class_1: 1.0682 (1.0682)  loss_bbox_1: 0.1445 (0.1445)  loss_giou_1: 0.7126 (0.7126)  loss_class_2: 1.0066 (1.0066)  loss_bbox_2: 0.1447 (0.1447)  loss_giou_2: 0.7444 (0.7444)  loss_class_3: 1.2048 (1.2048)  loss_bbox_3: 0.1198 (0.1198)  loss_giou_3: 0.6389 (0.6389)  loss_class_4: 1.2410 (1.2410)  loss_bbox_4: 0.1186 (0.1186)  loss_giou_4: 0.6370 (0.6370)  loss_class_enc: 1.0653 (1.0653)  loss_bbox_enc: 0.1910 (0.1910)  loss_giou_enc: 0.8102 (0.8102)  loss_class_dn: 0.6122 (0.6122)  loss_bbox_dn: 0.2098 (0.2098)  loss_giou_dn: 0.9682 (0.9682)  loss_class_dn_0: 0.3998 (0.3998)  loss_bbox_dn_0: 0.2485 (0.2485)  loss_giou_dn_0: 1.1155 (1.1155)  loss_class_dn_1: 0.3829 (0.3829)  loss_bbox_dn_1: 0.2260 (0.2260)  loss_giou_dn_1: 1.1355 (1.1355)  loss_class_dn_2: 0.5267 (0.5267)  loss_bbox_dn_2: 0.2153 (0.2153)  loss_giou_dn_2: 1.0306 (1.0306)  loss_class_dn_3: 0.5719 (0.5719)  loss_bbox_dn_3: 0.2123 (0.2123)  loss_giou_dn_3: 1.0001 (1.0001)  loss_class_dn_4: 0.6486 (0.6486)  loss_bbox_dn_4: 0.2090 (0.2090)  loss_giou_dn_4: 0.9632 (0.9632)  loss_class_hybrid: 0.8740 (0.8740)  loss_bbox_hybrid: 0.1467 (0.1467)  loss_giou_hybrid: 0.7619 (0.7619)  loss_class_0_hybrid: 0.7241 (0.7241)  loss_bbox_0_hybrid: 0.1860 (0.1860)  loss_giou_0_hybrid: 0.8610 (0.8610)  loss_class_1_hybrid: 0.7848 (0.7848)  loss_bbox_1_hybrid: 0.1593 (0.1593)  loss_giou_1_hybrid: 0.7950 (0.7950)  loss_class_2_hybrid: 0.7528 (0.7528)  loss_bbox_2_hybrid: 0.1729 (0.1729)  loss_giou_2_hybrid: 0.8553 (0.8553)  loss_class_3_hybrid: 0.8526 (0.8526)  loss_bbox_3_hybrid: 0.1551 (0.1551)  loss_giou_3_hybrid: 0.7909 (0.7909)  loss_class_4_hybrid: 0.8870 (0.8870)  loss_bbox_4_hybrid: 0.1484 (0.1484)  loss_giou_4_hybrid: 0.7623 (0.7623)  loss_class_enc_hybrid: 0.7391 (0.7391)  loss_bbox_enc_hybrid: 0.2565 (0.2565)  loss_giou_enc_hybrid: 1.0159 (1.0159)  mem: 735  max mem: 19986
[2025-05-19 19:04:35 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:21:59 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5643  loss: 41.3473 (43.2072)  loss_class: 1.6241 (1.6565)  loss_bbox: 0.1957 (0.3303)  loss_giou: 0.3555 (0.4632)  loss_class_0: 1.2505 (1.2527)  loss_bbox_0: 0.2521 (0.4088)  loss_giou_0: 0.4708 (0.5317)  loss_class_1: 1.3130 (1.3568)  loss_bbox_1: 0.1664 (0.3683)  loss_giou_1: 0.3987 (0.4971)  loss_class_2: 1.1574 (1.4208)  loss_bbox_2: 0.2620 (0.3604)  loss_giou_2: 0.4381 (0.4922)  loss_class_3: 1.5611 (1.4988)  loss_bbox_3: 0.2276 (0.3519)  loss_giou_3: 0.3575 (0.4845)  loss_class_4: 1.6021 (1.5728)  loss_bbox_4: 0.2204 (0.3440)  loss_giou_4: 0.3487 (0.4782)  loss_class_enc: 1.1673 (1.2705)  loss_bbox_enc: 0.3140 (0.4914)  loss_giou_enc: 0.6280 (0.6234)  loss_class_dn: 0.5629 (0.6040)  loss_bbox_dn: 0.3521 (0.7575)  loss_giou_dn: 0.6275 (0.6858)  loss_class_dn_0: 0.5062 (0.4524)  loss_bbox_dn_0: 0.7159 (0.9495)  loss_giou_dn_0: 0.8265 (0.8442)  loss_class_dn_1: 0.5464 (0.4990)  loss_bbox_dn_1: 0.5073 (0.8155)  loss_giou_dn_1: 0.6582 (0.7372)  loss_class_dn_2: 0.5593 (0.5343)  loss_bbox_dn_2: 0.4274 (0.7784)  loss_giou_dn_2: 0.6342 (0.6985)  loss_class_dn_3: 0.5565 (0.5501)  loss_bbox_dn_3: 0.3754 (0.7646)  loss_giou_dn_3: 0.6281 (0.6901)  loss_class_dn_4: 0.5571 (0.5705)  loss_bbox_dn_4: 0.3560 (0.7591)  loss_giou_dn_4: 0.6265 (0.6844)  loss_class_hybrid: 1.2511 (1.1997)  loss_bbox_hybrid: 0.1808 (0.3624)  loss_giou_hybrid: 0.3328 (0.4902)  loss_class_0_hybrid: 1.0780 (1.0491)  loss_bbox_0_hybrid: 0.2436 (0.4419)  loss_giou_0_hybrid: 0.4959 (0.5700)  loss_class_1_hybrid: 1.1993 (1.1139)  loss_bbox_1_hybrid: 0.2210 (0.4000)  loss_giou_1_hybrid: 0.4348 (0.5262)  loss_class_2_hybrid: 1.1928 (1.1468)  loss_bbox_2_hybrid: 0.2262 (0.3862)  loss_giou_2_hybrid: 0.4391 (0.5114)  loss_class_3_hybrid: 1.1912 (1.1623)  loss_bbox_3_hybrid: 0.1926 (0.3768)  loss_giou_3_hybrid: 0.4075 (0.5047)  loss_class_4_hybrid: 1.1954 (1.1763)  loss_bbox_4_hybrid: 0.1834 (0.3703)  loss_giou_4_hybrid: 0.3730 (0.4991)  loss_class_enc_hybrid: 1.0404 (1.0814)  loss_bbox_enc_hybrid: 0.3699 (0.5369)  loss_giou_enc_hybrid: 0.5724 (0.6722)
[2025-05-19 19:21:59 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\pytorch_model.bin
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\optimizer.bin
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\scheduler.bin
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\sampler.bin
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\sampler_1.bin
[2025-05-19 19:21:59 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_2\random_states_0.pkl
[2025-05-19 19:21:59 det.__main__] INFO: Start evaluation
[2025-05-19 19:21:59 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1670 (0.1670)  evaluator_time: 0.0040 (0.0040)  time: 0.1950  data: 0.0240  mem: 730  max mem: 19986
[2025-05-19 19:22:01 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1681 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1753  data: 0.0028  mem: 730  max mem: 19986
[2025-05-19 19:22:03 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1724  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:04 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1718  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:06 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1722  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:08 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1684 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:10 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1684 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:11 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1677 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1719  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:13 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1678 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:15 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0008  mem: 730  max mem: 19986
[2025-05-19 19:22:16 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1688 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0008  mem: 730  max mem: 19986
[2025-05-19 19:22:18 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:20 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:22 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:23 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:25 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:27 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:29 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1678 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:30 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1673 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:32 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1674 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:22:34 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:35 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1681 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:22:37 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:39 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1673 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:41 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:42 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1682)  evaluator_time: 0.0036 (0.0033)  time: 0.1721  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:22:44 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1682)  evaluator_time: 0.0036 (0.0033)  time: 0.1722  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:22:46 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:22:47 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1683 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:22:49 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1682 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:51 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1682 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0009  mem: 730  max mem: 19986
[2025-05-19 19:22:53 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1683 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:22:54 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0003  mem: 730  max mem: 19986
[2025-05-19 19:22:56 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1681 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:22:58 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:00 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:01 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1696 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:23:03 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:05 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:23:07 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1740  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:23:08 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:10 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:23:12 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:13 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:15 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1689 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:17 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1686 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:23:18 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:23:18 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 19:23:19 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.25s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.287
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.100
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.067
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.138
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.406
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.534

[2025-05-19 19:23:19 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 12701 | 0.647  | 0.022 |
| Crescent_gap  | 48   | 48  | 8180  | 1.000  | 0.527 |
| Inclusion     | 41   | 82  | 16142 | 0.720  | 0.053 |
| Oil_spot      | 58   | 125 | 6840  | 0.672  | 0.248 |
| Punching      | 74   | 74  | 3001  | 0.946  | 0.510 |
| Rolled_pit    | 10   | 25  | 816   | 0.440  | 0.183 |
| Silk_spot     | 134  | 150 | 44736 | 0.780  | 0.113 |
| Waist_folding | 24   | 26  | 14934 | 0.923  | 0.286 |
| Water_spot    | 68   | 78  | 14501 | 0.872  | 0.346 |
| Welding_line  | 99   | 99  | 15549 | 1.000  | 0.584 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.800  | 0.287 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 19:23:19 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:23:19 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 19:23:19 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 19:23:19 det.util.engine] INFO: Epoch: [3]  [0/1834]  eta: 0:12:29  lr: 0.000100  data_time: 0.0009  iter_time: 0.4085  loss: 0.1666 (0.1666)  loss_class: 0.0083 (0.0083)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0011 (0.0011)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0039 (0.0039)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0080 (0.0080)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0163 (0.0163)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0122 (0.0122)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0008 (0.0008)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0179 (0.0179)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0025 (0.0025)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0093 (0.0093)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0236 (0.0236)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0365 (0.0365)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0247 (0.0247)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0014 (0.0014)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 737  max mem: 19986
[2025-05-19 19:23:19 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:40:39 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5514  loss: 42.5234 (40.6423)  loss_class: 1.8693 (1.3922)  loss_bbox: 0.1470 (0.3473)  loss_giou: 0.2572 (0.4697)  loss_class_0: 1.3068 (1.1982)  loss_bbox_0: 0.3070 (0.3822)  loss_giou_0: 0.4192 (0.5134)  loss_class_1: 1.4124 (1.2493)  loss_bbox_1: 0.2265 (0.3598)  loss_giou_1: 0.3451 (0.4899)  loss_class_2: 1.7374 (1.2517)  loss_bbox_2: 0.1893 (0.3646)  loss_giou_2: 0.2639 (0.4896)  loss_class_3: 1.8272 (1.2980)  loss_bbox_3: 0.1860 (0.3574)  loss_giou_3: 0.2598 (0.4790)  loss_class_4: 1.8484 (1.3385)  loss_bbox_4: 0.1890 (0.3531)  loss_giou_4: 0.2609 (0.4777)  loss_class_enc: 1.2455 (1.2395)  loss_bbox_enc: 0.4612 (0.4712)  loss_giou_enc: 0.6334 (0.6072)  loss_class_dn: 0.5859 (0.5201)  loss_bbox_dn: 0.3944 (0.7047)  loss_giou_dn: 0.4623 (0.6453)  loss_class_dn_0: 0.5396 (0.4486)  loss_bbox_dn_0: 0.7670 (0.8895)  loss_giou_dn_0: 0.7055 (0.8017)  loss_class_dn_1: 0.5478 (0.4730)  loss_bbox_dn_1: 0.4821 (0.7576)  loss_giou_dn_1: 0.5380 (0.6937)  loss_class_dn_2: 0.5456 (0.4940)  loss_bbox_dn_2: 0.4014 (0.7228)  loss_giou_dn_2: 0.4910 (0.6580)  loss_class_dn_3: 0.5616 (0.5049)  loss_bbox_dn_3: 0.3878 (0.7096)  loss_giou_dn_3: 0.4692 (0.6484)  loss_class_dn_4: 0.5676 (0.5132)  loss_bbox_dn_4: 0.3960 (0.7055)  loss_giou_dn_4: 0.4563 (0.6435)  loss_class_hybrid: 1.3270 (1.1197)  loss_bbox_hybrid: 0.2564 (0.3584)  loss_giou_hybrid: 0.3000 (0.4790)  loss_class_0_hybrid: 1.0949 (1.0156)  loss_bbox_0_hybrid: 0.3429 (0.4233)  loss_giou_0_hybrid: 0.3642 (0.5426)  loss_class_1_hybrid: 1.0611 (1.0857)  loss_bbox_1_hybrid: 0.2803 (0.3819)  loss_giou_1_hybrid: 0.3533 (0.5008)  loss_class_2_hybrid: 1.2081 (1.0957)  loss_bbox_2_hybrid: 0.2804 (0.3729)  loss_giou_2_hybrid: 0.3060 (0.4919)  loss_class_3_hybrid: 1.2668 (1.1054)  loss_bbox_3_hybrid: 0.2730 (0.3650)  loss_giou_3_hybrid: 0.3129 (0.4849)  loss_class_4_hybrid: 1.3271 (1.1065)  loss_bbox_4_hybrid: 0.2770 (0.3612)  loss_giou_4_hybrid: 0.3105 (0.4826)  loss_class_enc_hybrid: 1.0411 (1.0269)  loss_bbox_enc_hybrid: 0.4123 (0.5265)  loss_giou_enc_hybrid: 0.5701 (0.6518)
[2025-05-19 19:40:39 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3
[2025-05-19 19:40:39 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\pytorch_model.bin
[2025-05-19 19:40:40 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\optimizer.bin
[2025-05-19 19:40:40 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\scheduler.bin
[2025-05-19 19:40:40 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\sampler.bin
[2025-05-19 19:40:40 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\sampler_1.bin
[2025-05-19 19:40:40 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_3\random_states_0.pkl
[2025-05-19 19:40:40 det.__main__] INFO: Start evaluation
[2025-05-19 19:40:40 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1677 (0.1677)  evaluator_time: 0.0030 (0.0030)  time: 0.1997  data: 0.0290  mem: 730  max mem: 19986
[2025-05-19 19:40:42 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1748  data: 0.0029  mem: 730  max mem: 19986
[2025-05-19 19:40:43 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1717  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:40:45 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1676 (0.1681)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:40:47 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1676 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1718  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:40:49 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1672 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1719  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:40:50 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:40:52 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:40:54 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1684 (0.1681)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:40:55 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1686 (0.1682)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:40:57 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1688 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:40:59 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:01 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:02 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:41:04 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1688 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:06 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:08 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:09 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1682 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:41:11 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1687 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:13 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1682 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0009  mem: 730  max mem: 19986
[2025-05-19 19:41:14 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1682 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:16 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1684 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:18 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1682 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:20 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:21 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:23 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:25 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:27 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0008  mem: 730  max mem: 19986
[2025-05-19 19:41:28 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:30 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:32 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1684 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:33 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:35 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0008  mem: 730  max mem: 19986
[2025-05-19 19:41:37 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1689 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:41:39 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0003  mem: 730  max mem: 19986
[2025-05-19 19:41:40 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1689 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:42 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:44 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:46 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:47 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1687)  evaluator_time: 0.0040 (0.0033)  time: 0.1741  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:49 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:51 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 730  max mem: 19986
[2025-05-19 19:41:53 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:41:54 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1691 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:41:56 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1697 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0004  mem: 730  max mem: 19986
[2025-05-19 19:41:58 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1696 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 730  max mem: 19986
[2025-05-19 19:41:59 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19986
[2025-05-19 19:41:59 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 19:41:59 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.26s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.172
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.130
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.092
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.513

[2025-05-19 19:41:59 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2031  | 0.471  | 0.117 |
| Crescent_gap  | 48   | 48  | 12538 | 1.000  | 0.561 |
| Inclusion     | 41   | 82  | 1956  | 0.524  | 0.046 |
| Oil_spot      | 58   | 125 | 12703 | 0.736  | 0.224 |
| Punching      | 74   | 74  | 2061  | 0.959  | 0.885 |
| Rolled_pit    | 10   | 25  | 2107  | 0.440  | 0.157 |
| Silk_spot     | 134  | 150 | 36933 | 0.787  | 0.243 |
| Waist_folding | 24   | 26  | 8964  | 0.885  | 0.291 |
| Water_spot    | 68   | 78  | 40318 | 0.910  | 0.335 |
| Welding_line  | 99   | 99  | 17789 | 1.000  | 0.780 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.771  | 0.364 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 19:41:59 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:42:00 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 19:42:00 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 19:42:01 det.util.engine] INFO: Epoch: [4]  [0/1834]  eta: 0:19:39  lr: 0.000100  data_time: 0.0008  iter_time: 0.6433  loss: 68.6465 (68.6465)  loss_class: 2.9481 (2.9481)  loss_bbox: 0.2416 (0.2416)  loss_giou: 0.1793 (0.1793)  loss_class_0: 1.3293 (1.3293)  loss_bbox_0: 0.7805 (0.7805)  loss_giou_0: 0.5569 (0.5569)  loss_class_1: 2.0329 (2.0329)  loss_bbox_1: 0.4952 (0.4952)  loss_giou_1: 0.3085 (0.3085)  loss_class_2: 2.2498 (2.2498)  loss_bbox_2: 0.2856 (0.2856)  loss_giou_2: 0.2102 (0.2102)  loss_class_3: 2.5214 (2.5214)  loss_bbox_3: 0.2492 (0.2492)  loss_giou_3: 0.1976 (0.1976)  loss_class_4: 3.3769 (3.3769)  loss_bbox_4: 0.2456 (0.2456)  loss_giou_4: 0.1896 (0.1896)  loss_class_enc: 3.3113 (3.3113)  loss_bbox_enc: 0.5028 (0.5028)  loss_giou_enc: 0.4317 (0.4317)  loss_class_dn: 0.4354 (0.4354)  loss_bbox_dn: 2.6300 (2.6300)  loss_giou_dn: 1.1278 (1.1278)  loss_class_dn_0: 0.4724 (0.4724)  loss_bbox_dn_0: 2.6581 (2.6581)  loss_giou_dn_0: 1.1049 (1.1049)  loss_class_dn_1: 0.4503 (0.4503)  loss_bbox_dn_1: 2.6182 (2.6182)  loss_giou_dn_1: 1.1169 (1.1169)  loss_class_dn_2: 0.4507 (0.4507)  loss_bbox_dn_2: 2.5819 (2.5819)  loss_giou_dn_2: 1.1097 (1.1097)  loss_class_dn_3: 0.4501 (0.4501)  loss_bbox_dn_3: 2.6266 (2.6266)  loss_giou_dn_3: 1.1260 (1.1260)  loss_class_dn_4: 0.4554 (0.4554)  loss_bbox_dn_4: 2.6317 (2.6317)  loss_giou_dn_4: 1.1274 (1.1274)  loss_class_hybrid: 2.1770 (2.1770)  loss_bbox_hybrid: 0.3734 (0.3734)  loss_giou_hybrid: 0.2713 (0.2713)  loss_class_0_hybrid: 2.1098 (2.1098)  loss_bbox_0_hybrid: 0.4633 (0.4633)  loss_giou_0_hybrid: 0.3920 (0.3920)  loss_class_1_hybrid: 2.0042 (2.0042)  loss_bbox_1_hybrid: 0.5268 (0.5268)  loss_giou_1_hybrid: 0.2965 (0.2965)  loss_class_2_hybrid: 2.0814 (2.0814)  loss_bbox_2_hybrid: 0.4207 (0.4207)  loss_giou_2_hybrid: 0.2998 (0.2998)  loss_class_3_hybrid: 2.3812 (2.3812)  loss_bbox_3_hybrid: 0.3790 (0.3790)  loss_giou_3_hybrid: 0.2752 (0.2752)  loss_class_4_hybrid: 2.5474 (2.5474)  loss_bbox_4_hybrid: 0.3741 (0.3741)  loss_giou_4_hybrid: 0.2741 (0.2741)  loss_class_enc_hybrid: 2.2156 (2.2156)  loss_bbox_enc_hybrid: 0.5881 (0.5881)  loss_giou_enc_hybrid: 0.3782 (0.3782)  mem: 737  max mem: 19986
[2025-05-19 19:42:01 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 19:59:20 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5644  loss: 34.4683 (39.3536)  loss_class: 0.6850 (1.3158)  loss_bbox: 0.2448 (0.3295)  loss_giou: 0.4367 (0.4576)  loss_class_0: 1.1157 (1.1797)  loss_bbox_0: 0.2245 (0.3734)  loss_giou_0: 0.4874 (0.4947)  loss_class_1: 0.7822 (1.2319)  loss_bbox_1: 0.2642 (0.3422)  loss_giou_1: 0.3968 (0.4735)  loss_class_2: 0.6007 (1.2027)  loss_bbox_2: 0.2575 (0.3432)  loss_giou_2: 0.4957 (0.4725)  loss_class_3: 0.5749 (1.2408)  loss_bbox_3: 0.2506 (0.3348)  loss_giou_3: 0.4934 (0.4648)  loss_class_4: 0.6237 (1.2930)  loss_bbox_4: 0.2504 (0.3271)  loss_giou_4: 0.4759 (0.4589)  loss_class_enc: 1.0499 (1.2307)  loss_bbox_enc: 0.3766 (0.4520)  loss_giou_enc: 0.6276 (0.5858)  loss_class_dn: 0.4993 (0.4895)  loss_bbox_dn: 0.3114 (0.6793)  loss_giou_dn: 0.5517 (0.6158)  loss_class_dn_0: 0.5050 (0.4451)  loss_bbox_dn_0: 0.6639 (0.8542)  loss_giou_dn_0: 0.7285 (0.7759)  loss_class_dn_1: 0.4947 (0.4578)  loss_bbox_dn_1: 0.4224 (0.7269)  loss_giou_dn_1: 0.6554 (0.6637)  loss_class_dn_2: 0.4857 (0.4712)  loss_bbox_dn_2: 0.3029 (0.6954)  loss_giou_dn_2: 0.5836 (0.6302)  loss_class_dn_3: 0.4935 (0.4809)  loss_bbox_dn_3: 0.3152 (0.6838)  loss_giou_dn_3: 0.5546 (0.6200)  loss_class_dn_4: 0.5051 (0.4857)  loss_bbox_dn_4: 0.3065 (0.6800)  loss_giou_dn_4: 0.5411 (0.6149)  loss_class_hybrid: 0.9449 (1.1036)  loss_bbox_hybrid: 0.2092 (0.3389)  loss_giou_hybrid: 0.4212 (0.4636)  loss_class_0_hybrid: 1.0818 (1.0281)  loss_bbox_0_hybrid: 0.2786 (0.3969)  loss_giou_0_hybrid: 0.4636 (0.5228)  loss_class_1_hybrid: 1.1367 (1.0919)  loss_bbox_1_hybrid: 0.2241 (0.3552)  loss_giou_1_hybrid: 0.4249 (0.4811)  loss_class_2_hybrid: 0.8748 (1.0965)  loss_bbox_2_hybrid: 0.2020 (0.3449)  loss_giou_2_hybrid: 0.4419 (0.4730)  loss_class_3_hybrid: 0.9081 (1.1015)  loss_bbox_3_hybrid: 0.2198 (0.3414)  loss_giou_3_hybrid: 0.4294 (0.4680)  loss_class_4_hybrid: 0.9458 (1.1016)  loss_bbox_4_hybrid: 0.2214 (0.3380)  loss_giou_4_hybrid: 0.4179 (0.4655)  loss_class_enc_hybrid: 1.0147 (1.0378)  loss_bbox_enc_hybrid: 0.3651 (0.4994)  loss_giou_enc_hybrid: 0.5628 (0.6285)
[2025-05-19 19:59:20 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4
[2025-05-19 19:59:20 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\pytorch_model.bin
[2025-05-19 19:59:21 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\optimizer.bin
[2025-05-19 19:59:21 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\scheduler.bin
[2025-05-19 19:59:21 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\sampler.bin
[2025-05-19 19:59:21 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\sampler_1.bin
[2025-05-19 19:59:21 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_4\random_states_0.pkl
[2025-05-19 19:59:21 det.__main__] INFO: Start evaluation
[2025-05-19 19:59:21 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1688 (0.1688)  evaluator_time: 0.0030 (0.0030)  time: 0.1918  data: 0.0200  mem: 726  max mem: 19986
[2025-05-19 19:59:23 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1688 (0.1697)  evaluator_time: 0.0030 (0.0029)  time: 0.1751  data: 0.0023  mem: 726  max mem: 19986
[2025-05-19 19:59:24 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1685 (0.1691)  evaluator_time: 0.0030 (0.0027)  time: 0.1725  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:26 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0029)  time: 0.1722  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 19:59:28 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1685 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1727  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:30 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1681 (0.1691)  evaluator_time: 0.0031 (0.0031)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:31 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0003  mem: 726  max mem: 19986
[2025-05-19 19:59:33 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 19:59:35 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:37 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:38 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:40 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:42 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:43 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 19:59:45 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1684 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:47 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:49 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1687 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1733  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:50 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1686 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1734  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 19:59:52 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:54 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:56 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1696 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1739  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 19:59:57 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 19:59:59 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:01 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:03 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1695 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:04 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1695 (0.1690)  evaluator_time: 0.0040 (0.0034)  time: 0.1740  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:06 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0007  mem: 726  max mem: 19986
[2025-05-19 20:00:08 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0007  mem: 726  max mem: 19986
[2025-05-19 20:00:09 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1733  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:11 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:13 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:15 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1733  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:16 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1696 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:18 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1696 (0.1691)  evaluator_time: 0.0040 (0.0034)  time: 0.1744  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:20 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1687 (0.1691)  evaluator_time: 0.0040 (0.0034)  time: 0.1738  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:22 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1676 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:23 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1676 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:25 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1676 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:27 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:29 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1690)  evaluator_time: 0.0040 (0.0038)  time: 0.1795  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:30 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0038)  time: 0.1796  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:32 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1719  data: 0.0005  mem: 726  max mem: 19986
[2025-05-19 20:00:34 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1723  data: 0.0006  mem: 726  max mem: 19986
[2025-05-19 20:00:36 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1723  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:37 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1720  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:39 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1721  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:40 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1718  data: 0.0004  mem: 726  max mem: 19986
[2025-05-19 20:00:40 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0037)
[2025-05-19 20:00:41 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.26s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.217
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.452
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.206
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.411
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.545

[2025-05-19 20:00:41 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2777  | 0.706  | 0.136 |
| Crescent_gap  | 48   | 48  | 11233 | 1.000  | 0.637 |
| Inclusion     | 41   | 82  | 10990 | 0.585  | 0.167 |
| Oil_spot      | 58   | 125 | 8747  | 0.648  | 0.212 |
| Punching      | 74   | 74  | 2610  | 0.973  | 0.925 |
| Rolled_pit    | 10   | 25  | 1867  | 0.480  | 0.039 |
| Silk_spot     | 134  | 150 | 53614 | 0.833  | 0.452 |
| Waist_folding | 24   | 26  | 7318  | 0.962  | 0.628 |
| Water_spot    | 68   | 78  | 21908 | 0.872  | 0.503 |
| Welding_line  | 99   | 99  | 16335 | 1.000  | 0.822 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.806  | 0.452 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 20:00:41 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:00:41 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 20:00:41 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 20:00:42 det.util.engine] INFO: Epoch: [5]  [0/1834]  eta: 0:16:40  lr: 0.000100  data_time: 0.0010  iter_time: 0.5453  loss: 32.9349 (32.9349)  loss_class: 0.7719 (0.7719)  loss_bbox: 0.2967 (0.2967)  loss_giou: 0.5728 (0.5728)  loss_class_0: 1.0753 (1.0753)  loss_bbox_0: 0.2826 (0.2826)  loss_giou_0: 0.5048 (0.5048)  loss_class_1: 0.6789 (0.6789)  loss_bbox_1: 0.3217 (0.3217)  loss_giou_1: 0.6378 (0.6378)  loss_class_2: 0.5248 (0.5248)  loss_bbox_2: 0.2913 (0.2913)  loss_giou_2: 0.6234 (0.6234)  loss_class_3: 0.5463 (0.5463)  loss_bbox_3: 0.2927 (0.2927)  loss_giou_3: 0.6391 (0.6391)  loss_class_4: 0.5777 (0.5777)  loss_bbox_4: 0.2945 (0.2945)  loss_giou_4: 0.6320 (0.6320)  loss_class_enc: 0.7838 (0.7838)  loss_bbox_enc: 0.3946 (0.3946)  loss_giou_enc: 0.7863 (0.7863)  loss_class_dn: 0.5161 (0.5161)  loss_bbox_dn: 0.3946 (0.3946)  loss_giou_dn: 0.7141 (0.7141)  loss_class_dn_0: 0.4833 (0.4833)  loss_bbox_dn_0: 0.5606 (0.5606)  loss_giou_dn_0: 0.8950 (0.8950)  loss_class_dn_1: 0.4566 (0.4566)  loss_bbox_dn_1: 0.4108 (0.4108)  loss_giou_dn_1: 0.7355 (0.7355)  loss_class_dn_2: 0.4916 (0.4916)  loss_bbox_dn_2: 0.4072 (0.4072)  loss_giou_dn_2: 0.7363 (0.7363)  loss_class_dn_3: 0.4941 (0.4941)  loss_bbox_dn_3: 0.3850 (0.3850)  loss_giou_dn_3: 0.7259 (0.7259)  loss_class_dn_4: 0.5000 (0.5000)  loss_bbox_dn_4: 0.3751 (0.3751)  loss_giou_dn_4: 0.7096 (0.7096)  loss_class_hybrid: 0.5878 (0.5878)  loss_bbox_hybrid: 0.3235 (0.3235)  loss_giou_hybrid: 0.6051 (0.6051)  loss_class_0_hybrid: 0.6632 (0.6632)  loss_bbox_0_hybrid: 0.3497 (0.3497)  loss_giou_0_hybrid: 0.6552 (0.6552)  loss_class_1_hybrid: 0.7191 (0.7191)  loss_bbox_1_hybrid: 0.3096 (0.3096)  loss_giou_1_hybrid: 0.5783 (0.5783)  loss_class_2_hybrid: 0.5751 (0.5751)  loss_bbox_2_hybrid: 0.3309 (0.3309)  loss_giou_2_hybrid: 0.6241 (0.6241)  loss_class_3_hybrid: 0.5963 (0.5963)  loss_bbox_3_hybrid: 0.3236 (0.3236)  loss_giou_3_hybrid: 0.6255 (0.6255)  loss_class_4_hybrid: 0.6049 (0.6049)  loss_bbox_4_hybrid: 0.3179 (0.3179)  loss_giou_4_hybrid: 0.5996 (0.5996)  loss_class_enc_hybrid: 0.7031 (0.7031)  loss_bbox_enc_hybrid: 0.5114 (0.5114)  loss_giou_enc_hybrid: 0.8109 (0.8109)  mem: 739  max mem: 19986
[2025-05-19 20:00:42 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:17:59 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5500  loss: 36.7152 (37.7860)  loss_class: 0.7579 (1.1747)  loss_bbox: 0.2364 (0.3281)  loss_giou: 0.3721 (0.4514)  loss_class_0: 1.2734 (1.1467)  loss_bbox_0: 0.1969 (0.3660)  loss_giou_0: 0.5130 (0.4949)  loss_class_1: 0.7853 (1.1609)  loss_bbox_1: 0.2284 (0.3340)  loss_giou_1: 0.4401 (0.4658)  loss_class_2: 0.7176 (1.1316)  loss_bbox_2: 0.2100 (0.3364)  loss_giou_2: 0.3888 (0.4650)  loss_class_3: 0.9800 (1.1293)  loss_bbox_3: 0.2031 (0.3356)  loss_giou_3: 0.3646 (0.4575)  loss_class_4: 0.8465 (1.1517)  loss_bbox_4: 0.2259 (0.3286)  loss_giou_4: 0.3643 (0.4546)  loss_class_enc: 0.9863 (1.2112)  loss_bbox_enc: 0.3437 (0.4470)  loss_giou_enc: 0.5243 (0.5855)  loss_class_dn: 0.4708 (0.4673)  loss_bbox_dn: 0.3544 (0.6384)  loss_giou_dn: 0.6641 (0.5921)  loss_class_dn_0: 0.4787 (0.4371)  loss_bbox_dn_0: 0.8066 (0.8055)  loss_giou_dn_0: 0.8257 (0.7528)  loss_class_dn_1: 0.4892 (0.4500)  loss_bbox_dn_1: 0.4693 (0.6818)  loss_giou_dn_1: 0.7019 (0.6369)  loss_class_dn_2: 0.4793 (0.4578)  loss_bbox_dn_2: 0.3523 (0.6523)  loss_giou_dn_2: 0.6706 (0.6043)  loss_class_dn_3: 0.4743 (0.4644)  loss_bbox_dn_3: 0.3610 (0.6421)  loss_giou_dn_3: 0.6717 (0.5941)  loss_class_dn_4: 0.4701 (0.4665)  loss_bbox_dn_4: 0.3557 (0.6389)  loss_giou_dn_4: 0.6752 (0.5911)  loss_class_hybrid: 0.7687 (1.0440)  loss_bbox_hybrid: 0.2484 (0.3333)  loss_giou_hybrid: 0.4487 (0.4596)  loss_class_0_hybrid: 0.9690 (0.9937)  loss_bbox_0_hybrid: 0.2773 (0.3820)  loss_giou_0_hybrid: 0.4685 (0.5145)  loss_class_1_hybrid: 0.7908 (1.0411)  loss_bbox_1_hybrid: 0.2593 (0.3458)  loss_giou_1_hybrid: 0.4910 (0.4744)  loss_class_2_hybrid: 0.7235 (1.0499)  loss_bbox_2_hybrid: 0.2381 (0.3362)  loss_giou_2_hybrid: 0.3809 (0.4661)  loss_class_3_hybrid: 0.7846 (1.0540)  loss_bbox_3_hybrid: 0.2350 (0.3325)  loss_giou_3_hybrid: 0.3688 (0.4614)  loss_class_4_hybrid: 0.7900 (1.0446)  loss_bbox_4_hybrid: 0.2457 (0.3327)  loss_giou_4_hybrid: 0.3942 (0.4615)  loss_class_enc_hybrid: 0.8988 (1.0277)  loss_bbox_enc_hybrid: 0.4514 (0.4818)  loss_giou_enc_hybrid: 0.5571 (0.6191)
[2025-05-19 20:17:59 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 20:17:59 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\pytorch_model.bin
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\optimizer.bin
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\scheduler.bin
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\sampler.bin
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\sampler_1.bin
[2025-05-19 20:17:59 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_5\random_states_0.pkl
[2025-05-19 20:17:59 det.__main__] INFO: Start evaluation
[2025-05-19 20:17:59 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1720 (0.1720)  evaluator_time: 0.0040 (0.0040)  time: 0.1970  data: 0.0210  mem: 728  max mem: 19986
[2025-05-19 20:18:01 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1698)  evaluator_time: 0.0030 (0.0033)  time: 0.1757  data: 0.0025  mem: 728  max mem: 19986
[2025-05-19 20:18:03 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:05 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1685 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:06 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:08 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:10 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:11 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1685 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:13 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1685 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:15 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:18:17 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1691)  evaluator_time: 0.0040 (0.0032)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:18:18 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1688 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:20 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:22 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1673 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:24 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1670 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:25 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1670 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:27 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1670 (0.1686)  evaluator_time: 0.0040 (0.0034)  time: 0.1720  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 20:18:29 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1670 (0.1685)  evaluator_time: 0.0040 (0.0034)  time: 0.1717  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:30 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1670 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:32 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:34 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:36 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1676 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1717  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:37 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1672 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:39 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:41 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1676 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:42 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:44 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1723  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:46 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1678 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:48 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0038)  time: 0.1772  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:49 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:18:51 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1684 (0.1682)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:18:53 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1686 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1729  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:55 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:56 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:18:58 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0037)  time: 0.1732  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:19:00 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1691 (0.1684)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:19:02 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:19:03 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1686 (0.1684)  evaluator_time: 0.0030 (0.0037)  time: 0.1730  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:19:05 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1697 (0.1685)  evaluator_time: 0.0030 (0.0036)  time: 0.1732  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:19:07 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1750  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:19:09 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1745  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:19:10 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1691 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:19:12 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1691 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:19:14 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1686 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 20:19:15 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1686 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1732  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 20:19:17 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1695 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1736  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 20:19:18 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1695 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 20:19:18 det.util.engine] INFO: Averaged stats: model_time: 0.1695 (0.1686)  evaluator_time: 0.0030 (0.0036)
[2025-05-19 20:19:19 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.32s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.226
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.482
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.454
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.582
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.468
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.591

[2025-05-19 20:19:19 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 8238  | 0.824  | 0.163 |
| Crescent_gap  | 48   | 48  | 4436  | 0.979  | 0.754 |
| Inclusion     | 41   | 82  | 9362  | 0.805  | 0.223 |
| Oil_spot      | 58   | 125 | 16743 | 0.832  | 0.349 |
| Punching      | 74   | 74  | 1879  | 0.973  | 0.903 |
| Rolled_pit    | 10   | 25  | 10326 | 0.800  | 0.167 |
| Silk_spot     | 134  | 150 | 40835 | 0.840  | 0.372 |
| Waist_folding | 24   | 26  | 8510  | 0.962  | 0.489 |
| Water_spot    | 68   | 78  | 26255 | 0.974  | 0.537 |
| Welding_line  | 99   | 99  | 10816 | 1.000  | 0.864 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.899  | 0.482 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 20:19:19 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:19:19 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 20:19:19 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 20:19:20 det.util.engine] INFO: Epoch: [6]  [0/1834]  eta: 0:19:04  lr: 0.000100  data_time: 0.0007  iter_time: 0.6240  loss: 35.4204 (35.4204)  loss_class: 1.3330 (1.3330)  loss_bbox: 0.1401 (0.1401)  loss_giou: 0.3327 (0.3327)  loss_class_0: 2.2207 (2.2207)  loss_bbox_0: 0.0726 (0.0726)  loss_giou_0: 0.1871 (0.1871)  loss_class_1: 0.7478 (0.7478)  loss_bbox_1: 0.1436 (0.1436)  loss_giou_1: 0.3922 (0.3922)  loss_class_2: 0.6308 (0.6308)  loss_bbox_2: 0.1553 (0.1553)  loss_giou_2: 0.3780 (0.3780)  loss_class_3: 0.7810 (0.7810)  loss_bbox_3: 0.1486 (0.1486)  loss_giou_3: 0.3660 (0.3660)  loss_class_4: 1.4164 (1.4164)  loss_bbox_4: 0.1548 (0.1548)  loss_giou_4: 0.3569 (0.3569)  loss_class_enc: 1.8543 (1.8543)  loss_bbox_enc: 0.1773 (0.1773)  loss_giou_enc: 0.4566 (0.4566)  loss_class_dn: 0.4712 (0.4712)  loss_bbox_dn: 0.3336 (0.3336)  loss_giou_dn: 0.5047 (0.5047)  loss_class_dn_0: 0.5280 (0.5280)  loss_bbox_dn_0: 0.4916 (0.4916)  loss_giou_dn_0: 0.7987 (0.7987)  loss_class_dn_1: 0.5472 (0.5472)  loss_bbox_dn_1: 0.3826 (0.3826)  loss_giou_dn_1: 0.6106 (0.6106)  loss_class_dn_2: 0.4964 (0.4964)  loss_bbox_dn_2: 0.3346 (0.3346)  loss_giou_dn_2: 0.5260 (0.5260)  loss_class_dn_3: 0.4766 (0.4766)  loss_bbox_dn_3: 0.3351 (0.3351)  loss_giou_dn_3: 0.5155 (0.5155)  loss_class_dn_4: 0.4822 (0.4822)  loss_bbox_dn_4: 0.3365 (0.3365)  loss_giou_dn_4: 0.5197 (0.5197)  loss_class_hybrid: 1.2902 (1.2902)  loss_bbox_hybrid: 0.1386 (0.1386)  loss_giou_hybrid: 0.3159 (0.3159)  loss_class_0_hybrid: 2.6532 (2.6532)  loss_bbox_0_hybrid: 0.1050 (0.1050)  loss_giou_0_hybrid: 0.2837 (0.2837)  loss_class_1_hybrid: 1.4126 (1.4126)  loss_bbox_1_hybrid: 0.1355 (0.1355)  loss_giou_1_hybrid: 0.3335 (0.3335)  loss_class_2_hybrid: 1.2863 (1.2863)  loss_bbox_2_hybrid: 0.1450 (0.1450)  loss_giou_2_hybrid: 0.3464 (0.3464)  loss_class_3_hybrid: 1.0784 (1.0784)  loss_bbox_3_hybrid: 0.1540 (0.1540)  loss_giou_3_hybrid: 0.3586 (0.3586)  loss_class_4_hybrid: 1.6017 (1.6017)  loss_bbox_4_hybrid: 0.1488 (0.1488)  loss_giou_4_hybrid: 0.3388 (0.3388)  loss_class_enc_hybrid: 1.2844 (1.2844)  loss_bbox_enc_hybrid: 0.2927 (0.2927)  loss_giou_enc_hybrid: 0.5807 (0.5807)  mem: 738  max mem: 19986
[2025-05-19 20:19:20 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:36:37 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5547  loss: 29.4177 (36.8372)  loss_class: 0.5949 (1.0824)  loss_bbox: 0.2212 (0.3341)  loss_giou: 0.3229 (0.4640)  loss_class_0: 0.6690 (1.0990)  loss_bbox_0: 0.2608 (0.3592)  loss_giou_0: 0.3819 (0.5018)  loss_class_1: 0.7692 (1.0811)  loss_bbox_1: 0.2188 (0.3351)  loss_giou_1: 0.3670 (0.4751)  loss_class_2: 0.5605 (1.0579)  loss_bbox_2: 0.2205 (0.3350)  loss_giou_2: 0.3711 (0.4740)  loss_class_3: 0.6552 (1.0633)  loss_bbox_3: 0.2158 (0.3316)  loss_giou_3: 0.3924 (0.4658)  loss_class_4: 0.5427 (1.0553)  loss_bbox_4: 0.2130 (0.3347)  loss_giou_4: 0.3971 (0.4669)  loss_class_enc: 1.1833 (1.1601)  loss_bbox_enc: 0.2527 (0.4412)  loss_giou_enc: 0.4849 (0.5924)  loss_class_dn: 0.4817 (0.4533)  loss_bbox_dn: 0.1933 (0.6127)  loss_giou_dn: 0.4085 (0.5819)  loss_class_dn_0: 0.4902 (0.4323)  loss_bbox_dn_0: 0.8030 (0.7696)  loss_giou_dn_0: 0.7279 (0.7388)  loss_class_dn_1: 0.4844 (0.4396)  loss_bbox_dn_1: 0.4159 (0.6525)  loss_giou_dn_1: 0.5712 (0.6258)  loss_class_dn_2: 0.4763 (0.4463)  loss_bbox_dn_2: 0.2764 (0.6254)  loss_giou_dn_2: 0.4996 (0.5935)  loss_class_dn_3: 0.4678 (0.4508)  loss_bbox_dn_3: 0.2194 (0.6160)  loss_giou_dn_3: 0.4545 (0.5839)  loss_class_dn_4: 0.4817 (0.4536)  loss_bbox_dn_4: 0.1890 (0.6131)  loss_giou_dn_4: 0.4177 (0.5808)  loss_class_hybrid: 0.7658 (1.0137)  loss_bbox_hybrid: 0.1890 (0.3286)  loss_giou_hybrid: 0.3121 (0.4680)  loss_class_0_hybrid: 0.6827 (0.9880)  loss_bbox_0_hybrid: 0.2464 (0.3735)  loss_giou_0_hybrid: 0.3857 (0.5187)  loss_class_1_hybrid: 0.7797 (1.0121)  loss_bbox_1_hybrid: 0.2045 (0.3402)  loss_giou_1_hybrid: 0.3029 (0.4820)  loss_class_2_hybrid: 0.7145 (1.0142)  loss_bbox_2_hybrid: 0.1877 (0.3332)  loss_giou_2_hybrid: 0.3025 (0.4749)  loss_class_3_hybrid: 0.7962 (1.0017)  loss_bbox_3_hybrid: 0.1811 (0.3311)  loss_giou_3_hybrid: 0.3055 (0.4719)  loss_class_4_hybrid: 0.7485 (1.0003)  loss_bbox_4_hybrid: 0.1877 (0.3311)  loss_giou_4_hybrid: 0.3185 (0.4714)  loss_class_enc_hybrid: 1.0704 (0.9950)  loss_bbox_enc_hybrid: 0.4079 (0.4794)  loss_giou_enc_hybrid: 0.5471 (0.6282)
[2025-05-19 20:36:37 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 20:36:37 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\pytorch_model.bin
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\optimizer.bin
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\scheduler.bin
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\sampler.bin
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\sampler_1.bin
[2025-05-19 20:36:37 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_6\random_states_0.pkl
[2025-05-19 20:36:37 det.__main__] INFO: Start evaluation
[2025-05-19 20:36:38 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1950  data: 0.0240  mem: 729  max mem: 19986
[2025-05-19 20:36:39 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1677 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1742  data: 0.0027  mem: 729  max mem: 19986
[2025-05-19 20:36:41 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1676 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1717  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:43 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1671 (0.1678)  evaluator_time: 0.0030 (0.0030)  time: 0.1711  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 20:36:45 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1712  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 20:36:46 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0031)  time: 0.1717  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:48 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1671 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:36:50 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1676 (0.1677)  evaluator_time: 0.0030 (0.0031)  time: 0.1716  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:51 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:53 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:55 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:36:57 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:36:58 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1688 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:00 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:02 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1696 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 20:37:04 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1696 (0.1685)  evaluator_time: 0.0030 (0.0040)  time: 0.1794  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:05 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0040)  time: 0.1793  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:07 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0039)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:09 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0039)  time: 0.1733  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:11 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1687)  evaluator_time: 0.0040 (0.0039)  time: 0.1735  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:12 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1687)  evaluator_time: 0.0040 (0.0039)  time: 0.1733  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:14 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0038)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:16 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0038)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:18 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0038)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:19 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:21 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1698 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1741  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 20:37:23 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1734  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 20:37:25 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:26 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1691 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:28 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1694 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:30 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:31 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1736  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:33 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1736  data: 0.0008  mem: 729  max mem: 19986
[2025-05-19 20:37:35 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1691 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:37 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1739  data: 0.0004  mem: 729  max mem: 19986
[2025-05-19 20:37:38 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1737  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:40 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:42 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:44 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1695 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:45 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1699 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1750  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:47 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1746  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:49 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:51 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:52 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19986
[2025-05-19 20:37:54 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0006  mem: 729  max mem: 19986
[2025-05-19 20:37:56 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1736  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:57 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1734  data: 0.0005  mem: 729  max mem: 19986
[2025-05-19 20:37:57 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)
[2025-05-19 20:37:57 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.239
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.502
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.200
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.446
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.576
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.574

[2025-05-19 20:37:57 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3724  | 0.706  | 0.177 |
| Crescent_gap  | 48   | 48  | 11825 | 1.000  | 0.814 |
| Inclusion     | 41   | 82  | 6913  | 0.768  | 0.202 |
| Oil_spot      | 58   | 125 | 9346  | 0.840  | 0.392 |
| Punching      | 74   | 74  | 1916  | 0.973  | 0.941 |
| Rolled_pit    | 10   | 25  | 4314  | 0.800  | 0.124 |
| Silk_spot     | 134  | 150 | 50367 | 0.893  | 0.325 |
| Waist_folding | 24   | 26  | 7241  | 0.962  | 0.514 |
| Water_spot    | 68   | 78  | 31469 | 0.974  | 0.690 |
| Welding_line  | 99   | 99  | 10285 | 1.000  | 0.836 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.892  | 0.502 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 20:37:57 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:37:58 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 20:37:58 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 20:37:58 det.util.engine] INFO: Epoch: [7]  [0/1834]  eta: 0:12:29  lr: 0.000100  data_time: 0.0009  iter_time: 0.4086  loss: 0.0003 (0.0003)  loss_class: 0.0000 (0.0000)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0000 (0.0000)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0000 (0.0000)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0000 (0.0000)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0000 (0.0000)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0000 (0.0000)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0000 (0.0000)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0000 (0.0000)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0000 (0.0000)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0000 (0.0000)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0000 (0.0000)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0000 (0.0000)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0000 (0.0000)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0000 (0.0000)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 733  max mem: 19986
[2025-05-19 20:37:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:55:13 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5715  loss: 33.6300 (36.1442)  loss_class: 0.6815 (1.0214)  loss_bbox: 0.2289 (0.3347)  loss_giou: 0.3757 (0.4604)  loss_class_0: 0.9849 (1.1354)  loss_bbox_0: 0.2471 (0.3496)  loss_giou_0: 0.4444 (0.4801)  loss_class_1: 0.9683 (1.0895)  loss_bbox_1: 0.2438 (0.3326)  loss_giou_1: 0.4007 (0.4610)  loss_class_2: 0.8097 (1.0128)  loss_bbox_2: 0.1890 (0.3379)  loss_giou_2: 0.4038 (0.4642)  loss_class_3: 0.7548 (0.9969)  loss_bbox_3: 0.2465 (0.3396)  loss_giou_3: 0.3552 (0.4629)  loss_class_4: 0.6892 (1.0040)  loss_bbox_4: 0.2319 (0.3403)  loss_giou_4: 0.3793 (0.4619)  loss_class_enc: 0.9592 (1.1696)  loss_bbox_enc: 0.3532 (0.4401)  loss_giou_enc: 0.5344 (0.5811)  loss_class_dn: 0.4573 (0.4392)  loss_bbox_dn: 0.3414 (0.6005)  loss_giou_dn: 0.4554 (0.5645)  loss_class_dn_0: 0.4645 (0.4304)  loss_bbox_dn_0: 0.4447 (0.7498)  loss_giou_dn_0: 0.7401 (0.7216)  loss_class_dn_1: 0.4699 (0.4361)  loss_bbox_dn_1: 0.3940 (0.6370)  loss_giou_dn_1: 0.5919 (0.6076)  loss_class_dn_2: 0.4729 (0.4396)  loss_bbox_dn_2: 0.3252 (0.6115)  loss_giou_dn_2: 0.4985 (0.5771)  loss_class_dn_3: 0.4529 (0.4402)  loss_bbox_dn_3: 0.3283 (0.6028)  loss_giou_dn_3: 0.4850 (0.5664)  loss_class_dn_4: 0.4423 (0.4400)  loss_bbox_dn_4: 0.3248 (0.6006)  loss_giou_dn_4: 0.4572 (0.5637)  loss_class_hybrid: 0.6510 (1.0079)  loss_bbox_hybrid: 0.2191 (0.3241)  loss_giou_hybrid: 0.3252 (0.4525)  loss_class_0_hybrid: 0.8566 (0.9862)  loss_bbox_0_hybrid: 0.2060 (0.3619)  loss_giou_0_hybrid: 0.3561 (0.4951)  loss_class_1_hybrid: 0.8282 (1.0029)  loss_bbox_1_hybrid: 0.2436 (0.3341)  loss_giou_1_hybrid: 0.3851 (0.4668)  loss_class_2_hybrid: 0.7273 (1.0011)  loss_bbox_2_hybrid: 0.2272 (0.3303)  loss_giou_2_hybrid: 0.3503 (0.4620)  loss_class_3_hybrid: 0.6874 (0.9845)  loss_bbox_3_hybrid: 0.2378 (0.3291)  loss_giou_3_hybrid: 0.3456 (0.4587)  loss_class_4_hybrid: 0.6574 (0.9903)  loss_bbox_4_hybrid: 0.2248 (0.3270)  loss_giou_4_hybrid: 0.3231 (0.4561)  loss_class_enc_hybrid: 1.0158 (1.0050)  loss_bbox_enc_hybrid: 0.3112 (0.4626)  loss_giou_enc_hybrid: 0.4828 (0.6014)
[2025-05-19 20:55:13 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 20:55:13 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\pytorch_model.bin
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\optimizer.bin
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\scheduler.bin
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\sampler.bin
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\sampler_1.bin
[2025-05-19 20:55:13 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_7\random_states_0.pkl
[2025-05-19 20:55:13 det.__main__] INFO: Start evaluation
[2025-05-19 20:55:13 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:35  model_time: 0.1690 (0.1690)  evaluator_time: 0.0036 (0.0036)  time: 0.2076  data: 0.0350  mem: 727  max mem: 19986
[2025-05-19 20:55:15 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:19  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1763  data: 0.0038  mem: 727  max mem: 19986
[2025-05-19 20:55:17 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:18 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1728  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:20 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:22 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0008  mem: 727  max mem: 19986
[2025-05-19 20:55:24 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0008  mem: 727  max mem: 19986
[2025-05-19 20:55:25 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:27 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:55:29 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:31 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0032)  time: 0.1729  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:32 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1691 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:34 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0003  mem: 727  max mem: 19986
[2025-05-19 20:55:36 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1688 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:37 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:39 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:41 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1684 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1739  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:43 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:44 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:46 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1681 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1731  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:48 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:55:50 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1689 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:51 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:53 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:55:55 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:55:57 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:55:58 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0034)  time: 0.1742  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:00 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:02 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0008  mem: 727  max mem: 19986
[2025-05-19 20:56:03 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1681 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0009  mem: 727  max mem: 19986
[2025-05-19 20:56:05 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:56:07 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:09 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1685 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1727  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:56:10 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1683 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0008  mem: 727  max mem: 19986
[2025-05-19 20:56:12 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:56:14 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:56:16 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:17 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1733  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:56:19 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0007  mem: 727  max mem: 19986
[2025-05-19 20:56:21 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1681 (0.1690)  evaluator_time: 0.0040 (0.0034)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:22 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1729  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:24 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1670 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:56:26 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1670 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1713  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:28 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1670 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1713  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:29 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1670 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1712  data: 0.0006  mem: 727  max mem: 19986
[2025-05-19 20:56:31 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1670 (0.1687)  evaluator_time: 0.0040 (0.0034)  time: 0.1715  data: 0.0004  mem: 727  max mem: 19986
[2025-05-19 20:56:32 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1670 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1713  data: 0.0005  mem: 727  max mem: 19986
[2025-05-19 20:56:32 det.util.engine] INFO: Averaged stats: model_time: 0.1670 (0.1687)  evaluator_time: 0.0030 (0.0034)
[2025-05-19 20:56:33 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.548
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.204
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.240
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.589
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.600

[2025-05-19 20:56:33 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2612  | 0.824  | 0.153 |
| Crescent_gap  | 48   | 48  | 9324  | 1.000  | 0.791 |
| Inclusion     | 41   | 82  | 8373  | 0.878  | 0.250 |
| Oil_spot      | 58   | 125 | 16674 | 0.904  | 0.470 |
| Punching      | 74   | 74  | 1879  | 0.959  | 0.911 |
| Rolled_pit    | 10   | 25  | 2479  | 0.760  | 0.177 |
| Silk_spot     | 134  | 150 | 53145 | 0.920  | 0.486 |
| Waist_folding | 24   | 26  | 8264  | 0.923  | 0.631 |
| Water_spot    | 68   | 78  | 25040 | 0.987  | 0.718 |
| Welding_line  | 99   | 99  | 9608  | 0.990  | 0.897 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.915  | 0.548 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 20:56:33 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 20:56:33 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 20:56:33 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 20:56:34 det.util.engine] INFO: Epoch: [8]  [0/1834]  eta: 0:16:41  lr: 0.000100  data_time: 0.0009  iter_time: 0.5461  loss: 42.3586 (42.3586)  loss_class: 0.4948 (0.4948)  loss_bbox: 0.8107 (0.8107)  loss_giou: 0.6453 (0.6453)  loss_class_0: 1.4782 (1.4782)  loss_bbox_0: 0.4183 (0.4183)  loss_giou_0: 0.2983 (0.2983)  loss_class_1: 2.6933 (2.6933)  loss_bbox_1: 0.1021 (0.1021)  loss_giou_1: 0.0964 (0.0964)  loss_class_2: 2.4258 (2.4258)  loss_bbox_2: 0.1162 (0.1162)  loss_giou_2: 0.1331 (0.1331)  loss_class_3: 0.6667 (0.6667)  loss_bbox_3: 0.8067 (0.8067)  loss_giou_3: 0.6586 (0.6586)  loss_class_4: 0.5516 (0.5516)  loss_bbox_4: 0.8114 (0.8114)  loss_giou_4: 0.6540 (0.6540)  loss_class_enc: 2.7454 (2.7454)  loss_bbox_enc: 0.0957 (0.0957)  loss_giou_enc: 0.0474 (0.0474)  loss_class_dn: 0.4518 (0.4518)  loss_bbox_dn: 0.7714 (0.7714)  loss_giou_dn: 0.5239 (0.5239)  loss_class_dn_0: 0.6378 (0.6378)  loss_bbox_dn_0: 0.9040 (0.9040)  loss_giou_dn_0: 0.5695 (0.5695)  loss_class_dn_1: 0.5573 (0.5573)  loss_bbox_dn_1: 0.8117 (0.8117)  loss_giou_dn_1: 0.5096 (0.5096)  loss_class_dn_2: 0.4850 (0.4850)  loss_bbox_dn_2: 0.8125 (0.8125)  loss_giou_dn_2: 0.5422 (0.5422)  loss_class_dn_3: 0.4904 (0.4904)  loss_bbox_dn_3: 0.7664 (0.7664)  loss_giou_dn_3: 0.5241 (0.5241)  loss_class_dn_4: 0.4578 (0.4578)  loss_bbox_dn_4: 0.7663 (0.7663)  loss_giou_dn_4: 0.5230 (0.5230)  loss_class_hybrid: 0.7099 (0.7099)  loss_bbox_hybrid: 0.5893 (0.5893)  loss_giou_hybrid: 0.4442 (0.4442)  loss_class_0_hybrid: 1.4594 (1.4594)  loss_bbox_0_hybrid: 0.4067 (0.4067)  loss_giou_0_hybrid: 0.3009 (0.3009)  loss_class_1_hybrid: 1.4834 (1.4834)  loss_bbox_1_hybrid: 0.4480 (0.4480)  loss_giou_1_hybrid: 0.3159 (0.3159)  loss_class_2_hybrid: 1.2914 (1.2914)  loss_bbox_2_hybrid: 0.4705 (0.4705)  loss_giou_2_hybrid: 0.3456 (0.3456)  loss_class_3_hybrid: 1.2327 (1.2327)  loss_bbox_3_hybrid: 0.4740 (0.4740)  loss_giou_3_hybrid: 0.3516 (0.3516)  loss_class_4_hybrid: 0.8463 (0.8463)  loss_bbox_4_hybrid: 0.5189 (0.5189)  loss_giou_4_hybrid: 0.4072 (0.4072)  loss_class_enc_hybrid: 1.2401 (1.2401)  loss_bbox_enc_hybrid: 0.6252 (0.6252)  loss_giou_enc_hybrid: 0.5426 (0.5426)  mem: 734  max mem: 19986
[2025-05-19 20:56:34 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:13:48 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5690  loss: 30.6777 (35.0734)  loss_class: 0.5001 (0.9271)  loss_bbox: 0.1484 (0.3449)  loss_giou: 0.3517 (0.4627)  loss_class_0: 0.9395 (1.0756)  loss_bbox_0: 0.1979 (0.3416)  loss_giou_0: 0.4551 (0.4731)  loss_class_1: 0.7088 (1.0180)  loss_bbox_1: 0.1429 (0.3322)  loss_giou_1: 0.3062 (0.4604)  loss_class_2: 0.5790 (0.9432)  loss_bbox_2: 0.1557 (0.3448)  loss_giou_2: 0.3159 (0.4666)  loss_class_3: 0.4883 (0.9263)  loss_bbox_3: 0.1575 (0.3432)  loss_giou_3: 0.3437 (0.4620)  loss_class_4: 0.5009 (0.9093)  loss_bbox_4: 0.1483 (0.3466)  loss_giou_4: 0.3888 (0.4649)  loss_class_enc: 1.1199 (1.1780)  loss_bbox_enc: 0.1986 (0.4181)  loss_giou_enc: 0.4320 (0.5571)  loss_class_dn: 0.4442 (0.4277)  loss_bbox_dn: 0.1923 (0.5728)  loss_giou_dn: 0.3952 (0.5518)  loss_class_dn_0: 0.4432 (0.4264)  loss_bbox_dn_0: 0.3663 (0.7188)  loss_giou_dn_0: 0.7647 (0.7081)  loss_class_dn_1: 0.4452 (0.4322)  loss_bbox_dn_1: 0.2489 (0.6086)  loss_giou_dn_1: 0.5561 (0.5946)  loss_class_dn_2: 0.4659 (0.4309)  loss_bbox_dn_2: 0.2162 (0.5837)  loss_giou_dn_2: 0.4058 (0.5640)  loss_class_dn_3: 0.4610 (0.4301)  loss_bbox_dn_3: 0.2005 (0.5756)  loss_giou_dn_3: 0.4265 (0.5543)  loss_class_dn_4: 0.4576 (0.4288)  loss_bbox_dn_4: 0.1932 (0.5732)  loss_giou_dn_4: 0.4086 (0.5515)  loss_class_hybrid: 0.6274 (0.9662)  loss_bbox_hybrid: 0.1749 (0.3163)  loss_giou_hybrid: 0.3539 (0.4487)  loss_class_0_hybrid: 0.7546 (1.0097)  loss_bbox_0_hybrid: 0.1827 (0.3359)  loss_giou_0_hybrid: 0.3864 (0.4768)  loss_class_1_hybrid: 0.6617 (0.9921)  loss_bbox_1_hybrid: 0.1850 (0.3163)  loss_giou_1_hybrid: 0.3683 (0.4565)  loss_class_2_hybrid: 0.5914 (0.9666)  loss_bbox_2_hybrid: 0.1966 (0.3174)  loss_giou_2_hybrid: 0.3720 (0.4551)  loss_class_3_hybrid: 0.5632 (0.9545)  loss_bbox_3_hybrid: 0.1924 (0.3173)  loss_giou_3_hybrid: 0.3768 (0.4523)  loss_class_4_hybrid: 0.6013 (0.9547)  loss_bbox_4_hybrid: 0.1783 (0.3199)  loss_giou_4_hybrid: 0.3814 (0.4522)  loss_class_enc_hybrid: 0.7595 (1.0112)  loss_bbox_enc_hybrid: 0.2829 (0.4429)  loss_giou_enc_hybrid: 0.5430 (0.5822)
[2025-05-19 21:13:48 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 21:13:48 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\pytorch_model.bin
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\optimizer.bin
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\scheduler.bin
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\sampler.bin
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\sampler_1.bin
[2025-05-19 21:13:48 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_8\random_states_0.pkl
[2025-05-19 21:13:48 det.__main__] INFO: Start evaluation
[2025-05-19 21:13:48 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1680 (0.1680)  evaluator_time: 0.0040 (0.0040)  time: 0.1950  data: 0.0230  mem: 728  max mem: 19986
[2025-05-19 21:13:50 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1751  data: 0.0028  mem: 728  max mem: 19986
[2025-05-19 21:13:52 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:13:54 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 21:13:55 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:13:57 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:13:59 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1689 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 21:14:01 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:02 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:04 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1687 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:06 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:07 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:09 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:11 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 21:14:13 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 21:14:14 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:16 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1688 (0.1690)  evaluator_time: 0.0040 (0.0033)  time: 0.1733  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:18 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0033)  time: 0.1737  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:20 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:21 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1677 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1723  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:23 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1670 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1717  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:25 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1671 (0.1688)  evaluator_time: 0.0031 (0.0034)  time: 0.1719  data: 0.0008  mem: 728  max mem: 19986
[2025-05-19 21:14:26 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1675 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:28 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1670 (0.1687)  evaluator_time: 0.0040 (0.0034)  time: 0.1717  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:30 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1670 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1714  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:32 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1672 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:33 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1672 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:35 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1672 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1717  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:37 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1675 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:38 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1672 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:40 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1672 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:42 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1670 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:44 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:45 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:47 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:49 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:14:51 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0003  mem: 728  max mem: 19986
[2025-05-19 21:14:52 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:14:54 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1687 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:56 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1683)  evaluator_time: 0.0040 (0.0034)  time: 0.1740  data: 0.0007  mem: 728  max mem: 19986
[2025-05-19 21:14:57 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1687 (0.1683)  evaluator_time: 0.0040 (0.0034)  time: 0.1741  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:14:59 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:15:01 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0006  mem: 728  max mem: 19986
[2025-05-19 21:15:03 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1733  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:15:04 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1724  data: 0.0003  mem: 728  max mem: 19986
[2025-05-19 21:15:06 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1682 (0.1684)  evaluator_time: 0.0030 (0.0036)  time: 0.1789  data: 0.0004  mem: 728  max mem: 19986
[2025-05-19 21:15:07 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1682 (0.1684)  evaluator_time: 0.0030 (0.0036)  time: 0.1787  data: 0.0005  mem: 728  max mem: 19986
[2025-05-19 21:15:07 det.util.engine] INFO: Averaged stats: model_time: 0.1682 (0.1684)  evaluator_time: 0.0030 (0.0036)
[2025-05-19 21:15:08 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.285
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.590
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.230
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.174
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.449
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.597

[2025-05-19 21:15:08 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 1645  | 0.647  | 0.258 |
| Crescent_gap  | 48   | 48  | 5841  | 1.000  | 0.838 |
| Inclusion     | 41   | 82  | 8049  | 0.805  | 0.245 |
| Oil_spot      | 58   | 125 | 20466 | 0.920  | 0.509 |
| Punching      | 74   | 74  | 2279  | 0.973  | 0.908 |
| Rolled_pit    | 10   | 25  | 2806  | 0.760  | 0.303 |
| Silk_spot     | 134  | 150 | 55510 | 0.900  | 0.494 |
| Waist_folding | 24   | 26  | 9665  | 0.923  | 0.641 |
| Water_spot    | 68   | 78  | 19788 | 0.987  | 0.753 |
| Welding_line  | 99   | 99  | 11351 | 1.000  | 0.955 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.892  | 0.590 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 21:15:08 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:15:08 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 21:15:08 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 21:15:09 det.util.engine] INFO: Epoch: [9]  [0/1834]  eta: 0:17:50  lr: 0.000100  data_time: 0.0110  iter_time: 0.5839  loss: 24.5836 (24.5836)  loss_class: 0.6523 (0.6523)  loss_bbox: 0.0838 (0.0838)  loss_giou: 0.4090 (0.4090)  loss_class_0: 0.8001 (0.8001)  loss_bbox_0: 0.1019 (0.1019)  loss_giou_0: 0.5050 (0.5050)  loss_class_1: 0.6888 (0.6888)  loss_bbox_1: 0.0907 (0.0907)  loss_giou_1: 0.4182 (0.4182)  loss_class_2: 0.6502 (0.6502)  loss_bbox_2: 0.0853 (0.0853)  loss_giou_2: 0.3972 (0.3972)  loss_class_3: 0.5992 (0.5992)  loss_bbox_3: 0.0827 (0.0827)  loss_giou_3: 0.4070 (0.4070)  loss_class_4: 0.6219 (0.6219)  loss_bbox_4: 0.0846 (0.0846)  loss_giou_4: 0.4223 (0.4223)  loss_class_enc: 0.9125 (0.9125)  loss_bbox_enc: 0.1357 (0.1357)  loss_giou_enc: 0.6256 (0.6256)  loss_class_dn: 0.4193 (0.4193)  loss_bbox_dn: 0.0985 (0.0985)  loss_giou_dn: 0.4533 (0.4533)  loss_class_dn_0: 0.4469 (0.4469)  loss_bbox_dn_0: 0.1636 (0.1636)  loss_giou_dn_0: 0.6985 (0.6985)  loss_class_dn_1: 0.4528 (0.4528)  loss_bbox_dn_1: 0.1062 (0.1062)  loss_giou_dn_1: 0.4736 (0.4736)  loss_class_dn_2: 0.4331 (0.4331)  loss_bbox_dn_2: 0.0948 (0.0948)  loss_giou_dn_2: 0.4109 (0.4109)  loss_class_dn_3: 0.4164 (0.4164)  loss_bbox_dn_3: 0.0943 (0.0943)  loss_giou_dn_3: 0.4191 (0.4191)  loss_class_dn_4: 0.4245 (0.4245)  loss_bbox_dn_4: 0.0999 (0.0999)  loss_giou_dn_4: 0.4636 (0.4636)  loss_class_hybrid: 0.9076 (0.9076)  loss_bbox_hybrid: 0.1010 (0.1010)  loss_giou_hybrid: 0.4397 (0.4397)  loss_class_0_hybrid: 0.8579 (0.8579)  loss_bbox_0_hybrid: 0.0925 (0.0925)  loss_giou_0_hybrid: 0.3956 (0.3956)  loss_class_1_hybrid: 0.8554 (0.8554)  loss_bbox_1_hybrid: 0.1033 (0.1033)  loss_giou_1_hybrid: 0.4185 (0.4185)  loss_class_2_hybrid: 0.8316 (0.8316)  loss_bbox_2_hybrid: 0.0998 (0.0998)  loss_giou_2_hybrid: 0.4286 (0.4286)  loss_class_3_hybrid: 0.7670 (0.7670)  loss_bbox_3_hybrid: 0.1020 (0.1020)  loss_giou_3_hybrid: 0.4367 (0.4367)  loss_class_4_hybrid: 0.8465 (0.8465)  loss_bbox_4_hybrid: 0.1017 (0.1017)  loss_giou_4_hybrid: 0.4425 (0.4425)  loss_class_enc_hybrid: 0.6782 (0.6782)  loss_bbox_enc_hybrid: 0.1373 (0.1373)  loss_giou_enc_hybrid: 0.5972 (0.5972)  mem: 739  max mem: 19986
[2025-05-19 21:15:09 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:32:22 det.util.engine] INFO: Averaged stats: lr: 0.000100  data_time: 0.0007  iter_time: 0.5732  loss: 30.3991 (34.4302)  loss_class: 0.5460 (0.8615)  loss_bbox: 0.2199 (0.3521)  loss_giou: 0.4885 (0.4526)  loss_class_0: 0.7642 (1.0444)  loss_bbox_0: 0.2189 (0.3460)  loss_giou_0: 0.4562 (0.4656)  loss_class_1: 0.6756 (0.9575)  loss_bbox_1: 0.2104 (0.3398)  loss_giou_1: 0.4604 (0.4522)  loss_class_2: 0.7851 (0.9058)  loss_bbox_2: 0.2162 (0.3451)  loss_giou_2: 0.4802 (0.4505)  loss_class_3: 0.5828 (0.8763)  loss_bbox_3: 0.2067 (0.3429)  loss_giou_3: 0.4701 (0.4497)  loss_class_4: 0.5306 (0.8664)  loss_bbox_4: 0.2208 (0.3455)  loss_giou_4: 0.4765 (0.4504)  loss_class_enc: 1.1724 (1.1458)  loss_bbox_enc: 0.3504 (0.4297)  loss_giou_enc: 0.5524 (0.5610)  loss_class_dn: 0.4431 (0.4139)  loss_bbox_dn: 0.2148 (0.5719)  loss_giou_dn: 0.5051 (0.5388)  loss_class_dn_0: 0.4917 (0.4219)  loss_bbox_dn_0: 0.4074 (0.7089)  loss_giou_dn_0: 0.6644 (0.6886)  loss_class_dn_1: 0.4640 (0.4234)  loss_bbox_dn_1: 0.2627 (0.6040)  loss_giou_dn_1: 0.5834 (0.5754)  loss_class_dn_2: 0.4596 (0.4189)  loss_bbox_dn_2: 0.2400 (0.5811)  loss_giou_dn_2: 0.5282 (0.5492)  loss_class_dn_3: 0.4445 (0.4168)  loss_bbox_dn_3: 0.2236 (0.5734)  loss_giou_dn_3: 0.5042 (0.5405)  loss_class_dn_4: 0.4471 (0.4155)  loss_bbox_dn_4: 0.2270 (0.5722)  loss_giou_dn_4: 0.5185 (0.5382)  loss_class_hybrid: 0.6496 (0.9751)  loss_bbox_hybrid: 0.1711 (0.3155)  loss_giou_hybrid: 0.4244 (0.4315)  loss_class_0_hybrid: 0.6436 (0.9919)  loss_bbox_0_hybrid: 0.2097 (0.3361)  loss_giou_0_hybrid: 0.4575 (0.4643)  loss_class_1_hybrid: 0.6402 (0.9717)  loss_bbox_1_hybrid: 0.1983 (0.3219)  loss_giou_1_hybrid: 0.3993 (0.4437)  loss_class_2_hybrid: 0.6295 (0.9632)  loss_bbox_2_hybrid: 0.1957 (0.3210)  loss_giou_2_hybrid: 0.4191 (0.4408)  loss_class_3_hybrid: 0.6392 (0.9604)  loss_bbox_3_hybrid: 0.1767 (0.3176)  loss_giou_3_hybrid: 0.4112 (0.4363)  loss_class_4_hybrid: 0.6236 (0.9645)  loss_bbox_4_hybrid: 0.1743 (0.3181)  loss_giou_4_hybrid: 0.4232 (0.4346)  loss_class_enc_hybrid: 0.9937 (1.0273)  loss_bbox_enc_hybrid: 0.3517 (0.4316)  loss_giou_enc_hybrid: 0.6003 (0.5696)
[2025-05-19 21:32:22 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 21:32:22 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\pytorch_model.bin
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\optimizer.bin
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\scheduler.bin
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\sampler.bin
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\sampler_1.bin
[2025-05-19 21:32:23 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_9\random_states_0.pkl
[2025-05-19 21:32:23 det.__main__] INFO: Start evaluation
[2025-05-19 21:32:23 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1661 (0.1661)  evaluator_time: 0.0030 (0.0030)  time: 0.1911  data: 0.0220  mem: 729  max mem: 19988
[2025-05-19 21:32:25 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1670 (0.1669)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0026  mem: 729  max mem: 19988
[2025-05-19 21:32:26 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1671)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:28 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1671 (0.1672)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:30 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1672 (0.1672)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0004  mem: 729  max mem: 19988
[2025-05-19 21:32:32 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0004  mem: 729  max mem: 19988
[2025-05-19 21:32:33 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1671 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:35 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1680 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:37 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1680 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:38 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:40 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:32:42 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:44 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:57  model_time: 0.1671 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:45 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1678 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0004  mem: 729  max mem: 19988
[2025-05-19 21:32:47 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1670 (0.1674)  evaluator_time: 0.0040 (0.0034)  time: 0.1717  data: 0.0003  mem: 729  max mem: 19988
[2025-05-19 21:32:49 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1670 (0.1673)  evaluator_time: 0.0040 (0.0034)  time: 0.1714  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:32:51 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1675 (0.1674)  evaluator_time: 0.0040 (0.0034)  time: 0.1722  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:52 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1690 (0.1675)  evaluator_time: 0.0040 (0.0034)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:54 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1690 (0.1676)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:32:56 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1677)  evaluator_time: 0.0030 (0.0035)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:32:57 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1678)  evaluator_time: 0.0040 (0.0035)  time: 0.1740  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:32:59 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1678)  evaluator_time: 0.0030 (0.0035)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 21:33:01 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1690 (0.1679)  evaluator_time: 0.0030 (0.0035)  time: 0.1738  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:03 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0035)  time: 0.1740  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:04 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0035)  time: 0.1736  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:06 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0035)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:08 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1681)  evaluator_time: 0.0040 (0.0035)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:10 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1736  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:11 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1684 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:13 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1725  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 21:33:15 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1728  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 21:33:17 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1686 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1730  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:18 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1686 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1726  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:20 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1686 (0.1683)  evaluator_time: 0.0040 (0.0035)  time: 0.1734  data: 0.0010  mem: 729  max mem: 19988
[2025-05-19 21:33:22 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1683)  evaluator_time: 0.0040 (0.0035)  time: 0.1740  data: 0.0010  mem: 729  max mem: 19988
[2025-05-19 21:33:23 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1683)  evaluator_time: 0.0040 (0.0035)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:25 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0035)  time: 0.1736  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:27 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0035)  time: 0.1735  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 21:33:29 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0035)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:30 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1684)  evaluator_time: 0.0040 (0.0035)  time: 0.1747  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:32 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1684)  evaluator_time: 0.0040 (0.0038)  time: 0.1809  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 21:33:34 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0038)  time: 0.1789  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:36 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:37 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)  time: 0.1736  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 21:33:39 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 21:33:41 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:42 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 21:33:42 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0038)
[2025-05-19 21:33:43 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.228
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.017
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.455
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.017
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.602

[2025-05-19 21:33:43 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 1794  | 0.647  | 0.131 |
| Crescent_gap  | 48   | 48  | 12802 | 1.000  | 0.840 |
| Inclusion     | 41   | 82  | 4597  | 0.829  | 0.312 |
| Oil_spot      | 58   | 125 | 13916 | 0.920  | 0.598 |
| Punching      | 74   | 74  | 3512  | 0.973  | 0.933 |
| Rolled_pit    | 10   | 25  | 2013  | 0.800  | 0.286 |
| Silk_spot     | 134  | 150 | 58524 | 0.900  | 0.512 |
| Waist_folding | 24   | 26  | 9716  | 0.962  | 0.489 |
| Water_spot    | 68   | 78  | 14959 | 0.962  | 0.784 |
| Welding_line  | 99   | 99  | 15475 | 1.000  | 0.930 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.899  | 0.582 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 21:33:43 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:33:43 det.util.engine] INFO: Epoch: [10]  [0/1834]  eta: 0:18:24  lr: 0.000010  data_time: 0.0023  iter_time: 0.6023  loss: 27.4668 (27.4668)  loss_class: 0.7461 (0.7461)  loss_bbox: 0.1518 (0.1518)  loss_giou: 0.5062 (0.5062)  loss_class_0: 1.0056 (1.0056)  loss_bbox_0: 0.0848 (0.0848)  loss_giou_0: 0.2475 (0.2475)  loss_class_1: 0.6925 (0.6925)  loss_bbox_1: 0.2223 (0.2223)  loss_giou_1: 0.3156 (0.3156)  loss_class_2: 0.8065 (0.8065)  loss_bbox_2: 0.1931 (0.1931)  loss_giou_2: 0.4863 (0.4863)  loss_class_3: 0.9495 (0.9495)  loss_bbox_3: 0.1635 (0.1635)  loss_giou_3: 0.5051 (0.5051)  loss_class_4: 1.1499 (1.1499)  loss_bbox_4: 0.1540 (0.1540)  loss_giou_4: 0.5208 (0.5208)  loss_class_enc: 1.8492 (1.8492)  loss_bbox_enc: 0.3835 (0.3835)  loss_giou_enc: 0.2788 (0.2788)  loss_class_dn: 0.4419 (0.4419)  loss_bbox_dn: 0.1320 (0.1320)  loss_giou_dn: 0.5339 (0.5339)  loss_class_dn_0: 0.5479 (0.5479)  loss_bbox_dn_0: 0.3560 (0.3560)  loss_giou_dn_0: 0.6506 (0.6506)  loss_class_dn_1: 0.5020 (0.5020)  loss_bbox_dn_1: 0.1893 (0.1893)  loss_giou_dn_1: 0.5407 (0.5407)  loss_class_dn_2: 0.4581 (0.4581)  loss_bbox_dn_2: 0.1428 (0.1428)  loss_giou_dn_2: 0.5278 (0.5278)  loss_class_dn_3: 0.4483 (0.4483)  loss_bbox_dn_3: 0.1317 (0.1317)  loss_giou_dn_3: 0.5199 (0.5199)  loss_class_dn_4: 0.4528 (0.4528)  loss_bbox_dn_4: 0.1342 (0.1342)  loss_giou_dn_4: 0.5418 (0.5418)  loss_class_hybrid: 0.6514 (0.6514)  loss_bbox_hybrid: 0.0864 (0.0864)  loss_giou_hybrid: 0.5133 (0.5133)  loss_class_0_hybrid: 0.5981 (0.5981)  loss_bbox_0_hybrid: 0.1207 (0.1207)  loss_giou_0_hybrid: 0.3786 (0.3786)  loss_class_1_hybrid: 0.5323 (0.5323)  loss_bbox_1_hybrid: 0.0854 (0.0854)  loss_giou_1_hybrid: 0.4207 (0.4207)  loss_class_2_hybrid: 0.5779 (0.5779)  loss_bbox_2_hybrid: 0.0853 (0.0853)  loss_giou_2_hybrid: 0.4723 (0.4723)  loss_class_3_hybrid: 0.6044 (0.6044)  loss_bbox_3_hybrid: 0.0822 (0.0822)  loss_giou_3_hybrid: 0.4843 (0.4843)  loss_class_4_hybrid: 0.6720 (0.6720)  loss_bbox_4_hybrid: 0.0876 (0.0876)  loss_giou_4_hybrid: 0.5160 (0.5160)  loss_class_enc_hybrid: 0.9041 (0.9041)  loss_bbox_enc_hybrid: 0.2615 (0.2615)  loss_giou_enc_hybrid: 0.6680 (0.6680)  mem: 733  max mem: 19988
[2025-05-19 21:33:43 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:51:00 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5436  loss: 26.7153 (32.2406)  loss_class: 0.4501 (0.7560)  loss_bbox: 0.1141 (0.3382)  loss_giou: 0.3439 (0.4370)  loss_class_0: 0.7732 (0.9723)  loss_bbox_0: 0.1711 (0.3344)  loss_giou_0: 0.2525 (0.4552)  loss_class_1: 0.4884 (0.8615)  loss_bbox_1: 0.1272 (0.3287)  loss_giou_1: 0.3235 (0.4403)  loss_class_2: 0.4580 (0.8132)  loss_bbox_2: 0.1846 (0.3269)  loss_giou_2: 0.3276 (0.4364)  loss_class_3: 0.4578 (0.7882)  loss_bbox_3: 0.1281 (0.3256)  loss_giou_3: 0.3239 (0.4329)  loss_class_4: 0.4488 (0.7654)  loss_bbox_4: 0.1294 (0.3316)  loss_giou_4: 0.3467 (0.4342)  loss_class_enc: 1.1253 (1.1735)  loss_bbox_enc: 0.2203 (0.3959)  loss_giou_enc: 0.3138 (0.5143)  loss_class_dn: 0.4192 (0.3901)  loss_bbox_dn: 0.1337 (0.5205)  loss_giou_dn: 0.4061 (0.4981)  loss_class_dn_0: 0.4898 (0.4289)  loss_bbox_dn_0: 0.3313 (0.6440)  loss_giou_dn_0: 0.5784 (0.6426)  loss_class_dn_1: 0.4494 (0.4166)  loss_bbox_dn_1: 0.1915 (0.5445)  loss_giou_dn_1: 0.4302 (0.5293)  loss_class_dn_2: 0.4352 (0.4031)  loss_bbox_dn_2: 0.1760 (0.5267)  loss_giou_dn_2: 0.4373 (0.5065)  loss_class_dn_3: 0.4311 (0.3978)  loss_bbox_dn_3: 0.1441 (0.5216)  loss_giou_dn_3: 0.4345 (0.4994)  loss_class_dn_4: 0.4263 (0.3944)  loss_bbox_dn_4: 0.1400 (0.5208)  loss_giou_dn_4: 0.4172 (0.4982)  loss_class_hybrid: 0.5097 (0.8746)  loss_bbox_hybrid: 0.1297 (0.3013)  loss_giou_hybrid: 0.2657 (0.4180)  loss_class_0_hybrid: 0.6376 (0.9400)  loss_bbox_0_hybrid: 0.1420 (0.3164)  loss_giou_0_hybrid: 0.2720 (0.4468)  loss_class_1_hybrid: 0.5233 (0.9060)  loss_bbox_1_hybrid: 0.1074 (0.3060)  loss_giou_1_hybrid: 0.2160 (0.4300)  loss_class_2_hybrid: 0.5286 (0.8761)  loss_bbox_2_hybrid: 0.1112 (0.3048)  loss_giou_2_hybrid: 0.2285 (0.4265)  loss_class_3_hybrid: 0.5180 (0.8743)  loss_bbox_3_hybrid: 0.1256 (0.3047)  loss_giou_3_hybrid: 0.2465 (0.4219)  loss_class_4_hybrid: 0.5090 (0.8736)  loss_bbox_4_hybrid: 0.1284 (0.3032)  loss_giou_4_hybrid: 0.2667 (0.4211)  loss_class_enc_hybrid: 0.7923 (1.0102)  loss_bbox_enc_hybrid: 0.2305 (0.4031)  loss_giou_enc_hybrid: 0.3135 (0.5372)
[2025-05-19 21:51:00 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 21:51:00 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10
[2025-05-19 21:51:00 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\pytorch_model.bin
[2025-05-19 21:51:01 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\optimizer.bin
[2025-05-19 21:51:01 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\scheduler.bin
[2025-05-19 21:51:01 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\sampler.bin
[2025-05-19 21:51:01 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\sampler_1.bin
[2025-05-19 21:51:01 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_10\random_states_0.pkl
[2025-05-19 21:51:01 det.__main__] INFO: Start evaluation
[2025-05-19 21:51:01 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:28  model_time: 0.1670 (0.1670)  evaluator_time: 0.0040 (0.0040)  time: 0.1940  data: 0.0230  mem: 723  max mem: 19988
[2025-05-19 21:51:03 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1684 (0.1684)  evaluator_time: 0.0040 (0.0035)  time: 0.1746  data: 0.0025  mem: 723  max mem: 19988
[2025-05-19 21:51:04 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1685 (0.1686)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0004  mem: 723  max mem: 19988
[2025-05-19 21:51:06 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0029)  time: 0.1724  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:51:08 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1727  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:09 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:11 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:13 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:51:15 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:16 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1689 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:18 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:51:20 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:22 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:23 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:51:25 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:27 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1694 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1740  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:28 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1688 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:30 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1684 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:32 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:34 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1683 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1733  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:35 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1680 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1732  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:37 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1680 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1728  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:39 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:41 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1681 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1734  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:42 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1736  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:44 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:46 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:48 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:49 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:51:51 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:53 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1723  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:54 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:51:56 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1678 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1718  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:51:58 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0004  mem: 723  max mem: 19988
[2025-05-19 21:52:00 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1725  data: 0.0003  mem: 723  max mem: 19988
[2025-05-19 21:52:01 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1683 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:03 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1724  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:05 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1675 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1717  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:06 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1670 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:52:08 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1670 (0.1686)  evaluator_time: 0.0040 (0.0034)  time: 0.1730  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:52:10 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1673 (0.1686)  evaluator_time: 0.0040 (0.0034)  time: 0.1731  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:12 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:13 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1723  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:15 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1795  data: 0.0004  mem: 723  max mem: 19988
[2025-05-19 21:52:17 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1795  data: 0.0006  mem: 723  max mem: 19988
[2025-05-19 21:52:19 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1726  data: 0.0007  mem: 723  max mem: 19988
[2025-05-19 21:52:20 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1676 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1720  data: 0.0005  mem: 723  max mem: 19988
[2025-05-19 21:52:20 det.util.engine] INFO: Averaged stats: model_time: 0.1676 (0.1686)  evaluator_time: 0.0030 (0.0037)
[2025-05-19 21:52:20 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.643
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.305
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.017
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.176
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.603
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.427
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.611

[2025-05-19 21:52:20 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2395  | 0.765  | 0.264 |
| Crescent_gap  | 48   | 48  | 7329  | 1.000  | 0.880 |
| Inclusion     | 41   | 82  | 8190  | 0.829  | 0.301 |
| Oil_spot      | 58   | 125 | 14278 | 0.928  | 0.602 |
| Punching      | 74   | 74  | 2587  | 0.973  | 0.938 |
| Rolled_pit    | 10   | 25  | 3818  | 0.800  | 0.415 |
| Silk_spot     | 134  | 150 | 65341 | 0.933  | 0.591 |
| Waist_folding | 24   | 26  | 7985  | 0.962  | 0.623 |
| Water_spot    | 68   | 78  | 15742 | 0.974  | 0.847 |
| Welding_line  | 99   | 99  | 9729  | 1.000  | 0.964 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.916  | 0.643 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 21:52:20 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 21:52:21 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 21:52:21 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 21:52:21 det.util.engine] INFO: Epoch: [11]  [0/1834]  eta: 0:19:09  lr: 0.000010  data_time: 0.0053  iter_time: 0.6267  loss: 25.1964 (25.1964)  loss_class: 0.5030 (0.5030)  loss_bbox: 0.2653 (0.2653)  loss_giou: 0.3752 (0.3752)  loss_class_0: 0.5299 (0.5299)  loss_bbox_0: 0.2544 (0.2544)  loss_giou_0: 0.6063 (0.6063)  loss_class_1: 0.4386 (0.4386)  loss_bbox_1: 0.3449 (0.3449)  loss_giou_1: 0.4227 (0.4227)  loss_class_2: 0.4273 (0.4273)  loss_bbox_2: 0.2718 (0.2718)  loss_giou_2: 0.3761 (0.3761)  loss_class_3: 0.4683 (0.4683)  loss_bbox_3: 0.2833 (0.2833)  loss_giou_3: 0.3969 (0.3969)  loss_class_4: 0.5258 (0.5258)  loss_bbox_4: 0.2727 (0.2727)  loss_giou_4: 0.3873 (0.3873)  loss_class_enc: 1.4180 (1.4180)  loss_bbox_enc: 0.1737 (0.1737)  loss_giou_enc: 0.2840 (0.2840)  loss_class_dn: 0.3769 (0.3769)  loss_bbox_dn: 0.2291 (0.2291)  loss_giou_dn: 0.2979 (0.2979)  loss_class_dn_0: 0.5200 (0.5200)  loss_bbox_dn_0: 0.4214 (0.4214)  loss_giou_dn_0: 0.6392 (0.6392)  loss_class_dn_1: 0.4631 (0.4631)  loss_bbox_dn_1: 0.3414 (0.3414)  loss_giou_dn_1: 0.4592 (0.4592)  loss_class_dn_2: 0.4001 (0.4001)  loss_bbox_dn_2: 0.2123 (0.2123)  loss_giou_dn_2: 0.3507 (0.3507)  loss_class_dn_3: 0.3884 (0.3884)  loss_bbox_dn_3: 0.2405 (0.2405)  loss_giou_dn_3: 0.3261 (0.3261)  loss_class_dn_4: 0.3811 (0.3811)  loss_bbox_dn_4: 0.2317 (0.2317)  loss_giou_dn_4: 0.3138 (0.3138)  loss_class_hybrid: 0.6938 (0.6938)  loss_bbox_hybrid: 0.2843 (0.2843)  loss_giou_hybrid: 0.3749 (0.3749)  loss_class_0_hybrid: 0.5533 (0.5533)  loss_bbox_0_hybrid: 0.2757 (0.2757)  loss_giou_0_hybrid: 0.5316 (0.5316)  loss_class_1_hybrid: 0.5304 (0.5304)  loss_bbox_1_hybrid: 0.3475 (0.3475)  loss_giou_1_hybrid: 0.4574 (0.4574)  loss_class_2_hybrid: 0.5543 (0.5543)  loss_bbox_2_hybrid: 0.3002 (0.3002)  loss_giou_2_hybrid: 0.3797 (0.3797)  loss_class_3_hybrid: 0.6252 (0.6252)  loss_bbox_3_hybrid: 0.3020 (0.3020)  loss_giou_3_hybrid: 0.3938 (0.3938)  loss_class_4_hybrid: 0.6478 (0.6478)  loss_bbox_4_hybrid: 0.2919 (0.2919)  loss_giou_4_hybrid: 0.3843 (0.3843)  loss_class_enc_hybrid: 0.9243 (0.9243)  loss_bbox_enc_hybrid: 0.2449 (0.2449)  loss_giou_enc_hybrid: 0.4802 (0.4802)  mem: 734  max mem: 19988
[2025-05-19 21:52:21 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:09:38 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5816  loss: 34.1011 (30.7721)  loss_class: 0.5462 (0.7226)  loss_bbox: 0.3864 (0.3322)  loss_giou: 0.4610 (0.4135)  loss_class_0: 1.1837 (0.9637)  loss_bbox_0: 0.3129 (0.3023)  loss_giou_0: 0.4165 (0.4207)  loss_class_1: 0.6298 (0.8223)  loss_bbox_1: 0.3509 (0.3140)  loss_giou_1: 0.4472 (0.4154)  loss_class_2: 0.5747 (0.7732)  loss_bbox_2: 0.3189 (0.3137)  loss_giou_2: 0.4037 (0.4103)  loss_class_3: 0.5471 (0.7559)  loss_bbox_3: 0.3957 (0.3157)  loss_giou_3: 0.4598 (0.4077)  loss_class_4: 0.5411 (0.7313)  loss_bbox_4: 0.3817 (0.3247)  loss_giou_4: 0.4738 (0.4113)  loss_class_enc: 1.2394 (1.2155)  loss_bbox_enc: 0.3811 (0.3504)  loss_giou_enc: 0.4713 (0.4630)  loss_class_dn: 0.4331 (0.3770)  loss_bbox_dn: 0.5914 (0.4884)  loss_giou_dn: 0.4746 (0.4671)  loss_class_dn_0: 0.4851 (0.4252)  loss_bbox_dn_0: 0.5849 (0.6103)  loss_giou_dn_0: 0.6471 (0.6079)  loss_class_dn_1: 0.4840 (0.4095)  loss_bbox_dn_1: 0.5860 (0.5117)  loss_giou_dn_1: 0.4805 (0.4952)  loss_class_dn_2: 0.4498 (0.3912)  loss_bbox_dn_2: 0.6224 (0.4945)  loss_giou_dn_2: 0.4497 (0.4742)  loss_class_dn_3: 0.4444 (0.3835)  loss_bbox_dn_3: 0.5945 (0.4897)  loss_giou_dn_3: 0.4514 (0.4683)  loss_class_dn_4: 0.4417 (0.3808)  loss_bbox_dn_4: 0.5931 (0.4886)  loss_giou_dn_4: 0.4683 (0.4675)  loss_class_hybrid: 0.8180 (0.8184)  loss_bbox_hybrid: 0.3502 (0.3007)  loss_giou_hybrid: 0.3805 (0.3972)  loss_class_0_hybrid: 1.1667 (0.9181)  loss_bbox_0_hybrid: 0.2816 (0.3010)  loss_giou_0_hybrid: 0.3861 (0.4184)  loss_class_1_hybrid: 1.1213 (0.8444)  loss_bbox_1_hybrid: 0.4182 (0.2965)  loss_giou_1_hybrid: 0.3691 (0.4067)  loss_class_2_hybrid: 0.9582 (0.8246)  loss_bbox_2_hybrid: 0.4047 (0.2977)  loss_giou_2_hybrid: 0.3731 (0.4024)  loss_class_3_hybrid: 0.8510 (0.8183)  loss_bbox_3_hybrid: 0.4028 (0.2999)  loss_giou_3_hybrid: 0.3920 (0.3992)  loss_class_4_hybrid: 0.8184 (0.8160)  loss_bbox_4_hybrid: 0.3928 (0.3006)  loss_giou_4_hybrid: 0.3933 (0.3988)  loss_class_enc_hybrid: 1.2041 (1.0340)  loss_bbox_enc_hybrid: 0.4508 (0.3741)  loss_giou_enc_hybrid: 0.5013 (0.4956)
[2025-05-19 22:09:38 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 22:09:38 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\pytorch_model.bin
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\optimizer.bin
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\scheduler.bin
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\sampler.bin
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\sampler_1.bin
[2025-05-19 22:09:38 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_11\random_states_0.pkl
[2025-05-19 22:09:38 det.__main__] INFO: Start evaluation
[2025-05-19 22:09:39 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:32  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.2030  data: 0.0300  mem: 733  max mem: 19988
[2025-05-19 22:09:40 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1763  data: 0.0035  mem: 733  max mem: 19988
[2025-05-19 22:09:42 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:09:44 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1685 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:09:45 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1724  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:09:47 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:09:49 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1734  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:09:51 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:09:52 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1673 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1717  data: 0.0004  mem: 733  max mem: 19988
[2025-05-19 22:09:54 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1716  data: 0.0004  mem: 733  max mem: 19988
[2025-05-19 22:09:56 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1719  data: 0.0004  mem: 733  max mem: 19988
[2025-05-19 22:09:58 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0004  mem: 733  max mem: 19988
[2025-05-19 22:09:59 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1677 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:01 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1678 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:03 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1677 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:04 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1676 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:06 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1726  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:08 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:10 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:11 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1681 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1727  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:13 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1679 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:15 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1676 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:16 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1678 (0.1684)  evaluator_time: 0.0037 (0.0033)  time: 0.1725  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:18 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1678 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1726  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:20 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1671 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1719  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:22 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1671 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:23 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1670 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:25 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1670 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:27 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1671 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:28 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1677 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0004  mem: 733  max mem: 19988
[2025-05-19 22:10:30 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1671 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1710  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:32 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1707  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:34 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1710  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:35 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1672 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:37 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:39 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:41 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1675 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:42 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1673 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:44 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1670 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:46 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1670 (0.1680)  evaluator_time: 0.0040 (0.0033)  time: 0.1725  data: 0.0003  mem: 733  max mem: 19988
[2025-05-19 22:10:47 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:09  model_time: 0.1670 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:49 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1671 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:51 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1677 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1712  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:53 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1678 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0005  mem: 733  max mem: 19988
[2025-05-19 22:10:54 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:56 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1682 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 733  max mem: 19988
[2025-05-19 22:10:57 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 733  max mem: 19988
[2025-05-19 22:10:57 det.util.engine] INFO: Averaged stats: model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 22:10:58 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.653
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.041
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.372
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.602
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.436
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.617

[2025-05-19 22:10:58 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2069  | 0.706  | 0.303 |
| Crescent_gap  | 48   | 48  | 6570  | 1.000  | 0.871 |
| Inclusion     | 41   | 82  | 8345  | 0.854  | 0.342 |
| Oil_spot      | 58   | 125 | 14308 | 0.952  | 0.599 |
| Punching      | 74   | 74  | 2314  | 0.973  | 0.937 |
| Rolled_pit    | 10   | 25  | 3821  | 0.800  | 0.367 |
| Silk_spot     | 134  | 150 | 72164 | 0.947  | 0.593 |
| Waist_folding | 24   | 26  | 8424  | 0.962  | 0.701 |
| Water_spot    | 68   | 78  | 12208 | 1.000  | 0.848 |
| Welding_line  | 99   | 99  | 7169  | 1.000  | 0.965 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.919  | 0.653 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 22:10:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:10:58 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 22:10:58 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 22:10:59 det.util.engine] INFO: Epoch: [12]  [0/1834]  eta: 0:19:28  lr: 0.000010  data_time: 0.0008  iter_time: 0.6372  loss: 30.6556 (30.6556)  loss_class: 1.0332 (1.0332)  loss_bbox: 0.0891 (0.0891)  loss_giou: 0.2915 (0.2915)  loss_class_0: 1.2927 (1.2927)  loss_bbox_0: 0.2385 (0.2385)  loss_giou_0: 0.2851 (0.2851)  loss_class_1: 0.9565 (0.9565)  loss_bbox_1: 0.2541 (0.2541)  loss_giou_1: 0.3245 (0.3245)  loss_class_2: 1.0203 (1.0203)  loss_bbox_2: 0.1988 (0.1988)  loss_giou_2: 0.4102 (0.4102)  loss_class_3: 0.9100 (0.9100)  loss_bbox_3: 0.1758 (0.1758)  loss_giou_3: 0.3363 (0.3363)  loss_class_4: 1.1229 (1.1229)  loss_bbox_4: 0.0899 (0.0899)  loss_giou_4: 0.2916 (0.2916)  loss_class_enc: 1.3402 (1.3402)  loss_bbox_enc: 0.4628 (0.4628)  loss_giou_enc: 0.4957 (0.4957)  loss_class_dn: 0.4383 (0.4383)  loss_bbox_dn: 0.4372 (0.4372)  loss_giou_dn: 0.4512 (0.4512)  loss_class_dn_0: 0.4882 (0.4882)  loss_bbox_dn_0: 0.5915 (0.5915)  loss_giou_dn_0: 0.6462 (0.6462)  loss_class_dn_1: 0.4494 (0.4494)  loss_bbox_dn_1: 0.4719 (0.4719)  loss_giou_dn_1: 0.4770 (0.4770)  loss_class_dn_2: 0.4389 (0.4389)  loss_bbox_dn_2: 0.4504 (0.4504)  loss_giou_dn_2: 0.4460 (0.4460)  loss_class_dn_3: 0.4339 (0.4339)  loss_bbox_dn_3: 0.4404 (0.4404)  loss_giou_dn_3: 0.4425 (0.4425)  loss_class_dn_4: 0.4396 (0.4396)  loss_bbox_dn_4: 0.4362 (0.4362)  loss_giou_dn_4: 0.4491 (0.4491)  loss_class_hybrid: 0.9281 (0.9281)  loss_bbox_hybrid: 0.1417 (0.1417)  loss_giou_hybrid: 0.3642 (0.3642)  loss_class_0_hybrid: 0.9074 (0.9074)  loss_bbox_0_hybrid: 0.2392 (0.2392)  loss_giou_0_hybrid: 0.3879 (0.3879)  loss_class_1_hybrid: 0.8163 (0.8163)  loss_bbox_1_hybrid: 0.2129 (0.2129)  loss_giou_1_hybrid: 0.4025 (0.4025)  loss_class_2_hybrid: 0.8094 (0.8094)  loss_bbox_2_hybrid: 0.2023 (0.2023)  loss_giou_2_hybrid: 0.3859 (0.3859)  loss_class_3_hybrid: 0.8397 (0.8397)  loss_bbox_3_hybrid: 0.1858 (0.1858)  loss_giou_3_hybrid: 0.3698 (0.3698)  loss_class_4_hybrid: 0.8932 (0.8932)  loss_bbox_4_hybrid: 0.1526 (0.1526)  loss_giou_4_hybrid: 0.3689 (0.3689)  loss_class_enc_hybrid: 1.1620 (1.1620)  loss_bbox_enc_hybrid: 0.3504 (0.3504)  loss_giou_enc_hybrid: 0.4880 (0.4880)  mem: 734  max mem: 19988
[2025-05-19 22:10:59 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:28:13 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5559  loss: 32.1201 (30.7114)  loss_class: 0.4991 (0.7380)  loss_bbox: 0.2573 (0.3292)  loss_giou: 0.4329 (0.4101)  loss_class_0: 0.7390 (0.9359)  loss_bbox_0: 0.1975 (0.3102)  loss_giou_0: 0.3601 (0.4268)  loss_class_1: 0.7357 (0.8329)  loss_bbox_1: 0.2309 (0.3128)  loss_giou_1: 0.3603 (0.4097)  loss_class_2: 0.6378 (0.7785)  loss_bbox_2: 0.2914 (0.3182)  loss_giou_2: 0.4346 (0.4101)  loss_class_3: 0.5053 (0.7586)  loss_bbox_3: 0.2685 (0.3180)  loss_giou_3: 0.4287 (0.4060)  loss_class_4: 0.4883 (0.7394)  loss_bbox_4: 0.2640 (0.3239)  loss_giou_4: 0.4306 (0.4085)  loss_class_enc: 1.2976 (1.1963)  loss_bbox_enc: 0.2624 (0.3442)  loss_giou_enc: 0.3887 (0.4655)  loss_class_dn: 0.4156 (0.3774)  loss_bbox_dn: 0.2420 (0.4890)  loss_giou_dn: 0.5422 (0.4706)  loss_class_dn_0: 0.4634 (0.4239)  loss_bbox_dn_0: 0.4366 (0.6076)  loss_giou_dn_0: 0.6693 (0.6068)  loss_class_dn_1: 0.4393 (0.4076)  loss_bbox_dn_1: 0.2775 (0.5102)  loss_giou_dn_1: 0.5520 (0.4967)  loss_class_dn_2: 0.4221 (0.3890)  loss_bbox_dn_2: 0.2610 (0.4950)  loss_giou_dn_2: 0.5380 (0.4775)  loss_class_dn_3: 0.4169 (0.3825)  loss_bbox_dn_3: 0.2450 (0.4900)  loss_giou_dn_3: 0.5227 (0.4714)  loss_class_dn_4: 0.4138 (0.3801)  loss_bbox_dn_4: 0.2485 (0.4893)  loss_giou_dn_4: 0.5330 (0.4709)  loss_class_hybrid: 0.6561 (0.8133)  loss_bbox_hybrid: 0.2075 (0.3053)  loss_giou_hybrid: 0.3908 (0.3976)  loss_class_0_hybrid: 0.7815 (0.8926)  loss_bbox_0_hybrid: 0.2441 (0.3058)  loss_giou_0_hybrid: 0.3771 (0.4224)  loss_class_1_hybrid: 0.6202 (0.8252)  loss_bbox_1_hybrid: 0.2348 (0.3077)  loss_giou_1_hybrid: 0.4028 (0.4103)  loss_class_2_hybrid: 0.6100 (0.8046)  loss_bbox_2_hybrid: 0.2063 (0.3084)  loss_giou_2_hybrid: 0.4433 (0.4060)  loss_class_3_hybrid: 0.6805 (0.8017)  loss_bbox_3_hybrid: 0.1989 (0.3088)  loss_giou_3_hybrid: 0.4312 (0.4017)  loss_class_4_hybrid: 0.6683 (0.8045)  loss_bbox_4_hybrid: 0.2067 (0.3076)  loss_giou_4_hybrid: 0.4199 (0.4002)  loss_class_enc_hybrid: 1.1308 (1.0102)  loss_bbox_enc_hybrid: 0.3029 (0.3703)  loss_giou_enc_hybrid: 0.4764 (0.4990)
[2025-05-19 22:28:13 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 22:28:13 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\pytorch_model.bin
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\optimizer.bin
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\scheduler.bin
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\sampler.bin
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\sampler_1.bin
[2025-05-19 22:28:13 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_12\random_states_0.pkl
[2025-05-19 22:28:13 det.__main__] INFO: Start evaluation
[2025-05-19 22:28:14 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:33  model_time: 0.1695 (0.1695)  evaluator_time: 0.0030 (0.0030)  time: 0.2035  data: 0.0310  mem: 725  max mem: 19988
[2025-05-19 22:28:15 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1753  data: 0.0035  mem: 725  max mem: 19988
[2025-05-19 22:28:17 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:19 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0030)  time: 0.1720  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:28:20 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1675 (0.1682)  evaluator_time: 0.0030 (0.0030)  time: 0.1717  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:22 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1671 (0.1680)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:24 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1671 (0.1679)  evaluator_time: 0.0030 (0.0030)  time: 0.1712  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:28:26 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1674 (0.1679)  evaluator_time: 0.0030 (0.0030)  time: 0.1712  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:27 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1670 (0.1677)  evaluator_time: 0.0030 (0.0045)  time: 0.1772  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:28:29 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1677)  evaluator_time: 0.0040 (0.0044)  time: 0.1772  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:31 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1670 (0.1677)  evaluator_time: 0.0030 (0.0043)  time: 0.1714  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:28:33 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0042)  time: 0.1714  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:28:34 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1671 (0.1676)  evaluator_time: 0.0030 (0.0041)  time: 0.1712  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:36 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0041)  time: 0.1713  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:38 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1670 (0.1676)  evaluator_time: 0.0040 (0.0041)  time: 0.1717  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:28:39 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1671 (0.1676)  evaluator_time: 0.0040 (0.0040)  time: 0.1719  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:41 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1671 (0.1676)  evaluator_time: 0.0040 (0.0040)  time: 0.1722  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:28:43 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1675 (0.1676)  evaluator_time: 0.0030 (0.0040)  time: 0.1721  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:45 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0039)  time: 0.1712  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:28:46 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0039)  time: 0.1711  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:48 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0039)  time: 0.1714  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:28:50 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1674 (0.1675)  evaluator_time: 0.0030 (0.0038)  time: 0.1718  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:28:51 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1676)  evaluator_time: 0.0030 (0.0038)  time: 0.1723  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:28:53 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1681 (0.1676)  evaluator_time: 0.0030 (0.0038)  time: 0.1726  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:28:55 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1681 (0.1676)  evaluator_time: 0.0030 (0.0038)  time: 0.1726  data: 0.0009  mem: 725  max mem: 19988
[2025-05-19 22:28:57 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1676)  evaluator_time: 0.0030 (0.0038)  time: 0.1727  data: 0.0008  mem: 725  max mem: 19988
[2025-05-19 22:28:58 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1683 (0.1677)  evaluator_time: 0.0030 (0.0038)  time: 0.1729  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:00 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1681 (0.1677)  evaluator_time: 0.0030 (0.0038)  time: 0.1728  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:29:02 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1677)  evaluator_time: 0.0030 (0.0037)  time: 0.1724  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:29:04 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1682 (0.1678)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:29:05 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1685 (0.1678)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0008  mem: 725  max mem: 19988
[2025-05-19 22:29:07 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1681 (0.1678)  evaluator_time: 0.0030 (0.0037)  time: 0.1724  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:09 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1678)  evaluator_time: 0.0030 (0.0037)  time: 0.1722  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:10 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1675 (0.1678)  evaluator_time: 0.0030 (0.0037)  time: 0.1721  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:12 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0036)  time: 0.1721  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:29:14 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0036)  time: 0.1719  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:29:16 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1681 (0.1679)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:29:17 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1684 (0.1679)  evaluator_time: 0.0030 (0.0036)  time: 0.1728  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:19 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1683 (0.1679)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:29:21 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1685 (0.1679)  evaluator_time: 0.0040 (0.0036)  time: 0.1738  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:23 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1691 (0.1680)  evaluator_time: 0.0040 (0.0036)  time: 0.1742  data: 0.0004  mem: 725  max mem: 19988
[2025-05-19 22:29:24 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0007  mem: 725  max mem: 19988
[2025-05-19 22:29:26 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0008  mem: 725  max mem: 19988
[2025-05-19 22:29:28 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1685 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:29 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1683 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1726  data: 0.0006  mem: 725  max mem: 19988
[2025-05-19 22:29:31 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1686 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0005  mem: 725  max mem: 19988
[2025-05-19 22:29:32 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0036)  time: 0.1724  data: 0.0005  mem: 724  max mem: 19988
[2025-05-19 22:29:32 det.util.engine] INFO: Averaged stats: model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0036)
[2025-05-19 22:29:33 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.660
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.321
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.600
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.434
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.606

[2025-05-19 22:29:33 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2550  | 0.706  | 0.242 |
| Crescent_gap  | 48   | 48  | 6193  | 1.000  | 0.906 |
| Inclusion     | 41   | 82  | 6733  | 0.817  | 0.292 |
| Oil_spot      | 58   | 125 | 13312 | 0.920  | 0.648 |
| Punching      | 74   | 74  | 2358  | 0.986  | 0.945 |
| Rolled_pit    | 10   | 25  | 3701  | 0.800  | 0.374 |
| Silk_spot     | 134  | 150 | 66475 | 0.953  | 0.597 |
| Waist_folding | 24   | 26  | 8735  | 0.962  | 0.786 |
| Water_spot    | 68   | 78  | 17580 | 0.974  | 0.844 |
| Welding_line  | 99   | 99  | 9739  | 1.000  | 0.967 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.912  | 0.660 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 22:29:33 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:29:33 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 22:29:33 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 22:29:34 det.util.engine] INFO: Epoch: [13]  [0/1834]  eta: 0:15:32  lr: 0.000010  data_time: 0.0005  iter_time: 0.5083  loss: 44.1284 (44.1284)  loss_class: 2.8087 (2.8087)  loss_bbox: 0.1458 (0.1458)  loss_giou: 0.0566 (0.0566)  loss_class_0: 1.7797 (1.7797)  loss_bbox_0: 0.3521 (0.3521)  loss_giou_0: 0.1432 (0.1432)  loss_class_1: 1.8856 (1.8856)  loss_bbox_1: 0.2063 (0.2063)  loss_giou_1: 0.0925 (0.0925)  loss_class_2: 1.9206 (1.9206)  loss_bbox_2: 0.2021 (0.2021)  loss_giou_2: 0.0869 (0.0869)  loss_class_3: 2.6945 (2.6945)  loss_bbox_3: 0.0765 (0.0765)  loss_giou_3: 0.0529 (0.0529)  loss_class_4: 2.5248 (2.5248)  loss_bbox_4: 0.1456 (0.1456)  loss_giou_4: 0.0523 (0.0523)  loss_class_enc: 1.8238 (1.8238)  loss_bbox_enc: 0.2535 (0.2535)  loss_giou_enc: 0.1071 (0.1071)  loss_class_dn: 0.4194 (0.4194)  loss_bbox_dn: 1.1229 (1.1229)  loss_giou_dn: 0.4086 (0.4086)  loss_class_dn_0: 0.4928 (0.4928)  loss_bbox_dn_0: 1.2489 (1.2489)  loss_giou_dn_0: 0.4590 (0.4590)  loss_class_dn_1: 0.4568 (0.4568)  loss_bbox_dn_1: 1.1350 (1.1350)  loss_giou_dn_1: 0.4181 (0.4181)  loss_class_dn_2: 0.4404 (0.4404)  loss_bbox_dn_2: 1.1088 (1.1088)  loss_giou_dn_2: 0.4085 (0.4085)  loss_class_dn_3: 0.4278 (0.4278)  loss_bbox_dn_3: 1.1333 (1.1333)  loss_giou_dn_3: 0.4071 (0.4071)  loss_class_dn_4: 0.4237 (0.4237)  loss_bbox_dn_4: 1.1197 (1.1197)  loss_giou_dn_4: 0.4060 (0.4060)  loss_class_hybrid: 1.3102 (1.3102)  loss_bbox_hybrid: 0.6559 (0.6559)  loss_giou_hybrid: 0.2577 (0.2577)  loss_class_0_hybrid: 1.5443 (1.5443)  loss_bbox_0_hybrid: 0.3022 (0.3022)  loss_giou_0_hybrid: 0.1595 (0.1595)  loss_class_1_hybrid: 1.2047 (1.2047)  loss_bbox_1_hybrid: 0.5091 (0.5091)  loss_giou_1_hybrid: 0.2146 (0.2146)  loss_class_2_hybrid: 1.1570 (1.1570)  loss_bbox_2_hybrid: 0.5940 (0.5940)  loss_giou_2_hybrid: 0.2473 (0.2473)  loss_class_3_hybrid: 1.3298 (1.3298)  loss_bbox_3_hybrid: 0.5986 (0.5986)  loss_giou_3_hybrid: 0.2435 (0.2435)  loss_class_4_hybrid: 1.3794 (1.3794)  loss_bbox_4_hybrid: 0.6012 (0.6012)  loss_giou_4_hybrid: 0.2397 (0.2397)  loss_class_enc_hybrid: 1.2441 (1.2441)  loss_bbox_enc_hybrid: 0.6405 (0.6405)  loss_giou_enc_hybrid: 0.2466 (0.2466)  mem: 735  max mem: 19988
[2025-05-19 22:29:34 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:46:43 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5365  loss: 27.7777 (30.2926)  loss_class: 0.4418 (0.7144)  loss_bbox: 0.2192 (0.3289)  loss_giou: 0.2887 (0.4096)  loss_class_0: 0.6624 (0.9089)  loss_bbox_0: 0.2117 (0.3185)  loss_giou_0: 0.3663 (0.4202)  loss_class_1: 0.4935 (0.7979)  loss_bbox_1: 0.2292 (0.3180)  loss_giou_1: 0.3139 (0.4083)  loss_class_2: 0.4527 (0.7522)  loss_bbox_2: 0.2270 (0.3207)  loss_giou_2: 0.3045 (0.4070)  loss_class_3: 0.4415 (0.7357)  loss_bbox_3: 0.2242 (0.3188)  loss_giou_3: 0.2956 (0.4057)  loss_class_4: 0.4630 (0.7264)  loss_bbox_4: 0.2212 (0.3186)  loss_giou_4: 0.2936 (0.4066)  loss_class_enc: 1.2654 (1.1986)  loss_bbox_enc: 0.1965 (0.3392)  loss_giou_enc: 0.3007 (0.4556)  loss_class_dn: 0.4108 (0.3720)  loss_bbox_dn: 0.2457 (0.4850)  loss_giou_dn: 0.3674 (0.4635)  loss_class_dn_0: 0.4793 (0.4204)  loss_bbox_dn_0: 0.3069 (0.6010)  loss_giou_dn_0: 0.5630 (0.5980)  loss_class_dn_1: 0.4542 (0.4014)  loss_bbox_dn_1: 0.2535 (0.5064)  loss_giou_dn_1: 0.4102 (0.4894)  loss_class_dn_2: 0.4253 (0.3816)  loss_bbox_dn_2: 0.2457 (0.4916)  loss_giou_dn_2: 0.3769 (0.4704)  loss_class_dn_3: 0.4167 (0.3766)  loss_bbox_dn_3: 0.2483 (0.4865)  loss_giou_dn_3: 0.3670 (0.4645)  loss_class_dn_4: 0.4141 (0.3740)  loss_bbox_dn_4: 0.2482 (0.4857)  loss_giou_dn_4: 0.3709 (0.4638)  loss_class_hybrid: 0.5640 (0.7930)  loss_bbox_hybrid: 0.2295 (0.3010)  loss_giou_hybrid: 0.2999 (0.3959)  loss_class_0_hybrid: 0.7923 (0.8772)  loss_bbox_0_hybrid: 0.2434 (0.3050)  loss_giou_0_hybrid: 0.3215 (0.4217)  loss_class_1_hybrid: 0.5552 (0.8020)  loss_bbox_1_hybrid: 0.2161 (0.3052)  loss_giou_1_hybrid: 0.3069 (0.4088)  loss_class_2_hybrid: 0.5838 (0.7917)  loss_bbox_2_hybrid: 0.2286 (0.3037)  loss_giou_2_hybrid: 0.2955 (0.4027)  loss_class_3_hybrid: 0.5402 (0.7864)  loss_bbox_3_hybrid: 0.2275 (0.3039)  loss_giou_3_hybrid: 0.3048 (0.4000)  loss_class_4_hybrid: 0.5420 (0.7867)  loss_bbox_4_hybrid: 0.2316 (0.3038)  loss_giou_4_hybrid: 0.3038 (0.3987)  loss_class_enc_hybrid: 0.9831 (1.0104)  loss_bbox_enc_hybrid: 0.2676 (0.3634)  loss_giou_enc_hybrid: 0.3799 (0.4899)
[2025-05-19 22:46:43 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 22:46:43 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\pytorch_model.bin
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\optimizer.bin
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\scheduler.bin
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\sampler.bin
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\sampler_1.bin
[2025-05-19 22:46:43 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_13\random_states_0.pkl
[2025-05-19 22:46:43 det.__main__] INFO: Start evaluation
[2025-05-19 22:46:44 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1680 (0.1680)  evaluator_time: 0.0040 (0.0040)  time: 0.1970  data: 0.0250  mem: 728  max mem: 19988
[2025-05-19 22:46:45 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1673 (0.1676)  evaluator_time: 0.0030 (0.0035)  time: 0.1740  data: 0.0027  mem: 728  max mem: 19988
[2025-05-19 22:46:47 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1712  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:46:49 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1709  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:46:50 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1678 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:46:52 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1684 (0.1678)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:46:54 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:46:56 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:46:57 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:46:59 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:01 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:02 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:04 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1685 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:06 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1685 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:08 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1681 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:09 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:11 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1680 (0.1682)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:13 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:15 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:16 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1677 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:18 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1671 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:20 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:21 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:23 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1681 (0.1682)  evaluator_time: 0.0040 (0.0033)  time: 0.1732  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:25 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1687 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:27 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1686 (0.1682)  evaluator_time: 0.0020 (0.0033)  time: 0.1728  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:28 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1677 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:30 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:32 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1684 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:34 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0004  mem: 728  max mem: 19988
[2025-05-19 22:47:35 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:37 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:39 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:40 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:42 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1685 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:44 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1689 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:46 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:47 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:47:49 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:51 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1687 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1736  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:47:53 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1734  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:54 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1682 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0008  mem: 728  max mem: 19988
[2025-05-19 22:47:56 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:58 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1688 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:47:59 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-19 22:48:01 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1693 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0007  mem: 728  max mem: 19988
[2025-05-19 22:48:02 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 728  max mem: 19988
[2025-05-19 22:48:02 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 22:48:03 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.652
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.321
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.197
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.379
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.605
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.608

[2025-05-19 22:48:03 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3141  | 0.647  | 0.236 |
| Crescent_gap  | 48   | 48  | 7303  | 1.000  | 0.901 |
| Inclusion     | 41   | 82  | 6960  | 0.829  | 0.321 |
| Oil_spot      | 58   | 125 | 14040 | 0.928  | 0.637 |
| Punching      | 74   | 74  | 2468  | 0.986  | 0.933 |
| Rolled_pit    | 10   | 25  | 5740  | 0.840  | 0.372 |
| Silk_spot     | 134  | 150 | 62830 | 0.947  | 0.596 |
| Waist_folding | 24   | 26  | 9767  | 0.962  | 0.708 |
| Water_spot    | 68   | 78  | 15879 | 0.987  | 0.831 |
| Welding_line  | 99   | 99  | 9250  | 1.000  | 0.980 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.913  | 0.652 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 22:48:03 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 22:48:04 det.util.engine] INFO: Epoch: [14]  [0/1834]  eta: 0:19:28  lr: 0.000010  data_time: 0.0046  iter_time: 0.6373  loss: 31.5354 (31.5354)  loss_class: 0.7076 (0.7076)  loss_bbox: 0.2914 (0.2914)  loss_giou: 0.6310 (0.6310)  loss_class_0: 0.6998 (0.6998)  loss_bbox_0: 0.1879 (0.1879)  loss_giou_0: 0.6927 (0.6927)  loss_class_1: 0.5866 (0.5866)  loss_bbox_1: 0.2422 (0.2422)  loss_giou_1: 0.6620 (0.6620)  loss_class_2: 0.7753 (0.7753)  loss_bbox_2: 0.2548 (0.2548)  loss_giou_2: 0.6022 (0.6022)  loss_class_3: 0.8843 (0.8843)  loss_bbox_3: 0.3144 (0.3144)  loss_giou_3: 0.6489 (0.6489)  loss_class_4: 0.8398 (0.8398)  loss_bbox_4: 0.2944 (0.2944)  loss_giou_4: 0.6362 (0.6362)  loss_class_enc: 1.0017 (1.0017)  loss_bbox_enc: 0.3892 (0.3892)  loss_giou_enc: 0.9305 (0.9305)  loss_class_dn: 0.4421 (0.4421)  loss_bbox_dn: 0.2511 (0.2511)  loss_giou_dn: 0.5543 (0.5543)  loss_class_dn_0: 0.4928 (0.4928)  loss_bbox_dn_0: 0.2851 (0.2851)  loss_giou_dn_0: 0.6728 (0.6728)  loss_class_dn_1: 0.4579 (0.4579)  loss_bbox_dn_1: 0.2047 (0.2047)  loss_giou_dn_1: 0.5463 (0.5463)  loss_class_dn_2: 0.4517 (0.4517)  loss_bbox_dn_2: 0.2370 (0.2370)  loss_giou_dn_2: 0.5539 (0.5539)  loss_class_dn_3: 0.4400 (0.4400)  loss_bbox_dn_3: 0.2360 (0.2360)  loss_giou_dn_3: 0.5489 (0.5489)  loss_class_dn_4: 0.4442 (0.4442)  loss_bbox_dn_4: 0.2557 (0.2557)  loss_giou_dn_4: 0.5608 (0.5608)  loss_class_hybrid: 0.6363 (0.6363)  loss_bbox_hybrid: 0.2789 (0.2789)  loss_giou_hybrid: 0.6213 (0.6213)  loss_class_0_hybrid: 0.7694 (0.7694)  loss_bbox_0_hybrid: 0.2677 (0.2677)  loss_giou_0_hybrid: 0.7657 (0.7657)  loss_class_1_hybrid: 0.6091 (0.6091)  loss_bbox_1_hybrid: 0.2621 (0.2621)  loss_giou_1_hybrid: 0.6696 (0.6696)  loss_class_2_hybrid: 0.7736 (0.7736)  loss_bbox_2_hybrid: 0.2675 (0.2675)  loss_giou_2_hybrid: 0.6365 (0.6365)  loss_class_3_hybrid: 0.6149 (0.6149)  loss_bbox_3_hybrid: 0.2715 (0.2715)  loss_giou_3_hybrid: 0.6282 (0.6282)  loss_class_4_hybrid: 0.6552 (0.6552)  loss_bbox_4_hybrid: 0.2821 (0.2821)  loss_giou_4_hybrid: 0.6279 (0.6279)  loss_class_enc_hybrid: 0.8461 (0.8461)  loss_bbox_enc_hybrid: 0.3046 (0.3046)  loss_giou_enc_hybrid: 0.8388 (0.8388)  mem: 739  max mem: 19988
[2025-05-19 22:48:04 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:05:19 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5407  loss: 30.5290 (30.2175)  loss_class: 0.4385 (0.7141)  loss_bbox: 0.1972 (0.3154)  loss_giou: 0.3146 (0.4126)  loss_class_0: 0.6888 (0.9149)  loss_bbox_0: 0.1319 (0.3115)  loss_giou_0: 0.4034 (0.4304)  loss_class_1: 0.6964 (0.7847)  loss_bbox_1: 0.1429 (0.3129)  loss_giou_1: 0.3818 (0.4159)  loss_class_2: 0.5599 (0.7417)  loss_bbox_2: 0.1539 (0.3141)  loss_giou_2: 0.4711 (0.4130)  loss_class_3: 0.5218 (0.7204)  loss_bbox_3: 0.1783 (0.3139)  loss_giou_3: 0.4337 (0.4119)  loss_class_4: 0.4459 (0.7180)  loss_bbox_4: 0.2025 (0.3098)  loss_giou_4: 0.4309 (0.4100)  loss_class_enc: 1.0074 (1.2212)  loss_bbox_enc: 0.1801 (0.3376)  loss_giou_enc: 0.4648 (0.4604)  loss_class_dn: 0.4277 (0.3746)  loss_bbox_dn: 0.2021 (0.4798)  loss_giou_dn: 0.4672 (0.4691)  loss_class_dn_0: 0.4619 (0.4279)  loss_bbox_dn_0: 0.1966 (0.5975)  loss_giou_dn_0: 0.6135 (0.6047)  loss_class_dn_1: 0.4569 (0.4063)  loss_bbox_dn_1: 0.1613 (0.5012)  loss_giou_dn_1: 0.4732 (0.4953)  loss_class_dn_2: 0.4283 (0.3865)  loss_bbox_dn_2: 0.1840 (0.4856)  loss_giou_dn_2: 0.4773 (0.4759)  loss_class_dn_3: 0.4326 (0.3800)  loss_bbox_dn_3: 0.1854 (0.4808)  loss_giou_dn_3: 0.4623 (0.4698)  loss_class_dn_4: 0.4293 (0.3774)  loss_bbox_dn_4: 0.2028 (0.4800)  loss_giou_dn_4: 0.4570 (0.4690)  loss_class_hybrid: 0.5129 (0.7818)  loss_bbox_hybrid: 0.1422 (0.2928)  loss_giou_hybrid: 0.3505 (0.3991)  loss_class_0_hybrid: 0.6655 (0.8612)  loss_bbox_0_hybrid: 0.1663 (0.3050)  loss_giou_0_hybrid: 0.4118 (0.4292)  loss_class_1_hybrid: 0.5663 (0.7892)  loss_bbox_1_hybrid: 0.1473 (0.3041)  loss_giou_1_hybrid: 0.3669 (0.4126)  loss_class_2_hybrid: 0.5319 (0.7715)  loss_bbox_2_hybrid: 0.1572 (0.3037)  loss_giou_2_hybrid: 0.3213 (0.4082)  loss_class_3_hybrid: 0.5312 (0.7687)  loss_bbox_3_hybrid: 0.1541 (0.2988)  loss_giou_3_hybrid: 0.3451 (0.4037)  loss_class_4_hybrid: 0.5140 (0.7760)  loss_bbox_4_hybrid: 0.1511 (0.2955)  loss_giou_4_hybrid: 0.3497 (0.4015)  loss_class_enc_hybrid: 0.8976 (1.0079)  loss_bbox_enc_hybrid: 0.1880 (0.3638)  loss_giou_enc_hybrid: 0.4303 (0.4978)
[2025-05-19 23:05:19 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 23:05:19 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14
[2025-05-19 23:05:19 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\pytorch_model.bin
[2025-05-19 23:05:20 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\optimizer.bin
[2025-05-19 23:05:20 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\scheduler.bin
[2025-05-19 23:05:20 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\sampler.bin
[2025-05-19 23:05:20 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\sampler_1.bin
[2025-05-19 23:05:20 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_14\random_states_0.pkl
[2025-05-19 23:05:20 det.__main__] INFO: Start evaluation
[2025-05-19 23:05:20 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1670 (0.1670)  evaluator_time: 0.0040 (0.0040)  time: 0.1966  data: 0.0256  mem: 729  max mem: 19988
[2025-05-19 23:05:22 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1686 (0.1684)  evaluator_time: 0.0040 (0.0035)  time: 0.1747  data: 0.0027  mem: 729  max mem: 19988
[2025-05-19 23:05:24 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1687 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:25 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0030)  time: 0.1720  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:27 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1686 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1721  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:29 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1686 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:30 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:32 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1675 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1719  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:34 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:05:36 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1682 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 23:05:37 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:05:39 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1684 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:41 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:43 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 23:05:44 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1678 (0.1684)  evaluator_time: 0.0040 (0.0032)  time: 0.1727  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 23:05:46 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1728  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:48 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1682 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:05:49 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0008  mem: 729  max mem: 19988
[2025-05-19 23:05:51 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:53 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:55 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1687 (0.1685)  evaluator_time: 0.0040 (0.0033)  time: 0.1732  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:05:56 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0004  mem: 729  max mem: 19988
[2025-05-19 23:05:58 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1688 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:00 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:02 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:03 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1686 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:05 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1683 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:07 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:08 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:10 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1687 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:12 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:14 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1688 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:15 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1685 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:17 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:19 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:21 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 729  max mem: 19988
[2025-05-19 23:06:22 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1670 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:24 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1671 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:26 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1671 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:27 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1671 (0.1685)  evaluator_time: 0.0040 (0.0034)  time: 0.1728  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:29 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1685)  evaluator_time: 0.0040 (0.0034)  time: 0.1730  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:31 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:33 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1676 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:34 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1670 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 729  max mem: 19988
[2025-05-19 23:06:36 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1722  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:38 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1724  data: 0.0005  mem: 729  max mem: 19988
[2025-05-19 23:06:39 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0004  mem: 730  max mem: 19988
[2025-05-19 23:06:39 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 23:06:39 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.656
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.285
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.190
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.477
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.584

[2025-05-19 23:06:39 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2575  | 0.765  | 0.260 |
| Crescent_gap  | 48   | 48  | 8014  | 1.000  | 0.889 |
| Inclusion     | 41   | 82  | 6611  | 0.841  | 0.303 |
| Oil_spot      | 58   | 125 | 13825 | 0.920  | 0.638 |
| Punching      | 74   | 74  | 2307  | 0.986  | 0.935 |
| Rolled_pit    | 10   | 25  | 3563  | 0.840  | 0.502 |
| Silk_spot     | 134  | 150 | 66047 | 0.940  | 0.581 |
| Waist_folding | 24   | 26  | 8439  | 0.962  | 0.671 |
| Water_spot    | 68   | 78  | 16306 | 0.987  | 0.828 |
| Welding_line  | 99   | 99  | 9637  | 1.000  | 0.957 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.924  | 0.656 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 23:06:39 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:06:40 det.util.engine] INFO: Epoch: [15]  [0/1834]  eta: 0:16:43  lr: 0.000010  data_time: 0.0046  iter_time: 0.5471  loss: 28.5753 (28.5753)  loss_class: 0.4346 (0.4346)  loss_bbox: 0.3197 (0.3197)  loss_giou: 0.4435 (0.4435)  loss_class_0: 0.4718 (0.4718)  loss_bbox_0: 0.5411 (0.5411)  loss_giou_0: 0.5710 (0.5710)  loss_class_1: 0.4739 (0.4739)  loss_bbox_1: 0.3518 (0.3518)  loss_giou_1: 0.5437 (0.5437)  loss_class_2: 0.4809 (0.4809)  loss_bbox_2: 0.3294 (0.3294)  loss_giou_2: 0.5195 (0.5195)  loss_class_3: 0.4555 (0.4555)  loss_bbox_3: 0.3116 (0.3116)  loss_giou_3: 0.4442 (0.4442)  loss_class_4: 0.4443 (0.4443)  loss_bbox_4: 0.3158 (0.3158)  loss_giou_4: 0.4395 (0.4395)  loss_class_enc: 0.7702 (0.7702)  loss_bbox_enc: 0.4954 (0.4954)  loss_giou_enc: 0.9449 (0.9449)  loss_class_dn: 0.4305 (0.4305)  loss_bbox_dn: 0.3071 (0.3071)  loss_giou_dn: 0.4499 (0.4499)  loss_class_dn_0: 0.4794 (0.4794)  loss_bbox_dn_0: 0.5297 (0.5297)  loss_giou_dn_0: 0.6801 (0.6801)  loss_class_dn_1: 0.4398 (0.4398)  loss_bbox_dn_1: 0.3507 (0.3507)  loss_giou_dn_1: 0.5190 (0.5190)  loss_class_dn_2: 0.4298 (0.4298)  loss_bbox_dn_2: 0.3078 (0.3078)  loss_giou_dn_2: 0.4821 (0.4821)  loss_class_dn_3: 0.4242 (0.4242)  loss_bbox_dn_3: 0.2959 (0.2959)  loss_giou_dn_3: 0.4464 (0.4464)  loss_class_dn_4: 0.4300 (0.4300)  loss_bbox_dn_4: 0.2974 (0.2974)  loss_giou_dn_4: 0.4450 (0.4450)  loss_class_hybrid: 0.5099 (0.5099)  loss_bbox_hybrid: 0.3456 (0.3456)  loss_giou_hybrid: 0.4479 (0.4479)  loss_class_0_hybrid: 0.6037 (0.6037)  loss_bbox_0_hybrid: 0.4110 (0.4110)  loss_giou_0_hybrid: 0.5274 (0.5274)  loss_class_1_hybrid: 0.5542 (0.5542)  loss_bbox_1_hybrid: 0.4195 (0.4195)  loss_giou_1_hybrid: 0.4753 (0.4753)  loss_class_2_hybrid: 0.5119 (0.5119)  loss_bbox_2_hybrid: 0.3888 (0.3888)  loss_giou_2_hybrid: 0.5077 (0.5077)  loss_class_3_hybrid: 0.5130 (0.5130)  loss_bbox_3_hybrid: 0.3593 (0.3593)  loss_giou_3_hybrid: 0.4409 (0.4409)  loss_class_4_hybrid: 0.5135 (0.5135)  loss_bbox_4_hybrid: 0.3471 (0.3471)  loss_giou_4_hybrid: 0.4497 (0.4497)  loss_class_enc_hybrid: 1.4750 (1.4750)  loss_bbox_enc_hybrid: 0.3685 (0.3685)  loss_giou_enc_hybrid: 0.5586 (0.5586)  mem: 732  max mem: 19988
[2025-05-19 23:06:40 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:23:58 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5569  loss: 25.4492 (29.7093)  loss_class: 0.4251 (0.6802)  loss_bbox: 0.1790 (0.3250)  loss_giou: 0.3857 (0.4112)  loss_class_0: 0.5831 (0.8942)  loss_bbox_0: 0.2040 (0.3024)  loss_giou_0: 0.4725 (0.4176)  loss_class_1: 0.4846 (0.7695)  loss_bbox_1: 0.1850 (0.3054)  loss_giou_1: 0.4248 (0.4066)  loss_class_2: 0.4354 (0.7197)  loss_bbox_2: 0.1803 (0.3097)  loss_giou_2: 0.4001 (0.4061)  loss_class_3: 0.4557 (0.7010)  loss_bbox_3: 0.1568 (0.3139)  loss_giou_3: 0.3848 (0.4058)  loss_class_4: 0.4333 (0.6897)  loss_bbox_4: 0.1757 (0.3187)  loss_giou_4: 0.3855 (0.4088)  loss_class_enc: 1.1441 (1.2043)  loss_bbox_enc: 0.3058 (0.3248)  loss_giou_enc: 0.4665 (0.4469)  loss_class_dn: 0.4007 (0.3709)  loss_bbox_dn: 0.1638 (0.4696)  loss_giou_dn: 0.3731 (0.4597)  loss_class_dn_0: 0.4757 (0.4230)  loss_bbox_dn_0: 0.3720 (0.5842)  loss_giou_dn_0: 0.5689 (0.5943)  loss_class_dn_1: 0.4497 (0.4015)  loss_bbox_dn_1: 0.1854 (0.4901)  loss_giou_dn_1: 0.4075 (0.4852)  loss_class_dn_2: 0.4212 (0.3809)  loss_bbox_dn_2: 0.1655 (0.4755)  loss_giou_dn_2: 0.3703 (0.4663)  loss_class_dn_3: 0.4122 (0.3754)  loss_bbox_dn_3: 0.1591 (0.4707)  loss_giou_dn_3: 0.3721 (0.4610)  loss_class_dn_4: 0.4041 (0.3736)  loss_bbox_dn_4: 0.1619 (0.4702)  loss_giou_dn_4: 0.3721 (0.4599)  loss_class_hybrid: 0.4935 (0.7518)  loss_bbox_hybrid: 0.1842 (0.3048)  loss_giou_hybrid: 0.3690 (0.3995)  loss_class_0_hybrid: 0.6233 (0.8542)  loss_bbox_0_hybrid: 0.1871 (0.3036)  loss_giou_0_hybrid: 0.4327 (0.4196)  loss_class_1_hybrid: 0.5346 (0.7696)  loss_bbox_1_hybrid: 0.1777 (0.3066)  loss_giou_1_hybrid: 0.3872 (0.4076)  loss_class_2_hybrid: 0.4853 (0.7525)  loss_bbox_2_hybrid: 0.1719 (0.3065)  loss_giou_2_hybrid: 0.3781 (0.4046)  loss_class_3_hybrid: 0.4826 (0.7501)  loss_bbox_3_hybrid: 0.1800 (0.3057)  loss_giou_3_hybrid: 0.3748 (0.4013)  loss_class_4_hybrid: 0.4857 (0.7508)  loss_bbox_4_hybrid: 0.1808 (0.3055)  loss_giou_4_hybrid: 0.3695 (0.4008)  loss_class_enc_hybrid: 0.9115 (1.0011)  loss_bbox_enc_hybrid: 0.3021 (0.3560)  loss_giou_enc_hybrid: 0.4918 (0.4837)
[2025-05-19 23:23:58 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 23:23:58 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15
[2025-05-19 23:23:58 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\pytorch_model.bin
[2025-05-19 23:23:59 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\optimizer.bin
[2025-05-19 23:23:59 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\scheduler.bin
[2025-05-19 23:23:59 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\sampler.bin
[2025-05-19 23:23:59 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\sampler_1.bin
[2025-05-19 23:23:59 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_15\random_states_0.pkl
[2025-05-19 23:23:59 det.__main__] INFO: Start evaluation
[2025-05-19 23:23:59 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1970  data: 0.0260  mem: 726  max mem: 19988
[2025-05-19 23:24:00 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1751  data: 0.0032  mem: 726  max mem: 19988
[2025-05-19 23:24:02 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1684 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:04 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1686 (0.1686)  evaluator_time: 0.0030 (0.0030)  time: 0.1724  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:06 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0029)  time: 0.1725  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:07 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:09 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1733  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:11 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1728  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:13 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1727  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:14 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1684 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:16 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:18 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1687 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:19 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:21 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1679 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1716  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:23 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1678 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:25 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1678 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:26 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1674 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:28 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1674 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1719  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:30 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1675 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0008  mem: 726  max mem: 19988
[2025-05-19 23:24:31 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1671 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:33 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1675 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1719  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:35 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:37 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1675 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:38 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1671 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:40 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:42 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1677 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:44 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1672 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:45 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:47 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1676 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0004  mem: 726  max mem: 19988
[2025-05-19 23:24:49 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1679 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:24:50 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:52 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1682 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:54 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1687 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:24:56 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:24:57 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1687 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0008  mem: 726  max mem: 19988
[2025-05-19 23:24:59 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:25:01 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:25:03 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:25:04 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0004  mem: 726  max mem: 19988
[2025-05-19 23:25:06 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1743  data: 0.0004  mem: 726  max mem: 19988
[2025-05-19 23:25:08 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1744  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:25:09 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1696 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:25:11 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1696 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 726  max mem: 19988
[2025-05-19 23:25:13 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1693 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19988
[2025-05-19 23:25:15 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:25:16 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1691 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:25:18 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-19 23:25:18 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 23:25:18 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.684
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.316
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.342
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.375
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.600
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.610

[2025-05-19 23:25:18 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2307  | 0.588  | 0.335 |
| Crescent_gap  | 48   | 48  | 8257  | 1.000  | 0.896 |
| Inclusion     | 41   | 82  | 7548  | 0.817  | 0.336 |
| Oil_spot      | 58   | 125 | 13198 | 0.936  | 0.674 |
| Punching      | 74   | 74  | 2578  | 0.986  | 0.931 |
| Rolled_pit    | 10   | 25  | 4555  | 0.880  | 0.508 |
| Silk_spot     | 134  | 150 | 64434 | 0.947  | 0.598 |
| Waist_folding | 24   | 26  | 8669  | 0.962  | 0.737 |
| Water_spot    | 68   | 78  | 17449 | 0.974  | 0.852 |
| Welding_line  | 99   | 99  | 8331  | 1.000  | 0.968 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.909  | 0.684 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 23:25:18 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:25:18 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 23:25:19 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-19 23:25:19 det.util.engine] INFO: Epoch: [16]  [0/1834]  eta: 0:17:23  lr: 0.000010  data_time: 0.0006  iter_time: 0.5692  loss: 31.9316 (31.9316)  loss_class: 0.4607 (0.4607)  loss_bbox: 0.1870 (0.1870)  loss_giou: 0.8140 (0.8140)  loss_class_0: 0.6422 (0.6422)  loss_bbox_0: 0.1563 (0.1563)  loss_giou_0: 0.6496 (0.6496)  loss_class_1: 0.5766 (0.5766)  loss_bbox_1: 0.1535 (0.1535)  loss_giou_1: 0.7278 (0.7278)  loss_class_2: 0.5252 (0.5252)  loss_bbox_2: 0.1771 (0.1771)  loss_giou_2: 0.7983 (0.7983)  loss_class_3: 0.4939 (0.4939)  loss_bbox_3: 0.1760 (0.1760)  loss_giou_3: 0.7882 (0.7882)  loss_class_4: 0.4848 (0.4848)  loss_bbox_4: 0.1792 (0.1792)  loss_giou_4: 0.8046 (0.8046)  loss_class_enc: 1.9139 (1.9139)  loss_bbox_enc: 0.1347 (0.1347)  loss_giou_enc: 0.4015 (0.4015)  loss_class_dn: 0.4446 (0.4446)  loss_bbox_dn: 0.2402 (0.2402)  loss_giou_dn: 0.7809 (0.7809)  loss_class_dn_0: 0.4651 (0.4651)  loss_bbox_dn_0: 0.2805 (0.2805)  loss_giou_dn_0: 0.9339 (0.9339)  loss_class_dn_1: 0.4847 (0.4847)  loss_bbox_dn_1: 0.2655 (0.2655)  loss_giou_dn_1: 0.8112 (0.8112)  loss_class_dn_2: 0.4534 (0.4534)  loss_bbox_dn_2: 0.2568 (0.2568)  loss_giou_dn_2: 0.8025 (0.8025)  loss_class_dn_3: 0.4608 (0.4608)  loss_bbox_dn_3: 0.2484 (0.2484)  loss_giou_dn_3: 0.7829 (0.7829)  loss_class_dn_4: 0.4497 (0.4497)  loss_bbox_dn_4: 0.2444 (0.2444)  loss_giou_dn_4: 0.7810 (0.7810)  loss_class_hybrid: 0.7141 (0.7141)  loss_bbox_hybrid: 0.1709 (0.1709)  loss_giou_hybrid: 0.7302 (0.7302)  loss_class_0_hybrid: 0.5576 (0.5576)  loss_bbox_0_hybrid: 0.1973 (0.1973)  loss_giou_0_hybrid: 0.8251 (0.8251)  loss_class_1_hybrid: 0.6335 (0.6335)  loss_bbox_1_hybrid: 0.1793 (0.1793)  loss_giou_1_hybrid: 0.7542 (0.7542)  loss_class_2_hybrid: 0.7307 (0.7307)  loss_bbox_2_hybrid: 0.1627 (0.1627)  loss_giou_2_hybrid: 0.7154 (0.7154)  loss_class_3_hybrid: 0.7518 (0.7518)  loss_bbox_3_hybrid: 0.1651 (0.1651)  loss_giou_3_hybrid: 0.7058 (0.7058)  loss_class_4_hybrid: 0.6955 (0.6955)  loss_bbox_4_hybrid: 0.1695 (0.1695)  loss_giou_4_hybrid: 0.7236 (0.7236)  loss_class_enc_hybrid: 0.6594 (0.6594)  loss_bbox_enc_hybrid: 0.2962 (0.2962)  loss_giou_enc_hybrid: 0.9623 (0.9623)  mem: 730  max mem: 19988
[2025-05-19 23:25:19 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:42:37 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0006  iter_time: 0.5599  loss: 35.0017 (30.3673)  loss_class: 0.5398 (0.7218)  loss_bbox: 0.3349 (0.3227)  loss_giou: 0.3720 (0.4118)  loss_class_0: 0.6209 (0.9180)  loss_bbox_0: 0.4168 (0.3182)  loss_giou_0: 0.4969 (0.4289)  loss_class_1: 0.5040 (0.7935)  loss_bbox_1: 0.3890 (0.3205)  loss_giou_1: 0.3762 (0.4126)  loss_class_2: 0.4998 (0.7499)  loss_bbox_2: 0.3493 (0.3213)  loss_giou_2: 0.3671 (0.4096)  loss_class_3: 0.5419 (0.7321)  loss_bbox_3: 0.3185 (0.3193)  loss_giou_3: 0.3688 (0.4104)  loss_class_4: 0.5205 (0.7268)  loss_bbox_4: 0.3288 (0.3187)  loss_giou_4: 0.3754 (0.4089)  loss_class_enc: 1.0850 (1.2298)  loss_bbox_enc: 0.3477 (0.3281)  loss_giou_enc: 0.4430 (0.4525)  loss_class_dn: 0.4186 (0.3773)  loss_bbox_dn: 0.5662 (0.4897)  loss_giou_dn: 0.4895 (0.4696)  loss_class_dn_0: 0.4825 (0.4299)  loss_bbox_dn_0: 0.6724 (0.5971)  loss_giou_dn_0: 0.6225 (0.6012)  loss_class_dn_1: 0.4632 (0.4074)  loss_bbox_dn_1: 0.5120 (0.5074)  loss_giou_dn_1: 0.5148 (0.4937)  loss_class_dn_2: 0.4338 (0.3865)  loss_bbox_dn_2: 0.5407 (0.4940)  loss_giou_dn_2: 0.4846 (0.4755)  loss_class_dn_3: 0.4307 (0.3815)  loss_bbox_dn_3: 0.5615 (0.4903)  loss_giou_dn_3: 0.4913 (0.4704)  loss_class_dn_4: 0.4296 (0.3796)  loss_bbox_dn_4: 0.5597 (0.4898)  loss_giou_dn_4: 0.4913 (0.4695)  loss_class_hybrid: 0.5530 (0.7666)  loss_bbox_hybrid: 0.3640 (0.3109)  loss_giou_hybrid: 0.3944 (0.4028)  loss_class_0_hybrid: 0.7792 (0.8500)  loss_bbox_0_hybrid: 0.3534 (0.3186)  loss_giou_0_hybrid: 0.3995 (0.4296)  loss_class_1_hybrid: 0.5800 (0.7688)  loss_bbox_1_hybrid: 0.3799 (0.3235)  loss_giou_1_hybrid: 0.3872 (0.4185)  loss_class_2_hybrid: 0.5306 (0.7586)  loss_bbox_2_hybrid: 0.3871 (0.3184)  loss_giou_2_hybrid: 0.3722 (0.4121)  loss_class_3_hybrid: 0.5569 (0.7583)  loss_bbox_3_hybrid: 0.4422 (0.3158)  loss_giou_3_hybrid: 0.3868 (0.4070)  loss_class_4_hybrid: 0.5141 (0.7625)  loss_bbox_4_hybrid: 0.3612 (0.3134)  loss_giou_4_hybrid: 0.3918 (0.4057)  loss_class_enc_hybrid: 1.1344 (0.9960)  loss_bbox_enc_hybrid: 0.4226 (0.3679)  loss_giou_enc_hybrid: 0.4068 (0.4965)
[2025-05-19 23:42:37 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-19 23:42:37 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16
[2025-05-19 23:42:37 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\pytorch_model.bin
[2025-05-19 23:42:38 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\optimizer.bin
[2025-05-19 23:42:38 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\scheduler.bin
[2025-05-19 23:42:38 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\sampler.bin
[2025-05-19 23:42:38 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\sampler_1.bin
[2025-05-19 23:42:38 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_16\random_states_0.pkl
[2025-05-19 23:42:38 det.__main__] INFO: Start evaluation
[2025-05-19 23:42:38 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:36  model_time: 0.1691 (0.1691)  evaluator_time: 0.0040 (0.0040)  time: 0.2101  data: 0.0370  mem: 727  max mem: 19988
[2025-05-19 23:42:40 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1676 (0.1677)  evaluator_time: 0.0030 (0.0034)  time: 0.1752  data: 0.0040  mem: 727  max mem: 19988
[2025-05-19 23:42:41 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:43 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0030)  time: 0.1711  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:45 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1680 (0.1675)  evaluator_time: 0.0030 (0.0030)  time: 0.1712  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:42:47 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1673 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:48 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1680 (0.1677)  evaluator_time: 0.0030 (0.0031)  time: 0.1720  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:50 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1681 (0.1677)  evaluator_time: 0.0030 (0.0030)  time: 0.1721  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:52 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1685 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:42:53 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1685 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:42:55 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0031)  time: 0.1720  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:42:57 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1685 (0.1680)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:42:59 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:00 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:02 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1681 (0.1682)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:04 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:06 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1691 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:07 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1693 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:09 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:11 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:12 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:43:14 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0008  mem: 727  max mem: 19988
[2025-05-19 23:43:16 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:18 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:19 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:21 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1692 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:23 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1691 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:25 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0004  mem: 727  max mem: 19988
[2025-05-19 23:43:26 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:28 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:30 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:32 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:33 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:35 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:37 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0009  mem: 727  max mem: 19988
[2025-05-19 23:43:38 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1698 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0009  mem: 727  max mem: 19988
[2025-05-19 23:43:40 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:42 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:44 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:45 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:47 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1743  data: 0.0004  mem: 727  max mem: 19988
[2025-05-19 23:43:49 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1696 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 727  max mem: 19988
[2025-05-19 23:43:51 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1696 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:43:52 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:43:54 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 727  max mem: 19988
[2025-05-19 23:43:56 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 727  max mem: 19988
[2025-05-19 23:43:57 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0004  mem: 727  max mem: 19988
[2025-05-19 23:43:57 det.util.engine] INFO: Averaged stats: model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)
[2025-05-19 23:43:58 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.672
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.190
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.378
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.598
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.596

[2025-05-19 23:43:58 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2225  | 0.647  | 0.288 |
| Crescent_gap  | 48   | 48  | 6722  | 1.000  | 0.913 |
| Inclusion     | 41   | 82  | 7904  | 0.817  | 0.294 |
| Oil_spot      | 58   | 125 | 10399 | 0.920  | 0.672 |
| Punching      | 74   | 74  | 1785  | 0.986  | 0.936 |
| Rolled_pit    | 10   | 25  | 2996  | 0.880  | 0.474 |
| Silk_spot     | 134  | 150 | 65156 | 0.953  | 0.600 |
| Waist_folding | 24   | 26  | 8194  | 0.962  | 0.756 |
| Water_spot    | 68   | 78  | 20600 | 0.974  | 0.814 |
| Welding_line  | 99   | 99  | 11322 | 1.000  | 0.971 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.914  | 0.672 |
+---------------+------+-----+-------+--------+-------+
[2025-05-19 23:43:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-19 23:43:58 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-19 23:43:58 det.util.engine] INFO: Epoch: [17]  [0/1834]  eta: 0:12:35  lr: 0.000010  data_time: 0.0009  iter_time: 0.4118  loss: 0.0010 (0.0010)  loss_class: 0.0000 (0.0000)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0001 (0.0001)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0001 (0.0001)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0001 (0.0001)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0001 (0.0001)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0001 (0.0001)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0001 (0.0001)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0001 (0.0001)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0000 (0.0000)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0001 (0.0001)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0001 (0.0001)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0001 (0.0001)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0001 (0.0001)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0000 (0.0000)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 743  max mem: 19988
[2025-05-19 23:43:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:01:18 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5813  loss: 20.2775 (29.2697)  loss_class: 0.4038 (0.6734)  loss_bbox: 0.1084 (0.3181)  loss_giou: 0.2422 (0.4051)  loss_class_0: 0.6593 (0.8626)  loss_bbox_0: 0.1209 (0.3112)  loss_giou_0: 0.2735 (0.4168)  loss_class_1: 0.4661 (0.7506)  loss_bbox_1: 0.1025 (0.3046)  loss_giou_1: 0.2332 (0.4020)  loss_class_2: 0.4164 (0.7093)  loss_bbox_2: 0.1329 (0.3077)  loss_giou_2: 0.2224 (0.4009)  loss_class_3: 0.4253 (0.6908)  loss_bbox_3: 0.1304 (0.3102)  loss_giou_3: 0.2310 (0.4009)  loss_class_4: 0.4109 (0.6748)  loss_bbox_4: 0.1126 (0.3143)  loss_giou_4: 0.2363 (0.4031)  loss_class_enc: 1.3102 (1.2183)  loss_bbox_enc: 0.2281 (0.3093)  loss_giou_enc: 0.3458 (0.4344)  loss_class_dn: 0.3736 (0.3670)  loss_bbox_dn: 0.1322 (0.4615)  loss_giou_dn: 0.2712 (0.4555)  loss_class_dn_0: 0.4757 (0.4220)  loss_bbox_dn_0: 0.3130 (0.5741)  loss_giou_dn_0: 0.5219 (0.5884)  loss_class_dn_1: 0.4121 (0.3988)  loss_bbox_dn_1: 0.1395 (0.4813)  loss_giou_dn_1: 0.3276 (0.4798)  loss_class_dn_2: 0.3735 (0.3773)  loss_bbox_dn_2: 0.1180 (0.4663)  loss_giou_dn_2: 0.2980 (0.4610)  loss_class_dn_3: 0.3759 (0.3709)  loss_bbox_dn_3: 0.1302 (0.4624)  loss_giou_dn_3: 0.2746 (0.4561)  loss_class_dn_4: 0.3751 (0.3694)  loss_bbox_dn_4: 0.1315 (0.4618)  loss_giou_dn_4: 0.2715 (0.4555)  loss_class_hybrid: 0.4559 (0.7332)  loss_bbox_hybrid: 0.1355 (0.3009)  loss_giou_hybrid: 0.2458 (0.3939)  loss_class_0_hybrid: 0.5770 (0.8260)  loss_bbox_0_hybrid: 0.1345 (0.3046)  loss_giou_0_hybrid: 0.2863 (0.4180)  loss_class_1_hybrid: 0.4980 (0.7460)  loss_bbox_1_hybrid: 0.1251 (0.3064)  loss_giou_1_hybrid: 0.2357 (0.4048)  loss_class_2_hybrid: 0.4672 (0.7354)  loss_bbox_2_hybrid: 0.1342 (0.3034)  loss_giou_2_hybrid: 0.2555 (0.3991)  loss_class_3_hybrid: 0.4698 (0.7334)  loss_bbox_3_hybrid: 0.1339 (0.3018)  loss_giou_3_hybrid: 0.2163 (0.3955)  loss_class_4_hybrid: 0.4751 (0.7314)  loss_bbox_4_hybrid: 0.1340 (0.3027)  loss_giou_4_hybrid: 0.2233 (0.3960)  loss_class_enc_hybrid: 0.9882 (0.9809)  loss_bbox_enc_hybrid: 0.2271 (0.3497)  loss_giou_enc_hybrid: 0.3873 (0.4791)
[2025-05-20 00:01:18 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 00:01:18 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\pytorch_model.bin
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\optimizer.bin
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\scheduler.bin
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\sampler.bin
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\sampler_1.bin
[2025-05-20 00:01:18 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_17\random_states_0.pkl
[2025-05-20 00:01:18 det.__main__] INFO: Start evaluation
[2025-05-20 00:01:19 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1680 (0.1680)  evaluator_time: 0.0040 (0.0040)  time: 0.1960  data: 0.0240  mem: 733  max mem: 19988
[2025-05-20 00:01:20 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1753  data: 0.0027  mem: 733  max mem: 19988
[2025-05-20 00:01:22 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:24 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0003  mem: 733  max mem: 19988
[2025-05-20 00:01:25 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0004  mem: 733  max mem: 19988
[2025-05-20 00:01:27 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:29 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1683 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:31 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:32 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1689 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:34 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1682 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:36 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:01:38 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:39 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:41 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:01:43 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:44 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1737  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:46 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1692 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:48 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:50 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1693 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:51 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:01:53 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:55 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1698 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:01:57 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:01:58 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1700 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:02:00 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1699 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:02 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1699 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:04 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1700 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:05 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1686 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0004  mem: 733  max mem: 19988
[2025-05-20 00:02:07 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1682 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:09 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:02:10 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:02:12 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1693 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0004  mem: 733  max mem: 19988
[2025-05-20 00:02:14 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0003  mem: 733  max mem: 19988
[2025-05-20 00:02:16 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1687 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 733  max mem: 19988
[2025-05-20 00:02:17 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:19 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:21 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:02:23 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1679 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:02:24 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1677 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1714  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:26 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0004  mem: 733  max mem: 19988
[2025-05-20 00:02:28 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1690)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:29 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1676 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:31 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1676 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0005  mem: 733  max mem: 19988
[2025-05-20 00:02:33 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1671 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0007  mem: 733  max mem: 19988
[2025-05-20 00:02:35 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1671 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 00:02:36 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1670 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1786  data: 0.0008  mem: 733  max mem: 19988
[2025-05-20 00:02:38 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1671 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1786  data: 0.0008  mem: 733  max mem: 19988
[2025-05-20 00:02:38 det.util.engine] INFO: Averaged stats: model_time: 0.1671 (0.1689)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 00:02:38 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.687
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.320
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.005
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.193
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.337
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.585

[2025-05-20 00:02:38 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 1824  | 0.647  | 0.408 |
| Crescent_gap  | 48   | 48  | 7713  | 1.000  | 0.885 |
| Inclusion     | 41   | 82  | 8107  | 0.829  | 0.295 |
| Oil_spot      | 58   | 125 | 15342 | 0.952  | 0.693 |
| Punching      | 74   | 74  | 2642  | 0.986  | 0.941 |
| Rolled_pit    | 10   | 25  | 3689  | 0.880  | 0.438 |
| Silk_spot     | 134  | 150 | 63432 | 0.953  | 0.593 |
| Waist_folding | 24   | 26  | 8876  | 0.962  | 0.810 |
| Water_spot    | 68   | 78  | 17583 | 0.987  | 0.840 |
| Welding_line  | 99   | 99  | 8110  | 1.000  | 0.968 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.920  | 0.687 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 00:02:38 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:02:38 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 00:02:39 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 00:02:39 det.util.engine] INFO: Epoch: [18]  [0/1834]  eta: 0:17:46  lr: 0.000010  data_time: 0.0006  iter_time: 0.5817  loss: 43.1404 (43.1404)  loss_class: 0.4688 (0.4688)  loss_bbox: 1.0471 (1.0471)  loss_giou: 0.5309 (0.5309)  loss_class_0: 0.4942 (0.4942)  loss_bbox_0: 0.9683 (0.9683)  loss_giou_0: 0.5372 (0.5372)  loss_class_1: 0.4942 (0.4942)  loss_bbox_1: 1.1760 (1.1760)  loss_giou_1: 0.5703 (0.5703)  loss_class_2: 0.4434 (0.4434)  loss_bbox_2: 1.0614 (1.0614)  loss_giou_2: 0.5381 (0.5381)  loss_class_3: 0.4697 (0.4697)  loss_bbox_3: 1.0705 (1.0705)  loss_giou_3: 0.5451 (0.5451)  loss_class_4: 0.4715 (0.4715)  loss_bbox_4: 1.0615 (1.0615)  loss_giou_4: 0.5319 (0.5319)  loss_class_enc: 1.2260 (1.2260)  loss_bbox_enc: 0.8185 (0.8185)  loss_giou_enc: 0.3984 (0.3984)  loss_class_dn: 0.5011 (0.5011)  loss_bbox_dn: 1.0719 (1.0719)  loss_giou_dn: 0.5586 (0.5586)  loss_class_dn_0: 0.5256 (0.5256)  loss_bbox_dn_0: 1.3759 (1.3759)  loss_giou_dn_0: 0.6852 (0.6852)  loss_class_dn_1: 0.4842 (0.4842)  loss_bbox_dn_1: 1.1673 (1.1673)  loss_giou_dn_1: 0.5969 (0.5969)  loss_class_dn_2: 0.4709 (0.4709)  loss_bbox_dn_2: 1.0659 (1.0659)  loss_giou_dn_2: 0.5668 (0.5668)  loss_class_dn_3: 0.4735 (0.4735)  loss_bbox_dn_3: 1.0700 (1.0700)  loss_giou_dn_3: 0.5669 (0.5669)  loss_class_dn_4: 0.4845 (0.4845)  loss_bbox_dn_4: 1.0924 (1.0924)  loss_giou_dn_4: 0.5646 (0.5646)  loss_class_hybrid: 0.4635 (0.4635)  loss_bbox_hybrid: 1.0320 (1.0320)  loss_giou_hybrid: 0.5287 (0.5287)  loss_class_0_hybrid: 0.6345 (0.6345)  loss_bbox_0_hybrid: 1.0293 (1.0293)  loss_giou_0_hybrid: 0.5385 (0.5385)  loss_class_1_hybrid: 0.4909 (0.4909)  loss_bbox_1_hybrid: 1.1022 (1.1022)  loss_giou_1_hybrid: 0.5451 (0.5451)  loss_class_2_hybrid: 0.4536 (0.4536)  loss_bbox_2_hybrid: 1.0181 (1.0181)  loss_giou_2_hybrid: 0.5309 (0.5309)  loss_class_3_hybrid: 0.4624 (0.4624)  loss_bbox_3_hybrid: 1.0403 (1.0403)  loss_giou_3_hybrid: 0.5398 (0.5398)  loss_class_4_hybrid: 0.4654 (0.4654)  loss_bbox_4_hybrid: 1.0414 (1.0414)  loss_giou_4_hybrid: 0.5302 (0.5302)  loss_class_enc_hybrid: 1.3325 (1.3325)  loss_bbox_enc_hybrid: 0.6874 (0.6874)  loss_giou_enc_hybrid: 0.4287 (0.4287)  mem: 734  max mem: 19988
[2025-05-20 00:02:39 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:20:02 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0006  iter_time: 0.5472  loss: 31.0114 (29.6948)  loss_class: 0.4436 (0.6701)  loss_bbox: 0.2224 (0.3302)  loss_giou: 0.3212 (0.4118)  loss_class_0: 0.6406 (0.8417)  loss_bbox_0: 0.2775 (0.3344)  loss_giou_0: 0.4023 (0.4340)  loss_class_1: 0.4490 (0.7277)  loss_bbox_1: 0.3089 (0.3304)  loss_giou_1: 0.3743 (0.4170)  loss_class_2: 0.4592 (0.7047)  loss_bbox_2: 0.2288 (0.3230)  loss_giou_2: 0.3266 (0.4105)  loss_class_3: 0.4290 (0.6795)  loss_bbox_3: 0.2314 (0.3270)  loss_giou_3: 0.3151 (0.4094)  loss_class_4: 0.4398 (0.6718)  loss_bbox_4: 0.2311 (0.3278)  loss_giou_4: 0.3195 (0.4107)  loss_class_enc: 1.0224 (1.2149)  loss_bbox_enc: 0.3300 (0.3235)  loss_giou_enc: 0.3409 (0.4403)  loss_class_dn: 0.4044 (0.3690)  loss_bbox_dn: 0.2477 (0.4679)  loss_giou_dn: 0.3868 (0.4582)  loss_class_dn_0: 0.4562 (0.4250)  loss_bbox_dn_0: 0.4607 (0.5787)  loss_giou_dn_0: 0.5662 (0.5886)  loss_class_dn_1: 0.4331 (0.4003)  loss_bbox_dn_1: 0.3204 (0.4877)  loss_giou_dn_1: 0.4130 (0.4833)  loss_class_dn_2: 0.4125 (0.3777)  loss_bbox_dn_2: 0.2699 (0.4730)  loss_giou_dn_2: 0.4049 (0.4648)  loss_class_dn_3: 0.4050 (0.3735)  loss_bbox_dn_3: 0.2561 (0.4688)  loss_giou_dn_3: 0.3907 (0.4593)  loss_class_dn_4: 0.4019 (0.3709)  loss_bbox_dn_4: 0.2518 (0.4683)  loss_giou_dn_4: 0.3888 (0.4585)  loss_class_hybrid: 0.4731 (0.7539)  loss_bbox_hybrid: 0.2120 (0.3123)  loss_giou_hybrid: 0.3174 (0.4011)  loss_class_0_hybrid: 0.6873 (0.8254)  loss_bbox_0_hybrid: 0.3061 (0.3248)  loss_giou_0_hybrid: 0.3631 (0.4329)  loss_class_1_hybrid: 0.4793 (0.7456)  loss_bbox_1_hybrid: 0.2402 (0.3246)  loss_giou_1_hybrid: 0.3910 (0.4180)  loss_class_2_hybrid: 0.4810 (0.7442)  loss_bbox_2_hybrid: 0.2345 (0.3170)  loss_giou_2_hybrid: 0.3125 (0.4092)  loss_class_3_hybrid: 0.4659 (0.7469)  loss_bbox_3_hybrid: 0.2175 (0.3151)  loss_giou_3_hybrid: 0.3306 (0.4050)  loss_class_4_hybrid: 0.4738 (0.7503)  loss_bbox_4_hybrid: 0.2154 (0.3143)  loss_giou_4_hybrid: 0.3206 (0.4037)  loss_class_enc_hybrid: 0.9959 (0.9747)  loss_bbox_enc_hybrid: 0.3700 (0.3680)  loss_giou_enc_hybrid: 0.4017 (0.4937)
[2025-05-20 00:20:02 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 00:20:02 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\pytorch_model.bin
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\optimizer.bin
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\scheduler.bin
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\sampler.bin
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\sampler_1.bin
[2025-05-20 00:20:02 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_18\random_states_0.pkl
[2025-05-20 00:20:02 det.__main__] INFO: Start evaluation
[2025-05-20 00:20:03 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:26  model_time: 0.1670 (0.1670)  evaluator_time: 0.0030 (0.0030)  time: 0.1890  data: 0.0180  mem: 728  max mem: 19988
[2025-05-20 00:20:04 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1746  data: 0.0025  mem: 728  max mem: 19988
[2025-05-20 00:20:06 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:08 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:09 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1725  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:11 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1689 (0.1690)  evaluator_time: 0.0030 (0.0029)  time: 0.1727  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:13 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1727  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:15 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1723  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:16 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:18 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1736  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:20 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:22 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1676 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:20:23 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1674 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1716  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:25 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1671 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:20:27 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1671 (0.1686)  evaluator_time: 0.0040 (0.0032)  time: 0.1716  data: 0.0003  mem: 728  max mem: 19988
[2025-05-20 00:20:28 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1673 (0.1685)  evaluator_time: 0.0040 (0.0032)  time: 0.1718  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:20:30 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:20:32 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:20:34 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1713  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:35 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1672 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:37 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1673 (0.1683)  evaluator_time: 0.0040 (0.0032)  time: 0.1724  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 00:20:39 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1671 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1722  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:40 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:42 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1670 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:44 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1675 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:46 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1674 (0.1682)  evaluator_time: 0.0020 (0.0033)  time: 0.1713  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:47 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1675 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:49 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:20:51 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:53 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1695 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 00:20:54 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1696 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:56 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1698 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:20:58 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1698 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:20:59 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1697 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 00:21:01 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:21:03 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 00:21:05 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:21:06 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1688 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 00:21:08 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1696 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 00:21:10 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1692 (0.1686)  evaluator_time: 0.0040 (0.0033)  time: 0.1746  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:21:12 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1700 (0.1686)  evaluator_time: 0.0040 (0.0033)  time: 0.1750  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:21:13 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 00:21:15 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1697 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:21:17 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1694 (0.1687)  evaluator_time: 0.0030 (0.0036)  time: 0.1808  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 00:21:19 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1694 (0.1687)  evaluator_time: 0.0030 (0.0036)  time: 0.1812  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:21:20 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0036)  time: 0.1738  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 00:21:22 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0036)  time: 0.1731  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 00:21:22 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 00:21:22 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.688
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.342
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.587
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.414
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.594

[2025-05-20 00:21:22 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2654  | 0.706  | 0.446 |
| Crescent_gap  | 48   | 48  | 7858  | 1.000  | 0.903 |
| Inclusion     | 41   | 82  | 9079  | 0.829  | 0.317 |
| Oil_spot      | 58   | 125 | 10984 | 0.912  | 0.677 |
| Punching      | 74   | 74  | 2817  | 1.000  | 0.936 |
| Rolled_pit    | 10   | 25  | 3934  | 1.000  | 0.462 |
| Silk_spot     | 134  | 150 | 72402 | 0.953  | 0.611 |
| Waist_folding | 24   | 26  | 9024  | 0.962  | 0.720 |
| Water_spot    | 68   | 78  | 11004 | 0.987  | 0.833 |
| Welding_line  | 99   | 99  | 7510  | 1.000  | 0.975 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.935  | 0.688 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 00:21:22 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:21:22 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 00:21:23 det.util.engine] INFO: Epoch: [19]  [0/1834]  eta: 0:18:00  lr: 0.000010  data_time: 0.0122  iter_time: 0.5892  loss: 39.6861 (39.6861)  loss_class: 0.4248 (0.4248)  loss_bbox: 0.8028 (0.8028)  loss_giou: 0.3897 (0.3897)  loss_class_0: 0.6368 (0.6368)  loss_bbox_0: 0.8327 (0.8327)  loss_giou_0: 0.4360 (0.4360)  loss_class_1: 0.4384 (0.4384)  loss_bbox_1: 0.7888 (0.7888)  loss_giou_1: 0.3918 (0.3918)  loss_class_2: 0.4383 (0.4383)  loss_bbox_2: 0.7523 (0.7523)  loss_giou_2: 0.3851 (0.3851)  loss_class_3: 0.4249 (0.4249)  loss_bbox_3: 0.8018 (0.8018)  loss_giou_3: 0.3918 (0.3918)  loss_class_4: 0.4242 (0.4242)  loss_bbox_4: 0.8101 (0.8101)  loss_giou_4: 0.4008 (0.4008)  loss_class_enc: 1.4826 (1.4826)  loss_bbox_enc: 0.5756 (0.5756)  loss_giou_enc: 0.2717 (0.2717)  loss_class_dn: 0.4208 (0.4208)  loss_bbox_dn: 0.9494 (0.9494)  loss_giou_dn: 0.4574 (0.4574)  loss_class_dn_0: 0.5245 (0.5245)  loss_bbox_dn_0: 1.1383 (1.1383)  loss_giou_dn_0: 0.5280 (0.5280)  loss_class_dn_1: 0.5255 (0.5255)  loss_bbox_dn_1: 1.0399 (1.0399)  loss_giou_dn_1: 0.4997 (0.4997)  loss_class_dn_2: 0.4448 (0.4448)  loss_bbox_dn_2: 0.9260 (0.9260)  loss_giou_dn_2: 0.4580 (0.4580)  loss_class_dn_3: 0.4328 (0.4328)  loss_bbox_dn_3: 0.9525 (0.9525)  loss_giou_dn_3: 0.4613 (0.4613)  loss_class_dn_4: 0.4228 (0.4228)  loss_bbox_dn_4: 0.9512 (0.9512)  loss_giou_dn_4: 0.4637 (0.4637)  loss_class_hybrid: 0.4738 (0.4738)  loss_bbox_hybrid: 1.2810 (1.2810)  loss_giou_hybrid: 0.5536 (0.5536)  loss_class_0_hybrid: 1.5285 (1.5285)  loss_bbox_0_hybrid: 0.4486 (0.4486)  loss_giou_0_hybrid: 0.2691 (0.2691)  loss_class_1_hybrid: 0.6586 (0.6586)  loss_bbox_1_hybrid: 1.0106 (1.0106)  loss_giou_1_hybrid: 0.4555 (0.4555)  loss_class_2_hybrid: 0.6455 (0.6455)  loss_bbox_2_hybrid: 1.0146 (1.0146)  loss_giou_2_hybrid: 0.4635 (0.4635)  loss_class_3_hybrid: 0.7258 (0.7258)  loss_bbox_3_hybrid: 1.0604 (1.0604)  loss_giou_3_hybrid: 0.4759 (0.4759)  loss_class_4_hybrid: 0.4631 (0.4631)  loss_bbox_4_hybrid: 1.2961 (1.2961)  loss_giou_4_hybrid: 0.5648 (0.5648)  loss_class_enc_hybrid: 1.5414 (1.5414)  loss_bbox_enc_hybrid: 0.5304 (0.5304)  loss_giou_enc_hybrid: 0.3280 (0.3280)  mem: 735  max mem: 19988
[2025-05-20 00:21:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:38:35 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5663  loss: 28.4819 (29.4338)  loss_class: 0.4339 (0.6964)  loss_bbox: 0.1706 (0.3203)  loss_giou: 0.3886 (0.3977)  loss_class_0: 0.6789 (0.8411)  loss_bbox_0: 0.1730 (0.3237)  loss_giou_0: 0.4752 (0.4179)  loss_class_1: 0.6630 (0.7525)  loss_bbox_1: 0.1857 (0.3178)  loss_giou_1: 0.3894 (0.3999)  loss_class_2: 0.4461 (0.7206)  loss_bbox_2: 0.1829 (0.3149)  loss_giou_2: 0.3608 (0.3965)  loss_class_3: 0.4319 (0.7011)  loss_bbox_3: 0.1850 (0.3178)  loss_giou_3: 0.3659 (0.3979)  loss_class_4: 0.4302 (0.6942)  loss_bbox_4: 0.1680 (0.3193)  loss_giou_4: 0.3873 (0.3971)  loss_class_enc: 1.3182 (1.1836)  loss_bbox_enc: 0.2107 (0.3148)  loss_giou_enc: 0.4464 (0.4298)  loss_class_dn: 0.4252 (0.3649)  loss_bbox_dn: 0.1734 (0.4725)  loss_giou_dn: 0.4662 (0.4499)  loss_class_dn_0: 0.4622 (0.4169)  loss_bbox_dn_0: 0.2424 (0.5799)  loss_giou_dn_0: 0.6078 (0.5762)  loss_class_dn_1: 0.4386 (0.3922)  loss_bbox_dn_1: 0.1824 (0.4913)  loss_giou_dn_1: 0.4578 (0.4736)  loss_class_dn_2: 0.4134 (0.3715)  loss_bbox_dn_2: 0.1717 (0.4776)  loss_giou_dn_2: 0.4588 (0.4560)  loss_class_dn_3: 0.4180 (0.3679)  loss_bbox_dn_3: 0.1725 (0.4736)  loss_giou_dn_3: 0.4682 (0.4509)  loss_class_dn_4: 0.4154 (0.3666)  loss_bbox_dn_4: 0.1744 (0.4729)  loss_giou_dn_4: 0.4777 (0.4500)  loss_class_hybrid: 0.5017 (0.7686)  loss_bbox_hybrid: 0.1881 (0.3049)  loss_giou_hybrid: 0.4850 (0.3863)  loss_class_0_hybrid: 0.7055 (0.8266)  loss_bbox_0_hybrid: 0.1844 (0.3162)  loss_giou_0_hybrid: 0.4394 (0.4124)  loss_class_1_hybrid: 0.5248 (0.7709)  loss_bbox_1_hybrid: 0.1824 (0.3115)  loss_giou_1_hybrid: 0.5025 (0.3982)  loss_class_2_hybrid: 0.5330 (0.7672)  loss_bbox_2_hybrid: 0.1899 (0.3075)  loss_giou_2_hybrid: 0.5181 (0.3921)  loss_class_3_hybrid: 0.5096 (0.7605)  loss_bbox_3_hybrid: 0.1918 (0.3080)  loss_giou_3_hybrid: 0.5014 (0.3894)  loss_class_4_hybrid: 0.4920 (0.7647)  loss_bbox_4_hybrid: 0.1903 (0.3066)  loss_giou_4_hybrid: 0.4964 (0.3880)  loss_class_enc_hybrid: 0.8581 (0.9586)  loss_bbox_enc_hybrid: 0.3116 (0.3602)  loss_giou_enc_hybrid: 0.5433 (0.4763)
[2025-05-20 00:38:35 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 00:38:35 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19
[2025-05-20 00:38:35 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\pytorch_model.bin
[2025-05-20 00:38:36 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\optimizer.bin
[2025-05-20 00:38:36 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\scheduler.bin
[2025-05-20 00:38:36 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\sampler.bin
[2025-05-20 00:38:36 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\sampler_1.bin
[2025-05-20 00:38:36 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_19\random_states_0.pkl
[2025-05-20 00:38:36 det.__main__] INFO: Start evaluation
[2025-05-20 00:38:36 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1681 (0.1681)  evaluator_time: 0.0038 (0.0038)  time: 0.1989  data: 0.0270  mem: 724  max mem: 19988
[2025-05-20 00:38:38 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0035)  time: 0.1738  data: 0.0028  mem: 724  max mem: 19988
[2025-05-20 00:38:39 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:38:41 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0031)  time: 0.1710  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:38:43 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1673 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1710  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 00:38:45 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1679 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:38:46 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1673 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1715  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:38:48 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1671 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1709  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:38:50 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1673 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1715  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 00:38:51 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1686 (0.1677)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:38:53 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1690 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:38:55 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1695 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:38:57 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1700 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:38:58 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1685 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:39:00 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1683 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:02 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 00:39:04 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1685 (0.1685)  evaluator_time: 0.0031 (0.0033)  time: 0.1737  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:05 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1685 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:07 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1688 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:09 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:10 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1687 (0.1686)  evaluator_time: 0.0040 (0.0033)  time: 0.1735  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:12 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:39:14 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:16 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:17 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:19 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 00:39:21 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:39:23 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1687 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:24 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:26 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:28 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:30 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:31 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:33 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1689 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:35 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:36 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 00:39:38 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1693 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:40 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:42 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 00:39:43 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1691 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1745  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:45 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1693 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1749  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 00:39:47 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1693 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:49 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1696 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:50 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1688 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 00:39:52 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1725  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 00:39:54 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1684 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:55 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 00:39:55 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 00:39:56 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.691
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.325
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.599
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.426
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.602

[2025-05-20 00:39:56 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2427  | 0.647  | 0.423 |
| Crescent_gap  | 48   | 48  | 9120  | 1.000  | 0.907 |
| Inclusion     | 41   | 82  | 8875  | 0.902  | 0.376 |
| Oil_spot      | 58   | 125 | 15194 | 0.920  | 0.669 |
| Punching      | 74   | 74  | 2701  | 1.000  | 0.942 |
| Rolled_pit    | 10   | 25  | 4810  | 0.880  | 0.466 |
| Silk_spot     | 134  | 150 | 60781 | 0.960  | 0.601 |
| Waist_folding | 24   | 26  | 8281  | 0.962  | 0.711 |
| Water_spot    | 68   | 78  | 16458 | 0.974  | 0.845 |
| Welding_line  | 99   | 99  | 8657  | 1.000  | 0.967 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.925  | 0.691 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 00:39:56 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:39:56 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 00:39:56 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 00:39:57 det.util.engine] INFO: Epoch: [20]  [0/1834]  eta: 0:19:22  lr: 0.000010  data_time: 0.0010  iter_time: 0.6339  loss: 42.3642 (42.3642)  loss_class: 1.4069 (1.4069)  loss_bbox: 0.3551 (0.3551)  loss_giou: 0.4706 (0.4706)  loss_class_0: 1.3065 (1.3065)  loss_bbox_0: 0.3309 (0.3309)  loss_giou_0: 0.5633 (0.5633)  loss_class_1: 1.5548 (1.5548)  loss_bbox_1: 0.2996 (0.2996)  loss_giou_1: 0.4051 (0.4051)  loss_class_2: 1.6510 (1.6510)  loss_bbox_2: 0.2061 (0.2061)  loss_giou_2: 0.3526 (0.3526)  loss_class_3: 1.4696 (1.4696)  loss_bbox_3: 0.3448 (0.3448)  loss_giou_3: 0.4627 (0.4627)  loss_class_4: 1.3922 (1.3922)  loss_bbox_4: 0.3539 (0.3539)  loss_giou_4: 0.4682 (0.4682)  loss_class_enc: 1.7913 (1.7913)  loss_bbox_enc: 0.1753 (0.1753)  loss_giou_enc: 0.4165 (0.4165)  loss_class_dn: 0.4816 (0.4816)  loss_bbox_dn: 0.7163 (0.7163)  loss_giou_dn: 0.7458 (0.7458)  loss_class_dn_0: 0.4666 (0.4666)  loss_bbox_dn_0: 0.8001 (0.8001)  loss_giou_dn_0: 0.9239 (0.9239)  loss_class_dn_1: 0.4935 (0.4935)  loss_bbox_dn_1: 0.7634 (0.7634)  loss_giou_dn_1: 0.8108 (0.8108)  loss_class_dn_2: 0.4806 (0.4806)  loss_bbox_dn_2: 0.7234 (0.7234)  loss_giou_dn_2: 0.7626 (0.7626)  loss_class_dn_3: 0.4832 (0.4832)  loss_bbox_dn_3: 0.7111 (0.7111)  loss_giou_dn_3: 0.7465 (0.7465)  loss_class_dn_4: 0.4764 (0.4764)  loss_bbox_dn_4: 0.7146 (0.7146)  loss_giou_dn_4: 0.7444 (0.7444)  loss_class_hybrid: 1.2657 (1.2657)  loss_bbox_hybrid: 0.3601 (0.3601)  loss_giou_hybrid: 0.4625 (0.4625)  loss_class_0_hybrid: 1.1648 (1.1648)  loss_bbox_0_hybrid: 0.3108 (0.3108)  loss_giou_0_hybrid: 0.4936 (0.4936)  loss_class_1_hybrid: 1.0874 (1.0874)  loss_bbox_1_hybrid: 0.3794 (0.3794)  loss_giou_1_hybrid: 0.5150 (0.5150)  loss_class_2_hybrid: 1.2635 (1.2635)  loss_bbox_2_hybrid: 0.3583 (0.3583)  loss_giou_2_hybrid: 0.4777 (0.4777)  loss_class_3_hybrid: 1.1878 (1.1878)  loss_bbox_3_hybrid: 0.3801 (0.3801)  loss_giou_3_hybrid: 0.4928 (0.4928)  loss_class_4_hybrid: 1.1949 (1.1949)  loss_bbox_4_hybrid: 0.3902 (0.3902)  loss_giou_4_hybrid: 0.5173 (0.5173)  loss_class_enc_hybrid: 1.3742 (1.3742)  loss_bbox_enc_hybrid: 0.3166 (0.3166)  loss_giou_enc_hybrid: 0.5493 (0.5493)  mem: 735  max mem: 19988
[2025-05-20 00:39:57 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:57:13 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5653  loss: 32.4810 (29.0077)  loss_class: 0.4375 (0.6835)  loss_bbox: 0.2511 (0.3124)  loss_giou: 0.3632 (0.3951)  loss_class_0: 0.6491 (0.8314)  loss_bbox_0: 0.3428 (0.3268)  loss_giou_0: 0.3759 (0.4145)  loss_class_1: 0.5711 (0.7491)  loss_bbox_1: 0.2430 (0.3093)  loss_giou_1: 0.3753 (0.3956)  loss_class_2: 0.4914 (0.7129)  loss_bbox_2: 0.2334 (0.3078)  loss_giou_2: 0.4025 (0.3921)  loss_class_3: 0.4691 (0.6976)  loss_bbox_3: 0.2108 (0.3096)  loss_giou_3: 0.3759 (0.3911)  loss_class_4: 0.4821 (0.6815)  loss_bbox_4: 0.2129 (0.3124)  loss_giou_4: 0.3789 (0.3941)  loss_class_enc: 1.1477 (1.1969)  loss_bbox_enc: 0.3428 (0.3073)  loss_giou_enc: 0.3770 (0.4189)  loss_class_dn: 0.4118 (0.3647)  loss_bbox_dn: 0.4347 (0.4585)  loss_giou_dn: 0.4094 (0.4458)  loss_class_dn_0: 0.4771 (0.4216)  loss_bbox_dn_0: 0.6271 (0.5639)  loss_giou_dn_0: 0.5731 (0.5723)  loss_class_dn_1: 0.4341 (0.3955)  loss_bbox_dn_1: 0.4231 (0.4770)  loss_giou_dn_1: 0.4485 (0.4695)  loss_class_dn_2: 0.4135 (0.3726)  loss_bbox_dn_2: 0.4231 (0.4635)  loss_giou_dn_2: 0.4366 (0.4521)  loss_class_dn_3: 0.4070 (0.3680)  loss_bbox_dn_3: 0.4319 (0.4594)  loss_giou_dn_3: 0.4141 (0.4467)  loss_class_dn_4: 0.4131 (0.3664)  loss_bbox_dn_4: 0.4325 (0.4588)  loss_giou_dn_4: 0.4093 (0.4458)  loss_class_hybrid: 0.5233 (0.7467)  loss_bbox_hybrid: 0.2588 (0.2974)  loss_giou_hybrid: 0.3419 (0.3838)  loss_class_0_hybrid: 0.7451 (0.8082)  loss_bbox_0_hybrid: 0.2668 (0.3116)  loss_giou_0_hybrid: 0.3929 (0.4128)  loss_class_1_hybrid: 0.5675 (0.7456)  loss_bbox_1_hybrid: 0.2799 (0.3070)  loss_giou_1_hybrid: 0.3256 (0.3976)  loss_class_2_hybrid: 0.5694 (0.7378)  loss_bbox_2_hybrid: 0.2660 (0.3029)  loss_giou_2_hybrid: 0.3550 (0.3916)  loss_class_3_hybrid: 0.5438 (0.7375)  loss_bbox_3_hybrid: 0.2162 (0.3001)  loss_giou_3_hybrid: 0.3363 (0.3872)  loss_class_4_hybrid: 0.5005 (0.7420)  loss_bbox_4_hybrid: 0.2616 (0.2987)  loss_giou_4_hybrid: 0.3468 (0.3859)  loss_class_enc_hybrid: 0.8791 (0.9433)  loss_bbox_enc_hybrid: 0.4162 (0.3528)  loss_giou_enc_hybrid: 0.4904 (0.4749)
[2025-05-20 00:57:13 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 00:57:13 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20
[2025-05-20 00:57:13 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\pytorch_model.bin
[2025-05-20 00:57:14 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\optimizer.bin
[2025-05-20 00:57:14 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\scheduler.bin
[2025-05-20 00:57:14 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\sampler.bin
[2025-05-20 00:57:14 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\sampler_1.bin
[2025-05-20 00:57:14 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_20\random_states_0.pkl
[2025-05-20 00:57:14 det.__main__] INFO: Start evaluation
[2025-05-20 00:57:14 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1730 (0.1730)  evaluator_time: 0.0030 (0.0030)  time: 0.1980  data: 0.0220  mem: 729  max mem: 19988
[2025-05-20 00:57:16 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1700 (0.1699)  evaluator_time: 0.0030 (0.0033)  time: 0.1760  data: 0.0027  mem: 729  max mem: 19988
[2025-05-20 00:57:17 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1687 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 00:57:19 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:21 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1726  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:57:22 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:24 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:26 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:28 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1684 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:29 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:31 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1684 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:33 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1694 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:35 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1701 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:36 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:57:38 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1685 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:40 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:42 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1695 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1739  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:43 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1687 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:45 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:57:47 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1736  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:48 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1694 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1745  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:50 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:57:52 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:54 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:57:55 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1685 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:57:57 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1723  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:57:59 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:01 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1727  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:58:02 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:04 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1721  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 00:58:06 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:07 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1721  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:09 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1725  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 00:58:11 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 00:58:13 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:58:14 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:16 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:18 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1692 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:20 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:21 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1686 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1739  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:58:23 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:25 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1691 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 00:58:26 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 00:58:28 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 00:58:30 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:58:32 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 00:58:33 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 00:58:33 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 00:58:33 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.679
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.302
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.074
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.582

[2025-05-20 00:58:33 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2761  | 0.706  | 0.423 |
| Crescent_gap  | 48   | 48  | 7560  | 1.000  | 0.907 |
| Inclusion     | 41   | 82  | 8379  | 0.854  | 0.298 |
| Oil_spot      | 58   | 125 | 13498 | 0.928  | 0.668 |
| Punching      | 74   | 74  | 2852  | 1.000  | 0.938 |
| Rolled_pit    | 10   | 25  | 4045  | 0.840  | 0.404 |
| Silk_spot     | 134  | 150 | 61442 | 0.947  | 0.602 |
| Waist_folding | 24   | 26  | 8924  | 0.962  | 0.785 |
| Water_spot    | 68   | 78  | 18922 | 0.962  | 0.791 |
| Welding_line  | 99   | 99  | 8834  | 1.000  | 0.971 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.920  | 0.679 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 00:58:33 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 00:58:34 det.util.engine] INFO: Epoch: [21]  [0/1834]  eta: 0:11:28  lr: 0.000010  data_time: 0.0006  iter_time: 0.3757  loss: 0.0002 (0.0002)  loss_class: 0.0000 (0.0000)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0000 (0.0000)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0000 (0.0000)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0000 (0.0000)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0000 (0.0000)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0000 (0.0000)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0000 (0.0000)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0000 (0.0000)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0000 (0.0000)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0000 (0.0000)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0000 (0.0000)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0000 (0.0000)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0000 (0.0000)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0000 (0.0000)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 734  max mem: 19988
[2025-05-20 00:58:34 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:15:50 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5596  loss: 27.1890 (28.5063)  loss_class: 0.4624 (0.6612)  loss_bbox: 0.1574 (0.3105)  loss_giou: 0.3470 (0.3894)  loss_class_0: 0.7262 (0.8060)  loss_bbox_0: 0.2189 (0.3205)  loss_giou_0: 0.3732 (0.4100)  loss_class_1: 0.5669 (0.7199)  loss_bbox_1: 0.1582 (0.3044)  loss_giou_1: 0.3460 (0.3917)  loss_class_2: 0.4330 (0.6974)  loss_bbox_2: 0.1554 (0.2979)  loss_giou_2: 0.3477 (0.3875)  loss_class_3: 0.4263 (0.6711)  loss_bbox_3: 0.1597 (0.3057)  loss_giou_3: 0.3469 (0.3889)  loss_class_4: 0.4715 (0.6656)  loss_bbox_4: 0.1582 (0.3060)  loss_giou_4: 0.3450 (0.3875)  loss_class_enc: 1.1052 (1.1591)  loss_bbox_enc: 0.1811 (0.3049)  loss_giou_enc: 0.4007 (0.4207)  loss_class_dn: 0.3988 (0.3624)  loss_bbox_dn: 0.1462 (0.4526)  loss_giou_dn: 0.3794 (0.4364)  loss_class_dn_0: 0.4684 (0.4163)  loss_bbox_dn_0: 0.2499 (0.5564)  loss_giou_dn_0: 0.6010 (0.5610)  loss_class_dn_1: 0.4222 (0.3900)  loss_bbox_dn_1: 0.1526 (0.4708)  loss_giou_dn_1: 0.3974 (0.4598)  loss_class_dn_2: 0.3887 (0.3681)  loss_bbox_dn_2: 0.1478 (0.4580)  loss_giou_dn_2: 0.3604 (0.4423)  loss_class_dn_3: 0.3882 (0.3653)  loss_bbox_dn_3: 0.1390 (0.4540)  loss_giou_dn_3: 0.3576 (0.4374)  loss_class_dn_4: 0.3885 (0.3639)  loss_bbox_dn_4: 0.1337 (0.4534)  loss_giou_dn_4: 0.3550 (0.4367)  loss_class_hybrid: 0.5602 (0.7182)  loss_bbox_hybrid: 0.1492 (0.2998)  loss_giou_hybrid: 0.3636 (0.3840)  loss_class_0_hybrid: 0.7250 (0.7868)  loss_bbox_0_hybrid: 0.1758 (0.3163)  loss_giou_0_hybrid: 0.3989 (0.4121)  loss_class_1_hybrid: 0.6072 (0.7250)  loss_bbox_1_hybrid: 0.1648 (0.3113)  loss_giou_1_hybrid: 0.3843 (0.3971)  loss_class_2_hybrid: 0.5781 (0.7188)  loss_bbox_2_hybrid: 0.1627 (0.3027)  loss_giou_2_hybrid: 0.3744 (0.3892)  loss_class_3_hybrid: 0.6194 (0.7151)  loss_bbox_3_hybrid: 0.1426 (0.3023)  loss_giou_3_hybrid: 0.3660 (0.3861)  loss_class_4_hybrid: 0.6030 (0.7166)  loss_bbox_4_hybrid: 0.1479 (0.3008)  loss_giou_4_hybrid: 0.3617 (0.3855)  loss_class_enc_hybrid: 0.9103 (0.9162)  loss_bbox_enc_hybrid: 0.2451 (0.3551)  loss_giou_enc_hybrid: 0.4361 (0.4765)
[2025-05-20 01:15:50 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 01:15:50 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\pytorch_model.bin
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\optimizer.bin
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\scheduler.bin
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\sampler.bin
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\sampler_1.bin
[2025-05-20 01:15:50 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_21\random_states_0.pkl
[2025-05-20 01:15:50 det.__main__] INFO: Start evaluation
[2025-05-20 01:15:51 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.1960  data: 0.0230  mem: 728  max mem: 19988
[2025-05-20 01:15:52 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1745  data: 0.0030  mem: 728  max mem: 19988
[2025-05-20 01:15:54 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:15:56 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1681 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:15:58 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:15:59 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:01 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1679 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:03 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:04 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:06 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1676 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:08 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1674 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:10 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1677 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:11 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:13 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1682 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:15 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1681 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1724  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:17 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1682 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1725  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:18 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1682 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:20 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1679 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:22 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1676 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:23 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1675 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:25 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1672 (0.1682)  evaluator_time: 0.0040 (0.0033)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:27 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:29 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1718  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:30 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:32 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1675 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1717  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:16:34 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1673 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1714  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:16:35 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1670 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1716  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:37 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1670 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1719  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:16:39 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1670 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1718  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:41 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1716  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:42 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1716  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:16:44 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1678 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1713  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:16:46 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1676 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:47 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1678 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:49 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:51 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1681 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:53 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:16:54 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:16:56 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:16:58 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1681)  evaluator_time: 0.0040 (0.0034)  time: 0.1745  data: 0.0002  mem: 728  max mem: 19988
[2025-05-20 01:17:00 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:09  model_time: 0.1681 (0.1681)  evaluator_time: 0.0040 (0.0034)  time: 0.1742  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 01:17:01 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:17:03 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1691 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 01:17:05 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 01:17:07 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:17:08 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 01:17:09 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1689 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 01:17:09 det.util.engine] INFO: Averaged stats: model_time: 0.1689 (0.1682)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 01:17:10 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.689
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.583
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.578

[2025-05-20 01:17:10 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2014  | 0.647  | 0.432 |
| Crescent_gap  | 48   | 48  | 8566  | 1.000  | 0.910 |
| Inclusion     | 41   | 82  | 7023  | 0.829  | 0.302 |
| Oil_spot      | 58   | 125 | 15697 | 0.928  | 0.670 |
| Punching      | 74   | 74  | 2760  | 1.000  | 0.941 |
| Rolled_pit    | 10   | 25  | 3078  | 0.840  | 0.457 |
| Silk_spot     | 134  | 150 | 62269 | 0.960  | 0.624 |
| Waist_folding | 24   | 26  | 9061  | 0.962  | 0.755 |
| Water_spot    | 68   | 78  | 18788 | 0.974  | 0.824 |
| Welding_line  | 99   | 99  | 7991  | 1.000  | 0.974 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.914  | 0.689 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 01:17:10 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:17:10 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 01:17:11 det.util.engine] INFO: Epoch: [22]  [0/1834]  eta: 0:19:43  lr: 0.000010  data_time: 0.0008  iter_time: 0.6451  loss: 21.5816 (21.5816)  loss_class: 0.3765 (0.3765)  loss_bbox: 0.2923 (0.2923)  loss_giou: 0.3184 (0.3184)  loss_class_0: 0.4216 (0.4216)  loss_bbox_0: 0.2201 (0.2201)  loss_giou_0: 0.2869 (0.2869)  loss_class_1: 0.3865 (0.3865)  loss_bbox_1: 0.2752 (0.2752)  loss_giou_1: 0.3300 (0.3300)  loss_class_2: 0.3900 (0.3900)  loss_bbox_2: 0.2888 (0.2888)  loss_giou_2: 0.3437 (0.3437)  loss_class_3: 0.3775 (0.3775)  loss_bbox_3: 0.2872 (0.2872)  loss_giou_3: 0.3264 (0.3264)  loss_class_4: 0.3772 (0.3772)  loss_bbox_4: 0.2898 (0.2898)  loss_giou_4: 0.3234 (0.3234)  loss_class_enc: 1.3530 (1.3530)  loss_bbox_enc: 0.1859 (0.1859)  loss_giou_enc: 0.2733 (0.2733)  loss_class_dn: 0.3879 (0.3879)  loss_bbox_dn: 0.2614 (0.2614)  loss_giou_dn: 0.3329 (0.3329)  loss_class_dn_0: 0.5214 (0.5214)  loss_bbox_dn_0: 0.4346 (0.4346)  loss_giou_dn_0: 0.4059 (0.4059)  loss_class_dn_1: 0.4272 (0.4272)  loss_bbox_dn_1: 0.2868 (0.2868)  loss_giou_dn_1: 0.3528 (0.3528)  loss_class_dn_2: 0.3980 (0.3980)  loss_bbox_dn_2: 0.2538 (0.2538)  loss_giou_dn_2: 0.3557 (0.3557)  loss_class_dn_3: 0.3927 (0.3927)  loss_bbox_dn_3: 0.2609 (0.2609)  loss_giou_dn_3: 0.3386 (0.3386)  loss_class_dn_4: 0.3889 (0.3889)  loss_bbox_dn_4: 0.2625 (0.2625)  loss_giou_dn_4: 0.3338 (0.3338)  loss_class_hybrid: 0.3767 (0.3767)  loss_bbox_hybrid: 0.2938 (0.2938)  loss_giou_hybrid: 0.3219 (0.3219)  loss_class_0_hybrid: 0.4355 (0.4355)  loss_bbox_0_hybrid: 0.2018 (0.2018)  loss_giou_0_hybrid: 0.2681 (0.2681)  loss_class_1_hybrid: 0.3937 (0.3937)  loss_bbox_1_hybrid: 0.2720 (0.2720)  loss_giou_1_hybrid: 0.3293 (0.3293)  loss_class_2_hybrid: 0.3762 (0.3762)  loss_bbox_2_hybrid: 0.2772 (0.2772)  loss_giou_2_hybrid: 0.3235 (0.3235)  loss_class_3_hybrid: 0.3735 (0.3735)  loss_bbox_3_hybrid: 0.2879 (0.2879)  loss_giou_3_hybrid: 0.3240 (0.3240)  loss_class_4_hybrid: 0.3757 (0.3757)  loss_bbox_4_hybrid: 0.2917 (0.2917)  loss_giou_4_hybrid: 0.3257 (0.3257)  loss_class_enc_hybrid: 0.9561 (0.9561)  loss_bbox_enc_hybrid: 0.3053 (0.3053)  loss_giou_enc_hybrid: 0.3525 (0.3525)  mem: 736  max mem: 19988
[2025-05-20 01:17:11 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:34:27 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5751  loss: 29.3819 (28.7843)  loss_class: 0.4773 (0.6715)  loss_bbox: 0.2251 (0.3146)  loss_giou: 0.3698 (0.3944)  loss_class_0: 0.5552 (0.7998)  loss_bbox_0: 0.3017 (0.3261)  loss_giou_0: 0.3929 (0.4181)  loss_class_1: 0.5279 (0.7213)  loss_bbox_1: 0.2463 (0.3125)  loss_giou_1: 0.3769 (0.3983)  loss_class_2: 0.4980 (0.6953)  loss_bbox_2: 0.2392 (0.3085)  loss_giou_2: 0.3754 (0.3956)  loss_class_3: 0.4881 (0.6734)  loss_bbox_3: 0.2292 (0.3142)  loss_giou_3: 0.3749 (0.3954)  loss_class_4: 0.4783 (0.6733)  loss_bbox_4: 0.2266 (0.3129)  loss_giou_4: 0.3673 (0.3942)  loss_class_enc: 1.1991 (1.1871)  loss_bbox_enc: 0.2768 (0.3101)  loss_giou_enc: 0.3583 (0.4258)  loss_class_dn: 0.3996 (0.3627)  loss_bbox_dn: 0.2386 (0.4526)  loss_giou_dn: 0.3818 (0.4415)  loss_class_dn_0: 0.4676 (0.4222)  loss_bbox_dn_0: 0.3633 (0.5591)  loss_giou_dn_0: 0.6052 (0.5666)  loss_class_dn_1: 0.4332 (0.3940)  loss_bbox_dn_1: 0.2559 (0.4714)  loss_giou_dn_1: 0.3925 (0.4640)  loss_class_dn_2: 0.4102 (0.3695)  loss_bbox_dn_2: 0.2435 (0.4581)  loss_giou_dn_2: 0.3927 (0.4473)  loss_class_dn_3: 0.4038 (0.3662)  loss_bbox_dn_3: 0.2422 (0.4537)  loss_giou_dn_3: 0.3859 (0.4425)  loss_class_dn_4: 0.4014 (0.3647)  loss_bbox_dn_4: 0.2390 (0.4532)  loss_giou_dn_4: 0.3831 (0.4419)  loss_class_hybrid: 0.5285 (0.7397)  loss_bbox_hybrid: 0.2520 (0.2934)  loss_giou_hybrid: 0.3834 (0.3833)  loss_class_0_hybrid: 0.5752 (0.7983)  loss_bbox_0_hybrid: 0.2609 (0.3128)  loss_giou_0_hybrid: 0.4163 (0.4132)  loss_class_1_hybrid: 0.5377 (0.7359)  loss_bbox_1_hybrid: 0.2394 (0.3067)  loss_giou_1_hybrid: 0.3843 (0.3963)  loss_class_2_hybrid: 0.5287 (0.7327)  loss_bbox_2_hybrid: 0.2508 (0.3003)  loss_giou_2_hybrid: 0.3830 (0.3896)  loss_class_3_hybrid: 0.5599 (0.7317)  loss_bbox_3_hybrid: 0.2583 (0.2983)  loss_giou_3_hybrid: 0.3802 (0.3864)  loss_class_4_hybrid: 0.5232 (0.7365)  loss_bbox_4_hybrid: 0.2569 (0.2947)  loss_giou_4_hybrid: 0.3813 (0.3849)  loss_class_enc_hybrid: 0.8918 (0.9354)  loss_bbox_enc_hybrid: 0.2832 (0.3607)  loss_giou_enc_hybrid: 0.4178 (0.4798)
[2025-05-20 01:34:27 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 01:34:27 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\pytorch_model.bin
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\optimizer.bin
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\scheduler.bin
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\sampler.bin
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\sampler_1.bin
[2025-05-20 01:34:27 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_22\random_states_0.pkl
[2025-05-20 01:34:27 det.__main__] INFO: Start evaluation
[2025-05-20 01:34:27 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1670 (0.1670)  evaluator_time: 0.0040 (0.0040)  time: 0.1920  data: 0.0210  mem: 729  max mem: 19988
[2025-05-20 01:34:29 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1670 (0.1677)  evaluator_time: 0.0030 (0.0035)  time: 0.1736  data: 0.0025  mem: 729  max mem: 19988
[2025-05-20 01:34:31 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:34:33 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1710  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:34:34 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0031)  time: 0.1708  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:34:36 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1673 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1713  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:34:38 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1677 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:34:39 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1671 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1715  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:34:41 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:34:43 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:34:45 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1671 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:34:46 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1677 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:34:48 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1677 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:34:50 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1677 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:34:51 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1687 (0.1676)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:34:53 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1681 (0.1677)  evaluator_time: 0.0040 (0.0034)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:34:55 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1681 (0.1678)  evaluator_time: 0.0040 (0.0034)  time: 0.1734  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:34:57 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1685 (0.1678)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:34:58 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1681 (0.1678)  evaluator_time: 0.0030 (0.0034)  time: 0.1722  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:00 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1679)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:35:02 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1686 (0.1679)  evaluator_time: 0.0040 (0.0034)  time: 0.1732  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:35:04 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:35:05 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1686 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:07 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1683 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:35:09 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:35:10 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1691 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 01:35:12 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1695 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:14 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1682)  evaluator_time: 0.0040 (0.0034)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:35:16 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1694 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:17 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1694 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:19 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1692 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:21 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1697 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:23 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1697 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:24 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1698 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:26 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:35:28 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:35:30 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:31 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 01:35:33 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:35 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1695 (0.1686)  evaluator_time: 0.0040 (0.0034)  time: 0.1745  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 01:35:37 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1691 (0.1686)  evaluator_time: 0.0040 (0.0034)  time: 0.1745  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:38 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1731  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:40 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1689 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:42 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:35:43 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 01:35:45 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1688 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:46 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 01:35:46 det.util.engine] INFO: Averaged stats: model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 01:35:47 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.689
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.188
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.588
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.217
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.457
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.584

[2025-05-20 01:35:47 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3092  | 0.706  | 0.334 |
| Crescent_gap  | 48   | 48  | 7146  | 1.000  | 0.904 |
| Inclusion     | 41   | 82  | 6455  | 0.878  | 0.335 |
| Oil_spot      | 58   | 125 | 17494 | 0.936  | 0.664 |
| Punching      | 74   | 74  | 2390  | 1.000  | 0.940 |
| Rolled_pit    | 10   | 25  | 3640  | 0.880  | 0.501 |
| Silk_spot     | 134  | 150 | 60439 | 0.953  | 0.630 |
| Waist_folding | 24   | 26  | 8226  | 0.923  | 0.768 |
| Water_spot    | 68   | 78  | 19404 | 0.974  | 0.835 |
| Welding_line  | 99   | 99  | 8958  | 1.000  | 0.980 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.925  | 0.689 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 01:35:47 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:35:48 det.util.engine] INFO: Epoch: [23]  [0/1834]  eta: 0:15:14  lr: 0.000010  data_time: 0.0007  iter_time: 0.4984  loss: 74.3593 (74.3593)  loss_class: 3.7754 (3.7754)  loss_bbox: 0.2457 (0.2457)  loss_giou: 0.3939 (0.3939)  loss_class_0: 2.9682 (2.9682)  loss_bbox_0: 0.3716 (0.3716)  loss_giou_0: 0.5052 (0.5052)  loss_class_1: 3.8434 (3.8434)  loss_bbox_1: 0.2795 (0.2795)  loss_giou_1: 0.4208 (0.4208)  loss_class_2: 3.7282 (3.7282)  loss_bbox_2: 0.2549 (0.2549)  loss_giou_2: 0.4104 (0.4104)  loss_class_3: 3.9552 (3.9552)  loss_bbox_3: 0.2096 (0.2096)  loss_giou_3: 0.3997 (0.3997)  loss_class_4: 3.7240 (3.7240)  loss_bbox_4: 0.2416 (0.2416)  loss_giou_4: 0.4196 (0.4196)  loss_class_enc: 2.8229 (2.8229)  loss_bbox_enc: 0.4555 (0.4555)  loss_giou_enc: 0.5162 (0.5162)  loss_class_dn: 0.5192 (0.5192)  loss_bbox_dn: 1.0607 (1.0607)  loss_giou_dn: 1.0547 (1.0547)  loss_class_dn_0: 0.3932 (0.3932)  loss_bbox_dn_0: 1.0761 (1.0761)  loss_giou_dn_0: 1.1910 (1.1910)  loss_class_dn_1: 0.4447 (0.4447)  loss_bbox_dn_1: 1.0759 (1.0759)  loss_giou_dn_1: 1.1097 (1.1097)  loss_class_dn_2: 0.4746 (0.4746)  loss_bbox_dn_2: 1.0595 (1.0595)  loss_giou_dn_2: 1.0691 (1.0691)  loss_class_dn_3: 0.5360 (0.5360)  loss_bbox_dn_3: 1.0633 (1.0633)  loss_giou_dn_3: 1.0569 (1.0569)  loss_class_dn_4: 0.5259 (0.5259)  loss_bbox_dn_4: 1.0560 (1.0560)  loss_giou_dn_4: 1.0515 (1.0515)  loss_class_hybrid: 3.1000 (3.1000)  loss_bbox_hybrid: 0.3937 (0.3937)  loss_giou_hybrid: 0.5629 (0.5629)  loss_class_0_hybrid: 3.3111 (3.3111)  loss_bbox_0_hybrid: 0.3266 (0.3266)  loss_giou_0_hybrid: 0.5170 (0.5170)  loss_class_1_hybrid: 3.4747 (3.4747)  loss_bbox_1_hybrid: 0.4028 (0.4028)  loss_giou_1_hybrid: 0.5102 (0.5102)  loss_class_2_hybrid: 3.3147 (3.3147)  loss_bbox_2_hybrid: 0.3135 (0.3135)  loss_giou_2_hybrid: 0.5363 (0.5363)  loss_class_3_hybrid: 3.3040 (3.3040)  loss_bbox_3_hybrid: 0.3543 (0.3543)  loss_giou_3_hybrid: 0.5427 (0.5427)  loss_class_4_hybrid: 3.1226 (3.1226)  loss_bbox_4_hybrid: 0.3861 (0.3861)  loss_giou_4_hybrid: 0.5700 (0.5700)  loss_class_enc_hybrid: 2.5646 (2.5646)  loss_bbox_enc_hybrid: 0.3599 (0.3599)  loss_giou_enc_hybrid: 0.6324 (0.6324)  mem: 740  max mem: 19988
[2025-05-20 01:35:48 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:53:05 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5406  loss: 22.4176 (28.3153)  loss_class: 0.3947 (0.6562)  loss_bbox: 0.1325 (0.3057)  loss_giou: 0.2076 (0.3870)  loss_class_0: 0.5676 (0.7935)  loss_bbox_0: 0.1420 (0.3187)  loss_giou_0: 0.3532 (0.4075)  loss_class_1: 0.5444 (0.7122)  loss_bbox_1: 0.1358 (0.3044)  loss_giou_1: 0.2572 (0.3905)  loss_class_2: 0.4434 (0.6787)  loss_bbox_2: 0.1370 (0.3017)  loss_giou_2: 0.2133 (0.3881)  loss_class_3: 0.4255 (0.6617)  loss_bbox_3: 0.1332 (0.3015)  loss_giou_3: 0.2083 (0.3875)  loss_class_4: 0.4083 (0.6566)  loss_bbox_4: 0.1325 (0.3030)  loss_giou_4: 0.2127 (0.3873)  loss_class_enc: 1.0262 (1.1423)  loss_bbox_enc: 0.2890 (0.3060)  loss_giou_enc: 0.2700 (0.4218)  loss_class_dn: 0.3707 (0.3593)  loss_bbox_dn: 0.1646 (0.4509)  loss_giou_dn: 0.3350 (0.4375)  loss_class_dn_0: 0.4692 (0.4159)  loss_bbox_dn_0: 0.3608 (0.5544)  loss_giou_dn_0: 0.5109 (0.5604)  loss_class_dn_1: 0.4276 (0.3878)  loss_bbox_dn_1: 0.1879 (0.4699)  loss_giou_dn_1: 0.3755 (0.4609)  loss_class_dn_2: 0.3857 (0.3650)  loss_bbox_dn_2: 0.1788 (0.4566)  loss_giou_dn_2: 0.3272 (0.4437)  loss_class_dn_3: 0.3858 (0.3627)  loss_bbox_dn_3: 0.1707 (0.4521)  loss_giou_dn_3: 0.3257 (0.4384)  loss_class_dn_4: 0.3749 (0.3614)  loss_bbox_dn_4: 0.1658 (0.4517)  loss_giou_dn_4: 0.3258 (0.4378)  loss_class_hybrid: 0.4789 (0.7146)  loss_bbox_hybrid: 0.2079 (0.2946)  loss_giou_hybrid: 0.2312 (0.3817)  loss_class_0_hybrid: 0.5222 (0.7751)  loss_bbox_0_hybrid: 0.2387 (0.3134)  loss_giou_0_hybrid: 0.3112 (0.4105)  loss_class_1_hybrid: 0.5027 (0.7184)  loss_bbox_1_hybrid: 0.2069 (0.3056)  loss_giou_1_hybrid: 0.2515 (0.3949)  loss_class_2_hybrid: 0.4895 (0.7136)  loss_bbox_2_hybrid: 0.1820 (0.3008)  loss_giou_2_hybrid: 0.2292 (0.3887)  loss_class_3_hybrid: 0.4826 (0.7083)  loss_bbox_3_hybrid: 0.2009 (0.3003)  loss_giou_3_hybrid: 0.2305 (0.3859)  loss_class_4_hybrid: 0.4740 (0.7139)  loss_bbox_4_hybrid: 0.2005 (0.2972)  loss_giou_4_hybrid: 0.2358 (0.3841)  loss_class_enc_hybrid: 0.7191 (0.8973)  loss_bbox_enc_hybrid: 0.3165 (0.3605)  loss_giou_enc_hybrid: 0.3825 (0.4774)
[2025-05-20 01:53:05 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 01:53:05 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23
[2025-05-20 01:53:05 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\pytorch_model.bin
[2025-05-20 01:53:06 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\optimizer.bin
[2025-05-20 01:53:06 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\scheduler.bin
[2025-05-20 01:53:06 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\sampler.bin
[2025-05-20 01:53:06 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\sampler_1.bin
[2025-05-20 01:53:06 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_23\random_states_0.pkl
[2025-05-20 01:53:06 det.__main__] INFO: Start evaluation
[2025-05-20 01:53:06 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:32  model_time: 0.1730 (0.1730)  evaluator_time: 0.0040 (0.0040)  time: 0.2010  data: 0.0240  mem: 731  max mem: 19988
[2025-05-20 01:53:07 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1687 (0.1688)  evaluator_time: 0.0030 (0.0035)  time: 0.1751  data: 0.0027  mem: 731  max mem: 19988
[2025-05-20 01:53:09 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0094)  time: 0.1792  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:11 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:15  model_time: 0.1683 (0.1688)  evaluator_time: 0.0030 (0.0073)  time: 0.1789  data: 0.0004  mem: 731  max mem: 19988
[2025-05-20 01:53:13 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:13  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0063)  time: 0.1719  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:14 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:11  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0058)  time: 0.1725  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:16 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1684 (0.1686)  evaluator_time: 0.0030 (0.0054)  time: 0.1728  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:18 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0050)  time: 0.1725  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:20 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0048)  time: 0.1726  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:53:21 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0046)  time: 0.1729  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:23 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0045)  time: 0.1729  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:25 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0044)  time: 0.1728  data: 0.0004  mem: 731  max mem: 19988
[2025-05-20 01:53:27 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1684 (0.1686)  evaluator_time: 0.0030 (0.0043)  time: 0.1723  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:28 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1682 (0.1686)  evaluator_time: 0.0030 (0.0042)  time: 0.1719  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:30 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1685 (0.1686)  evaluator_time: 0.0030 (0.0042)  time: 0.1730  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:32 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1687)  evaluator_time: 0.0040 (0.0042)  time: 0.1738  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:34 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1691 (0.1687)  evaluator_time: 0.0030 (0.0041)  time: 0.1735  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:35 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0041)  time: 0.1728  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:37 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1680 (0.1686)  evaluator_time: 0.0030 (0.0040)  time: 0.1721  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:39 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0040)  time: 0.1728  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:53:40 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1687 (0.1687)  evaluator_time: 0.0040 (0.0040)  time: 0.1734  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:42 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1687 (0.1687)  evaluator_time: 0.0030 (0.0040)  time: 0.1731  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:44 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1682 (0.1687)  evaluator_time: 0.0030 (0.0039)  time: 0.1729  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:46 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0039)  time: 0.1732  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:47 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1687)  evaluator_time: 0.0031 (0.0039)  time: 0.1732  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:49 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0039)  time: 0.1733  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:51 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1696 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1738  data: 0.0008  mem: 731  max mem: 19988
[2025-05-20 01:53:53 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1696 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1738  data: 0.0008  mem: 731  max mem: 19988
[2025-05-20 01:53:54 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1743  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:56 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1743  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:53:58 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1696 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:53:59 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:01 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:54:03 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1691 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1741  data: 0.0008  mem: 731  max mem: 19988
[2025-05-20 01:54:05 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0037)  time: 0.1733  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:06 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1733  data: 0.0003  mem: 731  max mem: 19988
[2025-05-20 01:54:08 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1691 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1736  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:10 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1734  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:54:12 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1733  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:54:13 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1691 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1750  data: 0.0008  mem: 731  max mem: 19988
[2025-05-20 01:54:15 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1702 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1755  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:54:17 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1736  data: 0.0005  mem: 731  max mem: 19988
[2025-05-20 01:54:19 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1733  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:20 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1685 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1730  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:22 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1726  data: 0.0006  mem: 731  max mem: 19988
[2025-05-20 01:54:24 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0008  mem: 731  max mem: 19988
[2025-05-20 01:54:25 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0007  mem: 731  max mem: 19988
[2025-05-20 01:54:25 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 01:54:26 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.692
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.323
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.378
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.582

[2025-05-20 01:54:26 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2807  | 0.647  | 0.398 |
| Crescent_gap  | 48   | 48  | 7578  | 1.000  | 0.894 |
| Inclusion     | 41   | 82  | 9303  | 0.878  | 0.341 |
| Oil_spot      | 58   | 125 | 16375 | 0.928  | 0.692 |
| Punching      | 74   | 74  | 2668  | 1.000  | 0.959 |
| Rolled_pit    | 10   | 25  | 4143  | 0.840  | 0.464 |
| Silk_spot     | 134  | 150 | 57618 | 0.960  | 0.607 |
| Waist_folding | 24   | 26  | 8737  | 0.962  | 0.774 |
| Water_spot    | 68   | 78  | 19334 | 0.974  | 0.819 |
| Welding_line  | 99   | 99  | 8732  | 1.000  | 0.972 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.919  | 0.692 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 01:54:26 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 01:54:26 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 01:54:26 det.util.engine] INFO: Epoch: [24]  [0/1834]  eta: 0:17:39  lr: 0.000010  data_time: 0.0006  iter_time: 0.5774  loss: 87.0700 (87.0700)  loss_class: 0.7908 (0.7908)  loss_bbox: 2.5100 (2.5100)  loss_giou: 1.8734 (1.8734)  loss_class_0: 0.8159 (0.8159)  loss_bbox_0: 2.6313 (2.6313)  loss_giou_0: 1.8721 (1.8721)  loss_class_1: 0.7965 (0.7965)  loss_bbox_1: 2.5266 (2.5266)  loss_giou_1: 1.8754 (1.8754)  loss_class_2: 0.7816 (0.7816)  loss_bbox_2: 2.5226 (2.5226)  loss_giou_2: 1.8773 (1.8773)  loss_class_3: 0.7517 (0.7517)  loss_bbox_3: 2.5138 (2.5138)  loss_giou_3: 1.8728 (1.8728)  loss_class_4: 0.7702 (0.7702)  loss_bbox_4: 2.5105 (2.5105)  loss_giou_4: 1.8728 (1.8728)  loss_class_enc: 1.1764 (1.1764)  loss_bbox_enc: 2.2591 (2.2591)  loss_giou_enc: 1.8494 (1.8494)  loss_class_dn: 0.5136 (0.5136)  loss_bbox_dn: 1.0543 (1.0543)  loss_giou_dn: 0.9329 (0.9329)  loss_class_dn_0: 0.4238 (0.4238)  loss_bbox_dn_0: 1.0926 (1.0926)  loss_giou_dn_0: 0.9584 (0.9584)  loss_class_dn_1: 0.4138 (0.4138)  loss_bbox_dn_1: 1.0701 (1.0701)  loss_giou_dn_1: 0.9407 (0.9407)  loss_class_dn_2: 0.4588 (0.4588)  loss_bbox_dn_2: 1.0642 (1.0642)  loss_giou_dn_2: 0.9377 (0.9377)  loss_class_dn_3: 0.4826 (0.4826)  loss_bbox_dn_3: 1.0565 (1.0565)  loss_giou_dn_3: 0.9332 (0.9332)  loss_class_dn_4: 0.5077 (0.5077)  loss_bbox_dn_4: 1.0586 (1.0586)  loss_giou_dn_4: 0.9343 (0.9343)  loss_class_hybrid: 0.8097 (0.8097)  loss_bbox_hybrid: 2.4186 (2.4186)  loss_giou_hybrid: 1.8013 (1.8013)  loss_class_0_hybrid: 0.9230 (0.9230)  loss_bbox_0_hybrid: 2.4864 (2.4864)  loss_giou_0_hybrid: 1.8039 (1.8039)  loss_class_1_hybrid: 0.9262 (0.9262)  loss_bbox_1_hybrid: 2.4254 (2.4254)  loss_giou_1_hybrid: 1.8057 (1.8057)  loss_class_2_hybrid: 0.8722 (0.8722)  loss_bbox_2_hybrid: 2.4187 (2.4187)  loss_giou_2_hybrid: 1.8025 (1.8025)  loss_class_3_hybrid: 0.8723 (0.8723)  loss_bbox_3_hybrid: 2.4176 (2.4176)  loss_giou_3_hybrid: 1.8009 (1.8009)  loss_class_4_hybrid: 0.8802 (0.8802)  loss_bbox_4_hybrid: 2.4243 (2.4243)  loss_giou_4_hybrid: 1.8059 (1.8059)  loss_class_enc_hybrid: 0.7962 (0.7962)  loss_bbox_enc_hybrid: 2.4682 (2.4682)  loss_giou_enc_hybrid: 1.8267 (1.8267)  mem: 735  max mem: 19988
[2025-05-20 01:54:26 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:11:42 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5685  loss: 24.5309 (28.2112)  loss_class: 0.4708 (0.6546)  loss_bbox: 0.1299 (0.3084)  loss_giou: 0.3778 (0.3878)  loss_class_0: 0.5517 (0.7837)  loss_bbox_0: 0.1781 (0.3235)  loss_giou_0: 0.3572 (0.4084)  loss_class_1: 0.4825 (0.6980)  loss_bbox_1: 0.1743 (0.3129)  loss_giou_1: 0.3469 (0.3912)  loss_class_2: 0.4858 (0.6766)  loss_bbox_2: 0.1312 (0.3064)  loss_giou_2: 0.3597 (0.3878)  loss_class_3: 0.4611 (0.6638)  loss_bbox_3: 0.1344 (0.3046)  loss_giou_3: 0.3936 (0.3861)  loss_class_4: 0.4593 (0.6538)  loss_bbox_4: 0.1317 (0.3067)  loss_giou_4: 0.3813 (0.3871)  loss_class_enc: 1.1755 (1.1564)  loss_bbox_enc: 0.2003 (0.3027)  loss_giou_enc: 0.3419 (0.4153)  loss_class_dn: 0.4055 (0.3587)  loss_bbox_dn: 0.1381 (0.4465)  loss_giou_dn: 0.3635 (0.4300)  loss_class_dn_0: 0.4832 (0.4182)  loss_bbox_dn_0: 0.3386 (0.5522)  loss_giou_dn_0: 0.5412 (0.5527)  loss_class_dn_1: 0.4377 (0.3880)  loss_bbox_dn_1: 0.2170 (0.4656)  loss_giou_dn_1: 0.4175 (0.4523)  loss_class_dn_2: 0.3953 (0.3641)  loss_bbox_dn_2: 0.1691 (0.4520)  loss_giou_dn_2: 0.3583 (0.4355)  loss_class_dn_3: 0.4020 (0.3620)  loss_bbox_dn_3: 0.1542 (0.4478)  loss_giou_dn_3: 0.3689 (0.4310)  loss_class_dn_4: 0.4033 (0.3602)  loss_bbox_dn_4: 0.1401 (0.4472)  loss_giou_dn_4: 0.3604 (0.4303)  loss_class_hybrid: 0.4703 (0.7271)  loss_bbox_hybrid: 0.1387 (0.2892)  loss_giou_hybrid: 0.2877 (0.3751)  loss_class_0_hybrid: 0.5882 (0.7821)  loss_bbox_0_hybrid: 0.1738 (0.3101)  loss_giou_0_hybrid: 0.3847 (0.4044)  loss_class_1_hybrid: 0.4716 (0.7168)  loss_bbox_1_hybrid: 0.1263 (0.3020)  loss_giou_1_hybrid: 0.3295 (0.3888)  loss_class_2_hybrid: 0.4551 (0.7151)  loss_bbox_2_hybrid: 0.1176 (0.2949)  loss_giou_2_hybrid: 0.3087 (0.3820)  loss_class_3_hybrid: 0.4604 (0.7188)  loss_bbox_3_hybrid: 0.1531 (0.2940)  loss_giou_3_hybrid: 0.2943 (0.3787)  loss_class_4_hybrid: 0.4547 (0.7233)  loss_bbox_4_hybrid: 0.1434 (0.2919)  loss_giou_4_hybrid: 0.2949 (0.3774)  loss_class_enc_hybrid: 0.8457 (0.9111)  loss_bbox_enc_hybrid: 0.2581 (0.3519)  loss_giou_enc_hybrid: 0.4565 (0.4664)
[2025-05-20 02:11:42 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 02:11:42 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\pytorch_model.bin
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\optimizer.bin
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\scheduler.bin
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\sampler.bin
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\sampler_1.bin
[2025-05-20 02:11:42 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_24\random_states_0.pkl
[2025-05-20 02:11:42 det.__main__] INFO: Start evaluation
[2025-05-20 02:11:42 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1710 (0.1710)  evaluator_time: 0.0040 (0.0040)  time: 0.1990  data: 0.0240  mem: 724  max mem: 19988
[2025-05-20 02:11:44 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1683 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1755  data: 0.0031  mem: 724  max mem: 19988
[2025-05-20 02:11:46 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1683 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:11:48 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1723  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:11:49 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1720  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:11:51 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:11:53 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:11:55 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:11:56 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1689 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:11:58 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:00 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1695 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1734  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:02 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:03 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1691 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1736  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:12:05 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:07 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:08 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1687 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:10 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1742  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:12 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:14 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:15 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:17 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1692)  evaluator_time: 0.0040 (0.0032)  time: 0.1734  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:19 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:21 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:22 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:24 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:26 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1682 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:27 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1690)  evaluator_time: 0.0020 (0.0033)  time: 0.1723  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:29 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:31 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:33 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:34 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:36 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1682 (0.1689)  evaluator_time: 0.0020 (0.0032)  time: 0.1719  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:38 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:40 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:41 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1682 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:43 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:45 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1683 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:12:46 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:48 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:50 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1685 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1741  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:52 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1700 (0.1688)  evaluator_time: 0.0035 (0.0033)  time: 0.1752  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:53 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1701 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:12:55 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:12:57 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:12:59 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1738  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:13:00 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1747  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:13:02 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1695 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:13:02 det.util.engine] INFO: Averaged stats: model_time: 0.1695 (0.1689)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 02:13:02 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.685
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.322
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.585
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.582

[2025-05-20 02:13:02 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2848  | 0.647  | 0.419 |
| Crescent_gap  | 48   | 48  | 5780  | 1.000  | 0.904 |
| Inclusion     | 41   | 82  | 8436  | 0.841  | 0.360 |
| Oil_spot      | 58   | 125 | 13556 | 0.920  | 0.675 |
| Punching      | 74   | 74  | 1803  | 1.000  | 0.952 |
| Rolled_pit    | 10   | 25  | 3848  | 0.840  | 0.420 |
| Silk_spot     | 134  | 150 | 69140 | 0.960  | 0.650 |
| Waist_folding | 24   | 26  | 9023  | 0.962  | 0.698 |
| Water_spot    | 68   | 78  | 14286 | 0.987  | 0.804 |
| Welding_line  | 99   | 99  | 8587  | 1.000  | 0.969 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.916  | 0.685 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 02:13:02 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:13:03 det.util.engine] INFO: Epoch: [25]  [0/1834]  eta: 0:18:14  lr: 0.000010  data_time: 0.0007  iter_time: 0.5968  loss: 16.3738 (16.3738)  loss_class: 0.4080 (0.4080)  loss_bbox: 0.0539 (0.0539)  loss_giou: 0.2562 (0.2562)  loss_class_0: 0.5830 (0.5830)  loss_bbox_0: 0.0653 (0.0653)  loss_giou_0: 0.3155 (0.3155)  loss_class_1: 0.3737 (0.3737)  loss_bbox_1: 0.0483 (0.0483)  loss_giou_1: 0.2598 (0.2598)  loss_class_2: 0.3693 (0.3693)  loss_bbox_2: 0.0457 (0.0457)  loss_giou_2: 0.2247 (0.2247)  loss_class_3: 0.4061 (0.4061)  loss_bbox_3: 0.0562 (0.0562)  loss_giou_3: 0.2602 (0.2602)  loss_class_4: 0.4220 (0.4220)  loss_bbox_4: 0.0555 (0.0555)  loss_giou_4: 0.2602 (0.2602)  loss_class_enc: 0.9962 (0.9962)  loss_bbox_enc: 0.0547 (0.0547)  loss_giou_enc: 0.3122 (0.3122)  loss_class_dn: 0.3441 (0.3441)  loss_bbox_dn: 0.0492 (0.0492)  loss_giou_dn: 0.2725 (0.2725)  loss_class_dn_0: 0.4812 (0.4812)  loss_bbox_dn_0: 0.1221 (0.1221)  loss_giou_dn_0: 0.6669 (0.6669)  loss_class_dn_1: 0.4598 (0.4598)  loss_bbox_dn_1: 0.0665 (0.0665)  loss_giou_dn_1: 0.3990 (0.3990)  loss_class_dn_2: 0.3746 (0.3746)  loss_bbox_dn_2: 0.0554 (0.0554)  loss_giou_dn_2: 0.3053 (0.3053)  loss_class_dn_3: 0.3645 (0.3645)  loss_bbox_dn_3: 0.0545 (0.0545)  loss_giou_dn_3: 0.2963 (0.2963)  loss_class_dn_4: 0.3500 (0.3500)  loss_bbox_dn_4: 0.0509 (0.0509)  loss_giou_dn_4: 0.2795 (0.2795)  loss_class_hybrid: 0.3704 (0.3704)  loss_bbox_hybrid: 0.0414 (0.0414)  loss_giou_hybrid: 0.2091 (0.2091)  loss_class_0_hybrid: 0.6086 (0.6086)  loss_bbox_0_hybrid: 0.0546 (0.0546)  loss_giou_0_hybrid: 0.3068 (0.3068)  loss_class_1_hybrid: 0.4421 (0.4421)  loss_bbox_1_hybrid: 0.0508 (0.0508)  loss_giou_1_hybrid: 0.2972 (0.2972)  loss_class_2_hybrid: 0.4021 (0.4021)  loss_bbox_2_hybrid: 0.0463 (0.0463)  loss_giou_2_hybrid: 0.2521 (0.2521)  loss_class_3_hybrid: 0.3951 (0.3951)  loss_bbox_3_hybrid: 0.0431 (0.0431)  loss_giou_3_hybrid: 0.2098 (0.2098)  loss_class_4_hybrid: 0.3840 (0.3840)  loss_bbox_4_hybrid: 0.0429 (0.0429)  loss_giou_4_hybrid: 0.2128 (0.2128)  loss_class_enc_hybrid: 0.5711 (0.5711)  loss_bbox_enc_hybrid: 0.0955 (0.0955)  loss_giou_enc_hybrid: 0.5186 (0.5186)  mem: 734  max mem: 19988
[2025-05-20 02:13:03 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:30:25 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5711  loss: 23.2037 (28.3321)  loss_class: 0.4773 (0.6620)  loss_bbox: 0.1956 (0.3099)  loss_giou: 0.3237 (0.3875)  loss_class_0: 0.5842 (0.7967)  loss_bbox_0: 0.1908 (0.3273)  loss_giou_0: 0.3225 (0.4083)  loss_class_1: 0.5018 (0.7065)  loss_bbox_1: 0.2113 (0.3138)  loss_giou_1: 0.3338 (0.3922)  loss_class_2: 0.4586 (0.6792)  loss_bbox_2: 0.2086 (0.3085)  loss_giou_2: 0.2924 (0.3885)  loss_class_3: 0.4654 (0.6633)  loss_bbox_3: 0.2038 (0.3081)  loss_giou_3: 0.2872 (0.3882)  loss_class_4: 0.4553 (0.6646)  loss_bbox_4: 0.2037 (0.3071)  loss_giou_4: 0.3048 (0.3862)  loss_class_enc: 1.2981 (1.1630)  loss_bbox_enc: 0.2421 (0.3090)  loss_giou_enc: 0.3860 (0.4196)  loss_class_dn: 0.3775 (0.3645)  loss_bbox_dn: 0.2116 (0.4423)  loss_giou_dn: 0.3395 (0.4320)  loss_class_dn_0: 0.4671 (0.4240)  loss_bbox_dn_0: 0.3305 (0.5512)  loss_giou_dn_0: 0.5394 (0.5557)  loss_class_dn_1: 0.4183 (0.3932)  loss_bbox_dn_1: 0.2448 (0.4634)  loss_giou_dn_1: 0.3678 (0.4550)  loss_class_dn_2: 0.4113 (0.3706)  loss_bbox_dn_2: 0.2323 (0.4493)  loss_giou_dn_2: 0.3530 (0.4380)  loss_class_dn_3: 0.3891 (0.3676)  loss_bbox_dn_3: 0.2220 (0.4438)  loss_giou_dn_3: 0.3563 (0.4329)  loss_class_dn_4: 0.3824 (0.3657)  loss_bbox_dn_4: 0.2220 (0.4431)  loss_giou_dn_4: 0.3495 (0.4324)  loss_class_hybrid: 0.5412 (0.7117)  loss_bbox_hybrid: 0.1843 (0.2969)  loss_giou_hybrid: 0.2636 (0.3782)  loss_class_0_hybrid: 0.6463 (0.7760)  loss_bbox_0_hybrid: 0.2280 (0.3179)  loss_giou_0_hybrid: 0.3312 (0.4060)  loss_class_1_hybrid: 0.5921 (0.7135)  loss_bbox_1_hybrid: 0.2234 (0.3109)  loss_giou_1_hybrid: 0.2933 (0.3922)  loss_class_2_hybrid: 0.5415 (0.7091)  loss_bbox_2_hybrid: 0.1918 (0.3031)  loss_giou_2_hybrid: 0.2947 (0.3849)  loss_class_3_hybrid: 0.5107 (0.7034)  loss_bbox_3_hybrid: 0.1912 (0.3023)  loss_giou_3_hybrid: 0.2635 (0.3821)  loss_class_4_hybrid: 0.5577 (0.7087)  loss_bbox_4_hybrid: 0.1732 (0.3005)  loss_giou_4_hybrid: 0.2692 (0.3805)  loss_class_enc_hybrid: 0.9097 (0.9103)  loss_bbox_enc_hybrid: 0.3185 (0.3595)  loss_giou_enc_hybrid: 0.4287 (0.4701)
[2025-05-20 02:30:25 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 02:30:25 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\pytorch_model.bin
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\optimizer.bin
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\scheduler.bin
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\sampler.bin
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\sampler_1.bin
[2025-05-20 02:30:25 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_25\random_states_0.pkl
[2025-05-20 02:30:25 det.__main__] INFO: Start evaluation
[2025-05-20 02:30:25 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1677 (0.1677)  evaluator_time: 0.0030 (0.0030)  time: 0.1947  data: 0.0240  mem: 728  max mem: 19988
[2025-05-20 02:30:27 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1670 (0.1670)  evaluator_time: 0.0030 (0.0035)  time: 0.1734  data: 0.0026  mem: 728  max mem: 19988
[2025-05-20 02:30:29 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1670 (0.1670)  evaluator_time: 0.0030 (0.0034)  time: 0.1711  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:30 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1672)  evaluator_time: 0.0030 (0.0032)  time: 0.1711  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:32 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1674 (0.1672)  evaluator_time: 0.0030 (0.0031)  time: 0.1710  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:34 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1671 (0.1673)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:36 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1675 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:37 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1675 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1712  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:39 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0032)  time: 0.1711  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:41 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0032)  time: 0.1711  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:42 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1670 (0.1673)  evaluator_time: 0.0030 (0.0032)  time: 0.1715  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:44 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1672 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:46 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:57  model_time: 0.1672 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:48 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1671 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1711  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:30:49 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 02:30:51 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1680 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:30:53 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1686 (0.1675)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:30:55 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1684 (0.1676)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:56 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1680 (0.1677)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:30:58 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1677)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 02:31:00 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1687 (0.1678)  evaluator_time: 0.0040 (0.0033)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 02:31:01 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1695 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:03 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:05 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:07 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:08 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1695 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:10 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 02:31:12 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1686 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 02:31:14 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1685 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 02:31:15 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:31:17 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:19 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:21 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:22 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1697 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:24 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1691 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:31:26 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1695 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 02:31:27 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0003  mem: 728  max mem: 19988
[2025-05-20 02:31:29 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 02:31:31 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1701 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 02:31:33 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1698 (0.1686)  evaluator_time: 0.0040 (0.0033)  time: 0.1751  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:31:34 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1695 (0.1686)  evaluator_time: 0.0040 (0.0033)  time: 0.1745  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:36 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1696 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 02:31:38 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1703 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:40 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 02:31:41 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1696 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:43 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:44 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 02:31:44 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 02:31:45 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.698
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.189
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.582
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.462
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.573

[2025-05-20 02:31:45 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3290  | 0.647  | 0.359 |
| Crescent_gap  | 48   | 48  | 7666  | 1.000  | 0.917 |
| Inclusion     | 41   | 82  | 7306  | 0.854  | 0.385 |
| Oil_spot      | 58   | 125 | 13721 | 0.904  | 0.675 |
| Punching      | 74   | 74  | 2031  | 0.986  | 0.945 |
| Rolled_pit    | 10   | 25  | 3663  | 0.920  | 0.477 |
| Silk_spot     | 134  | 150 | 62850 | 0.953  | 0.633 |
| Waist_folding | 24   | 26  | 8527  | 0.923  | 0.822 |
| Water_spot    | 68   | 78  | 20266 | 0.962  | 0.805 |
| Welding_line  | 99   | 99  | 7878  | 1.000  | 0.965 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.915  | 0.698 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 02:31:45 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:31:45 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 02:31:45 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 02:31:46 det.util.engine] INFO: Epoch: [26]  [0/1834]  eta: 0:17:27  lr: 0.000010  data_time: 0.0005  iter_time: 0.5713  loss: 40.1595 (40.1595)  loss_class: 0.7689 (0.7689)  loss_bbox: 0.7319 (0.7319)  loss_giou: 0.4973 (0.4973)  loss_class_0: 1.4427 (1.4427)  loss_bbox_0: 0.4983 (0.4983)  loss_giou_0: 0.3457 (0.3457)  loss_class_1: 1.4063 (1.4063)  loss_bbox_1: 0.4697 (0.4697)  loss_giou_1: 0.3276 (0.3276)  loss_class_2: 1.5671 (1.5671)  loss_bbox_2: 0.4718 (0.4718)  loss_giou_2: 0.3207 (0.3207)  loss_class_3: 1.0577 (1.0577)  loss_bbox_3: 0.7581 (0.7581)  loss_giou_3: 0.5167 (0.5167)  loss_class_4: 0.7868 (0.7868)  loss_bbox_4: 0.7282 (0.7282)  loss_giou_4: 0.4898 (0.4898)  loss_class_enc: 1.2232 (1.2232)  loss_bbox_enc: 0.6789 (0.6789)  loss_giou_enc: 0.7512 (0.7512)  loss_class_dn: 0.6519 (0.6519)  loss_bbox_dn: 0.5704 (0.5704)  loss_giou_dn: 0.3759 (0.3759)  loss_class_dn_0: 0.6740 (0.6740)  loss_bbox_dn_0: 0.8101 (0.8101)  loss_giou_dn_0: 0.5442 (0.5442)  loss_class_dn_1: 0.7291 (0.7291)  loss_bbox_dn_1: 0.5779 (0.5779)  loss_giou_dn_1: 0.4097 (0.4097)  loss_class_dn_2: 0.8481 (0.8481)  loss_bbox_dn_2: 0.5897 (0.5897)  loss_giou_dn_2: 0.3997 (0.3997)  loss_class_dn_3: 0.8167 (0.8167)  loss_bbox_dn_3: 0.5696 (0.5696)  loss_giou_dn_3: 0.3803 (0.3803)  loss_class_dn_4: 0.7110 (0.7110)  loss_bbox_dn_4: 0.5620 (0.5620)  loss_giou_dn_4: 0.3728 (0.3728)  loss_class_hybrid: 1.0605 (1.0605)  loss_bbox_hybrid: 0.4278 (0.4278)  loss_giou_hybrid: 0.2807 (0.2807)  loss_class_0_hybrid: 1.2951 (1.2951)  loss_bbox_0_hybrid: 0.4131 (0.4131)  loss_giou_0_hybrid: 0.3262 (0.3262)  loss_class_1_hybrid: 1.1855 (1.1855)  loss_bbox_1_hybrid: 0.4597 (0.4597)  loss_giou_1_hybrid: 0.3145 (0.3145)  loss_class_2_hybrid: 0.9376 (0.9376)  loss_bbox_2_hybrid: 0.4874 (0.4874)  loss_giou_2_hybrid: 0.3211 (0.3211)  loss_class_3_hybrid: 1.4104 (1.4104)  loss_bbox_3_hybrid: 0.3589 (0.3589)  loss_giou_3_hybrid: 0.2458 (0.2458)  loss_class_4_hybrid: 1.0760 (1.0760)  loss_bbox_4_hybrid: 0.4200 (0.4200)  loss_giou_4_hybrid: 0.2748 (0.2748)  loss_class_enc_hybrid: 1.4321 (1.4321)  loss_bbox_enc_hybrid: 0.5429 (0.5429)  loss_giou_enc_hybrid: 0.4574 (0.4574)  mem: 731  max mem: 19988
[2025-05-20 02:31:46 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:49:03 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5910  loss: 30.9424 (27.9436)  loss_class: 0.4465 (0.6466)  loss_bbox: 0.2669 (0.3058)  loss_giou: 0.3906 (0.3824)  loss_class_0: 0.6850 (0.7838)  loss_bbox_0: 0.3289 (0.3199)  loss_giou_0: 0.4082 (0.4061)  loss_class_1: 0.5250 (0.6964)  loss_bbox_1: 0.2776 (0.3073)  loss_giou_1: 0.4029 (0.3890)  loss_class_2: 0.4611 (0.6729)  loss_bbox_2: 0.2722 (0.3005)  loss_giou_2: 0.3947 (0.3832)  loss_class_3: 0.4387 (0.6527)  loss_bbox_3: 0.2732 (0.3038)  loss_giou_3: 0.3857 (0.3831)  loss_class_4: 0.4520 (0.6406)  loss_bbox_4: 0.2634 (0.3063)  loss_giou_4: 0.3979 (0.3831)  loss_class_enc: 1.2569 (1.1483)  loss_bbox_enc: 0.3038 (0.3018)  loss_giou_enc: 0.4506 (0.4168)  loss_class_dn: 0.4058 (0.3618)  loss_bbox_dn: 0.3872 (0.4360)  loss_giou_dn: 0.4000 (0.4241)  loss_class_dn_0: 0.4643 (0.4212)  loss_bbox_dn_0: 0.5059 (0.5442)  loss_giou_dn_0: 0.5913 (0.5485)  loss_class_dn_1: 0.4473 (0.3879)  loss_bbox_dn_1: 0.4233 (0.4574)  loss_giou_dn_1: 0.4494 (0.4473)  loss_class_dn_2: 0.4202 (0.3667)  loss_bbox_dn_2: 0.4054 (0.4437)  loss_giou_dn_2: 0.4265 (0.4305)  loss_class_dn_3: 0.4136 (0.3646)  loss_bbox_dn_3: 0.3978 (0.4382)  loss_giou_dn_3: 0.4234 (0.4253)  loss_class_dn_4: 0.4085 (0.3636)  loss_bbox_dn_4: 0.3974 (0.4374)  loss_giou_dn_4: 0.4169 (0.4246)  loss_class_hybrid: 0.5671 (0.6906)  loss_bbox_hybrid: 0.2541 (0.2930)  loss_giou_hybrid: 0.3831 (0.3799)  loss_class_0_hybrid: 0.6929 (0.7639)  loss_bbox_0_hybrid: 0.3276 (0.3160)  loss_giou_0_hybrid: 0.4125 (0.4103)  loss_class_1_hybrid: 0.5545 (0.6966)  loss_bbox_1_hybrid: 0.2804 (0.3071)  loss_giou_1_hybrid: 0.4191 (0.3936)  loss_class_2_hybrid: 0.5331 (0.6950)  loss_bbox_2_hybrid: 0.2385 (0.2986)  loss_giou_2_hybrid: 0.4155 (0.3851)  loss_class_3_hybrid: 0.5203 (0.6893)  loss_bbox_3_hybrid: 0.2385 (0.2977)  loss_giou_3_hybrid: 0.3878 (0.3831)  loss_class_4_hybrid: 0.5012 (0.6882)  loss_bbox_4_hybrid: 0.2387 (0.2968)  loss_giou_4_hybrid: 0.3846 (0.3825)  loss_class_enc_hybrid: 0.8990 (0.8936)  loss_bbox_enc_hybrid: 0.4605 (0.3554)  loss_giou_enc_hybrid: 0.5480 (0.4741)
[2025-05-20 02:49:03 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 02:49:03 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\pytorch_model.bin
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\optimizer.bin
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\scheduler.bin
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\sampler.bin
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\sampler_1.bin
[2025-05-20 02:49:04 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_26\random_states_0.pkl
[2025-05-20 02:49:04 det.__main__] INFO: Start evaluation
[2025-05-20 02:49:04 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1681 (0.1681)  evaluator_time: 0.0030 (0.0030)  time: 0.1991  data: 0.0280  mem: 724  max mem: 19988
[2025-05-20 02:49:06 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1686 (0.1690)  evaluator_time: 0.0036 (0.0036)  time: 0.1759  data: 0.0032  mem: 724  max mem: 19988
[2025-05-20 02:49:08 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1686 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1730  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:09 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1685 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:11 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:13 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:14 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:16 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:18 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:20 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1693 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:21 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1685 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:23 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1681 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:25 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:27 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:28 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:30 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1679 (0.1690)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:32 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1678 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0003  mem: 724  max mem: 19988
[2025-05-20 02:49:33 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:35 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1680 (0.1689)  evaluator_time: 0.0020 (0.0032)  time: 0.1717  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:37 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:39 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1680 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1722  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:40 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1682 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0003  mem: 724  max mem: 19988
[2025-05-20 02:49:42 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:44 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1686 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1735  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:46 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1733  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:47 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:49 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:51 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:53 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0004  mem: 724  max mem: 19988
[2025-05-20 02:49:54 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:49:56 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:49:58 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:49:59 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:01 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:03 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:50:05 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:06 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:50:08 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1696 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:10 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1696 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:50:12 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1691 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1746  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:50:13 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1688 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1748  data: 0.0008  mem: 724  max mem: 19988
[2025-05-20 02:50:15 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:17 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1697 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0005  mem: 724  max mem: 19988
[2025-05-20 02:50:19 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1695 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 02:50:20 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:22 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 724  max mem: 19988
[2025-05-20 02:50:23 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0007  mem: 723  max mem: 19988
[2025-05-20 02:50:23 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 02:50:24 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.695
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.076
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.390
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.430
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.570

[2025-05-20 02:50:24 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2294  | 0.588  | 0.313 |
| Crescent_gap  | 48   | 48  | 6799  | 1.000  | 0.914 |
| Inclusion     | 41   | 82  | 8331  | 0.878  | 0.392 |
| Oil_spot      | 58   | 125 | 17198 | 0.912  | 0.683 |
| Punching      | 74   | 74  | 2007  | 1.000  | 0.946 |
| Rolled_pit    | 10   | 25  | 3046  | 0.880  | 0.507 |
| Silk_spot     | 134  | 150 | 61283 | 0.947  | 0.621 |
| Waist_folding | 24   | 26  | 9958  | 0.923  | 0.788 |
| Water_spot    | 68   | 78  | 15853 | 0.962  | 0.823 |
| Welding_line  | 99   | 99  | 10565 | 1.000  | 0.963 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.909  | 0.695 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 02:50:24 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 02:50:24 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 02:50:25 det.util.engine] INFO: Epoch: [27]  [0/1834]  eta: 0:18:13  lr: 0.000010  data_time: 0.0007  iter_time: 0.5964  loss: 23.9552 (23.9552)  loss_class: 0.4497 (0.4497)  loss_bbox: 0.1190 (0.1190)  loss_giou: 0.5974 (0.5974)  loss_class_0: 0.5272 (0.5272)  loss_bbox_0: 0.1044 (0.1044)  loss_giou_0: 0.5840 (0.5840)  loss_class_1: 0.5204 (0.5204)  loss_bbox_1: 0.1108 (0.1108)  loss_giou_1: 0.5710 (0.5710)  loss_class_2: 0.4778 (0.4778)  loss_bbox_2: 0.1135 (0.1135)  loss_giou_2: 0.5847 (0.5847)  loss_class_3: 0.4580 (0.4580)  loss_bbox_3: 0.1155 (0.1155)  loss_giou_3: 0.6005 (0.6005)  loss_class_4: 0.4619 (0.4619)  loss_bbox_4: 0.1162 (0.1162)  loss_giou_4: 0.5987 (0.5987)  loss_class_enc: 0.7465 (0.7465)  loss_bbox_enc: 0.0955 (0.0955)  loss_giou_enc: 0.5750 (0.5750)  loss_class_dn: 0.4320 (0.4320)  loss_bbox_dn: 0.1177 (0.1177)  loss_giou_dn: 0.5571 (0.5571)  loss_class_dn_0: 0.4710 (0.4710)  loss_bbox_dn_0: 0.1562 (0.1562)  loss_giou_dn_0: 0.7646 (0.7646)  loss_class_dn_1: 0.4650 (0.4650)  loss_bbox_dn_1: 0.1236 (0.1236)  loss_giou_dn_1: 0.5891 (0.5891)  loss_class_dn_2: 0.4474 (0.4474)  loss_bbox_dn_2: 0.1175 (0.1175)  loss_giou_dn_2: 0.5652 (0.5652)  loss_class_dn_3: 0.4385 (0.4385)  loss_bbox_dn_3: 0.1184 (0.1184)  loss_giou_dn_3: 0.5595 (0.5595)  loss_class_dn_4: 0.4346 (0.4346)  loss_bbox_dn_4: 0.1149 (0.1149)  loss_giou_dn_4: 0.5555 (0.5555)  loss_class_hybrid: 0.5280 (0.5280)  loss_bbox_hybrid: 0.1081 (0.1081)  loss_giou_hybrid: 0.5232 (0.5232)  loss_class_0_hybrid: 0.6602 (0.6602)  loss_bbox_0_hybrid: 0.1069 (0.1069)  loss_giou_0_hybrid: 0.5363 (0.5363)  loss_class_1_hybrid: 0.5774 (0.5774)  loss_bbox_1_hybrid: 0.0993 (0.0993)  loss_giou_1_hybrid: 0.5214 (0.5214)  loss_class_2_hybrid: 0.5352 (0.5352)  loss_bbox_2_hybrid: 0.1072 (0.1072)  loss_giou_2_hybrid: 0.5373 (0.5373)  loss_class_3_hybrid: 0.5274 (0.5274)  loss_bbox_3_hybrid: 0.1090 (0.1090)  loss_giou_3_hybrid: 0.5235 (0.5235)  loss_class_4_hybrid: 0.5278 (0.5278)  loss_bbox_4_hybrid: 0.1074 (0.1074)  loss_giou_4_hybrid: 0.5215 (0.5215)  loss_class_enc_hybrid: 0.6498 (0.6498)  loss_bbox_enc_hybrid: 0.0829 (0.0829)  loss_giou_enc_hybrid: 0.5098 (0.5098)  mem: 733  max mem: 19988
[2025-05-20 02:50:25 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:07:42 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0006  iter_time: 0.5600  loss: 35.2951 (27.7353)  loss_class: 0.8006 (0.6383)  loss_bbox: 0.2361 (0.2980)  loss_giou: 0.1847 (0.3808)  loss_class_0: 0.6974 (0.7885)  loss_bbox_0: 0.2502 (0.3192)  loss_giou_0: 0.2857 (0.4069)  loss_class_1: 0.6263 (0.6995)  loss_bbox_1: 0.2790 (0.2995)  loss_giou_1: 0.2565 (0.3858)  loss_class_2: 0.7134 (0.6755)  loss_bbox_2: 0.2604 (0.2896)  loss_giou_2: 0.2394 (0.3792)  loss_class_3: 0.7638 (0.6520)  loss_bbox_3: 0.2481 (0.2925)  loss_giou_3: 0.2342 (0.3793)  loss_class_4: 0.7741 (0.6393)  loss_bbox_4: 0.2398 (0.2943)  loss_giou_4: 0.1942 (0.3806)  loss_class_enc: 1.1901 (1.1342)  loss_bbox_enc: 0.2862 (0.3011)  loss_giou_enc: 0.4439 (0.4165)  loss_class_dn: 0.4172 (0.3547)  loss_bbox_dn: 0.4015 (0.4358)  loss_giou_dn: 0.4106 (0.4258)  loss_class_dn_0: 0.4555 (0.4145)  loss_bbox_dn_0: 0.5981 (0.5424)  loss_giou_dn_0: 0.5071 (0.5481)  loss_class_dn_1: 0.4351 (0.3839)  loss_bbox_dn_1: 0.4111 (0.4567)  loss_giou_dn_1: 0.4334 (0.4488)  loss_class_dn_2: 0.4215 (0.3611)  loss_bbox_dn_2: 0.4273 (0.4430)  loss_giou_dn_2: 0.4197 (0.4322)  loss_class_dn_3: 0.4260 (0.3578)  loss_bbox_dn_3: 0.4115 (0.4378)  loss_giou_dn_3: 0.4105 (0.4271)  loss_class_dn_4: 0.4182 (0.3564)  loss_bbox_dn_4: 0.4103 (0.4370)  loss_giou_dn_4: 0.4086 (0.4264)  loss_class_hybrid: 0.7758 (0.6894)  loss_bbox_hybrid: 0.1947 (0.2894)  loss_giou_hybrid: 0.2327 (0.3753)  loss_class_0_hybrid: 0.9023 (0.7591)  loss_bbox_0_hybrid: 0.2885 (0.3084)  loss_giou_0_hybrid: 0.2726 (0.4046)  loss_class_1_hybrid: 0.8494 (0.7018)  loss_bbox_1_hybrid: 0.1724 (0.2963)  loss_giou_1_hybrid: 0.2683 (0.3851)  loss_class_2_hybrid: 0.7502 (0.6961)  loss_bbox_2_hybrid: 0.1971 (0.2907)  loss_giou_2_hybrid: 0.2456 (0.3786)  loss_class_3_hybrid: 0.8225 (0.6882)  loss_bbox_3_hybrid: 0.1966 (0.2919)  loss_giou_3_hybrid: 0.2505 (0.3769)  loss_class_4_hybrid: 0.7765 (0.6879)  loss_bbox_4_hybrid: 0.1919 (0.2908)  loss_giou_4_hybrid: 0.2415 (0.3765)  loss_class_enc_hybrid: 0.9633 (0.8817)  loss_bbox_enc_hybrid: 0.3168 (0.3527)  loss_giou_enc_hybrid: 0.4551 (0.4736)
[2025-05-20 03:07:42 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 03:07:42 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\pytorch_model.bin
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\optimizer.bin
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\scheduler.bin
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\sampler.bin
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\sampler_1.bin
[2025-05-20 03:07:43 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_27\random_states_0.pkl
[2025-05-20 03:07:43 det.__main__] INFO: Start evaluation
[2025-05-20 03:07:43 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0040)  time: 0.1999  data: 0.0269  mem: 727  max mem: 19988
[2025-05-20 03:07:45 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1698 (0.1696)  evaluator_time: 0.0030 (0.0035)  time: 0.1761  data: 0.0028  mem: 727  max mem: 19988
[2025-05-20 03:07:47 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:07:48 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1687 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:07:50 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0030)  time: 0.1727  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:07:52 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:07:54 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:07:55 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1692 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 03:07:57 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 03:07:59 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1728  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:00 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:02 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:04 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:08:06 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1696 (0.1693)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:07 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:09 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:08:11 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1691 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:13 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1696 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:14 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:16 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1693)  evaluator_time: 0.0031 (0.0032)  time: 0.1733  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:18 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1694 (0.1693)  evaluator_time: 0.0040 (0.0032)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:20 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1682 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:08:21 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:23 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1676 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0003  mem: 727  max mem: 19988
[2025-05-20 03:08:25 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:26 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1676 (0.1690)  evaluator_time: 0.0025 (0.0032)  time: 0.1714  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:28 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1676 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1715  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:30 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:32 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0003  mem: 727  max mem: 19988
[2025-05-20 03:08:33 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:35 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:37 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:08:38 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:40 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:42 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:44 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1676 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 03:08:45 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:47 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1719  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:49 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:51 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1687)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:52 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1697 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1748  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:54 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1702 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 03:08:56 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 03:08:57 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1695 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:08:59 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 03:09:01 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1749  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 03:09:02 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 03:09:02 det.util.engine] INFO: Averaged stats: model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 03:09:03 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.693
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.201
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.556

[2025-05-20 03:09:03 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2859  | 0.706  | 0.360 |
| Crescent_gap  | 48   | 48  | 6952  | 1.000  | 0.914 |
| Inclusion     | 41   | 82  | 9664  | 0.866  | 0.373 |
| Oil_spot      | 58   | 125 | 13787 | 0.920  | 0.699 |
| Punching      | 74   | 74  | 1854  | 0.986  | 0.930 |
| Rolled_pit    | 10   | 25  | 2253  | 0.800  | 0.396 |
| Silk_spot     | 134  | 150 | 59864 | 0.953  | 0.644 |
| Waist_folding | 24   | 26  | 8969  | 0.923  | 0.789 |
| Water_spot    | 68   | 78  | 22363 | 0.974  | 0.858 |
| Welding_line  | 99   | 99  | 8758  | 1.000  | 0.968 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.913  | 0.693 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 03:09:03 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:09:03 det.util.engine] INFO: Epoch: [28]  [0/1834]  eta: 0:17:46  lr: 0.000010  data_time: 0.0006  iter_time: 0.5813  loss: 25.2223 (25.2223)  loss_class: 0.8120 (0.8120)  loss_bbox: 0.1126 (0.1126)  loss_giou: 0.2695 (0.2695)  loss_class_0: 0.8045 (0.8045)  loss_bbox_0: 0.3218 (0.3218)  loss_giou_0: 0.4258 (0.4258)  loss_class_1: 0.9503 (0.9503)  loss_bbox_1: 0.1426 (0.1426)  loss_giou_1: 0.3129 (0.3129)  loss_class_2: 0.8571 (0.8571)  loss_bbox_2: 0.1184 (0.1184)  loss_giou_2: 0.2832 (0.2832)  loss_class_3: 0.8108 (0.8108)  loss_bbox_3: 0.1107 (0.1107)  loss_giou_3: 0.2662 (0.2662)  loss_class_4: 0.8440 (0.8440)  loss_bbox_4: 0.1128 (0.1128)  loss_giou_4: 0.2713 (0.2713)  loss_class_enc: 1.5376 (1.5376)  loss_bbox_enc: 0.3124 (0.3124)  loss_giou_enc: 0.4211 (0.4211)  loss_class_dn: 0.3655 (0.3655)  loss_bbox_dn: 0.2225 (0.2225)  loss_giou_dn: 0.2483 (0.2483)  loss_class_dn_0: 0.5114 (0.5114)  loss_bbox_dn_0: 0.4819 (0.4819)  loss_giou_dn_0: 0.4244 (0.4244)  loss_class_dn_1: 0.4569 (0.4569)  loss_bbox_dn_1: 0.3101 (0.3101)  loss_giou_dn_1: 0.3394 (0.3394)  loss_class_dn_2: 0.3890 (0.3890)  loss_bbox_dn_2: 0.2390 (0.2390)  loss_giou_dn_2: 0.2651 (0.2651)  loss_class_dn_3: 0.3711 (0.3711)  loss_bbox_dn_3: 0.2239 (0.2239)  loss_giou_dn_3: 0.2494 (0.2494)  loss_class_dn_4: 0.3691 (0.3691)  loss_bbox_dn_4: 0.2244 (0.2244)  loss_giou_dn_4: 0.2514 (0.2514)  loss_class_hybrid: 0.7596 (0.7596)  loss_bbox_hybrid: 0.1232 (0.1232)  loss_giou_hybrid: 0.2632 (0.2632)  loss_class_0_hybrid: 0.9386 (0.9386)  loss_bbox_0_hybrid: 0.1549 (0.1549)  loss_giou_0_hybrid: 0.2881 (0.2881)  loss_class_1_hybrid: 0.8547 (0.8547)  loss_bbox_1_hybrid: 0.1273 (0.1273)  loss_giou_1_hybrid: 0.2708 (0.2708)  loss_class_2_hybrid: 0.7997 (0.7997)  loss_bbox_2_hybrid: 0.1271 (0.1271)  loss_giou_2_hybrid: 0.2555 (0.2555)  loss_class_3_hybrid: 0.8063 (0.8063)  loss_bbox_3_hybrid: 0.1249 (0.1249)  loss_giou_3_hybrid: 0.2535 (0.2535)  loss_class_4_hybrid: 0.7736 (0.7736)  loss_bbox_4_hybrid: 0.1242 (0.1242)  loss_giou_4_hybrid: 0.2632 (0.2632)  loss_class_enc_hybrid: 1.1800 (1.1800)  loss_bbox_enc_hybrid: 0.3089 (0.3089)  loss_giou_enc_hybrid: 0.3846 (0.3846)  mem: 734  max mem: 19988
[2025-05-20 03:09:03 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:26:21 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5818  loss: 23.2887 (27.4911)  loss_class: 0.4141 (0.6479)  loss_bbox: 0.1925 (0.2953)  loss_giou: 0.3510 (0.3716)  loss_class_0: 0.6621 (0.7808)  loss_bbox_0: 0.1617 (0.3085)  loss_giou_0: 0.3554 (0.3959)  loss_class_1: 0.5147 (0.7186)  loss_bbox_1: 0.1519 (0.2897)  loss_giou_1: 0.3082 (0.3729)  loss_class_2: 0.4610 (0.6833)  loss_bbox_2: 0.1555 (0.2849)  loss_giou_2: 0.3037 (0.3686)  loss_class_3: 0.4358 (0.6616)  loss_bbox_3: 0.1483 (0.2902)  loss_giou_3: 0.3413 (0.3699)  loss_class_4: 0.4315 (0.6503)  loss_bbox_4: 0.1511 (0.2927)  loss_giou_4: 0.3501 (0.3703)  loss_class_enc: 1.1702 (1.1201)  loss_bbox_enc: 0.1859 (0.2996)  loss_giou_enc: 0.4391 (0.4050)  loss_class_dn: 0.3790 (0.3519)  loss_bbox_dn: 0.1404 (0.4354)  loss_giou_dn: 0.3438 (0.4209)  loss_class_dn_0: 0.4634 (0.4114)  loss_bbox_dn_0: 0.2927 (0.5390)  loss_giou_dn_0: 0.5008 (0.5410)  loss_class_dn_1: 0.4247 (0.3797)  loss_bbox_dn_1: 0.2153 (0.4561)  loss_giou_dn_1: 0.3722 (0.4436)  loss_class_dn_2: 0.3832 (0.3569)  loss_bbox_dn_2: 0.1597 (0.4429)  loss_giou_dn_2: 0.3441 (0.4274)  loss_class_dn_3: 0.3865 (0.3540)  loss_bbox_dn_3: 0.1552 (0.4372)  loss_giou_dn_3: 0.3430 (0.4222)  loss_class_dn_4: 0.3778 (0.3530)  loss_bbox_dn_4: 0.1515 (0.4365)  loss_giou_dn_4: 0.3429 (0.4216)  loss_class_hybrid: 0.4987 (0.6926)  loss_bbox_hybrid: 0.2122 (0.2842)  loss_giou_hybrid: 0.3503 (0.3678)  loss_class_0_hybrid: 0.6349 (0.7454)  loss_bbox_0_hybrid: 0.2040 (0.3037)  loss_giou_0_hybrid: 0.3435 (0.3946)  loss_class_1_hybrid: 0.5329 (0.7017)  loss_bbox_1_hybrid: 0.1862 (0.2903)  loss_giou_1_hybrid: 0.3366 (0.3776)  loss_class_2_hybrid: 0.5272 (0.6961)  loss_bbox_2_hybrid: 0.2086 (0.2852)  loss_giou_2_hybrid: 0.3434 (0.3710)  loss_class_3_hybrid: 0.4937 (0.6899)  loss_bbox_3_hybrid: 0.2320 (0.2867)  loss_giou_3_hybrid: 0.3422 (0.3699)  loss_class_4_hybrid: 0.4863 (0.6897)  loss_bbox_4_hybrid: 0.2213 (0.2869)  loss_giou_4_hybrid: 0.3442 (0.3699)  loss_class_enc_hybrid: 0.8352 (0.8713)  loss_bbox_enc_hybrid: 0.2402 (0.3494)  loss_giou_enc_hybrid: 0.4094 (0.4589)
[2025-05-20 03:26:21 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 03:26:22 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\pytorch_model.bin
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\optimizer.bin
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\scheduler.bin
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\sampler.bin
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\sampler_1.bin
[2025-05-20 03:26:22 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_28\random_states_0.pkl
[2025-05-20 03:26:22 det.__main__] INFO: Start evaluation
[2025-05-20 03:26:22 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1670 (0.1670)  evaluator_time: 0.0030 (0.0030)  time: 0.1920  data: 0.0220  mem: 729  max mem: 19988
[2025-05-20 03:26:24 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1679 (0.1677)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0025  mem: 729  max mem: 19988
[2025-05-20 03:26:26 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1674 (0.1677)  evaluator_time: 0.0030 (0.0031)  time: 0.1715  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 03:26:27 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1710  data: 0.0003  mem: 729  max mem: 19988
[2025-05-20 03:26:29 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1677 (0.1676)  evaluator_time: 0.0030 (0.0029)  time: 0.1711  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:31 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1677 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:32 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0030)  time: 0.1713  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:34 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1671 (0.1676)  evaluator_time: 0.0030 (0.0029)  time: 0.1712  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:36 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1673 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 03:26:38 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1675 (0.1675)  evaluator_time: 0.0030 (0.0030)  time: 0.1713  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:39 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1673 (0.1675)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:41 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1673 (0.1676)  evaluator_time: 0.0030 (0.0031)  time: 0.1718  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:43 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:57  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:44 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1671 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1713  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:46 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1673 (0.1675)  evaluator_time: 0.0037 (0.0031)  time: 0.1719  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:48 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1670 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1720  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:50 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1680 (0.1675)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 03:26:51 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1686 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:53 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1690 (0.1678)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:26:55 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1694 (0.1678)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:57 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1694 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:26:58 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1695 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:00 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1696 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0003  mem: 729  max mem: 19988
[2025-05-20 03:27:02 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1704 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1748  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 03:27:04 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1700 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1740  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:05 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1700 (0.1684)  evaluator_time: 0.0020 (0.0032)  time: 0.1735  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 03:27:07 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1700 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:09 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1695 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0003  mem: 729  max mem: 19988
[2025-05-20 03:27:10 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1694 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:12 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1701 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:14 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1702 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1742  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 03:27:16 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1697 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:17 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 03:27:19 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1695 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:21 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1696 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:23 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:24 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1740  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:26 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1692 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:28 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 03:27:30 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1747  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:31 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1748  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:33 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:35 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1694 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 03:27:37 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1693 (0.1689)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 03:27:38 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1742  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 03:27:40 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 03:27:41 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1697 (0.1690)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 03:27:41 det.util.engine] INFO: Averaged stats: model_time: 0.1697 (0.1690)  evaluator_time: 0.0030 (0.0032)
[2025-05-20 03:27:42 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.693
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.056
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.186
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.377
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.564

[2025-05-20 03:27:42 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2432  | 0.647  | 0.307 |
| Crescent_gap  | 48   | 48  | 6184  | 1.000  | 0.915 |
| Inclusion     | 41   | 82  | 6501  | 0.854  | 0.388 |
| Oil_spot      | 58   | 125 | 13868 | 0.928  | 0.704 |
| Punching      | 74   | 74  | 1818  | 1.000  | 0.960 |
| Rolled_pit    | 10   | 25  | 2650  | 0.920  | 0.482 |
| Silk_spot     | 134  | 150 | 73010 | 0.947  | 0.633 |
| Waist_folding | 24   | 26  | 7424  | 0.962  | 0.749 |
| Water_spot    | 68   | 78  | 13632 | 0.974  | 0.826 |
| Welding_line  | 99   | 99  | 9669  | 1.000  | 0.967 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.923  | 0.693 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 03:27:42 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:27:43 det.util.engine] INFO: Epoch: [29]  [0/1834]  eta: 0:16:34  lr: 0.000010  data_time: 0.0008  iter_time: 0.5421  loss: 28.8610 (28.8610)  loss_class: 0.4978 (0.4978)  loss_bbox: 0.4364 (0.4364)  loss_giou: 0.5622 (0.5622)  loss_class_0: 0.4466 (0.4466)  loss_bbox_0: 0.3590 (0.3590)  loss_giou_0: 0.4505 (0.4505)  loss_class_1: 0.4708 (0.4708)  loss_bbox_1: 0.4030 (0.4030)  loss_giou_1: 0.5197 (0.5197)  loss_class_2: 0.4604 (0.4604)  loss_bbox_2: 0.4058 (0.4058)  loss_giou_2: 0.5390 (0.5390)  loss_class_3: 0.4691 (0.4691)  loss_bbox_3: 0.4359 (0.4359)  loss_giou_3: 0.5514 (0.5514)  loss_class_4: 0.4853 (0.4853)  loss_bbox_4: 0.4393 (0.4393)  loss_giou_4: 0.5654 (0.5654)  loss_class_enc: 0.8921 (0.8921)  loss_bbox_enc: 0.1653 (0.1653)  loss_giou_enc: 0.4129 (0.4129)  loss_class_dn: 0.5009 (0.5009)  loss_bbox_dn: 0.4518 (0.4518)  loss_giou_dn: 0.5645 (0.5645)  loss_class_dn_0: 0.4823 (0.4823)  loss_bbox_dn_0: 0.4835 (0.4835)  loss_giou_dn_0: 0.5901 (0.5901)  loss_class_dn_1: 0.5920 (0.5920)  loss_bbox_dn_1: 0.4604 (0.4604)  loss_giou_dn_1: 0.5688 (0.5688)  loss_class_dn_2: 0.4996 (0.4996)  loss_bbox_dn_2: 0.4465 (0.4465)  loss_giou_dn_2: 0.5581 (0.5581)  loss_class_dn_3: 0.4863 (0.4863)  loss_bbox_dn_3: 0.4531 (0.4531)  loss_giou_dn_3: 0.5527 (0.5527)  loss_class_dn_4: 0.4942 (0.4942)  loss_bbox_dn_4: 0.4545 (0.4545)  loss_giou_dn_4: 0.5671 (0.5671)  loss_class_hybrid: 0.5144 (0.5144)  loss_bbox_hybrid: 0.4484 (0.4484)  loss_giou_hybrid: 0.5582 (0.5582)  loss_class_0_hybrid: 0.4335 (0.4335)  loss_bbox_0_hybrid: 0.3585 (0.3585)  loss_giou_0_hybrid: 0.4326 (0.4326)  loss_class_1_hybrid: 0.4936 (0.4936)  loss_bbox_1_hybrid: 0.4217 (0.4217)  loss_giou_1_hybrid: 0.5115 (0.5115)  loss_class_2_hybrid: 0.4641 (0.4641)  loss_bbox_2_hybrid: 0.4264 (0.4264)  loss_giou_2_hybrid: 0.5356 (0.5356)  loss_class_3_hybrid: 0.4707 (0.4707)  loss_bbox_3_hybrid: 0.4485 (0.4485)  loss_giou_3_hybrid: 0.5425 (0.5425)  loss_class_4_hybrid: 0.4979 (0.4979)  loss_bbox_4_hybrid: 0.4527 (0.4527)  loss_giou_4_hybrid: 0.5627 (0.5627)  loss_class_enc_hybrid: 0.6452 (0.6452)  loss_bbox_enc_hybrid: 0.1385 (0.1385)  loss_giou_enc_hybrid: 0.3294 (0.3294)  mem: 734  max mem: 19988
[2025-05-20 03:27:43 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:44:56 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5765  loss: 33.3522 (27.5429)  loss_class: 0.5382 (0.6334)  loss_bbox: 0.2691 (0.3054)  loss_giou: 0.2855 (0.3821)  loss_class_0: 0.7647 (0.7795)  loss_bbox_0: 0.3812 (0.3104)  loss_giou_0: 0.3423 (0.3981)  loss_class_1: 0.6092 (0.6857)  loss_bbox_1: 0.2777 (0.3053)  loss_giou_1: 0.3243 (0.3843)  loss_class_2: 0.6492 (0.6504)  loss_bbox_2: 0.2572 (0.3037)  loss_giou_2: 0.2975 (0.3825)  loss_class_3: 0.5224 (0.6405)  loss_bbox_3: 0.2586 (0.3009)  loss_giou_3: 0.3038 (0.3803)  loss_class_4: 0.5435 (0.6404)  loss_bbox_4: 0.2736 (0.3010)  loss_giou_4: 0.2886 (0.3793)  loss_class_enc: 1.4417 (1.1375)  loss_bbox_enc: 0.3048 (0.2900)  loss_giou_enc: 0.3571 (0.4054)  loss_class_dn: 0.4263 (0.3550)  loss_bbox_dn: 0.4367 (0.4293)  loss_giou_dn: 0.4277 (0.4206)  loss_class_dn_0: 0.4725 (0.4166)  loss_bbox_dn_0: 0.5849 (0.5301)  loss_giou_dn_0: 0.5792 (0.5373)  loss_class_dn_1: 0.4501 (0.3832)  loss_bbox_dn_1: 0.3867 (0.4503)  loss_giou_dn_1: 0.4551 (0.4422)  loss_class_dn_2: 0.4283 (0.3608)  loss_bbox_dn_2: 0.4065 (0.4380)  loss_giou_dn_2: 0.4509 (0.4265)  loss_class_dn_3: 0.4373 (0.3582)  loss_bbox_dn_3: 0.4180 (0.4314)  loss_giou_dn_3: 0.4194 (0.4215)  loss_class_dn_4: 0.4188 (0.3564)  loss_bbox_dn_4: 0.4390 (0.4306)  loss_giou_dn_4: 0.4257 (0.4207)  loss_class_hybrid: 0.6200 (0.6891)  loss_bbox_hybrid: 0.2740 (0.2939)  loss_giou_hybrid: 0.3462 (0.3721)  loss_class_0_hybrid: 0.7042 (0.7403)  loss_bbox_0_hybrid: 0.3726 (0.3105)  loss_giou_0_hybrid: 0.3607 (0.3994)  loss_class_1_hybrid: 0.6316 (0.6885)  loss_bbox_1_hybrid: 0.3313 (0.3028)  loss_giou_1_hybrid: 0.2959 (0.3834)  loss_class_2_hybrid: 0.6690 (0.6857)  loss_bbox_2_hybrid: 0.2951 (0.2982)  loss_giou_2_hybrid: 0.3287 (0.3773)  loss_class_3_hybrid: 0.6488 (0.6829)  loss_bbox_3_hybrid: 0.2732 (0.2982)  loss_giou_3_hybrid: 0.3429 (0.3753)  loss_class_4_hybrid: 0.6436 (0.6862)  loss_bbox_4_hybrid: 0.2751 (0.2963)  loss_giou_4_hybrid: 0.3447 (0.3737)  loss_class_enc_hybrid: 0.8480 (0.8781)  loss_bbox_enc_hybrid: 0.4335 (0.3468)  loss_giou_enc_hybrid: 0.5168 (0.4593)
[2025-05-20 03:44:56 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 03:44:56 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\pytorch_model.bin
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\optimizer.bin
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\scheduler.bin
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\sampler.bin
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\sampler_1.bin
[2025-05-20 03:44:57 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_29\random_states_0.pkl
[2025-05-20 03:44:57 det.__main__] INFO: Start evaluation
[2025-05-20 03:44:57 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1672 (0.1672)  evaluator_time: 0.0030 (0.0030)  time: 0.2002  data: 0.0300  mem: 726  max mem: 19988
[2025-05-20 03:44:59 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0035)  time: 0.1756  data: 0.0032  mem: 726  max mem: 19988
[2025-05-20 03:45:01 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:02 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1700 (0.1694)  evaluator_time: 0.0030 (0.0030)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:04 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1696 (0.1693)  evaluator_time: 0.0030 (0.0030)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:06 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:07 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:09 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0030)  time: 0.1728  data: 0.0004  mem: 726  max mem: 19988
[2025-05-20 03:45:11 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0003  mem: 726  max mem: 19988
[2025-05-20 03:45:13 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1696 (0.1693)  evaluator_time: 0.0030 (0.0030)  time: 0.1734  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:14 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:16 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:18 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:45:20 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:21 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0041)  time: 0.1802  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:45:23 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1693 (0.1692)  evaluator_time: 0.0030 (0.0040)  time: 0.1807  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:45:25 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1690 (0.1692)  evaluator_time: 0.0031 (0.0040)  time: 0.1738  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:27 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:28 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1725  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:30 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:32 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1736  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:34 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1734  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:35 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:45:37 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1687 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1736  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:39 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:41 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:42 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:44 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:46 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1693 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1736  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:47 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1700 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1733  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:45:49 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1692 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1732  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:45:51 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1692)  evaluator_time: 0.0020 (0.0036)  time: 0.1723  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:53 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0003  mem: 726  max mem: 19988
[2025-05-20 03:45:54 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:45:56 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1691 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1738  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 03:45:58 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1683 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:46:00 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1683 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1731  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:46:01 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1732  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:46:03 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1726  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:46:05 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1692)  evaluator_time: 0.0040 (0.0036)  time: 0.1739  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:46:07 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1739  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:46:08 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1726  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:46:10 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1681 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1725  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 03:46:12 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1729  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:46:13 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1692 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1737  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 03:46:15 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1695 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1736  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:46:16 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0035)  time: 0.1729  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 03:46:16 det.util.engine] INFO: Averaged stats: model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0035)
[2025-05-20 03:46:17 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.696
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.350
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.427
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.557

[2025-05-20 03:46:17 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3478  | 0.647  | 0.347 |
| Crescent_gap  | 48   | 48  | 7679  | 1.000  | 0.919 |
| Inclusion     | 41   | 82  | 7258  | 0.854  | 0.410 |
| Oil_spot      | 58   | 125 | 9480  | 0.928  | 0.673 |
| Punching      | 74   | 74  | 1178  | 1.000  | 0.949 |
| Rolled_pit    | 10   | 25  | 2978  | 0.840  | 0.435 |
| Silk_spot     | 134  | 150 | 70758 | 0.933  | 0.631 |
| Waist_folding | 24   | 26  | 7177  | 0.962  | 0.775 |
| Water_spot    | 68   | 78  | 19179 | 0.974  | 0.848 |
| Welding_line  | 99   | 99  | 8039  | 1.000  | 0.970 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.914  | 0.696 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 03:46:17 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 03:46:17 det.util.engine] INFO: Epoch: [30]  [0/1834]  eta: 0:11:39  lr: 0.000010  data_time: 0.0010  iter_time: 0.3814  loss: 0.0003 (0.0003)  loss_class: 0.0000 (0.0000)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0000 (0.0000)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0000 (0.0000)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0000 (0.0000)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0000 (0.0000)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0000 (0.0000)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0000 (0.0000)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0000 (0.0000)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0000 (0.0000)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0000 (0.0000)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0000 (0.0000)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0000 (0.0000)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0000 (0.0000)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0000 (0.0000)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 739  max mem: 19988
[2025-05-20 03:46:17 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:03:37 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5543  loss: 20.8132 (27.3854)  loss_class: 0.3560 (0.6165)  loss_bbox: 0.2516 (0.3011)  loss_giou: 0.2096 (0.3833)  loss_class_0: 0.4902 (0.7809)  loss_bbox_0: 0.2204 (0.3101)  loss_giou_0: 0.2276 (0.3978)  loss_class_1: 0.3906 (0.6886)  loss_bbox_1: 0.2021 (0.2948)  loss_giou_1: 0.2750 (0.3824)  loss_class_2: 0.3818 (0.6529)  loss_bbox_2: 0.2348 (0.2949)  loss_giou_2: 0.2390 (0.3810)  loss_class_3: 0.3648 (0.6283)  loss_bbox_3: 0.2925 (0.2993)  loss_giou_3: 0.2120 (0.3813)  loss_class_4: 0.3645 (0.6180)  loss_bbox_4: 0.2675 (0.3007)  loss_giou_4: 0.2073 (0.3824)  loss_class_enc: 1.1333 (1.1257)  loss_bbox_enc: 0.2410 (0.2974)  loss_giou_enc: 0.2523 (0.4128)  loss_class_dn: 0.3227 (0.3516)  loss_bbox_dn: 0.2490 (0.4235)  loss_giou_dn: 0.2284 (0.4172)  loss_class_dn_0: 0.4493 (0.4164)  loss_bbox_dn_0: 0.5268 (0.5321)  loss_giou_dn_0: 0.3754 (0.5412)  loss_class_dn_1: 0.3795 (0.3813)  loss_bbox_dn_1: 0.2950 (0.4485)  loss_giou_dn_1: 0.2683 (0.4421)  loss_class_dn_2: 0.3531 (0.3582)  loss_bbox_dn_2: 0.2706 (0.4346)  loss_giou_dn_2: 0.2858 (0.4247)  loss_class_dn_3: 0.3279 (0.3550)  loss_bbox_dn_3: 0.2553 (0.4260)  loss_giou_dn_3: 0.2267 (0.4188)  loss_class_dn_4: 0.3155 (0.3527)  loss_bbox_dn_4: 0.2459 (0.4253)  loss_giou_dn_4: 0.2236 (0.4178)  loss_class_hybrid: 0.3706 (0.6767)  loss_bbox_hybrid: 0.1987 (0.2910)  loss_giou_hybrid: 0.2031 (0.3730)  loss_class_0_hybrid: 0.4957 (0.7438)  loss_bbox_0_hybrid: 0.2442 (0.3100)  loss_giou_0_hybrid: 0.2579 (0.3999)  loss_class_1_hybrid: 0.4352 (0.6927)  loss_bbox_1_hybrid: 0.2073 (0.2975)  loss_giou_1_hybrid: 0.2566 (0.3834)  loss_class_2_hybrid: 0.3911 (0.6834)  loss_bbox_2_hybrid: 0.2015 (0.2924)  loss_giou_2_hybrid: 0.2476 (0.3769)  loss_class_3_hybrid: 0.3818 (0.6717)  loss_bbox_3_hybrid: 0.1881 (0.2949)  loss_giou_3_hybrid: 0.2069 (0.3760)  loss_class_4_hybrid: 0.3812 (0.6734)  loss_bbox_4_hybrid: 0.1857 (0.2940)  loss_giou_4_hybrid: 0.2094 (0.3750)  loss_class_enc_hybrid: 0.8378 (0.8615)  loss_bbox_enc_hybrid: 0.3204 (0.3531)  loss_giou_enc_hybrid: 0.3491 (0.4683)
[2025-05-20 04:03:37 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 04:03:37 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\pytorch_model.bin
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\optimizer.bin
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\scheduler.bin
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\sampler.bin
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\sampler_1.bin
[2025-05-20 04:03:37 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_30\random_states_0.pkl
[2025-05-20 04:03:37 det.__main__] INFO: Start evaluation
[2025-05-20 04:03:38 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1720 (0.1720)  evaluator_time: 0.0040 (0.0040)  time: 0.1950  data: 0.0190  mem: 725  max mem: 19988
[2025-05-20 04:03:39 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1697 (0.1696)  evaluator_time: 0.0040 (0.0038)  time: 0.1756  data: 0.0022  mem: 725  max mem: 19988
[2025-05-20 04:03:41 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0036)  time: 0.1737  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:03:43 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:03:45 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:03:46 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:03:48 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:03:50 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:03:52 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:03:53 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0048)  time: 0.1795  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:03:55 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0046)  time: 0.1796  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:03:57 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1688 (0.1691)  evaluator_time: 0.0030 (0.0045)  time: 0.1732  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:03:59 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1688 (0.1690)  evaluator_time: 0.0030 (0.0044)  time: 0.1728  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:00 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1682 (0.1690)  evaluator_time: 0.0030 (0.0043)  time: 0.1724  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:02 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1681 (0.1690)  evaluator_time: 0.0030 (0.0042)  time: 0.1727  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:04 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1686 (0.1690)  evaluator_time: 0.0040 (0.0042)  time: 0.1730  data: 0.0004  mem: 725  max mem: 19988
[2025-05-20 04:04:05 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1686 (0.1690)  evaluator_time: 0.0040 (0.0042)  time: 0.1735  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:07 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1681 (0.1690)  evaluator_time: 0.0030 (0.0041)  time: 0.1729  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:09 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0041)  time: 0.1723  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:11 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1686 (0.1689)  evaluator_time: 0.0040 (0.0041)  time: 0.1730  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:04:12 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0040)  time: 0.1733  data: 0.0008  mem: 725  max mem: 19988
[2025-05-20 04:04:14 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0040)  time: 0.1733  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:16 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0040)  time: 0.1737  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:18 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0040)  time: 0.1734  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:19 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0039)  time: 0.1731  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:21 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1683 (0.1689)  evaluator_time: 0.0030 (0.0039)  time: 0.1726  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:23 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0039)  time: 0.1721  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:25 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0039)  time: 0.1723  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:26 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1725  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:28 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1683 (0.1689)  evaluator_time: 0.0030 (0.0038)  time: 0.1726  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:30 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1723  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:31 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1720  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:33 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0038)  time: 0.1724  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:35 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1680 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:37 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1726  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:38 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1683 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1729  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:40 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1685 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1727  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:42 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0037)  time: 0.1722  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:43 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0037)  time: 0.1722  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:45 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1686 (0.1687)  evaluator_time: 0.0040 (0.0038)  time: 0.1740  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:47 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1686 (0.1687)  evaluator_time: 0.0040 (0.0037)  time: 0.1740  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:49 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0037)  time: 0.1722  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:50 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1682 (0.1687)  evaluator_time: 0.0030 (0.0037)  time: 0.1724  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 04:04:52 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1691 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1733  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:54 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1701 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1741  data: 0.0005  mem: 725  max mem: 19988
[2025-05-20 04:04:56 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1695 (0.1688)  evaluator_time: 0.0031 (0.0037)  time: 0.1741  data: 0.0007  mem: 725  max mem: 19988
[2025-05-20 04:04:57 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1739  data: 0.0006  mem: 724  max mem: 19988
[2025-05-20 04:04:57 det.util.engine] INFO: Averaged stats: model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 04:04:57 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.697
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.323
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.189
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.437
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.570

[2025-05-20 04:04:57 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2985  | 0.647  | 0.427 |
| Crescent_gap  | 48   | 48  | 7250  | 1.000  | 0.917 |
| Inclusion     | 41   | 82  | 9849  | 0.866  | 0.373 |
| Oil_spot      | 58   | 125 | 11590 | 0.928  | 0.688 |
| Punching      | 74   | 74  | 1883  | 0.973  | 0.931 |
| Rolled_pit    | 10   | 25  | 2465  | 0.800  | 0.443 |
| Silk_spot     | 134  | 150 | 64439 | 0.947  | 0.637 |
| Waist_folding | 24   | 26  | 8039  | 0.962  | 0.760 |
| Water_spot    | 68   | 78  | 17446 | 0.962  | 0.830 |
| Welding_line  | 99   | 99  | 11216 | 1.000  | 0.963 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.908  | 0.697 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 04:04:57 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:04:58 det.util.engine] INFO: Epoch: [31]  [0/1834]  eta: 0:18:48  lr: 0.000010  data_time: 0.0009  iter_time: 0.6152  loss: 51.9890 (51.9890)  loss_class: 1.9691 (1.9691)  loss_bbox: 0.4318 (0.4318)  loss_giou: 0.2866 (0.2866)  loss_class_0: 1.8487 (1.8487)  loss_bbox_0: 0.4450 (0.4450)  loss_giou_0: 0.3222 (0.3222)  loss_class_1: 2.0995 (2.0995)  loss_bbox_1: 0.4281 (0.4281)  loss_giou_1: 0.2925 (0.2925)  loss_class_2: 1.8935 (1.8935)  loss_bbox_2: 0.4371 (0.4371)  loss_giou_2: 0.2948 (0.2948)  loss_class_3: 1.8943 (1.8943)  loss_bbox_3: 0.4269 (0.4269)  loss_giou_3: 0.2886 (0.2886)  loss_class_4: 1.8826 (1.8826)  loss_bbox_4: 0.4327 (0.4327)  loss_giou_4: 0.2866 (0.2866)  loss_class_enc: 1.8034 (1.8034)  loss_bbox_enc: 0.7944 (0.7944)  loss_giou_enc: 0.3932 (0.3932)  loss_class_dn: 0.4468 (0.4468)  loss_bbox_dn: 1.4976 (1.4976)  loss_giou_dn: 0.6062 (0.6062)  loss_class_dn_0: 0.4733 (0.4733)  loss_bbox_dn_0: 1.6654 (1.6654)  loss_giou_dn_0: 0.7153 (0.7153)  loss_class_dn_1: 0.4466 (0.4466)  loss_bbox_dn_1: 1.6013 (1.6013)  loss_giou_dn_1: 0.6681 (0.6681)  loss_class_dn_2: 0.4365 (0.4365)  loss_bbox_dn_2: 1.5932 (1.5932)  loss_giou_dn_2: 0.6427 (0.6427)  loss_class_dn_3: 0.4454 (0.4454)  loss_bbox_dn_3: 1.5164 (1.5164)  loss_giou_dn_3: 0.6145 (0.6145)  loss_class_dn_4: 0.4462 (0.4462)  loss_bbox_dn_4: 1.5144 (1.5144)  loss_giou_dn_4: 0.6130 (0.6130)  loss_class_hybrid: 1.7211 (1.7211)  loss_bbox_hybrid: 0.4883 (0.4883)  loss_giou_hybrid: 0.2873 (0.2873)  loss_class_0_hybrid: 1.4390 (1.4390)  loss_bbox_0_hybrid: 0.6493 (0.6493)  loss_giou_0_hybrid: 0.3092 (0.3092)  loss_class_1_hybrid: 1.5783 (1.5783)  loss_bbox_1_hybrid: 0.5597 (0.5597)  loss_giou_1_hybrid: 0.3225 (0.3225)  loss_class_2_hybrid: 1.5281 (1.5281)  loss_bbox_2_hybrid: 0.5427 (0.5427)  loss_giou_2_hybrid: 0.3203 (0.3203)  loss_class_3_hybrid: 1.5695 (1.5695)  loss_bbox_3_hybrid: 0.5616 (0.5616)  loss_giou_3_hybrid: 0.3247 (0.3247)  loss_class_4_hybrid: 1.6988 (1.6988)  loss_bbox_4_hybrid: 0.4893 (0.4893)  loss_giou_4_hybrid: 0.2864 (0.2864)  loss_class_enc_hybrid: 1.7436 (1.7436)  loss_bbox_enc_hybrid: 0.4464 (0.4464)  loss_giou_enc_hybrid: 0.2285 (0.2285)  mem: 736  max mem: 19988
[2025-05-20 04:04:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:22:15 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5814  loss: 24.5200 (26.9331)  loss_class: 0.3744 (0.6101)  loss_bbox: 0.1894 (0.2935)  loss_giou: 0.3166 (0.3715)  loss_class_0: 0.6213 (0.7706)  loss_bbox_0: 0.2749 (0.3014)  loss_giou_0: 0.3611 (0.3862)  loss_class_1: 0.5060 (0.6780)  loss_bbox_1: 0.2285 (0.2872)  loss_giou_1: 0.3179 (0.3744)  loss_class_2: 0.4116 (0.6401)  loss_bbox_2: 0.2162 (0.2897)  loss_giou_2: 0.2998 (0.3724)  loss_class_3: 0.3828 (0.6193)  loss_bbox_3: 0.2435 (0.2936)  loss_giou_3: 0.3039 (0.3717)  loss_class_4: 0.3713 (0.6148)  loss_bbox_4: 0.2457 (0.2923)  loss_giou_4: 0.3055 (0.3712)  loss_class_enc: 1.1507 (1.1026)  loss_bbox_enc: 0.2636 (0.2924)  loss_giou_enc: 0.3351 (0.4036)  loss_class_dn: 0.3626 (0.3487)  loss_bbox_dn: 0.2759 (0.4178)  loss_giou_dn: 0.3144 (0.4148)  loss_class_dn_0: 0.4665 (0.4122)  loss_bbox_dn_0: 0.4465 (0.5244)  loss_giou_dn_0: 0.4782 (0.5320)  loss_class_dn_1: 0.4245 (0.3781)  loss_bbox_dn_1: 0.3077 (0.4432)  loss_giou_dn_1: 0.3401 (0.4368)  loss_class_dn_2: 0.3804 (0.3550)  loss_bbox_dn_2: 0.2801 (0.4291)  loss_giou_dn_2: 0.3126 (0.4218)  loss_class_dn_3: 0.3655 (0.3519)  loss_bbox_dn_3: 0.2782 (0.4200)  loss_giou_dn_3: 0.3147 (0.4158)  loss_class_dn_4: 0.3626 (0.3499)  loss_bbox_dn_4: 0.2783 (0.4189)  loss_giou_dn_4: 0.3132 (0.4152)  loss_class_hybrid: 0.4664 (0.6619)  loss_bbox_hybrid: 0.1946 (0.2877)  loss_giou_hybrid: 0.2886 (0.3680)  loss_class_0_hybrid: 0.5966 (0.7255)  loss_bbox_0_hybrid: 0.2309 (0.3054)  loss_giou_0_hybrid: 0.3462 (0.3927)  loss_class_1_hybrid: 0.4934 (0.6744)  loss_bbox_1_hybrid: 0.2054 (0.2957)  loss_giou_1_hybrid: 0.3207 (0.3780)  loss_class_2_hybrid: 0.4812 (0.6627)  loss_bbox_2_hybrid: 0.2014 (0.2921)  loss_giou_2_hybrid: 0.2881 (0.3728)  loss_class_3_hybrid: 0.4690 (0.6598)  loss_bbox_3_hybrid: 0.2016 (0.2912)  loss_giou_3_hybrid: 0.2908 (0.3704)  loss_class_4_hybrid: 0.4781 (0.6596)  loss_bbox_4_hybrid: 0.1946 (0.2889)  loss_giou_4_hybrid: 0.2897 (0.3688)  loss_class_enc_hybrid: 0.8691 (0.8570)  loss_bbox_enc_hybrid: 0.3861 (0.3446)  loss_giou_enc_hybrid: 0.3868 (0.4535)
[2025-05-20 04:22:15 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 04:22:15 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\pytorch_model.bin
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\optimizer.bin
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\scheduler.bin
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\sampler.bin
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\sampler_1.bin
[2025-05-20 04:22:15 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_31\random_states_0.pkl
[2025-05-20 04:22:15 det.__main__] INFO: Start evaluation
[2025-05-20 04:22:16 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1910  data: 0.0200  mem: 730  max mem: 19988
[2025-05-20 04:22:17 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1682 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0022  mem: 730  max mem: 19988
[2025-05-20 04:22:19 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1681 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:21 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1677 (0.1682)  evaluator_time: 0.0030 (0.0029)  time: 0.1715  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:23 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1670 (0.1679)  evaluator_time: 0.0030 (0.0029)  time: 0.1708  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:24 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1670 (0.1679)  evaluator_time: 0.0030 (0.0030)  time: 0.1714  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 04:22:26 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1675 (0.1678)  evaluator_time: 0.0030 (0.0029)  time: 0.1717  data: 0.0009  mem: 730  max mem: 19988
[2025-05-20 04:22:28 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0029)  time: 0.1716  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:22:29 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:04  model_time: 0.1680 (0.1678)  evaluator_time: 0.0030 (0.0030)  time: 0.1716  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:31 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1676 (0.1678)  evaluator_time: 0.0030 (0.0029)  time: 0.1715  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:33 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1676 (0.1678)  evaluator_time: 0.0030 (0.0030)  time: 0.1717  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:35 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1671 (0.1677)  evaluator_time: 0.0030 (0.0030)  time: 0.1716  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:36 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1670 (0.1677)  evaluator_time: 0.0030 (0.0030)  time: 0.1711  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:38 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:40 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1675 (0.1677)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:22:41 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1676 (0.1677)  evaluator_time: 0.0040 (0.0032)  time: 0.1724  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:22:43 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1677 (0.1677)  evaluator_time: 0.0030 (0.0032)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:45 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1715  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:47 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1670 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1709  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:48 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1676)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:50 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1684 (0.1677)  evaluator_time: 0.0030 (0.0032)  time: 0.1724  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:22:52 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1678)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:53 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1690 (0.1678)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:22:55 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:22:57 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1679)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:22:59 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1685 (0.1680)  evaluator_time: 0.0020 (0.0032)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:00 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1686 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:02 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:04 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1691 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:06 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1691 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:07 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1686 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:09 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1684 (0.1682)  evaluator_time: 0.0020 (0.0031)  time: 0.1723  data: 0.0009  mem: 730  max mem: 19988
[2025-05-20 04:23:11 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:13 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1734  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:14 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:16 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1682 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:18 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1727  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:19 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1685 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:21 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:23 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1683)  evaluator_time: 0.0040 (0.0032)  time: 0.1743  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:25 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1681 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:26 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:28 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:30 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:32 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:23:33 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:23:35 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:23:35 det.util.engine] INFO: Averaged stats: model_time: 0.1687 (0.1684)  evaluator_time: 0.0030 (0.0032)
[2025-05-20 04:23:35 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.690
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554

[2025-05-20 04:23:35 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3574  | 0.588  | 0.335 |
| Crescent_gap  | 48   | 48  | 7361  | 1.000  | 0.925 |
| Inclusion     | 41   | 82  | 7168  | 0.829  | 0.416 |
| Oil_spot      | 58   | 125 | 10788 | 0.944  | 0.700 |
| Punching      | 74   | 74  | 1221  | 0.986  | 0.950 |
| Rolled_pit    | 10   | 25  | 3094  | 0.880  | 0.412 |
| Silk_spot     | 134  | 150 | 75174 | 0.927  | 0.635 |
| Waist_folding | 24   | 26  | 7980  | 0.962  | 0.740 |
| Water_spot    | 68   | 78  | 13325 | 0.974  | 0.827 |
| Welding_line  | 99   | 99  | 7546  | 1.000  | 0.957 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.909  | 0.690 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 04:23:35 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:23:35 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 04:23:36 det.util.engine] INFO: Epoch: [32]  [0/1834]  eta: 0:17:54  lr: 0.000010  data_time: 0.0005  iter_time: 0.5861  loss: 19.7560 (19.7560)  loss_class: 0.2520 (0.2520)  loss_bbox: 0.3575 (0.3575)  loss_giou: 0.1175 (0.1175)  loss_class_0: 0.6694 (0.6694)  loss_bbox_0: 0.4127 (0.4127)  loss_giou_0: 0.1320 (0.1320)  loss_class_1: 0.3273 (0.3273)  loss_bbox_1: 0.3528 (0.3528)  loss_giou_1: 0.1260 (0.1260)  loss_class_2: 0.3002 (0.3002)  loss_bbox_2: 0.3472 (0.3472)  loss_giou_2: 0.1086 (0.1086)  loss_class_3: 0.2978 (0.2978)  loss_bbox_3: 0.3324 (0.3324)  loss_giou_3: 0.1147 (0.1147)  loss_class_4: 0.2613 (0.2613)  loss_bbox_4: 0.3561 (0.3561)  loss_giou_4: 0.1113 (0.1113)  loss_class_enc: 1.3749 (1.3749)  loss_bbox_enc: 0.3975 (0.3975)  loss_giou_enc: 0.1343 (0.1343)  loss_class_dn: 0.2727 (0.2727)  loss_bbox_dn: 0.3816 (0.3816)  loss_giou_dn: 0.1265 (0.1265)  loss_class_dn_0: 0.5213 (0.5213)  loss_bbox_dn_0: 0.8384 (0.8384)  loss_giou_dn_0: 0.2969 (0.2969)  loss_class_dn_1: 0.3971 (0.3971)  loss_bbox_dn_1: 0.4906 (0.4906)  loss_giou_dn_1: 0.1721 (0.1721)  loss_class_dn_2: 0.2906 (0.2906)  loss_bbox_dn_2: 0.3690 (0.3690)  loss_giou_dn_2: 0.1175 (0.1175)  loss_class_dn_3: 0.2808 (0.2808)  loss_bbox_dn_3: 0.3716 (0.3716)  loss_giou_dn_3: 0.1261 (0.1261)  loss_class_dn_4: 0.2712 (0.2712)  loss_bbox_dn_4: 0.3814 (0.3814)  loss_giou_dn_4: 0.1228 (0.1228)  loss_class_hybrid: 0.2495 (0.2495)  loss_bbox_hybrid: 0.3344 (0.3344)  loss_giou_hybrid: 0.1092 (0.1092)  loss_class_0_hybrid: 0.7885 (0.7885)  loss_bbox_0_hybrid: 0.4137 (0.4137)  loss_giou_0_hybrid: 0.1455 (0.1455)  loss_class_1_hybrid: 0.3817 (0.3817)  loss_bbox_1_hybrid: 0.3699 (0.3699)  loss_giou_1_hybrid: 0.1263 (0.1263)  loss_class_2_hybrid: 0.2932 (0.2932)  loss_bbox_2_hybrid: 0.3427 (0.3427)  loss_giou_2_hybrid: 0.1061 (0.1061)  loss_class_3_hybrid: 0.2766 (0.2766)  loss_bbox_3_hybrid: 0.3220 (0.3220)  loss_giou_3_hybrid: 0.1116 (0.1116)  loss_class_4_hybrid: 0.2623 (0.2623)  loss_bbox_4_hybrid: 0.3368 (0.3368)  loss_giou_4_hybrid: 0.1073 (0.1073)  loss_class_enc_hybrid: 1.1095 (1.1095)  loss_bbox_enc_hybrid: 0.6000 (0.6000)  loss_giou_enc_hybrid: 0.2575 (0.2575)  mem: 740  max mem: 19988
[2025-05-20 04:23:36 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:40:57 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5591  loss: 23.8811 (27.0438)  loss_class: 0.4012 (0.6187)  loss_bbox: 0.2161 (0.2989)  loss_giou: 0.4180 (0.3683)  loss_class_0: 0.7779 (0.7715)  loss_bbox_0: 0.2407 (0.3073)  loss_giou_0: 0.4097 (0.3876)  loss_class_1: 0.5191 (0.6848)  loss_bbox_1: 0.1984 (0.2958)  loss_giou_1: 0.4237 (0.3691)  loss_class_2: 0.4867 (0.6424)  loss_bbox_2: 0.2048 (0.2977)  loss_giou_2: 0.4139 (0.3696)  loss_class_3: 0.4751 (0.6268)  loss_bbox_3: 0.2068 (0.2958)  loss_giou_3: 0.4232 (0.3681)  loss_class_4: 0.4116 (0.6227)  loss_bbox_4: 0.2148 (0.2973)  loss_giou_4: 0.4140 (0.3673)  loss_class_enc: 1.0474 (1.1150)  loss_bbox_enc: 0.2436 (0.2958)  loss_giou_enc: 0.4490 (0.3998)  loss_class_dn: 0.3937 (0.3525)  loss_bbox_dn: 0.2016 (0.4158)  loss_giou_dn: 0.3930 (0.4099)  loss_class_dn_0: 0.4618 (0.4147)  loss_bbox_dn_0: 0.4316 (0.5222)  loss_giou_dn_0: 0.5828 (0.5285)  loss_class_dn_1: 0.4458 (0.3818)  loss_bbox_dn_1: 0.2640 (0.4411)  loss_giou_dn_1: 0.4558 (0.4328)  loss_class_dn_2: 0.4220 (0.3580)  loss_bbox_dn_2: 0.2343 (0.4271)  loss_giou_dn_2: 0.4378 (0.4170)  loss_class_dn_3: 0.4123 (0.3553)  loss_bbox_dn_3: 0.2301 (0.4175)  loss_giou_dn_3: 0.4182 (0.4112)  loss_class_dn_4: 0.4042 (0.3539)  loss_bbox_dn_4: 0.2287 (0.4166)  loss_giou_dn_4: 0.3928 (0.4105)  loss_class_hybrid: 0.5389 (0.6750)  loss_bbox_hybrid: 0.2096 (0.2901)  loss_giou_hybrid: 0.3969 (0.3639)  loss_class_0_hybrid: 0.6212 (0.7321)  loss_bbox_0_hybrid: 0.1998 (0.3104)  loss_giou_0_hybrid: 0.4037 (0.3916)  loss_class_1_hybrid: 0.5543 (0.6844)  loss_bbox_1_hybrid: 0.2050 (0.2964)  loss_giou_1_hybrid: 0.4056 (0.3735)  loss_class_2_hybrid: 0.5309 (0.6773)  loss_bbox_2_hybrid: 0.2111 (0.2926)  loss_giou_2_hybrid: 0.4275 (0.3681)  loss_class_3_hybrid: 0.5183 (0.6751)  loss_bbox_3_hybrid: 0.2145 (0.2919)  loss_giou_3_hybrid: 0.3941 (0.3655)  loss_class_4_hybrid: 0.5325 (0.6722)  loss_bbox_4_hybrid: 0.2176 (0.2915)  loss_giou_4_hybrid: 0.4075 (0.3651)  loss_class_enc_hybrid: 0.7447 (0.8582)  loss_bbox_enc_hybrid: 0.3059 (0.3499)  loss_giou_enc_hybrid: 0.4719 (0.4518)
[2025-05-20 04:40:57 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 04:40:57 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32
[2025-05-20 04:40:57 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\pytorch_model.bin
[2025-05-20 04:40:58 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\optimizer.bin
[2025-05-20 04:40:58 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\scheduler.bin
[2025-05-20 04:40:58 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\sampler.bin
[2025-05-20 04:40:58 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\sampler_1.bin
[2025-05-20 04:40:58 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_32\random_states_0.pkl
[2025-05-20 04:40:58 det.__main__] INFO: Start evaluation
[2025-05-20 04:40:58 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1717 (0.1717)  evaluator_time: 0.0030 (0.0030)  time: 0.1977  data: 0.0230  mem: 727  max mem: 19988
[2025-05-20 04:41:00 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1754  data: 0.0028  mem: 727  max mem: 19988
[2025-05-20 04:41:01 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1691 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 04:41:03 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1686 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:41:05 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1681 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 04:41:07 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1682 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:08 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:41:10 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1685 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:12 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:13 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:15 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:17 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:41:19 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:20 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:41:22 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1686 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1733  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:24 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1686 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1733  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:41:26 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1732  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:27 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1682 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1728  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:29 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1726  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:31 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1729  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:32 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1690 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:34 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1691 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:36 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:38 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1695 (0.1689)  evaluator_time: 0.0040 (0.0034)  time: 0.1738  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:39 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1698 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:41 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:43 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1692 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:41:45 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:41:46 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:41:48 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1698 (0.1690)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:50 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1694 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:52 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1694 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1733  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:41:53 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:41:55 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:57 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:41:59 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:42:00 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:42:02 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1697 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:42:04 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:42:06 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1691 (0.1692)  evaluator_time: 0.0040 (0.0034)  time: 0.1748  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 04:42:07 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1692)  evaluator_time: 0.0040 (0.0034)  time: 0.1747  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:42:09 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:42:11 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 04:42:12 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1693 (0.1692)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 04:42:14 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1697 (0.1693)  evaluator_time: 0.0030 (0.0034)  time: 0.1743  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:42:16 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1693)  evaluator_time: 0.0040 (0.0034)  time: 0.1744  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:42:17 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1691 (0.1693)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 04:42:17 det.util.engine] INFO: Averaged stats: model_time: 0.1691 (0.1693)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 04:42:18 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.699
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.013
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.193
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.357
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.453
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.563

[2025-05-20 04:42:18 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3311  | 0.647  | 0.404 |
| Crescent_gap  | 48   | 48  | 10027 | 1.000  | 0.918 |
| Inclusion     | 41   | 82  | 9331  | 0.841  | 0.433 |
| Oil_spot      | 58   | 125 | 12188 | 0.936  | 0.683 |
| Punching      | 74   | 74  | 1403  | 1.000  | 0.924 |
| Rolled_pit    | 10   | 25  | 2846  | 0.880  | 0.454 |
| Silk_spot     | 134  | 150 | 61017 | 0.947  | 0.620 |
| Waist_folding | 24   | 26  | 7789  | 0.962  | 0.769 |
| Water_spot    | 68   | 78  | 20062 | 0.974  | 0.823 |
| Welding_line  | 99   | 99  | 9200  | 1.000  | 0.966 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.919  | 0.699 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 04:42:18 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:42:18 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 04:42:19 det.util.engine] INFO: Epoch: [33]  [0/1834]  eta: 0:18:37  lr: 0.000010  data_time: 0.0008  iter_time: 0.6091  loss: 27.9029 (27.9029)  loss_class: 0.3696 (0.3696)  loss_bbox: 0.5479 (0.5479)  loss_giou: 0.3195 (0.3195)  loss_class_0: 0.4533 (0.4533)  loss_bbox_0: 0.7513 (0.7513)  loss_giou_0: 0.4491 (0.4491)  loss_class_1: 0.3871 (0.3871)  loss_bbox_1: 0.5396 (0.5396)  loss_giou_1: 0.3184 (0.3184)  loss_class_2: 0.3790 (0.3790)  loss_bbox_2: 0.5507 (0.5507)  loss_giou_2: 0.3137 (0.3137)  loss_class_3: 0.3695 (0.3695)  loss_bbox_3: 0.5319 (0.5319)  loss_giou_3: 0.3044 (0.3044)  loss_class_4: 0.3708 (0.3708)  loss_bbox_4: 0.5506 (0.5506)  loss_giou_4: 0.3093 (0.3093)  loss_class_enc: 1.5275 (1.5275)  loss_bbox_enc: 0.3514 (0.3514)  loss_giou_enc: 0.2463 (0.2463)  loss_class_dn: 0.3694 (0.3694)  loss_bbox_dn: 0.5659 (0.5659)  loss_giou_dn: 0.3170 (0.3170)  loss_class_dn_0: 0.5165 (0.5165)  loss_bbox_dn_0: 0.7670 (0.7670)  loss_giou_dn_0: 0.4256 (0.4256)  loss_class_dn_1: 0.4169 (0.4169)  loss_bbox_dn_1: 0.5482 (0.5482)  loss_giou_dn_1: 0.3327 (0.3327)  loss_class_dn_2: 0.3816 (0.3816)  loss_bbox_dn_2: 0.6148 (0.6148)  loss_giou_dn_2: 0.3359 (0.3359)  loss_class_dn_3: 0.3653 (0.3653)  loss_bbox_dn_3: 0.5525 (0.5525)  loss_giou_dn_3: 0.2938 (0.2938)  loss_class_dn_4: 0.3655 (0.3655)  loss_bbox_dn_4: 0.5498 (0.5498)  loss_giou_dn_4: 0.3054 (0.3054)  loss_class_hybrid: 0.3729 (0.3729)  loss_bbox_hybrid: 0.5651 (0.5651)  loss_giou_hybrid: 0.3252 (0.3252)  loss_class_0_hybrid: 0.4683 (0.4683)  loss_bbox_0_hybrid: 0.7668 (0.7668)  loss_giou_0_hybrid: 0.4207 (0.4207)  loss_class_1_hybrid: 0.3985 (0.3985)  loss_bbox_1_hybrid: 0.5173 (0.5173)  loss_giou_1_hybrid: 0.3371 (0.3371)  loss_class_2_hybrid: 0.3825 (0.3825)  loss_bbox_2_hybrid: 0.5923 (0.5923)  loss_giou_2_hybrid: 0.3374 (0.3374)  loss_class_3_hybrid: 0.3627 (0.3627)  loss_bbox_3_hybrid: 0.5675 (0.5675)  loss_giou_3_hybrid: 0.3058 (0.3058)  loss_class_4_hybrid: 0.3714 (0.3714)  loss_bbox_4_hybrid: 0.5487 (0.5487)  loss_giou_4_hybrid: 0.3146 (0.3146)  loss_class_enc_hybrid: 0.8626 (0.8626)  loss_bbox_enc_hybrid: 0.6882 (0.6882)  loss_giou_enc_hybrid: 0.4328 (0.4328)  mem: 737  max mem: 19988
[2025-05-20 04:42:19 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 04:59:37 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5838  loss: 22.5697 (26.7553)  loss_class: 0.4294 (0.5976)  loss_bbox: 0.1414 (0.3009)  loss_giou: 0.3313 (0.3724)  loss_class_0: 0.6070 (0.7529)  loss_bbox_0: 0.2122 (0.2999)  loss_giou_0: 0.3709 (0.3883)  loss_class_1: 0.5189 (0.6643)  loss_bbox_1: 0.1821 (0.2903)  loss_giou_1: 0.2922 (0.3721)  loss_class_2: 0.4403 (0.6375)  loss_bbox_2: 0.1334 (0.2897)  loss_giou_2: 0.2725 (0.3678)  loss_class_3: 0.4245 (0.6087)  loss_bbox_3: 0.1334 (0.2978)  loss_giou_3: 0.2702 (0.3715)  loss_class_4: 0.4284 (0.5996)  loss_bbox_4: 0.1310 (0.2994)  loss_giou_4: 0.3094 (0.3720)  loss_class_enc: 1.0636 (1.0815)  loss_bbox_enc: 0.1775 (0.2886)  loss_giou_enc: 0.3683 (0.4002)  loss_class_dn: 0.3858 (0.3507)  loss_bbox_dn: 0.1767 (0.4130)  loss_giou_dn: 0.3122 (0.4093)  loss_class_dn_0: 0.4619 (0.4135)  loss_bbox_dn_0: 0.4074 (0.5177)  loss_giou_dn_0: 0.4675 (0.5272)  loss_class_dn_1: 0.4047 (0.3787)  loss_bbox_dn_1: 0.2560 (0.4370)  loss_giou_dn_1: 0.3232 (0.4311)  loss_class_dn_2: 0.4027 (0.3563)  loss_bbox_dn_2: 0.1940 (0.4241)  loss_giou_dn_2: 0.3070 (0.4159)  loss_class_dn_3: 0.3669 (0.3538)  loss_bbox_dn_3: 0.1849 (0.4144)  loss_giou_dn_3: 0.2981 (0.4101)  loss_class_dn_4: 0.3818 (0.3521)  loss_bbox_dn_4: 0.1792 (0.4137)  loss_giou_dn_4: 0.3119 (0.4095)  loss_class_hybrid: 0.5787 (0.6627)  loss_bbox_hybrid: 0.1494 (0.2872)  loss_giou_hybrid: 0.3084 (0.3659)  loss_class_0_hybrid: 0.6558 (0.7154)  loss_bbox_0_hybrid: 0.1579 (0.3071)  loss_giou_0_hybrid: 0.3441 (0.3919)  loss_class_1_hybrid: 0.6204 (0.6738)  loss_bbox_1_hybrid: 0.1694 (0.2930)  loss_giou_1_hybrid: 0.3041 (0.3758)  loss_class_2_hybrid: 0.5560 (0.6708)  loss_bbox_2_hybrid: 0.1444 (0.2898)  loss_giou_2_hybrid: 0.2806 (0.3701)  loss_class_3_hybrid: 0.5577 (0.6601)  loss_bbox_3_hybrid: 0.1533 (0.2907)  loss_giou_3_hybrid: 0.2862 (0.3687)  loss_class_4_hybrid: 0.6008 (0.6591)  loss_bbox_4_hybrid: 0.1457 (0.2897)  loss_giou_4_hybrid: 0.3109 (0.3676)  loss_class_enc_hybrid: 0.7796 (0.8419)  loss_bbox_enc_hybrid: 0.2357 (0.3401)  loss_giou_enc_hybrid: 0.4846 (0.4530)
[2025-05-20 04:59:37 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 04:59:37 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\pytorch_model.bin
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\optimizer.bin
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\scheduler.bin
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\sampler.bin
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\sampler_1.bin
[2025-05-20 04:59:37 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_33\random_states_0.pkl
[2025-05-20 04:59:37 det.__main__] INFO: Start evaluation
[2025-05-20 04:59:37 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:34  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0030)  time: 0.2070  data: 0.0340  mem: 730  max mem: 19988
[2025-05-20 04:59:39 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1761  data: 0.0036  mem: 730  max mem: 19988
[2025-05-20 04:59:41 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:59:42 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1681 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1720  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:59:44 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1687 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1723  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:59:46 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1687 (0.1687)  evaluator_time: 0.0035 (0.0032)  time: 0.1728  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 04:59:48 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:59:49 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 04:59:51 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1723  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 04:59:53 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1681 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:59:55 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1683 (0.1687)  evaluator_time: 0.0030 (0.0045)  time: 0.1797  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 04:59:56 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0044)  time: 0.1804  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 04:59:58 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0042)  time: 0.1737  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 05:00:00 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0042)  time: 0.1739  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:02 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1697 (0.1690)  evaluator_time: 0.0030 (0.0041)  time: 0.1743  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:03 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1696 (0.1691)  evaluator_time: 0.0040 (0.0041)  time: 0.1743  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:05 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1695 (0.1691)  evaluator_time: 0.0030 (0.0041)  time: 0.1741  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:07 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1696 (0.1691)  evaluator_time: 0.0030 (0.0040)  time: 0.1733  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 05:00:08 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0039)  time: 0.1727  data: 0.0002  mem: 730  max mem: 19988
[2025-05-20 05:00:10 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1693 (0.1691)  evaluator_time: 0.0030 (0.0039)  time: 0.1735  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:12 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1693 (0.1692)  evaluator_time: 0.0040 (0.0039)  time: 0.1738  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:14 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1737  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:15 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1692 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1740  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:17 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1695 (0.1692)  evaluator_time: 0.0030 (0.0039)  time: 0.1739  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:19 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1736  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:21 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1686 (0.1692)  evaluator_time: 0.0020 (0.0038)  time: 0.1727  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:22 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:24 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1722  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:26 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1722  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:28 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1721  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:29 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1682 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1720  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:31 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1683 (0.1690)  evaluator_time: 0.0030 (0.0037)  time: 0.1718  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:33 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:34 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:36 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1681 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:38 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1683 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:40 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1730  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:41 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1726  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:43 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1681 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1720  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:45 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1681 (0.1689)  evaluator_time: 0.0040 (0.0036)  time: 0.1736  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:47 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1681 (0.1689)  evaluator_time: 0.0040 (0.0036)  time: 0.1735  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:48 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1721  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:50 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1686 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1728  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:52 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1691 (0.1689)  evaluator_time: 0.0036 (0.0036)  time: 0.1734  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:53 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1741  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:00:55 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1745  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:00:56 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1695 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1737  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:00:56 det.util.engine] INFO: Averaged stats: model_time: 0.1695 (0.1690)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 05:00:57 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.686
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.202
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.551

[2025-05-20 05:00:57 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 2992  | 0.588  | 0.284 |
| Crescent_gap  | 48   | 48  | 7177  | 1.000  | 0.912 |
| Inclusion     | 41   | 82  | 10880 | 0.854  | 0.418 |
| Oil_spot      | 58   | 125 | 11449 | 0.928  | 0.688 |
| Punching      | 74   | 74  | 2110  | 1.000  | 0.931 |
| Rolled_pit    | 10   | 25  | 3918  | 0.880  | 0.397 |
| Silk_spot     | 134  | 150 | 69517 | 0.933  | 0.639 |
| Waist_folding | 24   | 26  | 9461  | 0.962  | 0.808 |
| Water_spot    | 68   | 78  | 13774 | 0.974  | 0.813 |
| Welding_line  | 99   | 99  | 5988  | 1.000  | 0.969 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.912  | 0.686 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 05:00:57 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:00:58 det.util.engine] INFO: Epoch: [34]  [0/1834]  eta: 0:17:24  lr: 0.000010  data_time: 0.0168  iter_time: 0.5697  loss: 18.5025 (18.5025)  loss_class: 0.3501 (0.3501)  loss_bbox: 0.0819 (0.0819)  loss_giou: 0.3517 (0.3517)  loss_class_0: 0.5174 (0.5174)  loss_bbox_0: 0.1049 (0.1049)  loss_giou_0: 0.4407 (0.4407)  loss_class_1: 0.5986 (0.5986)  loss_bbox_1: 0.0971 (0.0971)  loss_giou_1: 0.4274 (0.4274)  loss_class_2: 0.4135 (0.4135)  loss_bbox_2: 0.0852 (0.0852)  loss_giou_2: 0.3656 (0.3656)  loss_class_3: 0.3482 (0.3482)  loss_bbox_3: 0.0808 (0.0808)  loss_giou_3: 0.3487 (0.3487)  loss_class_4: 0.3548 (0.3548)  loss_bbox_4: 0.0816 (0.0816)  loss_giou_4: 0.3527 (0.3527)  loss_class_enc: 0.7875 (0.7875)  loss_bbox_enc: 0.1682 (0.1682)  loss_giou_enc: 0.4816 (0.4816)  loss_class_dn: 0.3463 (0.3463)  loss_bbox_dn: 0.0810 (0.0810)  loss_giou_dn: 0.3586 (0.3586)  loss_class_dn_0: 0.4195 (0.4195)  loss_bbox_dn_0: 0.1313 (0.1313)  loss_giou_dn_0: 0.4838 (0.4838)  loss_class_dn_1: 0.3769 (0.3769)  loss_bbox_dn_1: 0.0879 (0.0879)  loss_giou_dn_1: 0.3870 (0.3870)  loss_class_dn_2: 0.3582 (0.3582)  loss_bbox_dn_2: 0.0835 (0.0835)  loss_giou_dn_2: 0.3709 (0.3709)  loss_class_dn_3: 0.3508 (0.3508)  loss_bbox_dn_3: 0.0821 (0.0821)  loss_giou_dn_3: 0.3605 (0.3605)  loss_class_dn_4: 0.3466 (0.3466)  loss_bbox_dn_4: 0.0809 (0.0809)  loss_giou_dn_4: 0.3579 (0.3579)  loss_class_hybrid: 0.3890 (0.3890)  loss_bbox_hybrid: 0.0812 (0.0812)  loss_giou_hybrid: 0.3482 (0.3482)  loss_class_0_hybrid: 0.6371 (0.6371)  loss_bbox_0_hybrid: 0.0944 (0.0944)  loss_giou_0_hybrid: 0.3880 (0.3880)  loss_class_1_hybrid: 0.4950 (0.4950)  loss_bbox_1_hybrid: 0.0870 (0.0870)  loss_giou_1_hybrid: 0.3820 (0.3820)  loss_class_2_hybrid: 0.4326 (0.4326)  loss_bbox_2_hybrid: 0.0776 (0.0776)  loss_giou_2_hybrid: 0.3422 (0.3422)  loss_class_3_hybrid: 0.3917 (0.3917)  loss_bbox_3_hybrid: 0.0814 (0.0814)  loss_giou_3_hybrid: 0.3525 (0.3525)  loss_class_4_hybrid: 0.3839 (0.3839)  loss_bbox_4_hybrid: 0.0814 (0.0814)  loss_giou_4_hybrid: 0.3490 (0.3490)  loss_class_enc_hybrid: 0.6551 (0.6551)  loss_bbox_enc_hybrid: 0.1245 (0.1245)  loss_giou_enc_hybrid: 0.4264 (0.4264)  mem: 739  max mem: 19988
[2025-05-20 05:00:58 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:18:15 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5937  loss: 26.5889 (26.9814)  loss_class: 0.4868 (0.6215)  loss_bbox: 0.2363 (0.2938)  loss_giou: 0.3987 (0.3745)  loss_class_0: 0.6200 (0.7360)  loss_bbox_0: 0.3810 (0.3211)  loss_giou_0: 0.4470 (0.3987)  loss_class_1: 0.5265 (0.6638)  loss_bbox_1: 0.2257 (0.2980)  loss_giou_1: 0.4215 (0.3798)  loss_class_2: 0.4885 (0.6420)  loss_bbox_2: 0.2298 (0.2940)  loss_giou_2: 0.4276 (0.3750)  loss_class_3: 0.4793 (0.6345)  loss_bbox_3: 0.2320 (0.2891)  loss_giou_3: 0.4073 (0.3715)  loss_class_4: 0.4682 (0.6175)  loss_bbox_4: 0.2302 (0.2939)  loss_giou_4: 0.4005 (0.3742)  loss_class_enc: 1.0749 (1.1054)  loss_bbox_enc: 0.2025 (0.2858)  loss_giou_enc: 0.3664 (0.4028)  loss_class_dn: 0.4071 (0.3532)  loss_bbox_dn: 0.2169 (0.4080)  loss_giou_dn: 0.4147 (0.4137)  loss_class_dn_0: 0.4671 (0.4139)  loss_bbox_dn_0: 0.4961 (0.5147)  loss_giou_dn_0: 0.5064 (0.5322)  loss_class_dn_1: 0.4353 (0.3796)  loss_bbox_dn_1: 0.3338 (0.4350)  loss_giou_dn_1: 0.4544 (0.4365)  loss_class_dn_2: 0.4115 (0.3582)  loss_bbox_dn_2: 0.2954 (0.4208)  loss_giou_dn_2: 0.4338 (0.4204)  loss_class_dn_3: 0.4086 (0.3559)  loss_bbox_dn_3: 0.2189 (0.4098)  loss_giou_dn_3: 0.4364 (0.4146)  loss_class_dn_4: 0.4090 (0.3544)  loss_bbox_dn_4: 0.2192 (0.4089)  loss_giou_dn_4: 0.4267 (0.4140)  loss_class_hybrid: 0.6044 (0.6835)  loss_bbox_hybrid: 0.2487 (0.2814)  loss_giou_hybrid: 0.3659 (0.3668)  loss_class_0_hybrid: 0.6910 (0.7169)  loss_bbox_0_hybrid: 0.2861 (0.3085)  loss_giou_0_hybrid: 0.3730 (0.3969)  loss_class_1_hybrid: 0.6350 (0.6886)  loss_bbox_1_hybrid: 0.2429 (0.2902)  loss_giou_1_hybrid: 0.3508 (0.3770)  loss_class_2_hybrid: 0.6479 (0.6841)  loss_bbox_2_hybrid: 0.2541 (0.2839)  loss_giou_2_hybrid: 0.3456 (0.3709)  loss_class_3_hybrid: 0.6136 (0.6806)  loss_bbox_3_hybrid: 0.2499 (0.2833)  loss_giou_3_hybrid: 0.3584 (0.3685)  loss_class_4_hybrid: 0.5691 (0.6793)  loss_bbox_4_hybrid: 0.2484 (0.2829)  loss_giou_4_hybrid: 0.3570 (0.3681)  loss_class_enc_hybrid: 0.8756 (0.8487)  loss_bbox_enc_hybrid: 0.3190 (0.3478)  loss_giou_enc_hybrid: 0.3634 (0.4568)
[2025-05-20 05:18:15 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 05:18:15 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34
[2025-05-20 05:18:15 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\pytorch_model.bin
[2025-05-20 05:18:16 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\optimizer.bin
[2025-05-20 05:18:16 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\scheduler.bin
[2025-05-20 05:18:16 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\sampler.bin
[2025-05-20 05:18:16 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\sampler_1.bin
[2025-05-20 05:18:16 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_34\random_states_0.pkl
[2025-05-20 05:18:16 det.__main__] INFO: Start evaluation
[2025-05-20 05:18:16 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1733 (0.1733)  evaluator_time: 0.0030 (0.0030)  time: 0.1953  data: 0.0190  mem: 727  max mem: 19988
[2025-05-20 05:18:18 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1700 (0.1700)  evaluator_time: 0.0030 (0.0034)  time: 0.1758  data: 0.0024  mem: 727  max mem: 19988
[2025-05-20 05:18:20 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1683 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:18:21 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1671 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:23 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1670 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1711  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:18:25 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1677 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:26 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:28 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1675 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1713  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:18:30 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:18:32 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1678 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1716  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:18:33 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1673 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1715  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:18:35 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1677 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:18:37 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:38 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1717  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:18:40 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1678 (0.1679)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:42 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:52  model_time: 0.1670 (0.1678)  evaluator_time: 0.0040 (0.0034)  time: 0.1723  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:18:44 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1670 (0.1678)  evaluator_time: 0.0040 (0.0034)  time: 0.1723  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:18:45 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1672 (0.1678)  evaluator_time: 0.0030 (0.0034)  time: 0.1715  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:47 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1680 (0.1678)  evaluator_time: 0.0030 (0.0034)  time: 0.1714  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:49 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1678)  evaluator_time: 0.0040 (0.0034)  time: 0.1724  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:50 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1685 (0.1679)  evaluator_time: 0.0040 (0.0034)  time: 0.1735  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:18:52 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1697 (0.1680)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0009  mem: 727  max mem: 19988
[2025-05-20 05:18:54 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1699 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1742  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:18:56 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1697 (0.1681)  evaluator_time: 0.0030 (0.0034)  time: 0.1742  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:18:57 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:18:59 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:19:01 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1694 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:19:03 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1697 (0.1683)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:19:04 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:19:06 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:19:08 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1736  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:19:10 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:19:11 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1700 (0.1686)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:19:13 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1700 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:19:15 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1701 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:19:17 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1701 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:19:18 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1697 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1742  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:19:20 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1696 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:19:22 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1691 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:19:24 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1696 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1747  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:19:25 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1696 (0.1688)  evaluator_time: 0.0040 (0.0034)  time: 0.1749  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:19:27 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1698 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:19:29 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0034)  time: 0.1735  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:19:30 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1696 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1734  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:19:32 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:19:34 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:19:35 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0034)  time: 0.1738  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 05:19:35 det.util.engine] INFO: Averaged stats: model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 05:19:36 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.687
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.059
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.356
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.458
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.569

[2025-05-20 05:19:36 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3656  | 0.647  | 0.354 |
| Crescent_gap  | 48   | 48  | 8204  | 1.000  | 0.919 |
| Inclusion     | 41   | 82  | 7839  | 0.841  | 0.372 |
| Oil_spot      | 58   | 125 | 14706 | 0.912  | 0.693 |
| Punching      | 74   | 74  | 2216  | 1.000  | 0.958 |
| Rolled_pit    | 10   | 25  | 3690  | 0.800  | 0.422 |
| Silk_spot     | 134  | 150 | 60358 | 0.927  | 0.647 |
| Waist_folding | 24   | 26  | 8672  | 0.923  | 0.716 |
| Water_spot    | 68   | 78  | 18280 | 0.987  | 0.828 |
| Welding_line  | 99   | 99  | 9631  | 1.000  | 0.964 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.904  | 0.687 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 05:19:36 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:19:36 det.util.engine] INFO: Epoch: [35]  [0/1834]  eta: 0:14:01  lr: 0.000010  data_time: 0.0039  iter_time: 0.4591  loss: 18.2290 (18.2290)  loss_class: 0.6908 (0.6908)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.5511 (0.5511)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.4575 (0.4575)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.5783 (0.5783)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.6528 (0.6528)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.6509 (0.6509)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.7532 (0.7532)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 1.9117 (1.9117)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 3.0458 (3.0458)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 1.4159 (1.4159)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 2.0177 (2.0177)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 1.7633 (1.7633)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 1.6511 (1.6511)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 2.0888 (2.0888)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 738  max mem: 19988
[2025-05-20 05:19:36 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:36:53 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5691  loss: 24.4017 (26.2096)  loss_class: 0.4494 (0.6012)  loss_bbox: 0.1323 (0.2870)  loss_giou: 0.2532 (0.3598)  loss_class_0: 0.5187 (0.7335)  loss_bbox_0: 0.2037 (0.3031)  loss_giou_0: 0.3270 (0.3791)  loss_class_1: 0.4856 (0.6558)  loss_bbox_1: 0.1455 (0.2893)  loss_giou_1: 0.2716 (0.3635)  loss_class_2: 0.4734 (0.6248)  loss_bbox_2: 0.1340 (0.2863)  loss_giou_2: 0.2662 (0.3593)  loss_class_3: 0.4580 (0.6199)  loss_bbox_3: 0.1330 (0.2823)  loss_giou_3: 0.2529 (0.3559)  loss_class_4: 0.4499 (0.6039)  loss_bbox_4: 0.1322 (0.2859)  loss_giou_4: 0.2534 (0.3590)  loss_class_enc: 1.1159 (1.0749)  loss_bbox_enc: 0.2005 (0.2843)  loss_giou_enc: 0.3386 (0.3933)  loss_class_dn: 0.3891 (0.3438)  loss_bbox_dn: 0.1793 (0.4000)  loss_giou_dn: 0.3698 (0.3997)  loss_class_dn_0: 0.4669 (0.4086)  loss_bbox_dn_0: 0.3210 (0.5056)  loss_giou_dn_0: 0.4805 (0.5170)  loss_class_dn_1: 0.4263 (0.3715)  loss_bbox_dn_1: 0.2416 (0.4262)  loss_giou_dn_1: 0.3758 (0.4224)  loss_class_dn_2: 0.3944 (0.3500)  loss_bbox_dn_2: 0.2437 (0.4128)  loss_giou_dn_2: 0.3720 (0.4069)  loss_class_dn_3: 0.3896 (0.3467)  loss_bbox_dn_3: 0.1882 (0.4020)  loss_giou_dn_3: 0.3665 (0.4010)  loss_class_dn_4: 0.3933 (0.3452)  loss_bbox_dn_4: 0.1884 (0.4013)  loss_giou_dn_4: 0.3607 (0.4001)  loss_class_hybrid: 0.4598 (0.6552)  loss_bbox_hybrid: 0.1244 (0.2747)  loss_giou_hybrid: 0.2682 (0.3526)  loss_class_0_hybrid: 0.5869 (0.7102)  loss_bbox_0_hybrid: 0.2335 (0.2969)  loss_giou_0_hybrid: 0.2948 (0.3798)  loss_class_1_hybrid: 0.4975 (0.6658)  loss_bbox_1_hybrid: 0.1578 (0.2825)  loss_giou_1_hybrid: 0.2808 (0.3613)  loss_class_2_hybrid: 0.4529 (0.6580)  loss_bbox_2_hybrid: 0.1435 (0.2786)  loss_giou_2_hybrid: 0.2602 (0.3560)  loss_class_3_hybrid: 0.4778 (0.6552)  loss_bbox_3_hybrid: 0.1366 (0.2768)  loss_giou_3_hybrid: 0.2666 (0.3536)  loss_class_4_hybrid: 0.4703 (0.6528)  loss_bbox_4_hybrid: 0.1285 (0.2764)  loss_giou_4_hybrid: 0.2737 (0.3534)  loss_class_enc_hybrid: 0.8109 (0.8299)  loss_bbox_enc_hybrid: 0.2754 (0.3373)  loss_giou_enc_hybrid: 0.4790 (0.4399)
[2025-05-20 05:36:53 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 05:36:53 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35
[2025-05-20 05:36:53 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\pytorch_model.bin
[2025-05-20 05:36:53 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\optimizer.bin
[2025-05-20 05:36:53 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\scheduler.bin
[2025-05-20 05:36:53 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\sampler.bin
[2025-05-20 05:36:53 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\sampler_1.bin
[2025-05-20 05:36:54 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_35\random_states_0.pkl
[2025-05-20 05:36:54 det.__main__] INFO: Start evaluation
[2025-05-20 05:36:54 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:27  model_time: 0.1700 (0.1700)  evaluator_time: 0.0020 (0.0020)  time: 0.1920  data: 0.0200  mem: 727  max mem: 19988
[2025-05-20 05:36:55 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1700 (0.1701)  evaluator_time: 0.0030 (0.0032)  time: 0.1758  data: 0.0024  mem: 727  max mem: 19988
[2025-05-20 05:36:57 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1700 (0.1701)  evaluator_time: 0.0030 (0.0031)  time: 0.1739  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:36:59 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1700 (0.1701)  evaluator_time: 0.0030 (0.0029)  time: 0.1734  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:37:01 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1696 (0.1698)  evaluator_time: 0.0030 (0.0029)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:02 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0029)  time: 0.1730  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:04 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1690 (0.1696)  evaluator_time: 0.0030 (0.0029)  time: 0.1729  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:06 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1693 (0.1696)  evaluator_time: 0.0030 (0.0029)  time: 0.1729  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:08 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1691 (0.1695)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:09 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0029)  time: 0.1731  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:11 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0030)  time: 0.1732  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:13 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:37:14 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1696 (0.1694)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:16 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:18 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0030)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:20 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0031)  time: 0.1737  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:37:21 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0031)  time: 0.1736  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:37:23 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0008  mem: 727  max mem: 19988
[2025-05-20 05:37:25 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1694)  evaluator_time: 0.0020 (0.0030)  time: 0.1731  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:27 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0031)  time: 0.1734  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:28 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1699 (0.1694)  evaluator_time: 0.0040 (0.0031)  time: 0.1739  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:30 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1700 (0.1695)  evaluator_time: 0.0036 (0.0031)  time: 0.1743  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:32 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1702 (0.1695)  evaluator_time: 0.0030 (0.0031)  time: 0.1744  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:34 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1700 (0.1695)  evaluator_time: 0.0030 (0.0031)  time: 0.1742  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:35 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1700 (0.1695)  evaluator_time: 0.0030 (0.0031)  time: 0.1739  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:37 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1700 (0.1696)  evaluator_time: 0.0020 (0.0031)  time: 0.1732  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:39 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1695 (0.1696)  evaluator_time: 0.0020 (0.0031)  time: 0.1734  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:41 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1695 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1740  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:42 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0031)  time: 0.1739  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:44 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1744  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:46 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1742  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:48 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1735  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:49 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1692 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1735  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:51 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1699 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1737  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:53 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1739  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:37:54 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1743  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:37:56 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1742  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:37:58 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1696 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1737  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:38:00 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1696 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1734  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:38:01 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1700 (0.1697)  evaluator_time: 0.0030 (0.0032)  time: 0.1750  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:38:03 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1700 (0.1697)  evaluator_time: 0.0040 (0.0032)  time: 0.1752  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:38:05 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:38:07 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1696 (0.1697)  evaluator_time: 0.0030 (0.0031)  time: 0.1736  data: 0.0004  mem: 727  max mem: 19988
[2025-05-20 05:38:08 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0031)  time: 0.1741  data: 0.0006  mem: 727  max mem: 19988
[2025-05-20 05:38:10 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1696 (0.1698)  evaluator_time: 0.0030 (0.0031)  time: 0.1740  data: 0.0007  mem: 727  max mem: 19988
[2025-05-20 05:38:12 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1698)  evaluator_time: 0.0030 (0.0031)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:38:13 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1702 (0.1698)  evaluator_time: 0.0030 (0.0031)  time: 0.1741  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 05:38:13 det.util.engine] INFO: Averaged stats: model_time: 0.1702 (0.1698)  evaluator_time: 0.0030 (0.0031)
[2025-05-20 05:38:14 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.27s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.693
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.042
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.414
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.548

[2025-05-20 05:38:14 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3471  | 0.647  | 0.357 |
| Crescent_gap  | 48   | 48  | 5872  | 1.000  | 0.933 |
| Inclusion     | 41   | 82  | 6544  | 0.793  | 0.400 |
| Oil_spot      | 58   | 125 | 10269 | 0.928  | 0.673 |
| Punching      | 74   | 74  | 2088  | 1.000  | 0.955 |
| Rolled_pit    | 10   | 25  | 2626  | 0.760  | 0.426 |
| Silk_spot     | 134  | 150 | 84043 | 0.940  | 0.637 |
| Waist_folding | 24   | 26  | 6810  | 0.962  | 0.772 |
| Water_spot    | 68   | 78  | 9883  | 0.974  | 0.819 |
| Welding_line  | 99   | 99  | 5632  | 1.000  | 0.964 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.900  | 0.693 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 05:38:14 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:38:14 det.util.engine] INFO: Epoch: [36]  [0/1834]  eta: 0:18:24  lr: 0.000010  data_time: 0.0007  iter_time: 0.6021  loss: 20.7901 (20.7901)  loss_class: 0.4356 (0.4356)  loss_bbox: 0.0547 (0.0547)  loss_giou: 0.3142 (0.3142)  loss_class_0: 0.8062 (0.8062)  loss_bbox_0: 0.1096 (0.1096)  loss_giou_0: 0.4151 (0.4151)  loss_class_1: 0.5569 (0.5569)  loss_bbox_1: 0.0716 (0.0716)  loss_giou_1: 0.3687 (0.3687)  loss_class_2: 0.4544 (0.4544)  loss_bbox_2: 0.0648 (0.0648)  loss_giou_2: 0.3366 (0.3366)  loss_class_3: 0.4426 (0.4426)  loss_bbox_3: 0.0621 (0.0621)  loss_giou_3: 0.3292 (0.3292)  loss_class_4: 0.4428 (0.4428)  loss_bbox_4: 0.0634 (0.0634)  loss_giou_4: 0.3308 (0.3308)  loss_class_enc: 1.0795 (1.0795)  loss_bbox_enc: 0.1378 (0.1378)  loss_giou_enc: 0.4982 (0.4982)  loss_class_dn: 0.4278 (0.4278)  loss_bbox_dn: 0.0560 (0.0560)  loss_giou_dn: 0.2918 (0.2918)  loss_class_dn_0: 0.5100 (0.5100)  loss_bbox_dn_0: 0.1281 (0.1281)  loss_giou_dn_0: 0.4972 (0.4972)  loss_class_dn_1: 0.4787 (0.4787)  loss_bbox_dn_1: 0.0740 (0.0740)  loss_giou_dn_1: 0.3573 (0.3573)  loss_class_dn_2: 0.4657 (0.4657)  loss_bbox_dn_2: 0.0670 (0.0670)  loss_giou_dn_2: 0.3163 (0.3163)  loss_class_dn_3: 0.4548 (0.4548)  loss_bbox_dn_3: 0.0655 (0.0655)  loss_giou_dn_3: 0.3100 (0.3100)  loss_class_dn_4: 0.4437 (0.4437)  loss_bbox_dn_4: 0.0658 (0.0658)  loss_giou_dn_4: 0.3130 (0.3130)  loss_class_hybrid: 0.5339 (0.5339)  loss_bbox_hybrid: 0.0640 (0.0640)  loss_giou_hybrid: 0.3389 (0.3389)  loss_class_0_hybrid: 0.9139 (0.9139)  loss_bbox_0_hybrid: 0.0834 (0.0834)  loss_giou_0_hybrid: 0.3490 (0.3490)  loss_class_1_hybrid: 0.7053 (0.7053)  loss_bbox_1_hybrid: 0.0767 (0.0767)  loss_giou_1_hybrid: 0.3484 (0.3484)  loss_class_2_hybrid: 0.6308 (0.6308)  loss_bbox_2_hybrid: 0.0703 (0.0703)  loss_giou_2_hybrid: 0.3459 (0.3459)  loss_class_3_hybrid: 0.6062 (0.6062)  loss_bbox_3_hybrid: 0.0657 (0.0657)  loss_giou_3_hybrid: 0.3426 (0.3426)  loss_class_4_hybrid: 0.5473 (0.5473)  loss_bbox_4_hybrid: 0.0656 (0.0656)  loss_giou_4_hybrid: 0.3431 (0.3431)  loss_class_enc_hybrid: 0.9218 (0.9218)  loss_bbox_enc_hybrid: 0.1526 (0.1526)  loss_giou_enc_hybrid: 0.5871 (0.5871)  mem: 737  max mem: 19988
[2025-05-20 05:38:14 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:55:31 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0008  iter_time: 0.6012  loss: 23.8355 (26.6930)  loss_class: 0.4372 (0.6040)  loss_bbox: 0.1675 (0.2997)  loss_giou: 0.3828 (0.3722)  loss_class_0: 0.5845 (0.7531)  loss_bbox_0: 0.1515 (0.3093)  loss_giou_0: 0.3650 (0.3900)  loss_class_1: 0.4804 (0.6614)  loss_bbox_1: 0.1717 (0.2985)  loss_giou_1: 0.3280 (0.3765)  loss_class_2: 0.4552 (0.6311)  loss_bbox_2: 0.1630 (0.2955)  loss_giou_2: 0.3236 (0.3731)  loss_class_3: 0.4590 (0.6083)  loss_bbox_3: 0.1682 (0.3004)  loss_giou_3: 0.3265 (0.3730)  loss_class_4: 0.4343 (0.6024)  loss_bbox_4: 0.1724 (0.3000)  loss_giou_4: 0.3468 (0.3730)  loss_class_enc: 1.1799 (1.0573)  loss_bbox_enc: 0.1688 (0.3022)  loss_giou_enc: 0.3778 (0.4109)  loss_class_dn: 0.4105 (0.3495)  loss_bbox_dn: 0.1638 (0.4029)  loss_giou_dn: 0.4367 (0.4028)  loss_class_dn_0: 0.4564 (0.4132)  loss_bbox_dn_0: 0.2890 (0.5100)  loss_giou_dn_0: 0.5693 (0.5202)  loss_class_dn_1: 0.4381 (0.3760)  loss_bbox_dn_1: 0.1716 (0.4292)  loss_giou_dn_1: 0.4602 (0.4247)  loss_class_dn_2: 0.4253 (0.3545)  loss_bbox_dn_2: 0.1681 (0.4153)  loss_giou_dn_2: 0.4598 (0.4095)  loss_class_dn_3: 0.4225 (0.3522)  loss_bbox_dn_3: 0.1676 (0.4049)  loss_giou_dn_3: 0.4445 (0.4039)  loss_class_dn_4: 0.4149 (0.3511)  loss_bbox_dn_4: 0.1658 (0.4041)  loss_giou_dn_4: 0.4346 (0.4033)  loss_class_hybrid: 0.5131 (0.6593)  loss_bbox_hybrid: 0.1831 (0.2900)  loss_giou_hybrid: 0.3880 (0.3677)  loss_class_0_hybrid: 0.6702 (0.7098)  loss_bbox_0_hybrid: 0.1914 (0.3130)  loss_giou_0_hybrid: 0.4213 (0.3965)  loss_class_1_hybrid: 0.5525 (0.6648)  loss_bbox_1_hybrid: 0.1932 (0.2979)  loss_giou_1_hybrid: 0.4142 (0.3780)  loss_class_2_hybrid: 0.5259 (0.6602)  loss_bbox_2_hybrid: 0.1789 (0.2935)  loss_giou_2_hybrid: 0.4261 (0.3724)  loss_class_3_hybrid: 0.5219 (0.6546)  loss_bbox_3_hybrid: 0.1847 (0.2932)  loss_giou_3_hybrid: 0.4212 (0.3702)  loss_class_4_hybrid: 0.4966 (0.6544)  loss_bbox_4_hybrid: 0.1815 (0.2917)  loss_giou_4_hybrid: 0.3902 (0.3692)  loss_class_enc_hybrid: 0.9159 (0.8271)  loss_bbox_enc_hybrid: 0.2256 (0.3521)  loss_giou_enc_hybrid: 0.4779 (0.4580)
[2025-05-20 05:55:31 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 05:55:31 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36
[2025-05-20 05:55:31 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\pytorch_model.bin
[2025-05-20 05:55:32 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\optimizer.bin
[2025-05-20 05:55:32 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\scheduler.bin
[2025-05-20 05:55:32 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\sampler.bin
[2025-05-20 05:55:32 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\sampler_1.bin
[2025-05-20 05:55:32 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_36\random_states_0.pkl
[2025-05-20 05:55:32 det.__main__] INFO: Start evaluation
[2025-05-20 05:55:32 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1681 (0.1681)  evaluator_time: 0.0030 (0.0030)  time: 0.1961  data: 0.0250  mem: 730  max mem: 19988
[2025-05-20 05:55:34 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0034)  time: 0.1751  data: 0.0030  mem: 730  max mem: 19988
[2025-05-20 05:55:35 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:55:37 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0003  mem: 730  max mem: 19988
[2025-05-20 05:55:39 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0030)  time: 0.1728  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:55:41 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1688 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 05:55:42 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1681 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0009  mem: 730  max mem: 19988
[2025-05-20 05:55:44 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1687 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:55:46 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:55:48 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1692 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1738  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:55:49 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1696 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1738  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:55:51 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1695 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1737  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:55:53 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1695 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:55:55 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 05:55:56 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1700 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1744  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:55:58 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1695 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1745  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:56:00 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1691 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:01 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1698 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:03 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1696 (0.1695)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:05 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1695)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:07 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1696 (0.1695)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:08 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1745  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:10 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1745  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:12 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1742  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:14 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1700 (0.1696)  evaluator_time: 0.0030 (0.0034)  time: 0.1741  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 05:56:15 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1700 (0.1696)  evaluator_time: 0.0020 (0.0033)  time: 0.1738  data: 0.0003  mem: 730  max mem: 19988
[2025-05-20 05:56:17 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1694 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:19 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1694 (0.1697)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0009  mem: 730  max mem: 19988
[2025-05-20 05:56:21 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1687 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 05:56:22 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1680 (0.1696)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 05:56:24 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1680 (0.1695)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:26 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1680 (0.1695)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:56:28 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1680 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:29 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1680 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:31 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1685 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:33 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1694)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:34 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1681 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1726  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:36 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:38 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1680 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 05:56:40 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1692)  evaluator_time: 0.0040 (0.0033)  time: 0.1734  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:41 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1692)  evaluator_time: 0.0040 (0.0033)  time: 0.1733  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:43 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1682 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:45 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:46 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:48 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:50 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 05:56:51 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 05:56:51 det.util.engine] INFO: Averaged stats: model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 05:56:52 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.697
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.217
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.459
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.560

[2025-05-20 05:56:52 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3064  | 0.588  | 0.346 |
| Crescent_gap  | 48   | 48  | 5644  | 1.000  | 0.929 |
| Inclusion     | 41   | 82  | 9848  | 0.817  | 0.365 |
| Oil_spot      | 58   | 125 | 15531 | 0.928  | 0.696 |
| Punching      | 74   | 74  | 2044  | 1.000  | 0.964 |
| Rolled_pit    | 10   | 25  | 2492  | 0.840  | 0.433 |
| Silk_spot     | 134  | 150 | 65456 | 0.960  | 0.655 |
| Waist_folding | 24   | 26  | 7210  | 0.962  | 0.795 |
| Water_spot    | 68   | 78  | 17387 | 0.974  | 0.830 |
| Welding_line  | 99   | 99  | 8551  | 1.000  | 0.960 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.907  | 0.697 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 05:56:52 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 05:56:52 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 05:56:53 det.util.engine] INFO: Epoch: [37]  [0/1834]  eta: 0:19:54  lr: 0.000010  data_time: 0.0009  iter_time: 0.6514  loss: 18.0895 (18.0895)  loss_class: 0.3818 (0.3818)  loss_bbox: 0.1181 (0.1181)  loss_giou: 0.3423 (0.3423)  loss_class_0: 0.5435 (0.5435)  loss_bbox_0: 0.1142 (0.1142)  loss_giou_0: 0.3315 (0.3315)  loss_class_1: 0.3955 (0.3955)  loss_bbox_1: 0.1071 (0.1071)  loss_giou_1: 0.3367 (0.3367)  loss_class_2: 0.3805 (0.3805)  loss_bbox_2: 0.1069 (0.1069)  loss_giou_2: 0.3238 (0.3238)  loss_class_3: 0.3679 (0.3679)  loss_bbox_3: 0.1047 (0.1047)  loss_giou_3: 0.3087 (0.3087)  loss_class_4: 0.3804 (0.3804)  loss_bbox_4: 0.1148 (0.1148)  loss_giou_4: 0.3370 (0.3370)  loss_class_enc: 0.9787 (0.9787)  loss_bbox_enc: 0.0942 (0.0942)  loss_giou_enc: 0.2299 (0.2299)  loss_class_dn: 0.3749 (0.3749)  loss_bbox_dn: 0.1155 (0.1155)  loss_giou_dn: 0.3315 (0.3315)  loss_class_dn_0: 0.5179 (0.5179)  loss_bbox_dn_0: 0.1888 (0.1888)  loss_giou_dn_0: 0.5795 (0.5795)  loss_class_dn_1: 0.4230 (0.4230)  loss_bbox_dn_1: 0.1171 (0.1171)  loss_giou_dn_1: 0.3409 (0.3409)  loss_class_dn_2: 0.3798 (0.3798)  loss_bbox_dn_2: 0.1154 (0.1154)  loss_giou_dn_2: 0.3194 (0.3194)  loss_class_dn_3: 0.3620 (0.3620)  loss_bbox_dn_3: 0.1079 (0.1079)  loss_giou_dn_3: 0.3025 (0.3025)  loss_class_dn_4: 0.3766 (0.3766)  loss_bbox_dn_4: 0.1138 (0.1138)  loss_giou_dn_4: 0.3289 (0.3289)  loss_class_hybrid: 0.4112 (0.4112)  loss_bbox_hybrid: 0.1177 (0.1177)  loss_giou_hybrid: 0.3340 (0.3340)  loss_class_0_hybrid: 0.5549 (0.5549)  loss_bbox_0_hybrid: 0.1007 (0.1007)  loss_giou_0_hybrid: 0.2883 (0.2883)  loss_class_1_hybrid: 0.4156 (0.4156)  loss_bbox_1_hybrid: 0.1042 (0.1042)  loss_giou_1_hybrid: 0.3189 (0.3189)  loss_class_2_hybrid: 0.4515 (0.4515)  loss_bbox_2_hybrid: 0.1066 (0.1066)  loss_giou_2_hybrid: 0.3128 (0.3128)  loss_class_3_hybrid: 0.4536 (0.4536)  loss_bbox_3_hybrid: 0.1063 (0.1063)  loss_giou_3_hybrid: 0.3018 (0.3018)  loss_class_4_hybrid: 0.4118 (0.4118)  loss_bbox_4_hybrid: 0.1151 (0.1151)  loss_giou_4_hybrid: 0.3313 (0.3313)  loss_class_enc_hybrid: 0.7361 (0.7361)  loss_bbox_enc_hybrid: 0.0712 (0.0712)  loss_giou_enc_hybrid: 0.2524 (0.2524)  mem: 735  max mem: 19988
[2025-05-20 05:56:53 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:14:10 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5484  loss: 23.7006 (26.4479)  loss_class: 0.4358 (0.5895)  loss_bbox: 0.1939 (0.2944)  loss_giou: 0.2180 (0.3727)  loss_class_0: 0.5565 (0.7362)  loss_bbox_0: 0.1752 (0.3056)  loss_giou_0: 0.2863 (0.3945)  loss_class_1: 0.4767 (0.6588)  loss_bbox_1: 0.1878 (0.2885)  loss_giou_1: 0.2405 (0.3729)  loss_class_2: 0.4623 (0.6175)  loss_bbox_2: 0.1843 (0.2895)  loss_giou_2: 0.2375 (0.3736)  loss_class_3: 0.4548 (0.5951)  loss_bbox_3: 0.1763 (0.2926)  loss_giou_3: 0.2353 (0.3723)  loss_class_4: 0.4425 (0.5945)  loss_bbox_4: 0.1835 (0.2912)  loss_giou_4: 0.2280 (0.3711)  loss_class_enc: 0.8720 (1.0553)  loss_bbox_enc: 0.1882 (0.2935)  loss_giou_enc: 0.3293 (0.4048)  loss_class_dn: 0.3905 (0.3481)  loss_bbox_dn: 0.1613 (0.4022)  loss_giou_dn: 0.3431 (0.4050)  loss_class_dn_0: 0.4488 (0.4132)  loss_bbox_dn_0: 0.3194 (0.5102)  loss_giou_dn_0: 0.5172 (0.5218)  loss_class_dn_1: 0.3991 (0.3739)  loss_bbox_dn_1: 0.2149 (0.4281)  loss_giou_dn_1: 0.3649 (0.4256)  loss_class_dn_2: 0.3910 (0.3525)  loss_bbox_dn_2: 0.1878 (0.4139)  loss_giou_dn_2: 0.3651 (0.4114)  loss_class_dn_3: 0.3879 (0.3508)  loss_bbox_dn_3: 0.1689 (0.4038)  loss_giou_dn_3: 0.3567 (0.4058)  loss_class_dn_4: 0.3921 (0.3494)  loss_bbox_dn_4: 0.1628 (0.4029)  loss_giou_dn_4: 0.3527 (0.4051)  loss_class_hybrid: 0.5065 (0.6506)  loss_bbox_hybrid: 0.1858 (0.2847)  loss_giou_hybrid: 0.2537 (0.3651)  loss_class_0_hybrid: 0.7443 (0.7035)  loss_bbox_0_hybrid: 0.1695 (0.3063)  loss_giou_0_hybrid: 0.2881 (0.3920)  loss_class_1_hybrid: 0.5898 (0.6625)  loss_bbox_1_hybrid: 0.1818 (0.2913)  loss_giou_1_hybrid: 0.2631 (0.3746)  loss_class_2_hybrid: 0.5071 (0.6520)  loss_bbox_2_hybrid: 0.1852 (0.2872)  loss_giou_2_hybrid: 0.2599 (0.3699)  loss_class_3_hybrid: 0.5129 (0.6460)  loss_bbox_3_hybrid: 0.1829 (0.2877)  loss_giou_3_hybrid: 0.2687 (0.3678)  loss_class_4_hybrid: 0.4965 (0.6491)  loss_bbox_4_hybrid: 0.1840 (0.2866)  loss_giou_4_hybrid: 0.2626 (0.3665)  loss_class_enc_hybrid: 0.8474 (0.8179)  loss_bbox_enc_hybrid: 0.2491 (0.3464)  loss_giou_enc_hybrid: 0.3599 (0.4528)
[2025-05-20 06:14:10 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 06:14:10 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37
[2025-05-20 06:14:10 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\pytorch_model.bin
[2025-05-20 06:14:11 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\optimizer.bin
[2025-05-20 06:14:11 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\scheduler.bin
[2025-05-20 06:14:11 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\sampler.bin
[2025-05-20 06:14:11 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\sampler_1.bin
[2025-05-20 06:14:11 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_37\random_states_0.pkl
[2025-05-20 06:14:11 det.__main__] INFO: Start evaluation
[2025-05-20 06:14:11 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1700 (0.1700)  evaluator_time: 0.0060 (0.0060)  time: 0.1950  data: 0.0190  mem: 728  max mem: 19988
[2025-05-20 06:14:13 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1687 (0.1687)  evaluator_time: 0.0030 (0.0036)  time: 0.1749  data: 0.0025  mem: 728  max mem: 19988
[2025-05-20 06:14:14 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1680 (0.1685)  evaluator_time: 0.0030 (0.0034)  time: 0.1725  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 06:14:16 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:18 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1691 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:20 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:21 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1679 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:23 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1715  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:25 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1677 (0.1685)  evaluator_time: 0.0030 (0.0030)  time: 0.1717  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:26 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1670 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1717  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:14:28 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1671 (0.1683)  evaluator_time: 0.0030 (0.0031)  time: 0.1716  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:14:30 det.util.utils] INFO: Test:  [110/458]  eta: 0:00:59  model_time: 0.1673 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:32 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1673 (0.1682)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:33 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1671 (0.1681)  evaluator_time: 0.0030 (0.0031)  time: 0.1712  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 06:14:35 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1676 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:14:37 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:38 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1675 (0.1681)  evaluator_time: 0.0040 (0.0033)  time: 0.1723  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:40 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1675 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1718  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:42 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1676 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:44 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1676 (0.1680)  evaluator_time: 0.0040 (0.0032)  time: 0.1720  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:14:45 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1674 (0.1680)  evaluator_time: 0.0040 (0.0033)  time: 0.1719  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 06:14:47 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1676 (0.1680)  evaluator_time: 0.0030 (0.0032)  time: 0.1716  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:49 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:40  model_time: 0.1677 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:50 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0033)  time: 0.1728  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 06:14:52 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1691 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:14:54 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1696 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:56 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1695 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:14:57 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1695 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:14:59 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1699 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1736  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:15:01 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1700 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:15:03 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 728  max mem: 19988
[2025-05-20 06:15:04 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1684)  evaluator_time: 0.0029 (0.0032)  time: 0.1726  data: 0.0004  mem: 728  max mem: 19988
[2025-05-20 06:15:06 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:08 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1695 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:10 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:11 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1696 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1742  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:13 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1696 (0.1686)  evaluator_time: 0.0030 (0.0032)  time: 0.1743  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:15 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1741  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:16 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1739  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:18 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1694 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1748  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:20 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1696 (0.1687)  evaluator_time: 0.0040 (0.0033)  time: 0.1749  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:22 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1698 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:23 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:25 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:27 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0006  mem: 728  max mem: 19988
[2025-05-20 06:15:29 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 06:15:30 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 06:15:30 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 06:15:31 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.706
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.194
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.367
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.560

[2025-05-20 06:15:31 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4362  | 0.647  | 0.437 |
| Crescent_gap  | 48   | 48  | 6940  | 1.000  | 0.927 |
| Inclusion     | 41   | 82  | 7614  | 0.793  | 0.370 |
| Oil_spot      | 58   | 125 | 8791  | 0.936  | 0.682 |
| Punching      | 74   | 74  | 1743  | 1.000  | 0.965 |
| Rolled_pit    | 10   | 25  | 2388  | 0.840  | 0.501 |
| Silk_spot     | 134  | 150 | 72007 | 0.953  | 0.635 |
| Waist_folding | 24   | 26  | 5469  | 0.962  | 0.759 |
| Water_spot    | 68   | 78  | 16039 | 0.974  | 0.825 |
| Welding_line  | 99   | 99  | 11724 | 1.000  | 0.958 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.910  | 0.706 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 06:15:31 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:15:31 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 06:15:31 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 06:15:32 det.util.engine] INFO: Epoch: [38]  [0/1834]  eta: 0:19:17  lr: 0.000010  data_time: 0.0044  iter_time: 0.6309  loss: 49.9914 (49.9914)  loss_class: 1.8172 (1.8172)  loss_bbox: 0.3932 (0.3932)  loss_giou: 0.1307 (0.1307)  loss_class_0: 2.4867 (2.4867)  loss_bbox_0: 0.2783 (0.2783)  loss_giou_0: 0.1342 (0.1342)  loss_class_1: 1.8755 (1.8755)  loss_bbox_1: 0.3845 (0.3845)  loss_giou_1: 0.1256 (0.1256)  loss_class_2: 1.9534 (1.9534)  loss_bbox_2: 0.3915 (0.3915)  loss_giou_2: 0.1284 (0.1284)  loss_class_3: 1.9686 (1.9686)  loss_bbox_3: 0.3944 (0.3944)  loss_giou_3: 0.1296 (0.1296)  loss_class_4: 1.8122 (1.8122)  loss_bbox_4: 0.3954 (0.3954)  loss_giou_4: 0.1319 (0.1319)  loss_class_enc: 1.5469 (1.5469)  loss_bbox_enc: 0.6573 (0.6573)  loss_giou_enc: 0.3163 (0.3163)  loss_class_dn: 0.4237 (0.4237)  loss_bbox_dn: 1.3220 (1.3220)  loss_giou_dn: 0.4520 (0.4520)  loss_class_dn_0: 0.4705 (0.4705)  loss_bbox_dn_0: 1.5508 (1.5508)  loss_giou_dn_0: 0.5429 (0.5429)  loss_class_dn_1: 0.4301 (0.4301)  loss_bbox_dn_1: 1.4314 (1.4314)  loss_giou_dn_1: 0.4931 (0.4931)  loss_class_dn_2: 0.4325 (0.4325)  loss_bbox_dn_2: 1.3731 (1.3731)  loss_giou_dn_2: 0.4726 (0.4726)  loss_class_dn_3: 0.4208 (0.4208)  loss_bbox_dn_3: 1.3287 (1.3287)  loss_giou_dn_3: 0.4557 (0.4557)  loss_class_dn_4: 0.4196 (0.4196)  loss_bbox_dn_4: 1.3233 (1.3233)  loss_giou_dn_4: 0.4531 (0.4531)  loss_class_hybrid: 1.7610 (1.7610)  loss_bbox_hybrid: 0.6395 (0.6395)  loss_giou_hybrid: 0.2229 (0.2229)  loss_class_0_hybrid: 1.7630 (1.7630)  loss_bbox_0_hybrid: 0.7020 (0.7020)  loss_giou_0_hybrid: 0.2637 (0.2637)  loss_class_1_hybrid: 1.7523 (1.7523)  loss_bbox_1_hybrid: 0.6567 (0.6567)  loss_giou_1_hybrid: 0.2408 (0.2408)  loss_class_2_hybrid: 1.8388 (1.8388)  loss_bbox_2_hybrid: 0.6472 (0.6472)  loss_giou_2_hybrid: 0.2358 (0.2358)  loss_class_3_hybrid: 1.8618 (1.8618)  loss_bbox_3_hybrid: 0.6901 (0.6901)  loss_giou_3_hybrid: 0.2339 (0.2339)  loss_class_4_hybrid: 1.8434 (1.8434)  loss_bbox_4_hybrid: 0.6258 (0.6258)  loss_giou_4_hybrid: 0.2165 (0.2165)  loss_class_enc_hybrid: 1.3055 (1.3055)  loss_bbox_enc_hybrid: 0.9139 (0.9139)  loss_giou_enc_hybrid: 0.3292 (0.3292)  mem: 737  max mem: 19988
[2025-05-20 06:15:32 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:32:45 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5412  loss: 19.1789 (26.2860)  loss_class: 0.3748 (0.5845)  loss_bbox: 0.2512 (0.2987)  loss_giou: 0.2243 (0.3713)  loss_class_0: 0.4575 (0.7350)  loss_bbox_0: 0.2379 (0.3063)  loss_giou_0: 0.2847 (0.3834)  loss_class_1: 0.3877 (0.6358)  loss_bbox_1: 0.2606 (0.3011)  loss_giou_1: 0.2064 (0.3743)  loss_class_2: 0.3792 (0.6114)  loss_bbox_2: 0.2560 (0.2968)  loss_giou_2: 0.2124 (0.3710)  loss_class_3: 0.3771 (0.5962)  loss_bbox_3: 0.2578 (0.2961)  loss_giou_3: 0.2240 (0.3698)  loss_class_4: 0.3735 (0.5893)  loss_bbox_4: 0.2577 (0.2954)  loss_giou_4: 0.2255 (0.3697)  loss_class_enc: 0.9729 (1.0384)  loss_bbox_enc: 0.3381 (0.2977)  loss_giou_enc: 0.2792 (0.4072)  loss_class_dn: 0.3469 (0.3462)  loss_bbox_dn: 0.1840 (0.3956)  loss_giou_dn: 0.2763 (0.4015)  loss_class_dn_0: 0.4627 (0.4100)  loss_bbox_dn_0: 0.4616 (0.5031)  loss_giou_dn_0: 0.3842 (0.5142)  loss_class_dn_1: 0.4140 (0.3722)  loss_bbox_dn_1: 0.2737 (0.4227)  loss_giou_dn_1: 0.3164 (0.4224)  loss_class_dn_2: 0.3694 (0.3515)  loss_bbox_dn_2: 0.2308 (0.4085)  loss_giou_dn_2: 0.3107 (0.4082)  loss_class_dn_3: 0.3545 (0.3496)  loss_bbox_dn_3: 0.1890 (0.3976)  loss_giou_dn_3: 0.2952 (0.4026)  loss_class_dn_4: 0.3516 (0.3478)  loss_bbox_dn_4: 0.1857 (0.3967)  loss_giou_dn_4: 0.2897 (0.4020)  loss_class_hybrid: 0.3736 (0.6400)  loss_bbox_hybrid: 0.2339 (0.2861)  loss_giou_hybrid: 0.2013 (0.3670)  loss_class_0_hybrid: 0.4667 (0.6978)  loss_bbox_0_hybrid: 0.2382 (0.3054)  loss_giou_0_hybrid: 0.2510 (0.3912)  loss_class_1_hybrid: 0.3946 (0.6473)  loss_bbox_1_hybrid: 0.2393 (0.2944)  loss_giou_1_hybrid: 0.2365 (0.3750)  loss_class_2_hybrid: 0.3932 (0.6431)  loss_bbox_2_hybrid: 0.2364 (0.2894)  loss_giou_2_hybrid: 0.2155 (0.3710)  loss_class_3_hybrid: 0.3770 (0.6375)  loss_bbox_3_hybrid: 0.2380 (0.2903)  loss_giou_3_hybrid: 0.2088 (0.3696)  loss_class_4_hybrid: 0.3716 (0.6370)  loss_bbox_4_hybrid: 0.2383 (0.2885)  loss_giou_4_hybrid: 0.2023 (0.3685)  loss_class_enc_hybrid: 0.7003 (0.8025)  loss_bbox_enc_hybrid: 0.3852 (0.3471)  loss_giou_enc_hybrid: 0.3094 (0.4559)
[2025-05-20 06:32:45 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 06:32:45 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\pytorch_model.bin
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\optimizer.bin
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\scheduler.bin
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\sampler.bin
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\sampler_1.bin
[2025-05-20 06:32:45 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_38\random_states_0.pkl
[2025-05-20 06:32:45 det.__main__] INFO: Start evaluation
[2025-05-20 06:32:45 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:26  model_time: 0.1676 (0.1676)  evaluator_time: 0.0030 (0.0030)  time: 0.1886  data: 0.0180  mem: 732  max mem: 19988
[2025-05-20 06:32:47 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1680 (0.1678)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0020  mem: 732  max mem: 19988
[2025-05-20 06:32:49 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1680 (0.1679)  evaluator_time: 0.0030 (0.0031)  time: 0.1717  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 06:32:51 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0030)  time: 0.1716  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:32:52 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0029)  time: 0.1722  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:32:54 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1696 (0.1686)  evaluator_time: 0.0030 (0.0030)  time: 0.1731  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:32:56 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1697 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1729  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:32:57 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1695 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1727  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:32:59 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0030)  time: 0.1730  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:01 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0030)  time: 0.1733  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:03 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1693 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1738  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:04 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1738  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:06 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:08 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:10 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1737  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:11 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1693 (0.1691)  evaluator_time: 0.0040 (0.0032)  time: 0.1739  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:13 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1687 (0.1690)  evaluator_time: 0.0040 (0.0032)  time: 0.1734  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:15 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1690 (0.1691)  evaluator_time: 0.0040 (0.0041)  time: 0.1808  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:17 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0040)  time: 0.1802  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:18 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1690 (0.1690)  evaluator_time: 0.0040 (0.0040)  time: 0.1732  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:20 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1696 (0.1690)  evaluator_time: 0.0040 (0.0040)  time: 0.1739  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:22 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0040)  time: 0.1735  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 06:33:24 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0040)  time: 0.1737  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 06:33:25 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0039)  time: 0.1736  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:27 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0039)  time: 0.1731  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:29 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1691)  evaluator_time: 0.0020 (0.0039)  time: 0.1731  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:31 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1691)  evaluator_time: 0.0020 (0.0039)  time: 0.1731  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:32 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:34 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1697 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1735  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:36 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1731  data: 0.0003  mem: 732  max mem: 19988
[2025-05-20 06:33:37 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1700 (0.1692)  evaluator_time: 0.0030 (0.0038)  time: 0.1736  data: 0.0003  mem: 732  max mem: 19988
[2025-05-20 06:33:39 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1704 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1740  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:41 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1704 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1745  data: 0.0008  mem: 732  max mem: 19988
[2025-05-20 06:33:43 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1700 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1745  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:44 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1696 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1737  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:46 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0008  mem: 732  max mem: 19988
[2025-05-20 06:33:48 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1700 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1741  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 06:33:50 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1698 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:51 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:53 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1693)  evaluator_time: 0.0040 (0.0037)  time: 0.1744  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:33:55 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1690 (0.1693)  evaluator_time: 0.0040 (0.0037)  time: 0.1743  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:57 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:33:58 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 06:34:00 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1730  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:34:02 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0036)  time: 0.1731  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 06:34:04 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1727  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 06:34:05 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 06:34:05 det.util.engine] INFO: Averaged stats: model_time: 0.1689 (0.1692)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 06:34:05 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.691
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.321
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.558

[2025-05-20 06:34:05 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3591  | 0.647  | 0.409 |
| Crescent_gap  | 48   | 48  | 6495  | 1.000  | 0.903 |
| Inclusion     | 41   | 82  | 7635  | 0.768  | 0.341 |
| Oil_spot      | 58   | 125 | 13005 | 0.944  | 0.704 |
| Punching      | 74   | 74  | 2669  | 1.000  | 0.962 |
| Rolled_pit    | 10   | 25  | 2964  | 0.880  | 0.451 |
| Silk_spot     | 134  | 150 | 70836 | 0.940  | 0.639 |
| Waist_folding | 24   | 26  | 8309  | 0.923  | 0.724 |
| Water_spot    | 68   | 78  | 13574 | 0.962  | 0.830 |
| Welding_line  | 99   | 99  | 8127  | 1.000  | 0.948 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.906  | 0.691 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 06:34:05 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:34:06 det.util.engine] INFO: Epoch: [39]  [0/1834]  eta: 0:19:01  lr: 0.000010  data_time: 0.0064  iter_time: 0.6227  loss: 16.3938 (16.3938)  loss_class: 0.2650 (0.2650)  loss_bbox: 0.1670 (0.1670)  loss_giou: 0.1603 (0.1603)  loss_class_0: 0.3879 (0.3879)  loss_bbox_0: 0.4118 (0.4118)  loss_giou_0: 0.3475 (0.3475)  loss_class_1: 0.2818 (0.2818)  loss_bbox_1: 0.2542 (0.2542)  loss_giou_1: 0.1630 (0.1630)  loss_class_2: 0.2281 (0.2281)  loss_bbox_2: 0.1905 (0.1905)  loss_giou_2: 0.1005 (0.1005)  loss_class_3: 0.2632 (0.2632)  loss_bbox_3: 0.1846 (0.1846)  loss_giou_3: 0.1526 (0.1526)  loss_class_4: 0.2622 (0.2622)  loss_bbox_4: 0.1792 (0.1792)  loss_giou_4: 0.1558 (0.1558)  loss_class_enc: 1.5022 (1.5022)  loss_bbox_enc: 0.0937 (0.0937)  loss_giou_enc: 0.1203 (0.1203)  loss_class_dn: 0.3008 (0.3008)  loss_bbox_dn: 0.2404 (0.2404)  loss_giou_dn: 0.2089 (0.2089)  loss_class_dn_0: 0.4878 (0.4878)  loss_bbox_dn_0: 0.4386 (0.4386)  loss_giou_dn_0: 0.3471 (0.3471)  loss_class_dn_1: 0.3662 (0.3662)  loss_bbox_dn_1: 0.2933 (0.2933)  loss_giou_dn_1: 0.2397 (0.2397)  loss_class_dn_2: 0.3057 (0.3057)  loss_bbox_dn_2: 0.2643 (0.2643)  loss_giou_dn_2: 0.2178 (0.2178)  loss_class_dn_3: 0.2991 (0.2991)  loss_bbox_dn_3: 0.2531 (0.2531)  loss_giou_dn_3: 0.2012 (0.2012)  loss_class_dn_4: 0.2986 (0.2986)  loss_bbox_dn_4: 0.2511 (0.2511)  loss_giou_dn_4: 0.2059 (0.2059)  loss_class_hybrid: 0.2960 (0.2960)  loss_bbox_hybrid: 0.1560 (0.1560)  loss_giou_hybrid: 0.2023 (0.2023)  loss_class_0_hybrid: 0.3629 (0.3629)  loss_bbox_0_hybrid: 0.2263 (0.2263)  loss_giou_0_hybrid: 0.2456 (0.2456)  loss_class_1_hybrid: 0.2679 (0.2679)  loss_bbox_1_hybrid: 0.1628 (0.1628)  loss_giou_1_hybrid: 0.1447 (0.1447)  loss_class_2_hybrid: 0.2773 (0.2773)  loss_bbox_2_hybrid: 0.1730 (0.1730)  loss_giou_2_hybrid: 0.1673 (0.1673)  loss_class_3_hybrid: 0.2914 (0.2914)  loss_bbox_3_hybrid: 0.1652 (0.1652)  loss_giou_3_hybrid: 0.1888 (0.1888)  loss_class_4_hybrid: 0.2903 (0.2903)  loss_bbox_4_hybrid: 0.1636 (0.1636)  loss_giou_4_hybrid: 0.1936 (0.1936)  loss_class_enc_hybrid: 0.8862 (0.8862)  loss_bbox_enc_hybrid: 0.2130 (0.2130)  loss_giou_enc_hybrid: 0.2285 (0.2285)  mem: 739  max mem: 19988
[2025-05-20 06:34:06 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:51:22 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5560  loss: 19.1180 (25.9770)  loss_class: 0.3679 (0.5936)  loss_bbox: 0.1190 (0.2886)  loss_giou: 0.2892 (0.3585)  loss_class_0: 0.5061 (0.7416)  loss_bbox_0: 0.0982 (0.2993)  loss_giou_0: 0.2750 (0.3767)  loss_class_1: 0.4203 (0.6446)  loss_bbox_1: 0.1236 (0.2876)  loss_giou_1: 0.2900 (0.3622)  loss_class_2: 0.3847 (0.6179)  loss_bbox_2: 0.1151 (0.2845)  loss_giou_2: 0.2868 (0.3588)  loss_class_3: 0.3738 (0.5922)  loss_bbox_3: 0.1177 (0.2904)  loss_giou_3: 0.2958 (0.3597)  loss_class_4: 0.3699 (0.5935)  loss_bbox_4: 0.1177 (0.2883)  loss_giou_4: 0.2990 (0.3584)  loss_class_enc: 0.9051 (1.0496)  loss_bbox_enc: 0.1329 (0.2913)  loss_giou_enc: 0.3467 (0.3919)  loss_class_dn: 0.3616 (0.3431)  loss_bbox_dn: 0.1022 (0.3919)  loss_giou_dn: 0.3014 (0.3917)  loss_class_dn_0: 0.4447 (0.4093)  loss_bbox_dn_0: 0.1676 (0.4963)  loss_giou_dn_0: 0.4107 (0.5061)  loss_class_dn_1: 0.3864 (0.3702)  loss_bbox_dn_1: 0.1042 (0.4176)  loss_giou_dn_1: 0.3226 (0.4124)  loss_class_dn_2: 0.3651 (0.3480)  loss_bbox_dn_2: 0.1013 (0.4038)  loss_giou_dn_2: 0.3080 (0.3979)  loss_class_dn_3: 0.3668 (0.3462)  loss_bbox_dn_3: 0.1024 (0.3936)  loss_giou_dn_3: 0.3047 (0.3924)  loss_class_dn_4: 0.3597 (0.3445)  loss_bbox_dn_4: 0.1026 (0.3930)  loss_giou_dn_4: 0.2993 (0.3920)  loss_class_hybrid: 0.3989 (0.6391)  loss_bbox_hybrid: 0.1093 (0.2820)  loss_giou_hybrid: 0.2951 (0.3559)  loss_class_0_hybrid: 0.5248 (0.6958)  loss_bbox_0_hybrid: 0.1172 (0.3040)  loss_giou_0_hybrid: 0.2840 (0.3837)  loss_class_1_hybrid: 0.4602 (0.6437)  loss_bbox_1_hybrid: 0.1010 (0.2937)  loss_giou_1_hybrid: 0.2967 (0.3674)  loss_class_2_hybrid: 0.4097 (0.6376)  loss_bbox_2_hybrid: 0.1155 (0.2884)  loss_giou_2_hybrid: 0.2869 (0.3616)  loss_class_3_hybrid: 0.4015 (0.6320)  loss_bbox_3_hybrid: 0.1163 (0.2869)  loss_giou_3_hybrid: 0.2926 (0.3596)  loss_class_4_hybrid: 0.4079 (0.6352)  loss_bbox_4_hybrid: 0.1097 (0.2841)  loss_giou_4_hybrid: 0.2951 (0.3576)  loss_class_enc_hybrid: 0.6971 (0.7972)  loss_bbox_enc_hybrid: 0.1607 (0.3449)  loss_giou_enc_hybrid: 0.3398 (0.4474)
[2025-05-20 06:51:22 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 06:51:22 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\pytorch_model.bin
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\optimizer.bin
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\scheduler.bin
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\sampler.bin
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\sampler_1.bin
[2025-05-20 06:51:22 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_39\random_states_0.pkl
[2025-05-20 06:51:22 det.__main__] INFO: Start evaluation
[2025-05-20 06:51:22 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:26  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1890  data: 0.0180  mem: 726  max mem: 19988
[2025-05-20 06:51:24 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1745  data: 0.0022  mem: 726  max mem: 19988
[2025-05-20 06:51:26 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1685 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:28 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1688 (0.1690)  evaluator_time: 0.0030 (0.0029)  time: 0.1725  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:29 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1697 (0.1692)  evaluator_time: 0.0030 (0.0029)  time: 0.1732  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:51:31 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0030)  time: 0.1735  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:33 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0030)  time: 0.1732  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:51:35 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1687 (0.1692)  evaluator_time: 0.0030 (0.0030)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:36 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1686 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:38 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:40 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:51:41 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0032)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:51:43 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1697 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1733  data: 0.0004  mem: 726  max mem: 19988
[2025-05-20 06:51:45 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:51:47 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0042)  time: 0.1811  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:51:49 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1692)  evaluator_time: 0.0040 (0.0042)  time: 0.1811  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:50 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1684 (0.1692)  evaluator_time: 0.0030 (0.0042)  time: 0.1734  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:51:52 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0041)  time: 0.1725  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:51:54 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1682 (0.1691)  evaluator_time: 0.0030 (0.0040)  time: 0.1721  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 06:51:55 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0040)  time: 0.1725  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 06:51:57 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1676 (0.1690)  evaluator_time: 0.0040 (0.0040)  time: 0.1724  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:51:59 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0040)  time: 0.1728  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:01 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0039)  time: 0.1736  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:02 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1691 (0.1690)  evaluator_time: 0.0030 (0.0039)  time: 0.1737  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:04 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0039)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:06 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1690)  evaluator_time: 0.0027 (0.0038)  time: 0.1728  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:08 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1730  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:09 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1733  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:11 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0038)  time: 0.1731  data: 0.0004  mem: 726  max mem: 19988
[2025-05-20 06:52:13 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1730  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:15 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:16 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:18 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1689 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:20 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:21 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1731  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:23 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1686 (0.1691)  evaluator_time: 0.0040 (0.0036)  time: 0.1731  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 06:52:25 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1686 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1731  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 06:52:27 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:28 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1691 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1729  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:30 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1682 (0.1690)  evaluator_time: 0.0040 (0.0037)  time: 0.1740  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:32 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1681 (0.1691)  evaluator_time: 0.0040 (0.0037)  time: 0.1740  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 06:52:34 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1728  data: 0.0004  mem: 726  max mem: 19988
[2025-05-20 06:52:35 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1688 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1726  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:37 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1688 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1730  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 06:52:39 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1686 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1732  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 06:52:41 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1734  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 06:52:42 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0006  mem: 725  max mem: 19988
[2025-05-20 06:52:42 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 06:52:42 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.28s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.708
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.065
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.570

[2025-05-20 06:52:42 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4562  | 0.588  | 0.325 |
| Crescent_gap  | 48   | 48  | 4918  | 1.000  | 0.925 |
| Inclusion     | 41   | 82  | 8792  | 0.817  | 0.444 |
| Oil_spot      | 58   | 125 | 10682 | 0.912  | 0.703 |
| Punching      | 74   | 74  | 2203  | 1.000  | 0.988 |
| Rolled_pit    | 10   | 25  | 2899  | 0.840  | 0.459 |
| Silk_spot     | 134  | 150 | 71785 | 0.933  | 0.678 |
| Waist_folding | 24   | 26  | 7339  | 0.962  | 0.781 |
| Water_spot    | 68   | 78  | 12820 | 0.974  | 0.824 |
| Welding_line  | 99   | 99  | 11149 | 1.000  | 0.957 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.903  | 0.708 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 06:52:42 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 06:52:42 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 06:52:43 det.util.engine] INFO: Epoch: [40]  [0/1834]  eta: 0:19:26  lr: 0.000010  data_time: 0.0008  iter_time: 0.6358  loss: 23.1014 (23.1014)  loss_class: 0.5384 (0.5384)  loss_bbox: 0.2400 (0.2400)  loss_giou: 0.2715 (0.2715)  loss_class_0: 0.9315 (0.9315)  loss_bbox_0: 0.2249 (0.2249)  loss_giou_0: 0.2609 (0.2609)  loss_class_1: 0.8527 (0.8527)  loss_bbox_1: 0.2090 (0.2090)  loss_giou_1: 0.2403 (0.2403)  loss_class_2: 0.6392 (0.6392)  loss_bbox_2: 0.2610 (0.2610)  loss_giou_2: 0.2684 (0.2684)  loss_class_3: 0.5376 (0.5376)  loss_bbox_3: 0.2467 (0.2467)  loss_giou_3: 0.2812 (0.2812)  loss_class_4: 0.5412 (0.5412)  loss_bbox_4: 0.2406 (0.2406)  loss_giou_4: 0.2703 (0.2703)  loss_class_enc: 1.1021 (1.1021)  loss_bbox_enc: 0.2569 (0.2569)  loss_giou_enc: 0.2796 (0.2796)  loss_class_dn: 0.3502 (0.3502)  loss_bbox_dn: 0.3181 (0.3181)  loss_giou_dn: 0.2751 (0.2751)  loss_class_dn_0: 0.4624 (0.4624)  loss_bbox_dn_0: 0.4651 (0.4651)  loss_giou_dn_0: 0.4211 (0.4211)  loss_class_dn_1: 0.4082 (0.4082)  loss_bbox_dn_1: 0.4044 (0.4044)  loss_giou_dn_1: 0.3467 (0.3467)  loss_class_dn_2: 0.3576 (0.3576)  loss_bbox_dn_2: 0.3525 (0.3525)  loss_giou_dn_2: 0.3006 (0.3006)  loss_class_dn_3: 0.3550 (0.3550)  loss_bbox_dn_3: 0.3312 (0.3312)  loss_giou_dn_3: 0.2862 (0.2862)  loss_class_dn_4: 0.3527 (0.3527)  loss_bbox_dn_4: 0.3236 (0.3236)  loss_giou_dn_4: 0.2820 (0.2820)  loss_class_hybrid: 0.6707 (0.6707)  loss_bbox_hybrid: 0.1412 (0.1412)  loss_giou_hybrid: 0.2000 (0.2000)  loss_class_0_hybrid: 0.8647 (0.8647)  loss_bbox_0_hybrid: 0.1547 (0.1547)  loss_giou_0_hybrid: 0.2085 (0.2085)  loss_class_1_hybrid: 0.7681 (0.7681)  loss_bbox_1_hybrid: 0.1581 (0.1581)  loss_giou_1_hybrid: 0.2112 (0.2112)  loss_class_2_hybrid: 0.6680 (0.6680)  loss_bbox_2_hybrid: 0.1597 (0.1597)  loss_giou_2_hybrid: 0.1998 (0.1998)  loss_class_3_hybrid: 0.6546 (0.6546)  loss_bbox_3_hybrid: 0.1532 (0.1532)  loss_giou_3_hybrid: 0.1947 (0.1947)  loss_class_4_hybrid: 0.6686 (0.6686)  loss_bbox_4_hybrid: 0.1416 (0.1416)  loss_giou_4_hybrid: 0.2050 (0.2050)  loss_class_enc_hybrid: 0.8218 (0.8218)  loss_bbox_enc_hybrid: 0.3491 (0.3491)  loss_giou_enc_hybrid: 0.4218 (0.4218)  mem: 735  max mem: 19988
[2025-05-20 06:52:43 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:10:02 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5421  loss: 19.5870 (25.6882)  loss_class: 0.3662 (0.5795)  loss_bbox: 0.1269 (0.2844)  loss_giou: 0.2138 (0.3588)  loss_class_0: 0.6062 (0.7299)  loss_bbox_0: 0.1390 (0.2979)  loss_giou_0: 0.2614 (0.3776)  loss_class_1: 0.4486 (0.6328)  loss_bbox_1: 0.1439 (0.2850)  loss_giou_1: 0.2484 (0.3617)  loss_class_2: 0.4260 (0.5984)  loss_bbox_2: 0.1267 (0.2852)  loss_giou_2: 0.2271 (0.3603)  loss_class_3: 0.3836 (0.5808)  loss_bbox_3: 0.1268 (0.2831)  loss_giou_3: 0.2207 (0.3593)  loss_class_4: 0.3730 (0.5803)  loss_bbox_4: 0.1272 (0.2831)  loss_giou_4: 0.2172 (0.3590)  loss_class_enc: 0.9126 (1.0435)  loss_bbox_enc: 0.2892 (0.2871)  loss_giou_enc: 0.3632 (0.3925)  loss_class_dn: 0.3590 (0.3435)  loss_bbox_dn: 0.1403 (0.3897)  loss_giou_dn: 0.2528 (0.3932)  loss_class_dn_0: 0.4525 (0.4100)  loss_bbox_dn_0: 0.2654 (0.4958)  loss_giou_dn_0: 0.4799 (0.5053)  loss_class_dn_1: 0.4087 (0.3699)  loss_bbox_dn_1: 0.1758 (0.4166)  loss_giou_dn_1: 0.2979 (0.4143)  loss_class_dn_2: 0.3769 (0.3478)  loss_bbox_dn_2: 0.1491 (0.4024)  loss_giou_dn_2: 0.2575 (0.3998)  loss_class_dn_3: 0.3746 (0.3454)  loss_bbox_dn_3: 0.1413 (0.3914)  loss_giou_dn_3: 0.2478 (0.3941)  loss_class_dn_4: 0.3630 (0.3447)  loss_bbox_dn_4: 0.1386 (0.3906)  loss_giou_dn_4: 0.2547 (0.3935)  loss_class_hybrid: 0.4155 (0.6225)  loss_bbox_hybrid: 0.1380 (0.2753)  loss_giou_hybrid: 0.2340 (0.3534)  loss_class_0_hybrid: 0.5751 (0.6773)  loss_bbox_0_hybrid: 0.1723 (0.3002)  loss_giou_0_hybrid: 0.2961 (0.3811)  loss_class_1_hybrid: 0.4656 (0.6268)  loss_bbox_1_hybrid: 0.1636 (0.2848)  loss_giou_1_hybrid: 0.2678 (0.3644)  loss_class_2_hybrid: 0.4239 (0.6175)  loss_bbox_2_hybrid: 0.1420 (0.2810)  loss_giou_2_hybrid: 0.2580 (0.3587)  loss_class_3_hybrid: 0.4345 (0.6155)  loss_bbox_3_hybrid: 0.1393 (0.2794)  loss_giou_3_hybrid: 0.2535 (0.3564)  loss_class_4_hybrid: 0.4247 (0.6197)  loss_bbox_4_hybrid: 0.1329 (0.2774)  loss_giou_4_hybrid: 0.2364 (0.3548)  loss_class_enc_hybrid: 0.7456 (0.7909)  loss_bbox_enc_hybrid: 0.2156 (0.3415)  loss_giou_enc_hybrid: 0.3887 (0.4412)
[2025-05-20 07:10:02 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 07:10:02 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40
[2025-05-20 07:10:02 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\pytorch_model.bin
[2025-05-20 07:10:03 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\optimizer.bin
[2025-05-20 07:10:03 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\scheduler.bin
[2025-05-20 07:10:03 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\sampler.bin
[2025-05-20 07:10:03 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\sampler_1.bin
[2025-05-20 07:10:03 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_40\random_states_0.pkl
[2025-05-20 07:10:03 det.__main__] INFO: Start evaluation
[2025-05-20 07:10:03 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:28  model_time: 0.1688 (0.1688)  evaluator_time: 0.0030 (0.0030)  time: 0.1938  data: 0.0220  mem: 732  max mem: 19988
[2025-05-20 07:10:05 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1681 (0.1682)  evaluator_time: 0.0030 (0.0035)  time: 0.1744  data: 0.0027  mem: 732  max mem: 19988
[2025-05-20 07:10:06 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:08 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1682 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1724  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:10 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:12 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0032)  time: 0.1725  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:13 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:09  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0054)  time: 0.1794  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:15 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1681 (0.1684)  evaluator_time: 0.0030 (0.0051)  time: 0.1791  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:17 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0049)  time: 0.1725  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:19 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1680 (0.1684)  evaluator_time: 0.0040 (0.0048)  time: 0.1728  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:20 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:02  model_time: 0.1680 (0.1684)  evaluator_time: 0.0030 (0.0046)  time: 0.1725  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:22 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1680 (0.1683)  evaluator_time: 0.0030 (0.0045)  time: 0.1722  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 07:10:24 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1677 (0.1682)  evaluator_time: 0.0030 (0.0044)  time: 0.1716  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:25 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1679 (0.1682)  evaluator_time: 0.0030 (0.0043)  time: 0.1714  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:10:27 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:55  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0042)  time: 0.1719  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:10:29 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1679 (0.1682)  evaluator_time: 0.0030 (0.0042)  time: 0.1723  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:31 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1676 (0.1681)  evaluator_time: 0.0040 (0.0042)  time: 0.1724  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:32 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1673 (0.1681)  evaluator_time: 0.0030 (0.0041)  time: 0.1719  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:34 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1677 (0.1681)  evaluator_time: 0.0030 (0.0041)  time: 0.1719  data: 0.0008  mem: 732  max mem: 19988
[2025-05-20 07:10:36 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1680 (0.1681)  evaluator_time: 0.0040 (0.0041)  time: 0.1726  data: 0.0008  mem: 732  max mem: 19988
[2025-05-20 07:10:38 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1680 (0.1681)  evaluator_time: 0.0040 (0.0040)  time: 0.1726  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:39 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1681 (0.1681)  evaluator_time: 0.0030 (0.0040)  time: 0.1724  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:41 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0040)  time: 0.1724  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:43 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0040)  time: 0.1726  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:44 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1679 (0.1681)  evaluator_time: 0.0030 (0.0039)  time: 0.1723  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:10:46 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1681)  evaluator_time: 0.0020 (0.0039)  time: 0.1719  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:10:48 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0039)  time: 0.1719  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:50 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1677 (0.1681)  evaluator_time: 0.0030 (0.0038)  time: 0.1721  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:10:51 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0038)  time: 0.1727  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 07:10:53 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1682)  evaluator_time: 0.0030 (0.0038)  time: 0.1731  data: 0.0004  mem: 732  max mem: 19988
[2025-05-20 07:10:55 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1685 (0.1682)  evaluator_time: 0.0030 (0.0038)  time: 0.1730  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:57 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1728  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:10:58 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:11:00 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0037)  time: 0.1738  data: 0.0009  mem: 732  max mem: 19988
[2025-05-20 07:11:02 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1691 (0.1684)  evaluator_time: 0.0030 (0.0037)  time: 0.1737  data: 0.0009  mem: 732  max mem: 19988
[2025-05-20 07:11:03 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1696 (0.1684)  evaluator_time: 0.0038 (0.0037)  time: 0.1743  data: 0.0008  mem: 732  max mem: 19988
[2025-05-20 07:11:05 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1696 (0.1684)  evaluator_time: 0.0031 (0.0037)  time: 0.1740  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:07 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1687 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1730  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:09 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1686 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:10 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1685)  evaluator_time: 0.0040 (0.0037)  time: 0.1745  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:12 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1700 (0.1685)  evaluator_time: 0.0040 (0.0037)  time: 0.1749  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:11:14 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1693 (0.1685)  evaluator_time: 0.0030 (0.0037)  time: 0.1732  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:11:16 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1731  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:11:17 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1733  data: 0.0005  mem: 732  max mem: 19988
[2025-05-20 07:11:19 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:21 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1690 (0.1686)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0007  mem: 732  max mem: 19988
[2025-05-20 07:11:22 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1691 (0.1686)  evaluator_time: 0.0030 (0.0036)  time: 0.1733  data: 0.0006  mem: 732  max mem: 19988
[2025-05-20 07:11:22 det.util.engine] INFO: Averaged stats: model_time: 0.1691 (0.1686)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 07:11:23 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.690
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.352
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.389
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552

[2025-05-20 07:11:23 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3368  | 0.588  | 0.370 |
| Crescent_gap  | 48   | 48  | 5375  | 1.000  | 0.930 |
| Inclusion     | 41   | 82  | 10872 | 0.768  | 0.349 |
| Oil_spot      | 58   | 125 | 13806 | 0.936  | 0.678 |
| Punching      | 74   | 74  | 2164  | 1.000  | 0.989 |
| Rolled_pit    | 10   | 25  | 2961  | 0.880  | 0.407 |
| Silk_spot     | 134  | 150 | 65139 | 0.927  | 0.654 |
| Waist_folding | 24   | 26  | 7024  | 0.962  | 0.743 |
| Water_spot    | 68   | 78  | 16035 | 0.962  | 0.820 |
| Welding_line  | 99   | 99  | 10153 | 1.000  | 0.962 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.902  | 0.690 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 07:11:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:11:23 det.util.engine] INFO: Epoch: [41]  [0/1834]  eta: 0:12:47  lr: 0.000010  data_time: 0.0086  iter_time: 0.4183  loss: 0.0002 (0.0002)  loss_class: 0.0000 (0.0000)  loss_bbox: 0.0000 (0.0000)  loss_giou: 0.0000 (0.0000)  loss_class_0: 0.0000 (0.0000)  loss_bbox_0: 0.0000 (0.0000)  loss_giou_0: 0.0000 (0.0000)  loss_class_1: 0.0000 (0.0000)  loss_bbox_1: 0.0000 (0.0000)  loss_giou_1: 0.0000 (0.0000)  loss_class_2: 0.0000 (0.0000)  loss_bbox_2: 0.0000 (0.0000)  loss_giou_2: 0.0000 (0.0000)  loss_class_3: 0.0000 (0.0000)  loss_bbox_3: 0.0000 (0.0000)  loss_giou_3: 0.0000 (0.0000)  loss_class_4: 0.0000 (0.0000)  loss_bbox_4: 0.0000 (0.0000)  loss_giou_4: 0.0000 (0.0000)  loss_class_enc: 0.0000 (0.0000)  loss_bbox_enc: 0.0000 (0.0000)  loss_giou_enc: 0.0000 (0.0000)  loss_class_dn: 0.0000 (0.0000)  loss_bbox_dn: 0.0000 (0.0000)  loss_giou_dn: 0.0000 (0.0000)  loss_class_dn_0: 0.0000 (0.0000)  loss_bbox_dn_0: 0.0000 (0.0000)  loss_giou_dn_0: 0.0000 (0.0000)  loss_class_dn_1: 0.0000 (0.0000)  loss_bbox_dn_1: 0.0000 (0.0000)  loss_giou_dn_1: 0.0000 (0.0000)  loss_class_dn_2: 0.0000 (0.0000)  loss_bbox_dn_2: 0.0000 (0.0000)  loss_giou_dn_2: 0.0000 (0.0000)  loss_class_dn_3: 0.0000 (0.0000)  loss_bbox_dn_3: 0.0000 (0.0000)  loss_giou_dn_3: 0.0000 (0.0000)  loss_class_dn_4: 0.0000 (0.0000)  loss_bbox_dn_4: 0.0000 (0.0000)  loss_giou_dn_4: 0.0000 (0.0000)  loss_class_hybrid: 0.0000 (0.0000)  loss_bbox_hybrid: 0.0000 (0.0000)  loss_giou_hybrid: 0.0000 (0.0000)  loss_class_0_hybrid: 0.0000 (0.0000)  loss_bbox_0_hybrid: 0.0000 (0.0000)  loss_giou_0_hybrid: 0.0000 (0.0000)  loss_class_1_hybrid: 0.0000 (0.0000)  loss_bbox_1_hybrid: 0.0000 (0.0000)  loss_giou_1_hybrid: 0.0000 (0.0000)  loss_class_2_hybrid: 0.0000 (0.0000)  loss_bbox_2_hybrid: 0.0000 (0.0000)  loss_giou_2_hybrid: 0.0000 (0.0000)  loss_class_3_hybrid: 0.0000 (0.0000)  loss_bbox_3_hybrid: 0.0000 (0.0000)  loss_giou_3_hybrid: 0.0000 (0.0000)  loss_class_4_hybrid: 0.0000 (0.0000)  loss_bbox_4_hybrid: 0.0000 (0.0000)  loss_giou_4_hybrid: 0.0000 (0.0000)  loss_class_enc_hybrid: 0.0000 (0.0000)  loss_bbox_enc_hybrid: 0.0000 (0.0000)  loss_giou_enc_hybrid: 0.0000 (0.0000)  mem: 744  max mem: 19988
[2025-05-20 07:11:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:28:41 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5698  loss: 25.5355 (26.1016)  loss_class: 0.4459 (0.5920)  loss_bbox: 0.2086 (0.2882)  loss_giou: 0.3439 (0.3626)  loss_class_0: 0.6156 (0.7369)  loss_bbox_0: 0.2544 (0.3018)  loss_giou_0: 0.3781 (0.3812)  loss_class_1: 0.4989 (0.6538)  loss_bbox_1: 0.2073 (0.2865)  loss_giou_1: 0.3795 (0.3654)  loss_class_2: 0.4479 (0.6101)  loss_bbox_2: 0.2184 (0.2878)  loss_giou_2: 0.3402 (0.3662)  loss_class_3: 0.4450 (0.5938)  loss_bbox_3: 0.2398 (0.2890)  loss_giou_3: 0.3378 (0.3634)  loss_class_4: 0.4431 (0.5884)  loss_bbox_4: 0.2066 (0.2888)  loss_giou_4: 0.3417 (0.3630)  loss_class_enc: 1.0949 (1.0489)  loss_bbox_enc: 0.2962 (0.2910)  loss_giou_enc: 0.4045 (0.4015)  loss_class_dn: 0.4015 (0.3483)  loss_bbox_dn: 0.2666 (0.3842)  loss_giou_dn: 0.3695 (0.3974)  loss_class_dn_0: 0.4675 (0.4153)  loss_bbox_dn_0: 0.4400 (0.4929)  loss_giou_dn_0: 0.5346 (0.5137)  loss_class_dn_1: 0.4223 (0.3748)  loss_bbox_dn_1: 0.3412 (0.4112)  loss_giou_dn_1: 0.3963 (0.4189)  loss_class_dn_2: 0.4111 (0.3526)  loss_bbox_dn_2: 0.3160 (0.3971)  loss_giou_dn_2: 0.3773 (0.4039)  loss_class_dn_3: 0.4085 (0.3507)  loss_bbox_dn_3: 0.2791 (0.3859)  loss_giou_dn_3: 0.3759 (0.3980)  loss_class_dn_4: 0.4026 (0.3497)  loss_bbox_dn_4: 0.2869 (0.3850)  loss_giou_dn_4: 0.3666 (0.3976)  loss_class_hybrid: 0.4659 (0.6491)  loss_bbox_hybrid: 0.2156 (0.2794)  loss_giou_hybrid: 0.3438 (0.3574)  loss_class_0_hybrid: 0.6219 (0.7002)  loss_bbox_0_hybrid: 0.2420 (0.3019)  loss_giou_0_hybrid: 0.3929 (0.3850)  loss_class_1_hybrid: 0.5337 (0.6614)  loss_bbox_1_hybrid: 0.2206 (0.2876)  loss_giou_1_hybrid: 0.3327 (0.3670)  loss_class_2_hybrid: 0.5347 (0.6537)  loss_bbox_2_hybrid: 0.1919 (0.2836)  loss_giou_2_hybrid: 0.3662 (0.3617)  loss_class_3_hybrid: 0.5139 (0.6509)  loss_bbox_3_hybrid: 0.1996 (0.2810)  loss_giou_3_hybrid: 0.3514 (0.3592)  loss_class_4_hybrid: 0.4670 (0.6459)  loss_bbox_4_hybrid: 0.2107 (0.2814)  loss_giou_4_hybrid: 0.3412 (0.3588)  loss_class_enc_hybrid: 0.8217 (0.8010)  loss_bbox_enc_hybrid: 0.3050 (0.3445)  loss_giou_enc_hybrid: 0.4588 (0.4537)
[2025-05-20 07:28:41 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 07:28:41 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41
[2025-05-20 07:28:41 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\pytorch_model.bin
[2025-05-20 07:28:42 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\optimizer.bin
[2025-05-20 07:28:42 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\scheduler.bin
[2025-05-20 07:28:42 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\sampler.bin
[2025-05-20 07:28:42 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\sampler_1.bin
[2025-05-20 07:28:42 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_41\random_states_0.pkl
[2025-05-20 07:28:42 det.__main__] INFO: Start evaluation
[2025-05-20 07:28:42 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1670 (0.1670)  evaluator_time: 0.0030 (0.0030)  time: 0.1990  data: 0.0280  mem: 730  max mem: 19988
[2025-05-20 07:28:44 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:17  model_time: 0.1670 (0.1672)  evaluator_time: 0.0030 (0.0034)  time: 0.1739  data: 0.0032  mem: 730  max mem: 19988
[2025-05-20 07:28:45 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:15  model_time: 0.1677 (0.1675)  evaluator_time: 0.0030 (0.0031)  time: 0.1715  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:28:47 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:13  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0030)  time: 0.1714  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 07:28:49 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:11  model_time: 0.1670 (0.1674)  evaluator_time: 0.0030 (0.0030)  time: 0.1712  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:28:50 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1680 (0.1677)  evaluator_time: 0.0030 (0.0031)  time: 0.1721  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:28:52 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1678)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:28:54 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:06  model_time: 0.1687 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1726  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:28:56 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0031)  time: 0.1729  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:28:57 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:28:59 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1683 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:01 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1684 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:03 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1684 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1725  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:04 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1687 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1723  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:06 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1683 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:08 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1683 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1736  data: 0.0008  mem: 730  max mem: 19988
[2025-05-20 07:29:09 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1688 (0.1683)  evaluator_time: 0.0040 (0.0033)  time: 0.1737  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:11 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1684 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1727  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:13 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1720  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:15 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1685 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:16 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1686 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1729  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:18 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1690 (0.1684)  evaluator_time: 0.0040 (0.0033)  time: 0.1737  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:20 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1690 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:22 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1688 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:23 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1688 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:25 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1690 (0.1686)  evaluator_time: 0.0020 (0.0033)  time: 0.1732  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:27 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1702 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:29 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1700 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:30 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1695 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1730  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:32 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1692 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:34 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1695 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:35 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1695 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:37 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:39 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1687 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:41 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1686 (0.1688)  evaluator_time: 0.0040 (0.0033)  time: 0.1731  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:42 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1692 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:44 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1698 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:29:46 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:48 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:49 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1690 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0004  mem: 730  max mem: 19988
[2025-05-20 07:29:51 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1698 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1751  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:53 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1742  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:29:55 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:56 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1698 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 730  max mem: 19988
[2025-05-20 07:29:58 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:30:00 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0007  mem: 730  max mem: 19988
[2025-05-20 07:30:01 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1698 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1740  data: 0.0006  mem: 730  max mem: 19988
[2025-05-20 07:30:01 det.util.engine] INFO: Averaged stats: model_time: 0.1698 (0.1690)  evaluator_time: 0.0030 (0.0033)
[2025-05-20 07:30:02 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.702
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.343
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.561

[2025-05-20 07:30:02 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3228  | 0.529  | 0.312 |
| Crescent_gap  | 48   | 48  | 5336  | 1.000  | 0.941 |
| Inclusion     | 41   | 82  | 9760  | 0.805  | 0.395 |
| Oil_spot      | 58   | 125 | 13455 | 0.952  | 0.709 |
| Punching      | 74   | 74  | 2145  | 1.000  | 0.968 |
| Rolled_pit    | 10   | 25  | 2940  | 0.840  | 0.453 |
| Silk_spot     | 134  | 150 | 66905 | 0.953  | 0.636 |
| Waist_folding | 24   | 26  | 8399  | 0.962  | 0.808 |
| Water_spot    | 68   | 78  | 13530 | 0.987  | 0.826 |
| Welding_line  | 99   | 99  | 11291 | 1.000  | 0.973 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.903  | 0.702 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 07:30:02 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:30:02 det.util.engine] INFO: Epoch: [42]  [0/1834]  eta: 0:17:29  lr: 0.000010  data_time: 0.0230  iter_time: 0.5722  loss: 20.0530 (20.0530)  loss_class: 0.3204 (0.3204)  loss_bbox: 0.3349 (0.3349)  loss_giou: 0.2192 (0.2192)  loss_class_0: 0.3950 (0.3950)  loss_bbox_0: 0.4654 (0.4654)  loss_giou_0: 0.2879 (0.2879)  loss_class_1: 0.3457 (0.3457)  loss_bbox_1: 0.4203 (0.4203)  loss_giou_1: 0.2425 (0.2425)  loss_class_2: 0.3305 (0.3305)  loss_bbox_2: 0.4154 (0.4154)  loss_giou_2: 0.2339 (0.2339)  loss_class_3: 0.3183 (0.3183)  loss_bbox_3: 0.3284 (0.3284)  loss_giou_3: 0.2193 (0.2193)  loss_class_4: 0.3194 (0.3194)  loss_bbox_4: 0.3295 (0.3295)  loss_giou_4: 0.2196 (0.2196)  loss_class_enc: 1.0559 (1.0559)  loss_bbox_enc: 0.2107 (0.2107)  loss_giou_enc: 0.1824 (0.1824)  loss_class_dn: 0.3244 (0.3244)  loss_bbox_dn: 0.3420 (0.3420)  loss_giou_dn: 0.2397 (0.2397)  loss_class_dn_0: 0.4243 (0.4243)  loss_bbox_dn_0: 0.4422 (0.4422)  loss_giou_dn_0: 0.3356 (0.3356)  loss_class_dn_1: 0.3864 (0.3864)  loss_bbox_dn_1: 0.4132 (0.4132)  loss_giou_dn_1: 0.2832 (0.2832)  loss_class_dn_2: 0.3465 (0.3465)  loss_bbox_dn_2: 0.4429 (0.4429)  loss_giou_dn_2: 0.2777 (0.2777)  loss_class_dn_3: 0.3236 (0.3236)  loss_bbox_dn_3: 0.3385 (0.3385)  loss_giou_dn_3: 0.2393 (0.2393)  loss_class_dn_4: 0.3228 (0.3228)  loss_bbox_dn_4: 0.3412 (0.3412)  loss_giou_dn_4: 0.2394 (0.2394)  loss_class_hybrid: 0.3162 (0.3162)  loss_bbox_hybrid: 0.3199 (0.3199)  loss_giou_hybrid: 0.2170 (0.2170)  loss_class_0_hybrid: 0.3818 (0.3818)  loss_bbox_0_hybrid: 0.4412 (0.4412)  loss_giou_0_hybrid: 0.2719 (0.2719)  loss_class_1_hybrid: 0.3433 (0.3433)  loss_bbox_1_hybrid: 0.4294 (0.4294)  loss_giou_1_hybrid: 0.2494 (0.2494)  loss_class_2_hybrid: 0.3295 (0.3295)  loss_bbox_2_hybrid: 0.4156 (0.4156)  loss_giou_2_hybrid: 0.2382 (0.2382)  loss_class_3_hybrid: 0.3182 (0.3182)  loss_bbox_3_hybrid: 0.3112 (0.3112)  loss_giou_3_hybrid: 0.2257 (0.2257)  loss_class_4_hybrid: 0.3162 (0.3162)  loss_bbox_4_hybrid: 0.3097 (0.3097)  loss_giou_4_hybrid: 0.2226 (0.2226)  loss_class_enc_hybrid: 0.7372 (0.7372)  loss_bbox_enc_hybrid: 0.2136 (0.2136)  loss_giou_enc_hybrid: 0.1874 (0.1874)  mem: 743  max mem: 19988
[2025-05-20 07:30:02 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:47:25 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5797  loss: 24.3530 (26.3386)  loss_class: 0.4241 (0.5919)  loss_bbox: 0.1638 (0.2949)  loss_giou: 0.3687 (0.3699)  loss_class_0: 0.6115 (0.7461)  loss_bbox_0: 0.1399 (0.3106)  loss_giou_0: 0.4137 (0.3888)  loss_class_1: 0.4967 (0.6579)  loss_bbox_1: 0.1277 (0.2915)  loss_giou_1: 0.3551 (0.3722)  loss_class_2: 0.4864 (0.6125)  loss_bbox_2: 0.1270 (0.2935)  loss_giou_2: 0.3397 (0.3705)  loss_class_3: 0.4343 (0.5980)  loss_bbox_3: 0.1341 (0.2939)  loss_giou_3: 0.3306 (0.3690)  loss_class_4: 0.4255 (0.5872)  loss_bbox_4: 0.1586 (0.2965)  loss_giou_4: 0.3614 (0.3716)  loss_class_enc: 1.0868 (1.0600)  loss_bbox_enc: 0.2179 (0.2953)  loss_giou_enc: 0.4363 (0.4054)  loss_class_dn: 0.4238 (0.3492)  loss_bbox_dn: 0.1816 (0.3911)  loss_giou_dn: 0.4387 (0.3996)  loss_class_dn_0: 0.4750 (0.4172)  loss_bbox_dn_0: 0.2770 (0.5012)  loss_giou_dn_0: 0.5861 (0.5168)  loss_class_dn_1: 0.4463 (0.3764)  loss_bbox_dn_1: 0.1763 (0.4176)  loss_giou_dn_1: 0.4483 (0.4218)  loss_class_dn_2: 0.4306 (0.3549)  loss_bbox_dn_2: 0.1726 (0.4036)  loss_giou_dn_2: 0.4196 (0.4068)  loss_class_dn_3: 0.4300 (0.3519)  loss_bbox_dn_3: 0.1812 (0.3935)  loss_giou_dn_3: 0.4505 (0.4006)  loss_class_dn_4: 0.4266 (0.3505)  loss_bbox_dn_4: 0.1803 (0.3923)  loss_giou_dn_4: 0.4522 (0.4001)  loss_class_hybrid: 0.4479 (0.6380)  loss_bbox_hybrid: 0.1488 (0.2852)  loss_giou_hybrid: 0.4551 (0.3668)  loss_class_0_hybrid: 0.5606 (0.6964)  loss_bbox_0_hybrid: 0.1785 (0.3076)  loss_giou_0_hybrid: 0.5033 (0.3954)  loss_class_1_hybrid: 0.4891 (0.6564)  loss_bbox_1_hybrid: 0.1542 (0.2913)  loss_giou_1_hybrid: 0.4490 (0.3762)  loss_class_2_hybrid: 0.5031 (0.6427)  loss_bbox_2_hybrid: 0.1430 (0.2883)  loss_giou_2_hybrid: 0.4441 (0.3713)  loss_class_3_hybrid: 0.4758 (0.6353)  loss_bbox_3_hybrid: 0.1479 (0.2881)  loss_giou_3_hybrid: 0.4428 (0.3692)  loss_class_4_hybrid: 0.4517 (0.6341)  loss_bbox_4_hybrid: 0.1484 (0.2866)  loss_giou_4_hybrid: 0.4436 (0.3681)  loss_class_enc_hybrid: 0.6959 (0.8056)  loss_bbox_enc_hybrid: 0.2425 (0.3523)  loss_giou_enc_hybrid: 0.5654 (0.4614)
[2025-05-20 07:47:25 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 07:47:25 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\pytorch_model.bin
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\optimizer.bin
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\scheduler.bin
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\sampler.bin
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\sampler_1.bin
[2025-05-20 07:47:25 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_42\random_states_0.pkl
[2025-05-20 07:47:25 det.__main__] INFO: Start evaluation
[2025-05-20 07:47:25 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:28  model_time: 0.1680 (0.1680)  evaluator_time: 0.0030 (0.0030)  time: 0.1930  data: 0.0220  mem: 729  max mem: 19988
[2025-05-20 07:47:27 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1686 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1745  data: 0.0025  mem: 729  max mem: 19988
[2025-05-20 07:47:29 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1686 (0.1686)  evaluator_time: 0.0030 (0.0031)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:30 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1723  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:47:32 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1685 (0.1687)  evaluator_time: 0.0030 (0.0030)  time: 0.1724  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:34 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:47:36 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1690 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1727  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:37 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1728  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:39 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0031)  time: 0.1730  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:41 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1726  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:42 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:47:44 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1681 (0.1687)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:47:46 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:47:48 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1729  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:49 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0032)  time: 0.1732  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:51 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1690 (0.1688)  evaluator_time: 0.0030 (0.0033)  time: 0.1736  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:47:53 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1693 (0.1689)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:55 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1739  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:47:56 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1696 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:47:58 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1692 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:00 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1700 (0.1690)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:02 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1738  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:03 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1700 (0.1691)  evaluator_time: 0.0030 (0.0033)  time: 0.1743  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:05 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1700 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1742  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:07 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1690 (0.1691)  evaluator_time: 0.0040 (0.0033)  time: 0.1734  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:09 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1690 (0.1692)  evaluator_time: 0.0026 (0.0033)  time: 0.1733  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:10 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1700 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 07:48:12 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1700 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 07:48:14 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1695 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:15 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0033)  time: 0.1734  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:17 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1693 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0008  mem: 729  max mem: 19988
[2025-05-20 07:48:19 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1693 (0.1693)  evaluator_time: 0.0030 (0.0032)  time: 0.1733  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:21 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1690 (0.1693)  evaluator_time: 0.0030 (0.0033)  time: 0.1732  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:22 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1685 (0.1692)  evaluator_time: 0.0030 (0.0032)  time: 0.1726  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 07:48:24 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1797  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:26 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1797  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:28 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1680 (0.1692)  evaluator_time: 0.0030 (0.0037)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:29 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:31 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1681 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1721  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:33 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1680 (0.1691)  evaluator_time: 0.0040 (0.0037)  time: 0.1736  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 07:48:35 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1680 (0.1691)  evaluator_time: 0.0040 (0.0037)  time: 0.1737  data: 0.0005  mem: 729  max mem: 19988
[2025-05-20 07:48:36 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1680 (0.1691)  evaluator_time: 0.0030 (0.0037)  time: 0.1724  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:38 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1681 (0.1691)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:40 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1724  data: 0.0006  mem: 729  max mem: 19988
[2025-05-20 07:48:42 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1723  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:43 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1727  data: 0.0007  mem: 729  max mem: 19988
[2025-05-20 07:48:44 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0036)  time: 0.1725  data: 0.0004  mem: 729  max mem: 19988
[2025-05-20 07:48:44 det.util.engine] INFO: Averaged stats: model_time: 0.1680 (0.1690)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 07:48:45 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.29s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.691
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.052
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.194
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.389
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.477
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.459
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.553

[2025-05-20 07:48:45 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4622  | 0.647  | 0.313 |
| Crescent_gap  | 48   | 48  | 4761  | 1.000  | 0.928 |
| Inclusion     | 41   | 82  | 8459  | 0.817  | 0.402 |
| Oil_spot      | 58   | 125 | 11673 | 0.928  | 0.694 |
| Punching      | 74   | 74  | 1505  | 0.986  | 0.947 |
| Rolled_pit    | 10   | 25  | 3761  | 0.920  | 0.434 |
| Silk_spot     | 134  | 150 | 66806 | 0.927  | 0.634 |
| Waist_folding | 24   | 26  | 8050  | 0.962  | 0.777 |
| Water_spot    | 68   | 78  | 17167 | 0.974  | 0.808 |
| Welding_line  | 99   | 99  | 10499 | 1.000  | 0.970 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.916  | 0.691 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 07:48:45 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 07:48:46 det.util.engine] INFO: Epoch: [43]  [0/1834]  eta: 0:17:56  lr: 0.000010  data_time: 0.0008  iter_time: 0.5867  loss: 43.8037 (43.8037)  loss_class: 0.7295 (0.7295)  loss_bbox: 0.7396 (0.7396)  loss_giou: 0.8830 (0.8830)  loss_class_0: 1.0098 (1.0098)  loss_bbox_0: 0.5009 (0.5009)  loss_giou_0: 0.7078 (0.7078)  loss_class_1: 0.8695 (0.8695)  loss_bbox_1: 0.6755 (0.6755)  loss_giou_1: 0.7607 (0.7607)  loss_class_2: 0.6724 (0.6724)  loss_bbox_2: 0.7847 (0.7847)  loss_giou_2: 0.8813 (0.8813)  loss_class_3: 0.7473 (0.7473)  loss_bbox_3: 0.7425 (0.7425)  loss_giou_3: 0.8873 (0.8873)  loss_class_4: 0.7140 (0.7140)  loss_bbox_4: 0.7416 (0.7416)  loss_giou_4: 0.8826 (0.8826)  loss_class_enc: 1.0511 (1.0511)  loss_bbox_enc: 0.4858 (0.4858)  loss_giou_enc: 0.7830 (0.7830)  loss_class_dn: 0.5407 (0.5407)  loss_bbox_dn: 0.6084 (0.6084)  loss_giou_dn: 0.7595 (0.7595)  loss_class_dn_0: 0.4805 (0.4805)  loss_bbox_dn_0: 0.6964 (0.6964)  loss_giou_dn_0: 0.8231 (0.8231)  loss_class_dn_1: 0.5421 (0.5421)  loss_bbox_dn_1: 0.6042 (0.6042)  loss_giou_dn_1: 0.7553 (0.7553)  loss_class_dn_2: 0.5493 (0.5493)  loss_bbox_dn_2: 0.6122 (0.6122)  loss_giou_dn_2: 0.7593 (0.7593)  loss_class_dn_3: 0.5703 (0.5703)  loss_bbox_dn_3: 0.6133 (0.6133)  loss_giou_dn_3: 0.7634 (0.7634)  loss_class_dn_4: 0.5775 (0.5775)  loss_bbox_dn_4: 0.6099 (0.6099)  loss_giou_dn_4: 0.7601 (0.7601)  loss_class_hybrid: 1.3489 (1.3489)  loss_bbox_hybrid: 0.3732 (0.3732)  loss_giou_hybrid: 0.5540 (0.5540)  loss_class_0_hybrid: 1.2341 (1.2341)  loss_bbox_0_hybrid: 0.4157 (0.4157)  loss_giou_0_hybrid: 0.6033 (0.6033)  loss_class_1_hybrid: 1.2695 (1.2695)  loss_bbox_1_hybrid: 0.3882 (0.3882)  loss_giou_1_hybrid: 0.5741 (0.5741)  loss_class_2_hybrid: 1.2849 (1.2849)  loss_bbox_2_hybrid: 0.3842 (0.3842)  loss_giou_2_hybrid: 0.5671 (0.5671)  loss_class_3_hybrid: 1.3225 (1.3225)  loss_bbox_3_hybrid: 0.3750 (0.3750)  loss_giou_3_hybrid: 0.5621 (0.5621)  loss_class_4_hybrid: 1.3751 (1.3751)  loss_bbox_4_hybrid: 0.3800 (0.3800)  loss_giou_4_hybrid: 0.5613 (0.5613)  loss_class_enc_hybrid: 1.2174 (1.2174)  loss_bbox_enc_hybrid: 0.4604 (0.4604)  loss_giou_enc_hybrid: 0.6775 (0.6775)  mem: 736  max mem: 19988
[2025-05-20 07:48:46 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:06:03 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5491  loss: 28.3525 (26.2425)  loss_class: 0.4660 (0.6063)  loss_bbox: 0.2121 (0.2908)  loss_giou: 0.2199 (0.3609)  loss_class_0: 0.5495 (0.7303)  loss_bbox_0: 0.1660 (0.3132)  loss_giou_0: 0.2424 (0.3836)  loss_class_1: 0.4848 (0.6631)  loss_bbox_1: 0.1840 (0.2889)  loss_giou_1: 0.2259 (0.3630)  loss_class_2: 0.4965 (0.6336)  loss_bbox_2: 0.1899 (0.2887)  loss_giou_2: 0.2356 (0.3592)  loss_class_3: 0.5269 (0.6136)  loss_bbox_3: 0.1846 (0.2874)  loss_giou_3: 0.2355 (0.3594)  loss_class_4: 0.4926 (0.5994)  loss_bbox_4: 0.1836 (0.2921)  loss_giou_4: 0.2196 (0.3625)  loss_class_enc: 1.0743 (1.0441)  loss_bbox_enc: 0.2103 (0.3044)  loss_giou_enc: 0.2989 (0.4001)  loss_class_dn: 0.4196 (0.3430)  loss_bbox_dn: 0.3222 (0.3895)  loss_giou_dn: 0.4599 (0.3937)  loss_class_dn_0: 0.4523 (0.4080)  loss_bbox_dn_0: 0.4307 (0.4958)  loss_giou_dn_0: 0.5608 (0.5083)  loss_class_dn_1: 0.4304 (0.3686)  loss_bbox_dn_1: 0.3187 (0.4173)  loss_giou_dn_1: 0.4946 (0.4158)  loss_class_dn_2: 0.4272 (0.3475)  loss_bbox_dn_2: 0.3177 (0.4026)  loss_giou_dn_2: 0.4751 (0.4006)  loss_class_dn_3: 0.4253 (0.3453)  loss_bbox_dn_3: 0.3198 (0.3917)  loss_giou_dn_3: 0.4746 (0.3948)  loss_class_dn_4: 0.4219 (0.3445)  loss_bbox_dn_4: 0.3225 (0.3906)  loss_giou_dn_4: 0.4716 (0.3940)  loss_class_hybrid: 0.7101 (0.6682)  loss_bbox_hybrid: 0.1996 (0.2793)  loss_giou_hybrid: 0.2145 (0.3544)  loss_class_0_hybrid: 0.5100 (0.6982)  loss_bbox_0_hybrid: 0.2337 (0.3089)  loss_giou_0_hybrid: 0.2676 (0.3866)  loss_class_1_hybrid: 0.6664 (0.6674)  loss_bbox_1_hybrid: 0.2147 (0.2895)  loss_giou_1_hybrid: 0.2864 (0.3668)  loss_class_2_hybrid: 0.7190 (0.6627)  loss_bbox_2_hybrid: 0.2091 (0.2860)  loss_giou_2_hybrid: 0.2307 (0.3608)  loss_class_3_hybrid: 0.7046 (0.6628)  loss_bbox_3_hybrid: 0.2036 (0.2831)  loss_giou_3_hybrid: 0.2268 (0.3580)  loss_class_4_hybrid: 0.7035 (0.6636)  loss_bbox_4_hybrid: 0.1995 (0.2822)  loss_giou_4_hybrid: 0.2134 (0.3565)  loss_class_enc_hybrid: 0.8514 (0.8076)  loss_bbox_enc_hybrid: 0.2855 (0.3527)  loss_giou_enc_hybrid: 0.3801 (0.4509)
[2025-05-20 08:06:03 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 08:06:03 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\pytorch_model.bin
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\optimizer.bin
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\scheduler.bin
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\sampler.bin
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\sampler_1.bin
[2025-05-20 08:06:03 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_43\random_states_0.pkl
[2025-05-20 08:06:03 det.__main__] INFO: Start evaluation
[2025-05-20 08:06:04 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1700 (0.1700)  evaluator_time: 0.0030 (0.0030)  time: 0.1990  data: 0.0260  mem: 726  max mem: 19988
[2025-05-20 08:06:05 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:18  model_time: 0.1692 (0.1691)  evaluator_time: 0.0030 (0.0031)  time: 0.1754  data: 0.0031  mem: 726  max mem: 19988
[2025-05-20 08:06:07 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:16  model_time: 0.1690 (0.1692)  evaluator_time: 0.0030 (0.0031)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:09 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:14  model_time: 0.1690 (0.1691)  evaluator_time: 0.0030 (0.0029)  time: 0.1727  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:11 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:12  model_time: 0.1687 (0.1690)  evaluator_time: 0.0030 (0.0028)  time: 0.1721  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:12 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:10  model_time: 0.1682 (0.1690)  evaluator_time: 0.0030 (0.0029)  time: 0.1726  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:14 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:08  model_time: 0.1682 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1727  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:16 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:07  model_time: 0.1680 (0.1689)  evaluator_time: 0.0030 (0.0029)  time: 0.1725  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:18 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:05  model_time: 0.1687 (0.1688)  evaluator_time: 0.0030 (0.0030)  time: 0.1727  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:19 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:03  model_time: 0.1682 (0.1688)  evaluator_time: 0.0030 (0.0030)  time: 0.1725  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:21 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:01  model_time: 0.1680 (0.1687)  evaluator_time: 0.0030 (0.0031)  time: 0.1722  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:23 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:00  model_time: 0.1670 (0.1686)  evaluator_time: 0.0031 (0.0031)  time: 0.1718  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:24 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:58  model_time: 0.1670 (0.1685)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:26 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:56  model_time: 0.1672 (0.1684)  evaluator_time: 0.0030 (0.0031)  time: 0.1714  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:28 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:54  model_time: 0.1671 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1717  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:30 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:53  model_time: 0.1672 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1719  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:31 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:51  model_time: 0.1671 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1722  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:33 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:49  model_time: 0.1670 (0.1682)  evaluator_time: 0.0030 (0.0032)  time: 0.1722  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:35 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:47  model_time: 0.1670 (0.1681)  evaluator_time: 0.0030 (0.0032)  time: 0.1714  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:36 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:46  model_time: 0.1670 (0.1681)  evaluator_time: 0.0040 (0.0033)  time: 0.1716  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 08:06:38 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:44  model_time: 0.1680 (0.1681)  evaluator_time: 0.0040 (0.0033)  time: 0.1722  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:40 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:42  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1723  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:42 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:43 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:39  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1725  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:45 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:37  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1724  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:47 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:35  model_time: 0.1680 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1718  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:48 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1677 (0.1681)  evaluator_time: 0.0030 (0.0033)  time: 0.1719  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:06:50 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:32  model_time: 0.1680 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1729  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:52 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:30  model_time: 0.1694 (0.1682)  evaluator_time: 0.0030 (0.0033)  time: 0.1733  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:06:54 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:28  model_time: 0.1694 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:55 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1690 (0.1683)  evaluator_time: 0.0030 (0.0033)  time: 0.1731  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:57 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:25  model_time: 0.1687 (0.1683)  evaluator_time: 0.0030 (0.0032)  time: 0.1730  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:06:59 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:23  model_time: 0.1696 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1735  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:07:01 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1690 (0.1684)  evaluator_time: 0.0030 (0.0033)  time: 0.1737  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:07:02 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1697 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1741  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 08:07:04 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:18  model_time: 0.1700 (0.1685)  evaluator_time: 0.0030 (0.0033)  time: 0.1747  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:06 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:16  model_time: 0.1710 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1752  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:08 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1710 (0.1686)  evaluator_time: 0.0030 (0.0033)  time: 0.1749  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 08:07:09 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1701 (0.1687)  evaluator_time: 0.0030 (0.0033)  time: 0.1746  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:11 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:11  model_time: 0.1693 (0.1687)  evaluator_time: 0.0040 (0.0037)  time: 0.1835  data: 0.0004  mem: 726  max mem: 19988
[2025-05-20 08:07:13 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1693 (0.1688)  evaluator_time: 0.0040 (0.0037)  time: 0.1832  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:07:15 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1743  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:17 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1700 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1735  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:18 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1698 (0.1688)  evaluator_time: 0.0030 (0.0037)  time: 0.1737  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:20 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1705 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1747  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 08:07:22 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1692 (0.1689)  evaluator_time: 0.0030 (0.0037)  time: 0.1742  data: 0.0005  mem: 726  max mem: 19988
[2025-05-20 08:07:23 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0036)  time: 0.1730  data: 0.0005  mem: 727  max mem: 19988
[2025-05-20 08:07:23 det.util.engine] INFO: Averaged stats: model_time: 0.1690 (0.1689)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 08:07:23 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.688
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.548

[2025-05-20 08:07:23 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3753  | 0.647  | 0.365 |
| Crescent_gap  | 48   | 48  | 7394  | 1.000  | 0.927 |
| Inclusion     | 41   | 82  | 10546 | 0.768  | 0.342 |
| Oil_spot      | 58   | 125 | 12199 | 0.936  | 0.708 |
| Punching      | 74   | 74  | 3106  | 0.973  | 0.926 |
| Rolled_pit    | 10   | 25  | 2625  | 0.800  | 0.425 |
| Silk_spot     | 134  | 150 | 65704 | 0.927  | 0.636 |
| Waist_folding | 24   | 26  | 6629  | 0.962  | 0.767 |
| Water_spot    | 68   | 78  | 14236 | 0.962  | 0.830 |
| Welding_line  | 99   | 99  | 11012 | 1.000  | 0.953 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.897  | 0.688 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 08:07:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:07:24 det.util.engine] INFO: Epoch: [44]  [0/1834]  eta: 0:19:22  lr: 0.000010  data_time: 0.0125  iter_time: 0.6341  loss: 22.5978 (22.5978)  loss_class: 0.4825 (0.4825)  loss_bbox: 0.2120 (0.2120)  loss_giou: 0.2081 (0.2081)  loss_class_0: 1.2010 (1.2010)  loss_bbox_0: 0.1336 (0.1336)  loss_giou_0: 0.1724 (0.1724)  loss_class_1: 1.1745 (1.1745)  loss_bbox_1: 0.0943 (0.0943)  loss_giou_1: 0.1502 (0.1502)  loss_class_2: 1.3310 (1.3310)  loss_bbox_2: 0.2024 (0.2024)  loss_giou_2: 0.2042 (0.2042)  loss_class_3: 0.6462 (0.6462)  loss_bbox_3: 0.2119 (0.2119)  loss_giou_3: 0.2125 (0.2125)  loss_class_4: 0.4879 (0.4879)  loss_bbox_4: 0.2106 (0.2106)  loss_giou_4: 0.2059 (0.2059)  loss_class_enc: 1.0543 (1.0543)  loss_bbox_enc: 0.7657 (0.7657)  loss_giou_enc: 0.6026 (0.6026)  loss_class_dn: 0.2664 (0.2664)  loss_bbox_dn: 0.2112 (0.2112)  loss_giou_dn: 0.1734 (0.1734)  loss_class_dn_0: 0.4744 (0.4744)  loss_bbox_dn_0: 0.5686 (0.5686)  loss_giou_dn_0: 0.4984 (0.4984)  loss_class_dn_1: 0.3279 (0.3279)  loss_bbox_dn_1: 0.2960 (0.2960)  loss_giou_dn_1: 0.2693 (0.2693)  loss_class_dn_2: 0.2621 (0.2621)  loss_bbox_dn_2: 0.2308 (0.2308)  loss_giou_dn_2: 0.1878 (0.1878)  loss_class_dn_3: 0.2625 (0.2625)  loss_bbox_dn_3: 0.2185 (0.2185)  loss_giou_dn_3: 0.1811 (0.1811)  loss_class_dn_4: 0.2679 (0.2679)  loss_bbox_dn_4: 0.2150 (0.2150)  loss_giou_dn_4: 0.1756 (0.1756)  loss_class_hybrid: 0.5247 (0.5247)  loss_bbox_hybrid: 0.1879 (0.1879)  loss_giou_hybrid: 0.1608 (0.1608)  loss_class_0_hybrid: 0.7321 (0.7321)  loss_bbox_0_hybrid: 0.1497 (0.1497)  loss_giou_0_hybrid: 0.1495 (0.1495)  loss_class_1_hybrid: 0.5890 (0.5890)  loss_bbox_1_hybrid: 0.1643 (0.1643)  loss_giou_1_hybrid: 0.1531 (0.1531)  loss_class_2_hybrid: 0.5534 (0.5534)  loss_bbox_2_hybrid: 0.1817 (0.1817)  loss_giou_2_hybrid: 0.1469 (0.1469)  loss_class_3_hybrid: 0.4813 (0.4813)  loss_bbox_3_hybrid: 0.1949 (0.1949)  loss_giou_3_hybrid: 0.1568 (0.1568)  loss_class_4_hybrid: 0.4822 (0.4822)  loss_bbox_4_hybrid: 0.1874 (0.1874)  loss_giou_4_hybrid: 0.1614 (0.1614)  loss_class_enc_hybrid: 0.9808 (0.9808)  loss_bbox_enc_hybrid: 0.5677 (0.5677)  loss_giou_enc_hybrid: 0.6411 (0.6411)  mem: 732  max mem: 19988
[2025-05-20 08:07:24 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:27:01 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0010  iter_time: 0.7435  loss: 29.7702 (25.6485)  loss_class: 0.4427 (0.5760)  loss_bbox: 0.2541 (0.2820)  loss_giou: 0.4156 (0.3576)  loss_class_0: 0.5824 (0.7270)  loss_bbox_0: 0.2053 (0.2954)  loss_giou_0: 0.3989 (0.3778)  loss_class_1: 0.5199 (0.6310)  loss_bbox_1: 0.2104 (0.2799)  loss_giou_1: 0.3298 (0.3614)  loss_class_2: 0.4669 (0.6022)  loss_bbox_2: 0.2406 (0.2778)  loss_giou_2: 0.3756 (0.3577)  loss_class_3: 0.4609 (0.5811)  loss_bbox_3: 0.2633 (0.2833)  loss_giou_3: 0.4232 (0.3577)  loss_class_4: 0.4578 (0.5744)  loss_bbox_4: 0.2678 (0.2835)  loss_giou_4: 0.4154 (0.3578)  loss_class_enc: 0.9306 (1.0365)  loss_bbox_enc: 0.3531 (0.2912)  loss_giou_enc: 0.4453 (0.4002)  loss_class_dn: 0.4242 (0.3480)  loss_bbox_dn: 0.3348 (0.3804)  loss_giou_dn: 0.5096 (0.3872)  loss_class_dn_0: 0.4498 (0.4168)  loss_bbox_dn_0: 0.5975 (0.4904)  loss_giou_dn_0: 0.5940 (0.5071)  loss_class_dn_1: 0.4256 (0.3748)  loss_bbox_dn_1: 0.3805 (0.4086)  loss_giou_dn_1: 0.5066 (0.4099)  loss_class_dn_2: 0.4211 (0.3523)  loss_bbox_dn_2: 0.3724 (0.3932)  loss_giou_dn_2: 0.5105 (0.3943)  loss_class_dn_3: 0.4174 (0.3506)  loss_bbox_dn_3: 0.3548 (0.3824)  loss_giou_dn_3: 0.5112 (0.3885)  loss_class_dn_4: 0.4208 (0.3494)  loss_bbox_dn_4: 0.3467 (0.3815)  loss_giou_dn_4: 0.5121 (0.3878)  loss_class_hybrid: 0.4634 (0.6268)  loss_bbox_hybrid: 0.2505 (0.2766)  loss_giou_hybrid: 0.4300 (0.3543)  loss_class_0_hybrid: 0.5707 (0.6791)  loss_bbox_0_hybrid: 0.2762 (0.2992)  loss_giou_0_hybrid: 0.4895 (0.3793)  loss_class_1_hybrid: 0.5247 (0.6338)  loss_bbox_1_hybrid: 0.2725 (0.2818)  loss_giou_1_hybrid: 0.4702 (0.3618)  loss_class_2_hybrid: 0.4988 (0.6277)  loss_bbox_2_hybrid: 0.2473 (0.2772)  loss_giou_2_hybrid: 0.4252 (0.3581)  loss_class_3_hybrid: 0.4935 (0.6241)  loss_bbox_3_hybrid: 0.2563 (0.2780)  loss_giou_3_hybrid: 0.4341 (0.3562)  loss_class_4_hybrid: 0.4828 (0.6226)  loss_bbox_4_hybrid: 0.2564 (0.2777)  loss_giou_4_hybrid: 0.4273 (0.3559)  loss_class_enc_hybrid: 0.7931 (0.7912)  loss_bbox_enc_hybrid: 0.4180 (0.3444)  loss_giou_enc_hybrid: 0.4894 (0.4477)
[2025-05-20 08:27:01 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 08:27:01 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44
[2025-05-20 08:27:01 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\pytorch_model.bin
[2025-05-20 08:27:02 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\optimizer.bin
[2025-05-20 08:27:02 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\scheduler.bin
[2025-05-20 08:27:02 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\sampler.bin
[2025-05-20 08:27:02 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\sampler_1.bin
[2025-05-20 08:27:02 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_44\random_states_0.pkl
[2025-05-20 08:27:02 det.__main__] INFO: Start evaluation
[2025-05-20 08:27:02 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:46  model_time: 0.1960 (0.1960)  evaluator_time: 0.0070 (0.0070)  time: 0.2315  data: 0.0285  mem: 733  max mem: 19988
[2025-05-20 08:27:04 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:28  model_time: 0.1880 (0.1888)  evaluator_time: 0.0050 (0.0057)  time: 0.1985  data: 0.0036  mem: 733  max mem: 19988
[2025-05-20 08:27:06 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:25  model_time: 0.1870 (0.1876)  evaluator_time: 0.0050 (0.0055)  time: 0.1941  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:08 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:23  model_time: 0.1859 (0.1867)  evaluator_time: 0.0050 (0.0052)  time: 0.1917  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:27:10 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:20  model_time: 0.1849 (0.1862)  evaluator_time: 0.0050 (0.0051)  time: 0.1905  data: 0.0008  mem: 733  max mem: 19988
[2025-05-20 08:27:12 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:18  model_time: 0.1841 (0.1860)  evaluator_time: 0.0050 (0.0053)  time: 0.1916  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:13 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:16  model_time: 0.1840 (0.1859)  evaluator_time: 0.0060 (0.0052)  time: 0.1920  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:27:15 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:15  model_time: 0.1850 (0.1866)  evaluator_time: 0.0050 (0.0055)  time: 0.1957  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:17 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:13  model_time: 0.1880 (0.1869)  evaluator_time: 0.0050 (0.0056)  time: 0.1980  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:19 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:11  model_time: 0.1885 (0.1871)  evaluator_time: 0.0060 (0.0056)  time: 0.1963  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:27:21 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:09  model_time: 0.1885 (0.1871)  evaluator_time: 0.0060 (0.0057)  time: 0.1958  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:27:23 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:07  model_time: 0.1870 (0.1871)  evaluator_time: 0.0050 (0.0057)  time: 0.1943  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:27:25 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:05  model_time: 0.1860 (0.1869)  evaluator_time: 0.0040 (0.0056)  time: 0.1921  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:27 det.util.utils] INFO: Test:  [130/458]  eta: 0:01:03  model_time: 0.1840 (0.1867)  evaluator_time: 0.0050 (0.0056)  time: 0.1910  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:29 det.util.utils] INFO: Test:  [140/458]  eta: 0:01:01  model_time: 0.1840 (0.1867)  evaluator_time: 0.0060 (0.0056)  time: 0.1928  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:27:31 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:59  model_time: 0.1839 (0.1865)  evaluator_time: 0.0060 (0.0057)  time: 0.1927  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:27:33 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:57  model_time: 0.1840 (0.1864)  evaluator_time: 0.0060 (0.0057)  time: 0.1919  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:27:35 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:55  model_time: 0.1840 (0.1863)  evaluator_time: 0.0050 (0.0057)  time: 0.1913  data: 0.0008  mem: 733  max mem: 19988
[2025-05-20 08:27:37 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:53  model_time: 0.1836 (0.1861)  evaluator_time: 0.0040 (0.0056)  time: 0.1899  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:27:39 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:51  model_time: 0.1834 (0.1860)  evaluator_time: 0.0050 (0.0056)  time: 0.1904  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:40 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:49  model_time: 0.1839 (0.1859)  evaluator_time: 0.0060 (0.0056)  time: 0.1911  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:27:42 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:47  model_time: 0.1840 (0.1858)  evaluator_time: 0.0050 (0.0056)  time: 0.1912  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:44 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:45  model_time: 0.1850 (0.1859)  evaluator_time: 0.0060 (0.0057)  time: 0.1926  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:27:46 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:44  model_time: 0.1867 (0.1859)  evaluator_time: 0.0060 (0.0057)  time: 0.1944  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:48 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:42  model_time: 0.1870 (0.1860)  evaluator_time: 0.0050 (0.0056)  time: 0.1943  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:50 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:40  model_time: 0.1871 (0.1861)  evaluator_time: 0.0040 (0.0056)  time: 0.1942  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:27:52 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:38  model_time: 0.1880 (0.1862)  evaluator_time: 0.0050 (0.0056)  time: 0.1951  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:54 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:36  model_time: 0.1890 (0.1863)  evaluator_time: 0.0060 (0.0056)  time: 0.1956  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:27:56 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:34  model_time: 0.1883 (0.1864)  evaluator_time: 0.0050 (0.0056)  time: 0.1953  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:27:58 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:32  model_time: 0.1873 (0.1864)  evaluator_time: 0.0050 (0.0055)  time: 0.1947  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:28:00 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:30  model_time: 0.1876 (0.1865)  evaluator_time: 0.0050 (0.0055)  time: 0.1943  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:28:02 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:28  model_time: 0.1878 (0.1865)  evaluator_time: 0.0050 (0.0055)  time: 0.1939  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:28:04 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:26  model_time: 0.1855 (0.1865)  evaluator_time: 0.0050 (0.0055)  time: 0.1926  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:28:06 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:24  model_time: 0.1840 (0.1864)  evaluator_time: 0.0050 (0.0055)  time: 0.1910  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:28:08 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:22  model_time: 0.1840 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1908  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:28:10 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:20  model_time: 0.1848 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1924  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:28:11 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:18  model_time: 0.1860 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1939  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:28:13 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:17  model_time: 0.1865 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1934  data: 0.0011  mem: 733  max mem: 19988
[2025-05-20 08:28:15 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:15  model_time: 0.1860 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1927  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:28:17 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:13  model_time: 0.1860 (0.1863)  evaluator_time: 0.0070 (0.0056)  time: 0.1951  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:28:19 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:11  model_time: 0.1866 (0.1863)  evaluator_time: 0.0060 (0.0056)  time: 0.1950  data: 0.0010  mem: 733  max mem: 19988
[2025-05-20 08:28:21 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:09  model_time: 0.1866 (0.1863)  evaluator_time: 0.0050 (0.0056)  time: 0.1923  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:28:23 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:07  model_time: 0.1870 (0.1864)  evaluator_time: 0.0050 (0.0056)  time: 0.1923  data: 0.0008  mem: 733  max mem: 19988
[2025-05-20 08:28:25 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:05  model_time: 0.1870 (0.1864)  evaluator_time: 0.0050 (0.0055)  time: 0.1930  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:28:27 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1870 (0.1864)  evaluator_time: 0.0060 (0.0056)  time: 0.1937  data: 0.0013  mem: 733  max mem: 19988
[2025-05-20 08:28:29 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1860 (0.1864)  evaluator_time: 0.0060 (0.0062)  time: 0.2083  data: 0.0012  mem: 733  max mem: 19988
[2025-05-20 08:28:31 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1850 (0.1864)  evaluator_time: 0.0050 (0.0062)  time: 0.2070  data: 0.0009  mem: 733  max mem: 19988
[2025-05-20 08:28:31 det.util.engine] INFO: Averaged stats: model_time: 0.1850 (0.1864)  evaluator_time: 0.0050 (0.0062)
[2025-05-20 08:28:31 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.48s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.689
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.055
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.344
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.380
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.546
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.535

[2025-05-20 08:28:31 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3692  | 0.588  | 0.341 |
| Crescent_gap  | 48   | 48  | 5006  | 1.000  | 0.940 |
| Inclusion     | 41   | 82  | 9505  | 0.780  | 0.361 |
| Oil_spot      | 58   | 125 | 13289 | 0.936  | 0.681 |
| Punching      | 74   | 74  | 2298  | 0.986  | 0.947 |
| Rolled_pit    | 10   | 25  | 2784  | 0.880  | 0.418 |
| Silk_spot     | 134  | 150 | 69872 | 0.920  | 0.652 |
| Waist_folding | 24   | 26  | 7302  | 0.962  | 0.756 |
| Water_spot    | 68   | 78  | 12348 | 0.962  | 0.823 |
| Welding_line  | 99   | 99  | 11100 | 1.000  | 0.967 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.901  | 0.689 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 08:28:31 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:28:32 det.util.engine] INFO: Epoch: [45]  [0/1834]  eta: 0:22:37  lr: 0.000010  data_time: 0.0124  iter_time: 0.7400  loss: 12.0448 (12.0448)  loss_class: 0.2934 (0.2934)  loss_bbox: 0.0441 (0.0441)  loss_giou: 0.1141 (0.1141)  loss_class_0: 0.3542 (0.3542)  loss_bbox_0: 0.0754 (0.0754)  loss_giou_0: 0.1290 (0.1290)  loss_class_1: 0.3074 (0.3074)  loss_bbox_1: 0.0561 (0.0561)  loss_giou_1: 0.1289 (0.1289)  loss_class_2: 0.2908 (0.2908)  loss_bbox_2: 0.0514 (0.0514)  loss_giou_2: 0.1451 (0.1451)  loss_class_3: 0.2925 (0.2925)  loss_bbox_3: 0.0505 (0.0505)  loss_giou_3: 0.1460 (0.1460)  loss_class_4: 0.3004 (0.3004)  loss_bbox_4: 0.0495 (0.0495)  loss_giou_4: 0.1213 (0.1213)  loss_class_enc: 1.3685 (1.3685)  loss_bbox_enc: 0.2624 (0.2624)  loss_giou_enc: 0.2737 (0.2737)  loss_class_dn: 0.2681 (0.2681)  loss_bbox_dn: 0.0494 (0.0494)  loss_giou_dn: 0.1254 (0.1254)  loss_class_dn_0: 0.3883 (0.3883)  loss_bbox_dn_0: 0.1761 (0.1761)  loss_giou_dn_0: 0.3134 (0.3134)  loss_class_dn_1: 0.3147 (0.3147)  loss_bbox_dn_1: 0.0827 (0.0827)  loss_giou_dn_1: 0.2073 (0.2073)  loss_class_dn_2: 0.2809 (0.2809)  loss_bbox_dn_2: 0.0629 (0.0629)  loss_giou_dn_2: 0.1658 (0.1658)  loss_class_dn_3: 0.2781 (0.2781)  loss_bbox_dn_3: 0.0613 (0.0613)  loss_giou_dn_3: 0.1595 (0.1595)  loss_class_dn_4: 0.2738 (0.2738)  loss_bbox_dn_4: 0.0515 (0.0515)  loss_giou_dn_4: 0.1287 (0.1287)  loss_class_hybrid: 0.3255 (0.3255)  loss_bbox_hybrid: 0.0392 (0.0392)  loss_giou_hybrid: 0.1037 (0.1037)  loss_class_0_hybrid: 0.3052 (0.3052)  loss_bbox_0_hybrid: 0.0397 (0.0397)  loss_giou_0_hybrid: 0.0626 (0.0626)  loss_class_1_hybrid: 0.3258 (0.3258)  loss_bbox_1_hybrid: 0.0415 (0.0415)  loss_giou_1_hybrid: 0.1016 (0.1016)  loss_class_2_hybrid: 0.3294 (0.3294)  loss_bbox_2_hybrid: 0.0406 (0.0406)  loss_giou_2_hybrid: 0.1093 (0.1093)  loss_class_3_hybrid: 0.3272 (0.3272)  loss_bbox_3_hybrid: 0.0418 (0.0418)  loss_giou_3_hybrid: 0.1136 (0.1136)  loss_class_4_hybrid: 0.3154 (0.3154)  loss_bbox_4_hybrid: 0.0408 (0.0408)  loss_giou_4_hybrid: 0.1050 (0.1050)  loss_class_enc_hybrid: 0.6906 (0.6906)  loss_bbox_enc_hybrid: 0.1390 (0.1390)  loss_giou_enc_hybrid: 0.2046 (0.2046)  mem: 735  max mem: 19988
[2025-05-20 08:28:32 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:51:06 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0011  iter_time: 0.7311  loss: 26.7656 (25.6394)  loss_class: 0.4437 (0.5573)  loss_bbox: 0.1657 (0.2990)  loss_giou: 0.3827 (0.3576)  loss_class_0: 0.7226 (0.6955)  loss_bbox_0: 0.1457 (0.3127)  loss_giou_0: 0.3748 (0.3775)  loss_class_1: 0.4726 (0.6021)  loss_bbox_1: 0.1580 (0.2999)  loss_giou_1: 0.3594 (0.3613)  loss_class_2: 0.4477 (0.5839)  loss_bbox_2: 0.1619 (0.2961)  loss_giou_2: 0.3611 (0.3561)  loss_class_3: 0.4704 (0.5666)  loss_bbox_3: 0.1672 (0.2972)  loss_giou_3: 0.3512 (0.3561)  loss_class_4: 0.4653 (0.5570)  loss_bbox_4: 0.1697 (0.2989)  loss_giou_4: 0.3776 (0.3577)  loss_class_enc: 0.8711 (1.0033)  loss_bbox_enc: 0.1669 (0.3053)  loss_giou_enc: 0.4292 (0.3988)  loss_class_dn: 0.4051 (0.3387)  loss_bbox_dn: 0.1582 (0.3938)  loss_giou_dn: 0.4356 (0.3876)  loss_class_dn_0: 0.4631 (0.4075)  loss_bbox_dn_0: 0.1868 (0.4976)  loss_giou_dn_0: 0.5478 (0.5001)  loss_class_dn_1: 0.4283 (0.3647)  loss_bbox_dn_1: 0.1573 (0.4196)  loss_giou_dn_1: 0.4263 (0.4084)  loss_class_dn_2: 0.4127 (0.3428)  loss_bbox_dn_2: 0.1542 (0.4053)  loss_giou_dn_2: 0.4317 (0.3940)  loss_class_dn_3: 0.4053 (0.3409)  loss_bbox_dn_3: 0.1525 (0.3956)  loss_giou_dn_3: 0.4365 (0.3886)  loss_class_dn_4: 0.4015 (0.3397)  loss_bbox_dn_4: 0.1531 (0.3947)  loss_giou_dn_4: 0.4351 (0.3879)  loss_class_hybrid: 0.4587 (0.6167)  loss_bbox_hybrid: 0.1475 (0.2922)  loss_giou_hybrid: 0.3708 (0.3560)  loss_class_0_hybrid: 0.6337 (0.6575)  loss_bbox_0_hybrid: 0.1385 (0.3153)  loss_giou_0_hybrid: 0.3862 (0.3841)  loss_class_1_hybrid: 0.4867 (0.6229)  loss_bbox_1_hybrid: 0.1500 (0.2995)  loss_giou_1_hybrid: 0.3671 (0.3662)  loss_class_2_hybrid: 0.4832 (0.6153)  loss_bbox_2_hybrid: 0.1540 (0.2962)  loss_giou_2_hybrid: 0.3629 (0.3610)  loss_class_3_hybrid: 0.4619 (0.6113)  loss_bbox_3_hybrid: 0.1671 (0.2957)  loss_giou_3_hybrid: 0.3683 (0.3590)  loss_class_4_hybrid: 0.4693 (0.6118)  loss_bbox_4_hybrid: 0.1589 (0.2947)  loss_giou_4_hybrid: 0.3608 (0.3578)  loss_class_enc_hybrid: 0.6483 (0.7746)  loss_bbox_enc_hybrid: 0.2114 (0.3557)  loss_giou_enc_hybrid: 0.5003 (0.4483)
[2025-05-20 08:51:06 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 08:51:06 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45
[2025-05-20 08:51:06 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\pytorch_model.bin
[2025-05-20 08:51:07 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\optimizer.bin
[2025-05-20 08:51:07 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\scheduler.bin
[2025-05-20 08:51:07 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\sampler.bin
[2025-05-20 08:51:07 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\sampler_1.bin
[2025-05-20 08:51:07 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_45\random_states_0.pkl
[2025-05-20 08:51:07 det.__main__] INFO: Start evaluation
[2025-05-20 08:51:07 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:43  model_time: 0.1902 (0.1902)  evaluator_time: 0.0050 (0.0050)  time: 0.2257  data: 0.0296  mem: 728  max mem: 19988
[2025-05-20 08:51:09 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:26  model_time: 0.1839 (0.1840)  evaluator_time: 0.0050 (0.0055)  time: 0.1937  data: 0.0040  mem: 728  max mem: 19988
[2025-05-20 08:51:11 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:24  model_time: 0.1833 (0.1837)  evaluator_time: 0.0050 (0.0052)  time: 0.1901  data: 0.0012  mem: 728  max mem: 19988
[2025-05-20 08:51:13 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:21  model_time: 0.1830 (0.1837)  evaluator_time: 0.0050 (0.0050)  time: 0.1895  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:15 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:22  model_time: 0.1846 (0.1906)  evaluator_time: 0.0050 (0.0052)  time: 0.2044  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:17 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:20  model_time: 0.1854 (0.1898)  evaluator_time: 0.0060 (0.0054)  time: 0.2066  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:19 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:18  model_time: 0.1850 (0.1890)  evaluator_time: 0.0060 (0.0053)  time: 0.1925  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:51:21 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:15  model_time: 0.1850 (0.1884)  evaluator_time: 0.0050 (0.0053)  time: 0.1910  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:51:23 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:13  model_time: 0.1848 (0.1880)  evaluator_time: 0.0050 (0.0053)  time: 0.1916  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:25 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:11  model_time: 0.1847 (0.1877)  evaluator_time: 0.0060 (0.0054)  time: 0.1919  data: 0.0012  mem: 728  max mem: 19988
[2025-05-20 08:51:27 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:09  model_time: 0.1850 (0.1875)  evaluator_time: 0.0060 (0.0054)  time: 0.1924  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:51:28 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:07  model_time: 0.1854 (0.1873)  evaluator_time: 0.0050 (0.0054)  time: 0.1926  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:30 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:05  model_time: 0.1850 (0.1871)  evaluator_time: 0.0050 (0.0054)  time: 0.1913  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:32 det.util.utils] INFO: Test:  [130/458]  eta: 0:01:03  model_time: 0.1846 (0.1869)  evaluator_time: 0.0050 (0.0054)  time: 0.1912  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:34 det.util.utils] INFO: Test:  [140/458]  eta: 0:01:01  model_time: 0.1850 (0.1868)  evaluator_time: 0.0060 (0.0055)  time: 0.1924  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:36 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:59  model_time: 0.1852 (0.1867)  evaluator_time: 0.0060 (0.0055)  time: 0.1927  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:51:38 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:57  model_time: 0.1849 (0.1866)  evaluator_time: 0.0060 (0.0056)  time: 0.1926  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:51:40 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:55  model_time: 0.1840 (0.1865)  evaluator_time: 0.0050 (0.0055)  time: 0.1918  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:42 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:53  model_time: 0.1840 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1903  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 08:51:44 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:51  model_time: 0.1846 (0.1862)  evaluator_time: 0.0050 (0.0055)  time: 0.1909  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:51:46 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:49  model_time: 0.1846 (0.1861)  evaluator_time: 0.0060 (0.0055)  time: 0.1916  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:48 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:47  model_time: 0.1843 (0.1861)  evaluator_time: 0.0050 (0.0055)  time: 0.1916  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:51:50 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:45  model_time: 0.1843 (0.1860)  evaluator_time: 0.0050 (0.0055)  time: 0.1912  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:51 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:43  model_time: 0.1830 (0.1859)  evaluator_time: 0.0050 (0.0055)  time: 0.1904  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:53 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:42  model_time: 0.1835 (0.1858)  evaluator_time: 0.0050 (0.0055)  time: 0.1903  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:55 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:40  model_time: 0.1838 (0.1857)  evaluator_time: 0.0050 (0.0055)  time: 0.1905  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:51:57 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:38  model_time: 0.1840 (0.1857)  evaluator_time: 0.0050 (0.0055)  time: 0.1906  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:51:59 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:36  model_time: 0.1847 (0.1856)  evaluator_time: 0.0050 (0.0055)  time: 0.1906  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:52:01 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:34  model_time: 0.1849 (0.1856)  evaluator_time: 0.0050 (0.0055)  time: 0.1904  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:52:03 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:32  model_time: 0.1840 (0.1855)  evaluator_time: 0.0050 (0.0055)  time: 0.1903  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:52:05 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:30  model_time: 0.1840 (0.1855)  evaluator_time: 0.0050 (0.0055)  time: 0.1906  data: 0.0011  mem: 728  max mem: 19988
[2025-05-20 08:52:07 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:28  model_time: 0.1840 (0.1854)  evaluator_time: 0.0050 (0.0054)  time: 0.1903  data: 0.0012  mem: 728  max mem: 19988
[2025-05-20 08:52:09 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:26  model_time: 0.1840 (0.1854)  evaluator_time: 0.0050 (0.0054)  time: 0.1906  data: 0.0010  mem: 728  max mem: 19988
[2025-05-20 08:52:11 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:24  model_time: 0.1840 (0.1854)  evaluator_time: 0.0050 (0.0055)  time: 0.1912  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:52:12 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:22  model_time: 0.1834 (0.1853)  evaluator_time: 0.0060 (0.0055)  time: 0.1904  data: 0.0007  mem: 728  max mem: 19988
[2025-05-20 08:52:14 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:20  model_time: 0.1834 (0.1853)  evaluator_time: 0.0060 (0.0055)  time: 0.1903  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:52:16 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:18  model_time: 0.1840 (0.1852)  evaluator_time: 0.0050 (0.0055)  time: 0.1912  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:52:18 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:16  model_time: 0.1840 (0.1852)  evaluator_time: 0.0050 (0.0055)  time: 0.1911  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:52:20 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:14  model_time: 0.1840 (0.1852)  evaluator_time: 0.0050 (0.0055)  time: 0.1904  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:52:22 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:13  model_time: 0.1840 (0.1851)  evaluator_time: 0.0070 (0.0056)  time: 0.1925  data: 0.0009  mem: 728  max mem: 19988
[2025-05-20 08:52:24 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:11  model_time: 0.1840 (0.1851)  evaluator_time: 0.0060 (0.0056)  time: 0.1932  data: 0.0013  mem: 728  max mem: 19988
[2025-05-20 08:52:26 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:09  model_time: 0.1840 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1912  data: 0.0013  mem: 728  max mem: 19988
[2025-05-20 08:52:28 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:07  model_time: 0.1840 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1903  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:52:30 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:05  model_time: 0.1836 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1902  data: 0.0008  mem: 728  max mem: 19988
[2025-05-20 08:52:32 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1837 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1914  data: 0.0013  mem: 728  max mem: 19988
[2025-05-20 08:52:34 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1847 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1944  data: 0.0015  mem: 728  max mem: 19988
[2025-05-20 08:52:35 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1850 (0.1851)  evaluator_time: 0.0050 (0.0055)  time: 0.1943  data: 0.0012  mem: 728  max mem: 19988
[2025-05-20 08:52:35 det.util.engine] INFO: Averaged stats: model_time: 0.1850 (0.1851)  evaluator_time: 0.0050 (0.0055)
[2025-05-20 08:52:36 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.47s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.691
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.101
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.183
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.371
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.547

[2025-05-20 08:52:36 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4031  | 0.588  | 0.346 |
| Crescent_gap  | 48   | 48  | 5047  | 1.000  | 0.930 |
| Inclusion     | 41   | 82  | 13640 | 0.841  | 0.376 |
| Oil_spot      | 58   | 125 | 15223 | 0.952  | 0.679 |
| Punching      | 74   | 74  | 2548  | 1.000  | 0.949 |
| Rolled_pit    | 10   | 25  | 2235  | 0.880  | 0.441 |
| Silk_spot     | 134  | 150 | 64978 | 0.933  | 0.653 |
| Waist_folding | 24   | 26  | 6305  | 0.962  | 0.756 |
| Water_spot    | 68   | 78  | 9704  | 0.974  | 0.806 |
| Welding_line  | 99   | 99  | 13359 | 1.000  | 0.969 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.913  | 0.691 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 08:52:36 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 08:52:37 det.util.engine] INFO: Epoch: [46]  [0/1834]  eta: 0:24:12  lr: 0.000010  data_time: 0.0008  iter_time: 0.7921  loss: 16.9575 (16.9575)  loss_class: 0.3619 (0.3619)  loss_bbox: 0.0765 (0.0765)  loss_giou: 0.2944 (0.2944)  loss_class_0: 0.4532 (0.4532)  loss_bbox_0: 0.0955 (0.0955)  loss_giou_0: 0.5185 (0.5185)  loss_class_1: 0.3972 (0.3972)  loss_bbox_1: 0.0883 (0.0883)  loss_giou_1: 0.3771 (0.3771)  loss_class_2: 0.3840 (0.3840)  loss_bbox_2: 0.0725 (0.0725)  loss_giou_2: 0.3415 (0.3415)  loss_class_3: 0.3734 (0.3734)  loss_bbox_3: 0.0800 (0.0800)  loss_giou_3: 0.3197 (0.3197)  loss_class_4: 0.3617 (0.3617)  loss_bbox_4: 0.0759 (0.0759)  loss_giou_4: 0.2950 (0.2950)  loss_class_enc: 1.2338 (1.2338)  loss_bbox_enc: 0.0957 (0.0957)  loss_giou_enc: 0.2893 (0.2893)  loss_class_dn: 0.3506 (0.3506)  loss_bbox_dn: 0.0745 (0.0745)  loss_giou_dn: 0.2834 (0.2834)  loss_class_dn_0: 0.4680 (0.4680)  loss_bbox_dn_0: 0.1655 (0.1655)  loss_giou_dn_0: 0.4404 (0.4404)  loss_class_dn_1: 0.3788 (0.3788)  loss_bbox_dn_1: 0.0768 (0.0768)  loss_giou_dn_1: 0.3109 (0.3109)  loss_class_dn_2: 0.3567 (0.3567)  loss_bbox_dn_2: 0.0675 (0.0675)  loss_giou_dn_2: 0.2931 (0.2931)  loss_class_dn_3: 0.3508 (0.3508)  loss_bbox_dn_3: 0.0734 (0.0734)  loss_giou_dn_3: 0.2839 (0.2839)  loss_class_dn_4: 0.3489 (0.3489)  loss_bbox_dn_4: 0.0734 (0.0734)  loss_giou_dn_4: 0.2812 (0.2812)  loss_class_hybrid: 0.3586 (0.3586)  loss_bbox_hybrid: 0.0704 (0.0704)  loss_giou_hybrid: 0.2584 (0.2584)  loss_class_0_hybrid: 0.4176 (0.4176)  loss_bbox_0_hybrid: 0.0571 (0.0571)  loss_giou_0_hybrid: 0.3407 (0.3407)  loss_class_1_hybrid: 0.3659 (0.3659)  loss_bbox_1_hybrid: 0.0736 (0.0736)  loss_giou_1_hybrid: 0.2880 (0.2880)  loss_class_2_hybrid: 0.3601 (0.3601)  loss_bbox_2_hybrid: 0.0693 (0.0693)  loss_giou_2_hybrid: 0.2766 (0.2766)  loss_class_3_hybrid: 0.3645 (0.3645)  loss_bbox_3_hybrid: 0.0715 (0.0715)  loss_giou_3_hybrid: 0.2644 (0.2644)  loss_class_4_hybrid: 0.3573 (0.3573)  loss_bbox_4_hybrid: 0.0691 (0.0691)  loss_giou_4_hybrid: 0.2559 (0.2559)  loss_class_enc_hybrid: 0.6283 (0.6283)  loss_bbox_enc_hybrid: 0.2261 (0.2261)  loss_giou_enc_hybrid: 0.5213 (0.5213)  mem: 731  max mem: 19988
[2025-05-20 08:52:37 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 09:15:03 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0009  iter_time: 0.7282  loss: 23.3363 (25.3179)  loss_class: 0.4903 (0.5823)  loss_bbox: 0.1762 (0.2713)  loss_giou: 0.3000 (0.3450)  loss_class_0: 0.5486 (0.7146)  loss_bbox_0: 0.1839 (0.2906)  loss_giou_0: 0.3582 (0.3682)  loss_class_1: 0.5016 (0.6306)  loss_bbox_1: 0.1814 (0.2745)  loss_giou_1: 0.2930 (0.3526)  loss_class_2: 0.4866 (0.5977)  loss_bbox_2: 0.1789 (0.2729)  loss_giou_2: 0.2901 (0.3491)  loss_class_3: 0.4833 (0.5871)  loss_bbox_3: 0.1799 (0.2710)  loss_giou_3: 0.2986 (0.3459)  loss_class_4: 0.4837 (0.5825)  loss_bbox_4: 0.1874 (0.2705)  loss_giou_4: 0.2961 (0.3448)  loss_class_enc: 1.0104 (1.0163)  loss_bbox_enc: 0.2851 (0.2886)  loss_giou_enc: 0.3373 (0.3882)  loss_class_dn: 0.3893 (0.3404)  loss_bbox_dn: 0.2176 (0.3765)  loss_giou_dn: 0.4018 (0.3824)  loss_class_dn_0: 0.4577 (0.4121)  loss_bbox_dn_0: 0.4896 (0.4893)  loss_giou_dn_0: 0.4497 (0.4983)  loss_class_dn_1: 0.4253 (0.3685)  loss_bbox_dn_1: 0.3356 (0.4054)  loss_giou_dn_1: 0.4091 (0.4041)  loss_class_dn_2: 0.4057 (0.3460)  loss_bbox_dn_2: 0.2916 (0.3897)  loss_giou_dn_2: 0.3926 (0.3889)  loss_class_dn_3: 0.3990 (0.3432)  loss_bbox_dn_3: 0.2100 (0.3787)  loss_giou_dn_3: 0.3952 (0.3831)  loss_class_dn_4: 0.3981 (0.3418)  loss_bbox_dn_4: 0.2022 (0.3776)  loss_giou_dn_4: 0.3910 (0.3826)  loss_class_hybrid: 0.4869 (0.6341)  loss_bbox_hybrid: 0.1993 (0.2667)  loss_giou_hybrid: 0.3632 (0.3415)  loss_class_0_hybrid: 0.5636 (0.6841)  loss_bbox_0_hybrid: 0.1674 (0.2937)  loss_giou_0_hybrid: 0.3580 (0.3716)  loss_class_1_hybrid: 0.5296 (0.6418)  loss_bbox_1_hybrid: 0.1711 (0.2768)  loss_giou_1_hybrid: 0.3131 (0.3536)  loss_class_2_hybrid: 0.5035 (0.6317)  loss_bbox_2_hybrid: 0.1789 (0.2716)  loss_giou_2_hybrid: 0.3976 (0.3479)  loss_class_3_hybrid: 0.4960 (0.6303)  loss_bbox_3_hybrid: 0.1927 (0.2706)  loss_giou_3_hybrid: 0.3918 (0.3446)  loss_class_4_hybrid: 0.4905 (0.6334)  loss_bbox_4_hybrid: 0.1904 (0.2687)  loss_giou_4_hybrid: 0.3917 (0.3427)  loss_class_enc_hybrid: 0.7608 (0.7936)  loss_bbox_enc_hybrid: 0.2551 (0.3333)  loss_giou_enc_hybrid: 0.3132 (0.4327)
[2025-05-20 09:15:03 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 09:15:03 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\pytorch_model.bin
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\optimizer.bin
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\scheduler.bin
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\sampler.bin
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\sampler_1.bin
[2025-05-20 09:15:04 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_46\random_states_0.pkl
[2025-05-20 09:15:04 det.__main__] INFO: Start evaluation
[2025-05-20 09:15:04 det.util.utils] INFO: Test:  [  0/458]  eta: 0:02:25  model_time: 0.1875 (0.1875)  evaluator_time: 0.0849 (0.0849)  time: 0.3166  data: 0.0443  mem: 726  max mem: 19988
[2025-05-20 09:15:06 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:30  model_time: 0.1846 (0.1842)  evaluator_time: 0.0060 (0.0129)  time: 0.2022  data: 0.0049  mem: 726  max mem: 19988
[2025-05-20 09:15:08 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:26  model_time: 0.1841 (0.1843)  evaluator_time: 0.0050 (0.0091)  time: 0.1909  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:10 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:23  model_time: 0.1830 (0.1841)  evaluator_time: 0.0050 (0.0077)  time: 0.1903  data: 0.0014  mem: 726  max mem: 19988
[2025-05-20 09:15:12 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:20  model_time: 0.1830 (0.1839)  evaluator_time: 0.0050 (0.0070)  time: 0.1899  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:14 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:18  model_time: 0.1831 (0.1838)  evaluator_time: 0.0050 (0.0069)  time: 0.1907  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:16 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:17  model_time: 0.1840 (0.1853)  evaluator_time: 0.0050 (0.0065)  time: 0.1951  data: 0.0012  mem: 726  max mem: 19988
[2025-05-20 09:15:18 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:15  model_time: 0.1840 (0.1851)  evaluator_time: 0.0040 (0.0063)  time: 0.1944  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:20 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:13  model_time: 0.1837 (0.1850)  evaluator_time: 0.0050 (0.0062)  time: 0.1908  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 09:15:22 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:11  model_time: 0.1840 (0.1849)  evaluator_time: 0.0060 (0.0061)  time: 0.1913  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:24 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:08  model_time: 0.1839 (0.1848)  evaluator_time: 0.0060 (0.0061)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:25 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:07  model_time: 0.1837 (0.1847)  evaluator_time: 0.0050 (0.0061)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:27 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:04  model_time: 0.1835 (0.1846)  evaluator_time: 0.0040 (0.0059)  time: 0.1903  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 09:15:29 det.util.utils] INFO: Test:  [130/458]  eta: 0:01:03  model_time: 0.1835 (0.1846)  evaluator_time: 0.0050 (0.0059)  time: 0.1903  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:31 det.util.utils] INFO: Test:  [140/458]  eta: 0:01:01  model_time: 0.1840 (0.1846)  evaluator_time: 0.0060 (0.0059)  time: 0.1913  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 09:15:33 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:59  model_time: 0.1840 (0.1846)  evaluator_time: 0.0060 (0.0060)  time: 0.1920  data: 0.0008  mem: 726  max mem: 19988
[2025-05-20 09:15:35 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:57  model_time: 0.1845 (0.1846)  evaluator_time: 0.0060 (0.0060)  time: 0.1927  data: 0.0011  mem: 726  max mem: 19988
[2025-05-20 09:15:37 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:55  model_time: 0.1840 (0.1846)  evaluator_time: 0.0050 (0.0060)  time: 0.1922  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:39 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:53  model_time: 0.1847 (0.1846)  evaluator_time: 0.0050 (0.0059)  time: 0.1909  data: 0.0011  mem: 726  max mem: 19988
[2025-05-20 09:15:41 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:51  model_time: 0.1841 (0.1845)  evaluator_time: 0.0060 (0.0059)  time: 0.1910  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 09:15:43 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:49  model_time: 0.1840 (0.1845)  evaluator_time: 0.0060 (0.0059)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:15:45 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:47  model_time: 0.1840 (0.1845)  evaluator_time: 0.0050 (0.0059)  time: 0.1907  data: 0.0011  mem: 726  max mem: 19988
[2025-05-20 09:15:47 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:45  model_time: 0.1847 (0.1845)  evaluator_time: 0.0050 (0.0059)  time: 0.1925  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:48 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:43  model_time: 0.1840 (0.1845)  evaluator_time: 0.0060 (0.0059)  time: 0.1924  data: 0.0012  mem: 726  max mem: 19988
[2025-05-20 09:15:50 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:41  model_time: 0.1837 (0.1845)  evaluator_time: 0.0060 (0.0059)  time: 0.1911  data: 0.0012  mem: 726  max mem: 19988
[2025-05-20 09:15:52 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:39  model_time: 0.1837 (0.1845)  evaluator_time: 0.0050 (0.0059)  time: 0.1912  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:54 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:37  model_time: 0.1830 (0.1844)  evaluator_time: 0.0050 (0.0059)  time: 0.1910  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:15:56 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:36  model_time: 0.1839 (0.1844)  evaluator_time: 0.0060 (0.0059)  time: 0.1910  data: 0.0011  mem: 726  max mem: 19988
[2025-05-20 09:15:58 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:34  model_time: 0.1843 (0.1844)  evaluator_time: 0.0060 (0.0059)  time: 0.1909  data: 0.0006  mem: 726  max mem: 19988
[2025-05-20 09:16:00 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:32  model_time: 0.1845 (0.1844)  evaluator_time: 0.0050 (0.0058)  time: 0.1910  data: 0.0007  mem: 726  max mem: 19988
[2025-05-20 09:16:02 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:30  model_time: 0.1840 (0.1844)  evaluator_time: 0.0050 (0.0058)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:04 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:28  model_time: 0.1840 (0.1844)  evaluator_time: 0.0050 (0.0058)  time: 0.1906  data: 0.0011  mem: 726  max mem: 19988
[2025-05-20 09:16:06 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:26  model_time: 0.1840 (0.1844)  evaluator_time: 0.0050 (0.0058)  time: 0.1910  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:08 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:24  model_time: 0.1837 (0.1844)  evaluator_time: 0.0060 (0.0058)  time: 0.1912  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:09 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:22  model_time: 0.1840 (0.1844)  evaluator_time: 0.0050 (0.0058)  time: 0.1909  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:11 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:20  model_time: 0.1840 (0.1844)  evaluator_time: 0.0060 (0.0058)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:13 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:18  model_time: 0.1840 (0.1844)  evaluator_time: 0.0060 (0.0058)  time: 0.1913  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:15 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:16  model_time: 0.1840 (0.1843)  evaluator_time: 0.0050 (0.0058)  time: 0.1908  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:17 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:14  model_time: 0.1836 (0.1843)  evaluator_time: 0.0050 (0.0058)  time: 0.1902  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:19 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:13  model_time: 0.1841 (0.1843)  evaluator_time: 0.0060 (0.0059)  time: 0.1928  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:21 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:11  model_time: 0.1840 (0.1843)  evaluator_time: 0.0060 (0.0059)  time: 0.1930  data: 0.0012  mem: 726  max mem: 19988
[2025-05-20 09:16:23 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:09  model_time: 0.1836 (0.1843)  evaluator_time: 0.0050 (0.0059)  time: 0.1904  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:25 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:07  model_time: 0.1840 (0.1843)  evaluator_time: 0.0050 (0.0058)  time: 0.1904  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:27 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:05  model_time: 0.1840 (0.1843)  evaluator_time: 0.0050 (0.0058)  time: 0.1904  data: 0.0009  mem: 726  max mem: 19988
[2025-05-20 09:16:29 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1840 (0.1843)  evaluator_time: 0.0060 (0.0059)  time: 0.1919  data: 0.0013  mem: 726  max mem: 19988
[2025-05-20 09:16:31 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1837 (0.1843)  evaluator_time: 0.0060 (0.0058)  time: 0.1917  data: 0.0014  mem: 726  max mem: 19988
[2025-05-20 09:16:32 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1825 (0.1842)  evaluator_time: 0.0050 (0.0058)  time: 0.1890  data: 0.0010  mem: 726  max mem: 19988
[2025-05-20 09:16:32 det.util.engine] INFO: Averaged stats: model_time: 0.1825 (0.1842)  evaluator_time: 0.0050 (0.0058)
[2025-05-20 09:16:33 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.47s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.692
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.308
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.072
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.182
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.377
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.546

[2025-05-20 09:16:33 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4209  | 0.647  | 0.420 |
| Crescent_gap  | 48   | 48  | 6159  | 1.000  | 0.927 |
| Inclusion     | 41   | 82  | 11327 | 0.854  | 0.399 |
| Oil_spot      | 58   | 125 | 13701 | 0.928  | 0.701 |
| Punching      | 74   | 74  | 2389  | 0.986  | 0.952 |
| Rolled_pit    | 10   | 25  | 2825  | 0.760  | 0.418 |
| Silk_spot     | 134  | 150 | 59041 | 0.940  | 0.621 |
| Waist_folding | 24   | 26  | 8339  | 0.962  | 0.729 |
| Water_spot    | 68   | 78  | 15523 | 0.962  | 0.793 |
| Welding_line  | 99   | 99  | 13676 | 1.000  | 0.959 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.904  | 0.692 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 09:16:33 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 09:16:34 det.util.engine] INFO: Epoch: [47]  [0/1834]  eta: 0:24:08  lr: 0.000010  data_time: 0.0152  iter_time: 0.7899  loss: 25.4980 (25.4980)  loss_class: 0.4027 (0.4027)  loss_bbox: 0.2974 (0.2974)  loss_giou: 0.3323 (0.3323)  loss_class_0: 0.7405 (0.7405)  loss_bbox_0: 0.5249 (0.5249)  loss_giou_0: 0.4710 (0.4710)  loss_class_1: 0.6409 (0.6409)  loss_bbox_1: 0.3549 (0.3549)  loss_giou_1: 0.3703 (0.3703)  loss_class_2: 0.4556 (0.4556)  loss_bbox_2: 0.3323 (0.3323)  loss_giou_2: 0.4051 (0.4051)  loss_class_3: 0.4258 (0.4258)  loss_bbox_3: 0.3176 (0.3176)  loss_giou_3: 0.3932 (0.3932)  loss_class_4: 0.4104 (0.4104)  loss_bbox_4: 0.3032 (0.3032)  loss_giou_4: 0.3484 (0.3484)  loss_class_enc: 2.0025 (2.0025)  loss_bbox_enc: 0.2236 (0.2236)  loss_giou_enc: 0.3612 (0.3612)  loss_class_dn: 0.3573 (0.3573)  loss_bbox_dn: 0.2709 (0.2709)  loss_giou_dn: 0.2873 (0.2873)  loss_class_dn_0: 0.4980 (0.4980)  loss_bbox_dn_0: 0.3606 (0.3606)  loss_giou_dn_0: 0.4526 (0.4526)  loss_class_dn_1: 0.4507 (0.4507)  loss_bbox_dn_1: 0.3052 (0.3052)  loss_giou_dn_1: 0.3637 (0.3637)  loss_class_dn_2: 0.4081 (0.4081)  loss_bbox_dn_2: 0.3049 (0.3049)  loss_giou_dn_2: 0.3402 (0.3402)  loss_class_dn_3: 0.3966 (0.3966)  loss_bbox_dn_3: 0.2938 (0.2938)  loss_giou_dn_3: 0.3399 (0.3399)  loss_class_dn_4: 0.3744 (0.3744)  loss_bbox_dn_4: 0.2777 (0.2777)  loss_giou_dn_4: 0.3029 (0.3029)  loss_class_hybrid: 0.4074 (0.4074)  loss_bbox_hybrid: 0.2863 (0.2863)  loss_giou_hybrid: 0.3178 (0.3178)  loss_class_0_hybrid: 0.7896 (0.7896)  loss_bbox_0_hybrid: 0.3357 (0.3357)  loss_giou_0_hybrid: 0.3500 (0.3500)  loss_class_1_hybrid: 0.6781 (0.6781)  loss_bbox_1_hybrid: 0.2665 (0.2665)  loss_giou_1_hybrid: 0.3107 (0.3107)  loss_class_2_hybrid: 0.4869 (0.4869)  loss_bbox_2_hybrid: 0.2756 (0.2756)  loss_giou_2_hybrid: 0.3475 (0.3475)  loss_class_3_hybrid: 0.4277 (0.4277)  loss_bbox_3_hybrid: 0.2788 (0.2788)  loss_giou_3_hybrid: 0.3533 (0.3533)  loss_class_4_hybrid: 0.4305 (0.4305)  loss_bbox_4_hybrid: 0.2731 (0.2731)  loss_giou_4_hybrid: 0.3254 (0.3254)  loss_class_enc_hybrid: 1.3790 (1.3790)  loss_bbox_enc_hybrid: 0.3089 (0.3089)  loss_giou_enc_hybrid: 0.3705 (0.3705)  mem: 735  max mem: 19988
[2025-05-20 09:16:34 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 09:39:08 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0011  iter_time: 0.7620  loss: 17.7543 (25.2605)  loss_class: 0.3888 (0.5998)  loss_bbox: 0.1067 (0.2712)  loss_giou: 0.2724 (0.3398)  loss_class_0: 0.5184 (0.7320)  loss_bbox_0: 0.1110 (0.2894)  loss_giou_0: 0.2465 (0.3581)  loss_class_1: 0.3801 (0.6504)  loss_bbox_1: 0.1160 (0.2733)  loss_giou_1: 0.2594 (0.3435)  loss_class_2: 0.3862 (0.6207)  loss_bbox_2: 0.1206 (0.2695)  loss_giou_2: 0.2887 (0.3398)  loss_class_3: 0.3890 (0.6022)  loss_bbox_3: 0.1041 (0.2709)  loss_giou_3: 0.2809 (0.3391)  loss_class_4: 0.3863 (0.5989)  loss_bbox_4: 0.1047 (0.2709)  loss_giou_4: 0.2784 (0.3389)  loss_class_enc: 0.9757 (1.0172)  loss_bbox_enc: 0.1456 (0.2825)  loss_giou_enc: 0.2595 (0.3813)  loss_class_dn: 0.3214 (0.3398)  loss_bbox_dn: 0.1114 (0.3786)  loss_giou_dn: 0.2330 (0.3781)  loss_class_dn_0: 0.4420 (0.4066)  loss_bbox_dn_0: 0.2119 (0.4834)  loss_giou_dn_0: 0.3932 (0.4897)  loss_class_dn_1: 0.3751 (0.3644)  loss_bbox_dn_1: 0.1190 (0.4037)  loss_giou_dn_1: 0.2441 (0.3988)  loss_class_dn_2: 0.3475 (0.3432)  loss_bbox_dn_2: 0.1092 (0.3899)  loss_giou_dn_2: 0.2590 (0.3843)  loss_class_dn_3: 0.3256 (0.3414)  loss_bbox_dn_3: 0.1051 (0.3801)  loss_giou_dn_3: 0.2345 (0.3791)  loss_class_dn_4: 0.3313 (0.3404)  loss_bbox_dn_4: 0.1098 (0.3793)  loss_giou_dn_4: 0.2425 (0.3784)  loss_class_hybrid: 0.4220 (0.6498)  loss_bbox_hybrid: 0.0988 (0.2569)  loss_giou_hybrid: 0.2724 (0.3323)  loss_class_0_hybrid: 0.4768 (0.6826)  loss_bbox_0_hybrid: 0.1028 (0.2876)  loss_giou_0_hybrid: 0.2641 (0.3625)  loss_class_1_hybrid: 0.4034 (0.6549)  loss_bbox_1_hybrid: 0.1009 (0.2701)  loss_giou_1_hybrid: 0.2452 (0.3434)  loss_class_2_hybrid: 0.4277 (0.6489)  loss_bbox_2_hybrid: 0.1063 (0.2618)  loss_giou_2_hybrid: 0.2939 (0.3368)  loss_class_3_hybrid: 0.4128 (0.6465)  loss_bbox_3_hybrid: 0.0957 (0.2622)  loss_giou_3_hybrid: 0.2800 (0.3356)  loss_class_4_hybrid: 0.4302 (0.6450)  loss_bbox_4_hybrid: 0.0965 (0.2592)  loss_giou_4_hybrid: 0.2778 (0.3337)  loss_class_enc_hybrid: 0.6561 (0.7823)  loss_bbox_enc_hybrid: 0.2150 (0.3316)  loss_giou_enc_hybrid: 0.3446 (0.4279)
[2025-05-20 09:39:08 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 09:39:08 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47
[2025-05-20 09:39:08 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\pytorch_model.bin
[2025-05-20 09:39:09 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\optimizer.bin
[2025-05-20 09:39:09 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\scheduler.bin
[2025-05-20 09:39:09 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\sampler.bin
[2025-05-20 09:39:09 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\sampler_1.bin
[2025-05-20 09:39:09 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_47\random_states_0.pkl
[2025-05-20 09:39:09 det.__main__] INFO: Start evaluation
[2025-05-20 09:39:09 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:49  model_time: 0.1950 (0.1950)  evaluator_time: 0.0060 (0.0060)  time: 0.2380  data: 0.0370  mem: 726  max mem: 19990
[2025-05-20 09:39:11 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:28  model_time: 0.1848 (0.1863)  evaluator_time: 0.0050 (0.0055)  time: 0.1965  data: 0.0044  mem: 726  max mem: 19990
[2025-05-20 09:39:13 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:25  model_time: 0.1860 (0.1865)  evaluator_time: 0.0050 (0.0050)  time: 0.1923  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:15 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:23  model_time: 0.1869 (0.1866)  evaluator_time: 0.0040 (0.0048)  time: 0.1925  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:17 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:22  model_time: 0.1867 (0.1907)  evaluator_time: 0.0050 (0.0049)  time: 0.2011  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:19 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:20  model_time: 0.1867 (0.1899)  evaluator_time: 0.0060 (0.0051)  time: 0.2017  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:21 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:18  model_time: 0.1857 (0.1892)  evaluator_time: 0.0050 (0.0050)  time: 0.1927  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:23 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:15  model_time: 0.1858 (0.1888)  evaluator_time: 0.0040 (0.0050)  time: 0.1922  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:25 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:13  model_time: 0.1860 (0.1885)  evaluator_time: 0.0050 (0.0051)  time: 0.1932  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:26 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:11  model_time: 0.1868 (0.1883)  evaluator_time: 0.0050 (0.0051)  time: 0.1934  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:28 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:09  model_time: 0.1860 (0.1882)  evaluator_time: 0.0050 (0.0052)  time: 0.1941  data: 0.0014  mem: 726  max mem: 19990
[2025-05-20 09:39:30 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:07  model_time: 0.1866 (0.1881)  evaluator_time: 0.0050 (0.0052)  time: 0.1943  data: 0.0012  mem: 726  max mem: 19990
[2025-05-20 09:39:32 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:05  model_time: 0.1867 (0.1881)  evaluator_time: 0.0050 (0.0052)  time: 0.1941  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:34 det.util.utils] INFO: Test:  [130/458]  eta: 0:01:03  model_time: 0.1867 (0.1880)  evaluator_time: 0.0050 (0.0052)  time: 0.1940  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:36 det.util.utils] INFO: Test:  [140/458]  eta: 0:01:02  model_time: 0.1876 (0.1881)  evaluator_time: 0.0060 (0.0053)  time: 0.1956  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:39:38 det.util.utils] INFO: Test:  [150/458]  eta: 0:01:00  model_time: 0.1878 (0.1880)  evaluator_time: 0.0060 (0.0053)  time: 0.1956  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:39:40 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:58  model_time: 0.1870 (0.1880)  evaluator_time: 0.0050 (0.0054)  time: 0.1950  data: 0.0012  mem: 726  max mem: 19990
[2025-05-20 09:39:42 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:56  model_time: 0.1870 (0.1879)  evaluator_time: 0.0050 (0.0054)  time: 0.1943  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:39:44 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:54  model_time: 0.1858 (0.1879)  evaluator_time: 0.0050 (0.0054)  time: 0.1932  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:39:46 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:52  model_time: 0.1848 (0.1877)  evaluator_time: 0.0060 (0.0054)  time: 0.1933  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:39:48 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:50  model_time: 0.1847 (0.1876)  evaluator_time: 0.0050 (0.0054)  time: 0.1917  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:50 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:48  model_time: 0.1840 (0.1874)  evaluator_time: 0.0050 (0.0055)  time: 0.1907  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:39:52 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:46  model_time: 0.1830 (0.1872)  evaluator_time: 0.0050 (0.0055)  time: 0.1906  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:54 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:44  model_time: 0.1836 (0.1870)  evaluator_time: 0.0050 (0.0055)  time: 0.1908  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:55 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:42  model_time: 0.1837 (0.1869)  evaluator_time: 0.0050 (0.0055)  time: 0.1909  data: 0.0012  mem: 726  max mem: 19990
[2025-05-20 09:39:57 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:40  model_time: 0.1840 (0.1868)  evaluator_time: 0.0040 (0.0054)  time: 0.1907  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:39:59 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:38  model_time: 0.1840 (0.1867)  evaluator_time: 0.0050 (0.0055)  time: 0.1910  data: 0.0012  mem: 726  max mem: 19990
[2025-05-20 09:40:01 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:36  model_time: 0.1840 (0.1867)  evaluator_time: 0.0050 (0.0054)  time: 0.1913  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:03 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:34  model_time: 0.1840 (0.1866)  evaluator_time: 0.0050 (0.0054)  time: 0.1905  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:05 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:32  model_time: 0.1830 (0.1865)  evaluator_time: 0.0050 (0.0054)  time: 0.1896  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:07 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:30  model_time: 0.1836 (0.1864)  evaluator_time: 0.0040 (0.0054)  time: 0.1897  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 09:40:09 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:28  model_time: 0.1836 (0.1863)  evaluator_time: 0.0050 (0.0054)  time: 0.1901  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:11 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:26  model_time: 0.1834 (0.1862)  evaluator_time: 0.0050 (0.0054)  time: 0.1902  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:13 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:24  model_time: 0.1840 (0.1861)  evaluator_time: 0.0050 (0.0054)  time: 0.1900  data: 0.0009  mem: 726  max mem: 19990
[2025-05-20 09:40:14 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:22  model_time: 0.1840 (0.1861)  evaluator_time: 0.0050 (0.0054)  time: 0.1909  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:40:16 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:20  model_time: 0.1840 (0.1860)  evaluator_time: 0.0050 (0.0054)  time: 0.1915  data: 0.0014  mem: 726  max mem: 19990
[2025-05-20 09:40:18 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:18  model_time: 0.1839 (0.1860)  evaluator_time: 0.0050 (0.0054)  time: 0.1909  data: 0.0013  mem: 726  max mem: 19990
[2025-05-20 09:40:20 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:16  model_time: 0.1840 (0.1859)  evaluator_time: 0.0050 (0.0054)  time: 0.1906  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:22 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:15  model_time: 0.1847 (0.1859)  evaluator_time: 0.0050 (0.0054)  time: 0.1905  data: 0.0009  mem: 726  max mem: 19990
[2025-05-20 09:40:24 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:13  model_time: 0.1846 (0.1858)  evaluator_time: 0.0060 (0.0054)  time: 0.1925  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:26 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:11  model_time: 0.1840 (0.1858)  evaluator_time: 0.0060 (0.0054)  time: 0.1922  data: 0.0012  mem: 726  max mem: 19990
[2025-05-20 09:40:28 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:09  model_time: 0.1840 (0.1857)  evaluator_time: 0.0050 (0.0054)  time: 0.1900  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:40:30 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:07  model_time: 0.1840 (0.1857)  evaluator_time: 0.0050 (0.0054)  time: 0.1901  data: 0.0009  mem: 726  max mem: 19990
[2025-05-20 09:40:32 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:05  model_time: 0.1850 (0.1857)  evaluator_time: 0.0050 (0.0054)  time: 0.1908  data: 0.0009  mem: 726  max mem: 19990
[2025-05-20 09:40:34 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1840 (0.1856)  evaluator_time: 0.0050 (0.0054)  time: 0.1905  data: 0.0010  mem: 726  max mem: 19990
[2025-05-20 09:40:35 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1830 (0.1856)  evaluator_time: 0.0050 (0.0054)  time: 0.1901  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:40:37 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1820 (0.1855)  evaluator_time: 0.0040 (0.0054)  time: 0.1887  data: 0.0011  mem: 726  max mem: 19990
[2025-05-20 09:40:37 det.util.engine] INFO: Averaged stats: model_time: 0.1820 (0.1855)  evaluator_time: 0.0040 (0.0054)
[2025-05-20 09:40:38 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.45s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.702
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.027
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.557

[2025-05-20 09:40:38 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3760  | 0.588  | 0.386 |
| Crescent_gap  | 48   | 48  | 6473  | 1.000  | 0.941 |
| Inclusion     | 41   | 82  | 11724 | 0.793  | 0.407 |
| Oil_spot      | 58   | 125 | 13931 | 0.928  | 0.680 |
| Punching      | 74   | 74  | 2047  | 1.000  | 0.973 |
| Rolled_pit    | 10   | 25  | 2066  | 0.800  | 0.473 |
| Silk_spot     | 134  | 150 | 64485 | 0.927  | 0.626 |
| Waist_folding | 24   | 26  | 7664  | 0.962  | 0.775 |
| Water_spot    | 68   | 78  | 16076 | 0.987  | 0.798 |
| Welding_line  | 99   | 99  | 9048  | 1.000  | 0.966 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.898  | 0.702 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 09:40:38 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 09:40:39 det.util.engine] INFO: Epoch: [48]  [0/1834]  eta: 0:23:57  lr: 0.000010  data_time: 0.0238  iter_time: 0.7836  loss: 31.7295 (31.7295)  loss_class: 0.9903 (0.9903)  loss_bbox: 0.3352 (0.3352)  loss_giou: 0.4905 (0.4905)  loss_class_0: 0.4430 (0.4430)  loss_bbox_0: 1.0165 (1.0165)  loss_giou_0: 0.7953 (0.7953)  loss_class_1: 1.7367 (1.7367)  loss_bbox_1: 0.1547 (0.1547)  loss_giou_1: 0.3298 (0.3298)  loss_class_2: 0.8081 (0.8081)  loss_bbox_2: 0.2252 (0.2252)  loss_giou_2: 0.4472 (0.4472)  loss_class_3: 0.8174 (0.8174)  loss_bbox_3: 0.2333 (0.2333)  loss_giou_3: 0.4834 (0.4834)  loss_class_4: 0.9318 (0.9318)  loss_bbox_4: 0.3051 (0.3051)  loss_giou_4: 0.4789 (0.4789)  loss_class_enc: 1.8158 (1.8158)  loss_bbox_enc: 0.1826 (0.1826)  loss_giou_enc: 0.1091 (0.1091)  loss_class_dn: 0.4437 (0.4437)  loss_bbox_dn: 0.4205 (0.4205)  loss_giou_dn: 0.5197 (0.5197)  loss_class_dn_0: 0.4628 (0.4628)  loss_bbox_dn_0: 0.5679 (0.5679)  loss_giou_dn_0: 0.5550 (0.5550)  loss_class_dn_1: 0.4405 (0.4405)  loss_bbox_dn_1: 0.4431 (0.4431)  loss_giou_dn_1: 0.5027 (0.5027)  loss_class_dn_2: 0.4295 (0.4295)  loss_bbox_dn_2: 0.4268 (0.4268)  loss_giou_dn_2: 0.5091 (0.5091)  loss_class_dn_3: 0.4510 (0.4510)  loss_bbox_dn_3: 0.4577 (0.4577)  loss_giou_dn_3: 0.5155 (0.5155)  loss_class_dn_4: 0.4492 (0.4492)  loss_bbox_dn_4: 0.4490 (0.4490)  loss_giou_dn_4: 0.5212 (0.5212)  loss_class_hybrid: 0.4951 (0.4951)  loss_bbox_hybrid: 0.3236 (0.3236)  loss_giou_hybrid: 0.5135 (0.5135)  loss_class_0_hybrid: 0.8006 (0.8006)  loss_bbox_0_hybrid: 0.3930 (0.3930)  loss_giou_0_hybrid: 0.5211 (0.5211)  loss_class_1_hybrid: 0.5272 (0.5272)  loss_bbox_1_hybrid: 0.2905 (0.2905)  loss_giou_1_hybrid: 0.5141 (0.5141)  loss_class_2_hybrid: 0.4925 (0.4925)  loss_bbox_2_hybrid: 0.3045 (0.3045)  loss_giou_2_hybrid: 0.5186 (0.5186)  loss_class_3_hybrid: 0.5143 (0.5143)  loss_bbox_3_hybrid: 0.3088 (0.3088)  loss_giou_3_hybrid: 0.5167 (0.5167)  loss_class_4_hybrid: 0.4967 (0.4967)  loss_bbox_4_hybrid: 0.3182 (0.3182)  loss_giou_4_hybrid: 0.5097 (0.5097)  loss_class_enc_hybrid: 0.9923 (0.9923)  loss_bbox_enc_hybrid: 0.3044 (0.3044)  loss_giou_enc_hybrid: 0.3793 (0.3793)  mem: 737  max mem: 19990
[2025-05-20 09:40:39 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:00:27 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5664  loss: 20.7098 (25.7385)  loss_class: 0.4169 (0.5711)  loss_bbox: 0.1492 (0.2895)  loss_giou: 0.2853 (0.3643)  loss_class_0: 0.5946 (0.7336)  loss_bbox_0: 0.1514 (0.3007)  loss_giou_0: 0.2969 (0.3805)  loss_class_1: 0.4463 (0.6364)  loss_bbox_1: 0.1438 (0.2857)  loss_giou_1: 0.2648 (0.3643)  loss_class_2: 0.4147 (0.5995)  loss_bbox_2: 0.1493 (0.2829)  loss_giou_2: 0.2569 (0.3628)  loss_class_3: 0.4144 (0.5797)  loss_bbox_3: 0.1553 (0.2871)  loss_giou_3: 0.2846 (0.3634)  loss_class_4: 0.4167 (0.5704)  loss_bbox_4: 0.1498 (0.2897)  loss_giou_4: 0.2856 (0.3642)  loss_class_enc: 0.9069 (1.0093)  loss_bbox_enc: 0.1688 (0.2926)  loss_giou_enc: 0.3268 (0.3998)  loss_class_dn: 0.3877 (0.3439)  loss_bbox_dn: 0.1671 (0.3865)  loss_giou_dn: 0.3739 (0.3907)  loss_class_dn_0: 0.4617 (0.4104)  loss_bbox_dn_0: 0.2725 (0.4943)  loss_giou_dn_0: 0.4388 (0.5024)  loss_class_dn_1: 0.4355 (0.3678)  loss_bbox_dn_1: 0.1819 (0.4130)  loss_giou_dn_1: 0.4017 (0.4115)  loss_class_dn_2: 0.3969 (0.3474)  loss_bbox_dn_2: 0.1701 (0.3980)  loss_giou_dn_2: 0.3822 (0.3970)  loss_class_dn_3: 0.3921 (0.3456)  loss_bbox_dn_3: 0.1699 (0.3886)  loss_giou_dn_3: 0.3761 (0.3916)  loss_class_dn_4: 0.3894 (0.3444)  loss_bbox_dn_4: 0.1677 (0.3875)  loss_giou_dn_4: 0.3725 (0.3911)  loss_class_hybrid: 0.4345 (0.6308)  loss_bbox_hybrid: 0.1348 (0.2783)  loss_giou_hybrid: 0.2665 (0.3546)  loss_class_0_hybrid: 0.5629 (0.6871)  loss_bbox_0_hybrid: 0.1518 (0.2985)  loss_giou_0_hybrid: 0.3205 (0.3798)  loss_class_1_hybrid: 0.4484 (0.6435)  loss_bbox_1_hybrid: 0.1427 (0.2841)  loss_giou_1_hybrid: 0.2507 (0.3624)  loss_class_2_hybrid: 0.4280 (0.6386)  loss_bbox_2_hybrid: 0.1361 (0.2792)  loss_giou_2_hybrid: 0.2532 (0.3576)  loss_class_3_hybrid: 0.4349 (0.6322)  loss_bbox_3_hybrid: 0.1372 (0.2796)  loss_giou_3_hybrid: 0.2829 (0.3561)  loss_class_4_hybrid: 0.4227 (0.6279)  loss_bbox_4_hybrid: 0.1383 (0.2796)  loss_giou_4_hybrid: 0.2968 (0.3559)  loss_class_enc_hybrid: 0.6978 (0.7850)  loss_bbox_enc_hybrid: 0.2388 (0.3430)  loss_giou_enc_hybrid: 0.4228 (0.4459)
[2025-05-20 10:00:27 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 10:00:27 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\pytorch_model.bin
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\optimizer.bin
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\scheduler.bin
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\sampler.bin
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\sampler_1.bin
[2025-05-20 10:00:28 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_48\random_states_0.pkl
[2025-05-20 10:00:28 det.__main__] INFO: Start evaluation
[2025-05-20 10:00:28 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:35  model_time: 0.1718 (0.1718)  evaluator_time: 0.0030 (0.0030)  time: 0.2078  data: 0.0330  mem: 728  max mem: 19990
[2025-05-20 10:00:30 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1720 (0.1718)  evaluator_time: 0.0030 (0.0033)  time: 0.1789  data: 0.0036  mem: 728  max mem: 19990
[2025-05-20 10:00:32 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:17  model_time: 0.1720 (0.1721)  evaluator_time: 0.0030 (0.0032)  time: 0.1762  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:33 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:15  model_time: 0.1726 (0.1725)  evaluator_time: 0.0030 (0.0032)  time: 0.1766  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:35 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1720 (0.1724)  evaluator_time: 0.0030 (0.0032)  time: 0.1764  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:00:37 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1720 (0.1724)  evaluator_time: 0.0030 (0.0032)  time: 0.1764  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:00:39 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1720 (0.1724)  evaluator_time: 0.0030 (0.0032)  time: 0.1765  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:00:40 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1720 (0.1723)  evaluator_time: 0.0030 (0.0032)  time: 0.1760  data: 0.0004  mem: 728  max mem: 19990
[2025-05-20 10:00:42 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:06  model_time: 0.1720 (0.1723)  evaluator_time: 0.0030 (0.0032)  time: 0.1762  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:00:44 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1716 (0.1722)  evaluator_time: 0.0030 (0.0032)  time: 0.1761  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:00:46 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1710 (0.1722)  evaluator_time: 0.0040 (0.0033)  time: 0.1760  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:47 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1720 (0.1722)  evaluator_time: 0.0030 (0.0033)  time: 0.1767  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:00:49 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:59  model_time: 0.1720 (0.1722)  evaluator_time: 0.0030 (0.0033)  time: 0.1765  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:51 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1730 (0.1724)  evaluator_time: 0.0030 (0.0033)  time: 0.1776  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:53 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1750 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1791  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:55 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1746 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1791  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:00:56 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1740 (0.1728)  evaluator_time: 0.0040 (0.0044)  time: 0.1865  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:00:58 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0043)  time: 0.1860  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:00 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1750 (0.1730)  evaluator_time: 0.0030 (0.0042)  time: 0.1788  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:02 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1740 (0.1731)  evaluator_time: 0.0030 (0.0042)  time: 0.1791  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:04 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1750 (0.1732)  evaluator_time: 0.0040 (0.0042)  time: 0.1791  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:05 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1750 (0.1732)  evaluator_time: 0.0036 (0.0041)  time: 0.1791  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:07 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1743 (0.1733)  evaluator_time: 0.0030 (0.0041)  time: 0.1790  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:09 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1743 (0.1734)  evaluator_time: 0.0040 (0.0041)  time: 0.1794  data: 0.0004  mem: 728  max mem: 19990
[2025-05-20 10:01:11 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1746 (0.1735)  evaluator_time: 0.0040 (0.0041)  time: 0.1798  data: 0.0004  mem: 728  max mem: 19990
[2025-05-20 10:01:13 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1750 (0.1736)  evaluator_time: 0.0030 (0.0040)  time: 0.1796  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:14 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1732 (0.1736)  evaluator_time: 0.0030 (0.0040)  time: 0.1782  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:16 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0040)  time: 0.1787  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:18 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1750 (0.1737)  evaluator_time: 0.0030 (0.0040)  time: 0.1792  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:20 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1785  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:22 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1750 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1789  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:23 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1784  data: 0.0008  mem: 728  max mem: 19990
[2025-05-20 10:01:25 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1732 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1774  data: 0.0008  mem: 728  max mem: 19990
[2025-05-20 10:01:27 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1731 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1777  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:29 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:21  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1781  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:30 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1737 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1778  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:32 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1778  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:34 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1774  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:36 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1771  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:38 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1731 (0.1737)  evaluator_time: 0.0040 (0.0038)  time: 0.1792  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:39 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1732 (0.1737)  evaluator_time: 0.0040 (0.0038)  time: 0.1790  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:41 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1768  data: 0.0008  mem: 728  max mem: 19990
[2025-05-20 10:01:43 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0038)  time: 0.1770  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:45 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1776  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:46 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0038)  time: 0.1778  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 10:01:48 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1779  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 10:01:49 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1736 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1780  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 10:01:49 det.util.engine] INFO: Averaged stats: model_time: 0.1736 (0.1737)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 10:01:50 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.701
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.353
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.233
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.342
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.539

[2025-05-20 10:01:50 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4328  | 0.647  | 0.455 |
| Crescent_gap  | 48   | 48  | 6361  | 1.000  | 0.937 |
| Inclusion     | 41   | 82  | 12639 | 0.768  | 0.323 |
| Oil_spot      | 58   | 125 | 11103 | 0.912  | 0.711 |
| Punching      | 74   | 74  | 3048  | 1.000  | 0.948 |
| Rolled_pit    | 10   | 25  | 2694  | 0.800  | 0.421 |
| Silk_spot     | 134  | 150 | 62381 | 0.933  | 0.632 |
| Waist_folding | 24   | 26  | 7207  | 0.962  | 0.803 |
| Water_spot    | 68   | 78  | 16509 | 0.974  | 0.810 |
| Welding_line  | 99   | 99  | 10860 | 1.000  | 0.968 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.900  | 0.701 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 10:01:50 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:01:51 det.util.engine] INFO: Epoch: [49]  [0/1834]  eta: 0:19:04  lr: 0.000010  data_time: 0.0011  iter_time: 0.6241  loss: 18.0848 (18.0848)  loss_class: 0.3365 (0.3365)  loss_bbox: 0.1028 (0.1028)  loss_giou: 0.3261 (0.3261)  loss_class_0: 0.7747 (0.7747)  loss_bbox_0: 0.1324 (0.1324)  loss_giou_0: 0.3751 (0.3751)  loss_class_1: 0.3986 (0.3986)  loss_bbox_1: 0.1270 (0.1270)  loss_giou_1: 0.3680 (0.3680)  loss_class_2: 0.3530 (0.3530)  loss_bbox_2: 0.1260 (0.1260)  loss_giou_2: 0.3418 (0.3418)  loss_class_3: 0.3412 (0.3412)  loss_bbox_3: 0.0968 (0.0968)  loss_giou_3: 0.3176 (0.3176)  loss_class_4: 0.3406 (0.3406)  loss_bbox_4: 0.1019 (0.1019)  loss_giou_4: 0.3268 (0.3268)  loss_class_enc: 0.7137 (0.7137)  loss_bbox_enc: 0.1628 (0.1628)  loss_giou_enc: 0.2976 (0.2976)  loss_class_dn: 0.3223 (0.3223)  loss_bbox_dn: 0.0974 (0.0974)  loss_giou_dn: 0.2830 (0.2830)  loss_class_dn_0: 0.4129 (0.4129)  loss_bbox_dn_0: 0.2553 (0.2553)  loss_giou_dn_0: 0.3847 (0.3847)  loss_class_dn_1: 0.3570 (0.3570)  loss_bbox_dn_1: 0.1387 (0.1387)  loss_giou_dn_1: 0.3029 (0.3029)  loss_class_dn_2: 0.3249 (0.3249)  loss_bbox_dn_2: 0.1063 (0.1063)  loss_giou_dn_2: 0.2847 (0.2847)  loss_class_dn_3: 0.3183 (0.3183)  loss_bbox_dn_3: 0.0971 (0.0971)  loss_giou_dn_3: 0.2758 (0.2758)  loss_class_dn_4: 0.3253 (0.3253)  loss_bbox_dn_4: 0.0976 (0.0976)  loss_giou_dn_4: 0.2834 (0.2834)  loss_class_hybrid: 0.4845 (0.4845)  loss_bbox_hybrid: 0.1058 (0.1058)  loss_giou_hybrid: 0.3373 (0.3373)  loss_class_0_hybrid: 0.5548 (0.5548)  loss_bbox_0_hybrid: 0.1572 (0.1572)  loss_giou_0_hybrid: 0.3959 (0.3959)  loss_class_1_hybrid: 0.4664 (0.4664)  loss_bbox_1_hybrid: 0.1326 (0.1326)  loss_giou_1_hybrid: 0.3741 (0.3741)  loss_class_2_hybrid: 0.4613 (0.4613)  loss_bbox_2_hybrid: 0.1189 (0.1189)  loss_giou_2_hybrid: 0.3427 (0.3427)  loss_class_3_hybrid: 0.4598 (0.4598)  loss_bbox_3_hybrid: 0.1033 (0.1033)  loss_giou_3_hybrid: 0.3293 (0.3293)  loss_class_4_hybrid: 0.4732 (0.4732)  loss_bbox_4_hybrid: 0.1044 (0.1044)  loss_giou_4_hybrid: 0.3367 (0.3367)  loss_class_enc_hybrid: 0.5805 (0.5805)  loss_bbox_enc_hybrid: 0.2324 (0.2324)  loss_giou_enc_hybrid: 0.4052 (0.4052)  mem: 731  max mem: 19990
[2025-05-20 10:01:51 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:19:38 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5923  loss: 26.7832 (25.0296)  loss_class: 0.4304 (0.5491)  loss_bbox: 0.2652 (0.2854)  loss_giou: 0.3880 (0.3500)  loss_class_0: 0.5540 (0.7040)  loss_bbox_0: 0.2313 (0.2929)  loss_giou_0: 0.3402 (0.3623)  loss_class_1: 0.4670 (0.6082)  loss_bbox_1: 0.2663 (0.2788)  loss_giou_1: 0.3646 (0.3507)  loss_class_2: 0.4407 (0.5730)  loss_bbox_2: 0.2564 (0.2797)  loss_giou_2: 0.3961 (0.3498)  loss_class_3: 0.4364 (0.5527)  loss_bbox_3: 0.1978 (0.2854)  loss_giou_3: 0.3703 (0.3506)  loss_class_4: 0.4297 (0.5479)  loss_bbox_4: 0.2648 (0.2863)  loss_giou_4: 0.3869 (0.3503)  loss_class_enc: 0.9460 (0.9889)  loss_bbox_enc: 0.3070 (0.2900)  loss_giou_enc: 0.4091 (0.3896)  loss_class_dn: 0.4098 (0.3375)  loss_bbox_dn: 0.3966 (0.3764)  loss_giou_dn: 0.4017 (0.3783)  loss_class_dn_0: 0.4638 (0.4077)  loss_bbox_dn_0: 0.4183 (0.4803)  loss_giou_dn_0: 0.5480 (0.4900)  loss_class_dn_1: 0.4361 (0.3630)  loss_bbox_dn_1: 0.4024 (0.4033)  loss_giou_dn_1: 0.4442 (0.3991)  loss_class_dn_2: 0.4272 (0.3411)  loss_bbox_dn_2: 0.3934 (0.3886)  loss_giou_dn_2: 0.4335 (0.3849)  loss_class_dn_3: 0.4133 (0.3388)  loss_bbox_dn_3: 0.3905 (0.3784)  loss_giou_dn_3: 0.4034 (0.3794)  loss_class_dn_4: 0.4108 (0.3382)  loss_bbox_dn_4: 0.3964 (0.3774)  loss_giou_dn_4: 0.4035 (0.3786)  loss_class_hybrid: 0.4557 (0.6199)  loss_bbox_hybrid: 0.2650 (0.2703)  loss_giou_hybrid: 0.3609 (0.3420)  loss_class_0_hybrid: 0.5842 (0.6721)  loss_bbox_0_hybrid: 0.3224 (0.2919)  loss_giou_0_hybrid: 0.3825 (0.3671)  loss_class_1_hybrid: 0.4727 (0.6279)  loss_bbox_1_hybrid: 0.3555 (0.2789)  loss_giou_1_hybrid: 0.3967 (0.3510)  loss_class_2_hybrid: 0.4539 (0.6199)  loss_bbox_2_hybrid: 0.2937 (0.2734)  loss_giou_2_hybrid: 0.3560 (0.3459)  loss_class_3_hybrid: 0.4466 (0.6168)  loss_bbox_3_hybrid: 0.3069 (0.2728)  loss_giou_3_hybrid: 0.3572 (0.3441)  loss_class_4_hybrid: 0.4546 (0.6159)  loss_bbox_4_hybrid: 0.2732 (0.2724)  loss_giou_4_hybrid: 0.3626 (0.3435)  loss_class_enc_hybrid: 0.6767 (0.7612)  loss_bbox_enc_hybrid: 0.3906 (0.3412)  loss_giou_enc_hybrid: 0.4810 (0.4350)
[2025-05-20 10:19:38 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 10:19:38 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\pytorch_model.bin
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\optimizer.bin
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\scheduler.bin
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\sampler.bin
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\sampler_1.bin
[2025-05-20 10:19:38 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_49\random_states_0.pkl
[2025-05-20 10:19:38 det.__main__] INFO: Start evaluation
[2025-05-20 10:19:39 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:34  model_time: 0.1720 (0.1720)  evaluator_time: 0.0030 (0.0030)  time: 0.2070  data: 0.0320  mem: 732  max mem: 19990
[2025-05-20 10:19:40 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1736 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1801  data: 0.0033  mem: 732  max mem: 19990
[2025-05-20 10:19:42 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1732 (0.1735)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:19:44 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1732 (0.1735)  evaluator_time: 0.0030 (0.0031)  time: 0.1774  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:19:46 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0031)  time: 0.1772  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:19:48 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0033)  time: 0.1783  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:19:49 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1725 (0.1734)  evaluator_time: 0.0030 (0.0033)  time: 0.1778  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:19:51 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:09  model_time: 0.1720 (0.1735)  evaluator_time: 0.0030 (0.0033)  time: 0.1771  data: 0.0009  mem: 732  max mem: 19990
[2025-05-20 10:19:53 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1720 (0.1733)  evaluator_time: 0.0040 (0.0034)  time: 0.1775  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:19:55 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1730 (0.1734)  evaluator_time: 0.0040 (0.0034)  time: 0.1774  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:19:56 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1735 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1782  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:19:58 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1735 (0.1734)  evaluator_time: 0.0030 (0.0035)  time: 0.1782  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:00 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1730 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:02 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1721 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1768  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:20:04 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1730 (0.1734)  evaluator_time: 0.0040 (0.0035)  time: 0.1781  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:05 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:55  model_time: 0.1746 (0.1735)  evaluator_time: 0.0040 (0.0045)  time: 0.1870  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:07 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1746 (0.1735)  evaluator_time: 0.0040 (0.0045)  time: 0.1871  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:09 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1743 (0.1736)  evaluator_time: 0.0030 (0.0044)  time: 0.1786  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:11 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0043)  time: 0.1774  data: 0.0008  mem: 732  max mem: 19990
[2025-05-20 10:20:13 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1720 (0.1735)  evaluator_time: 0.0030 (0.0043)  time: 0.1771  data: 0.0008  mem: 732  max mem: 19990
[2025-05-20 10:20:14 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:46  model_time: 0.1720 (0.1735)  evaluator_time: 0.0040 (0.0042)  time: 0.1775  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:16 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1720 (0.1735)  evaluator_time: 0.0030 (0.0042)  time: 0.1779  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:18 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0042)  time: 0.1781  data: 0.0008  mem: 732  max mem: 19990
[2025-05-20 10:20:20 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0042)  time: 0.1779  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:21 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1720 (0.1735)  evaluator_time: 0.0030 (0.0041)  time: 0.1764  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:20:23 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1720 (0.1734)  evaluator_time: 0.0020 (0.0041)  time: 0.1757  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:20:25 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1716 (0.1733)  evaluator_time: 0.0030 (0.0040)  time: 0.1757  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:20:27 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1720 (0.1733)  evaluator_time: 0.0030 (0.0040)  time: 0.1759  data: 0.0003  mem: 732  max mem: 19990
[2025-05-20 10:20:28 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0040)  time: 0.1757  data: 0.0004  mem: 732  max mem: 19990
[2025-05-20 10:20:30 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1718 (0.1732)  evaluator_time: 0.0030 (0.0039)  time: 0.1754  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:32 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0039)  time: 0.1759  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:34 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0039)  time: 0.1758  data: 0.0008  mem: 732  max mem: 19990
[2025-05-20 10:20:36 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1716 (0.1731)  evaluator_time: 0.0030 (0.0039)  time: 0.1758  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:37 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1720 (0.1730)  evaluator_time: 0.0030 (0.0039)  time: 0.1760  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:39 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1720 (0.1730)  evaluator_time: 0.0030 (0.0039)  time: 0.1761  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:41 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1716 (0.1730)  evaluator_time: 0.0040 (0.0038)  time: 0.1762  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:43 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1715 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1759  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:44 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1715 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1756  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:46 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0038)  time: 0.1757  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:48 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1720 (0.1728)  evaluator_time: 0.0040 (0.0039)  time: 0.1772  data: 0.0005  mem: 732  max mem: 19990
[2025-05-20 10:20:50 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1720 (0.1728)  evaluator_time: 0.0040 (0.0038)  time: 0.1776  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:51 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1782  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:53 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1760 (0.1730)  evaluator_time: 0.0030 (0.0038)  time: 0.1796  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:20:55 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1747 (0.1730)  evaluator_time: 0.0030 (0.0038)  time: 0.1787  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:57 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1747 (0.1730)  evaluator_time: 0.0030 (0.0038)  time: 0.1789  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:20:59 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1756 (0.1731)  evaluator_time: 0.0030 (0.0038)  time: 0.1800  data: 0.0007  mem: 732  max mem: 19990
[2025-05-20 10:21:00 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1759 (0.1731)  evaluator_time: 0.0030 (0.0038)  time: 0.1797  data: 0.0006  mem: 732  max mem: 19990
[2025-05-20 10:21:00 det.util.engine] INFO: Averaged stats: model_time: 0.1759 (0.1731)  evaluator_time: 0.0030 (0.0038)
[2025-05-20 10:21:00 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.32s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.710
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554

[2025-05-20 10:21:00 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4039  | 0.647  | 0.405 |
| Crescent_gap  | 48   | 48  | 5113  | 1.000  | 0.943 |
| Inclusion     | 41   | 82  | 12901 | 0.793  | 0.420 |
| Oil_spot      | 58   | 125 | 18991 | 0.920  | 0.687 |
| Punching      | 74   | 74  | 3235  | 1.000  | 0.949 |
| Rolled_pit    | 10   | 25  | 3313  | 0.800  | 0.456 |
| Silk_spot     | 134  | 150 | 58801 | 0.933  | 0.648 |
| Waist_folding | 24   | 26  | 7382  | 0.962  | 0.787 |
| Water_spot    | 68   | 78  | 10761 | 0.987  | 0.847 |
| Welding_line  | 99   | 99  | 12584 | 1.000  | 0.963 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.904  | 0.710 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 10:21:00 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:21:01 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 10:21:01 det.util.engine] INFO: Epoch: [50]  [0/1834]  eta: 0:18:27  lr: 0.000010  data_time: 0.0006  iter_time: 0.6037  loss: 18.8838 (18.8838)  loss_class: 0.4203 (0.4203)  loss_bbox: 0.0350 (0.0350)  loss_giou: 0.3919 (0.3919)  loss_class_0: 0.7979 (0.7979)  loss_bbox_0: 0.0242 (0.0242)  loss_giou_0: 0.3255 (0.3255)  loss_class_1: 0.5404 (0.5404)  loss_bbox_1: 0.0430 (0.0430)  loss_giou_1: 0.4537 (0.4537)  loss_class_2: 0.4640 (0.4640)  loss_bbox_2: 0.0325 (0.0325)  loss_giou_2: 0.3559 (0.3559)  loss_class_3: 0.4293 (0.4293)  loss_bbox_3: 0.0352 (0.0352)  loss_giou_3: 0.3767 (0.3767)  loss_class_4: 0.4241 (0.4241)  loss_bbox_4: 0.0350 (0.0350)  loss_giou_4: 0.3927 (0.3927)  loss_class_enc: 0.4923 (0.4923)  loss_bbox_enc: 0.0706 (0.0706)  loss_giou_enc: 0.6138 (0.6138)  loss_class_dn: 0.4179 (0.4179)  loss_bbox_dn: 0.0362 (0.0362)  loss_giou_dn: 0.3633 (0.3633)  loss_class_dn_0: 0.5243 (0.5243)  loss_bbox_dn_0: 0.0546 (0.0546)  loss_giou_dn_0: 0.6155 (0.6155)  loss_class_dn_1: 0.4337 (0.4337)  loss_bbox_dn_1: 0.0354 (0.0354)  loss_giou_dn_1: 0.3749 (0.3749)  loss_class_dn_2: 0.4042 (0.4042)  loss_bbox_dn_2: 0.0373 (0.0373)  loss_giou_dn_2: 0.3840 (0.3840)  loss_class_dn_3: 0.4125 (0.4125)  loss_bbox_dn_3: 0.0356 (0.0356)  loss_giou_dn_3: 0.3587 (0.3587)  loss_class_dn_4: 0.4079 (0.4079)  loss_bbox_dn_4: 0.0361 (0.0361)  loss_giou_dn_4: 0.3633 (0.3633)  loss_class_hybrid: 0.4630 (0.4630)  loss_bbox_hybrid: 0.0355 (0.0355)  loss_giou_hybrid: 0.4000 (0.4000)  loss_class_0_hybrid: 0.6065 (0.6065)  loss_bbox_0_hybrid: 0.0352 (0.0352)  loss_giou_0_hybrid: 0.4001 (0.4001)  loss_class_1_hybrid: 0.5341 (0.5341)  loss_bbox_1_hybrid: 0.0266 (0.0266)  loss_giou_1_hybrid: 0.2842 (0.2842)  loss_class_2_hybrid: 0.4543 (0.4543)  loss_bbox_2_hybrid: 0.0354 (0.0354)  loss_giou_2_hybrid: 0.3641 (0.3641)  loss_class_3_hybrid: 0.4549 (0.4549)  loss_bbox_3_hybrid: 0.0362 (0.0362)  loss_giou_3_hybrid: 0.3938 (0.3938)  loss_class_4_hybrid: 0.4561 (0.4561)  loss_bbox_4_hybrid: 0.0355 (0.0355)  loss_giou_4_hybrid: 0.4006 (0.4006)  loss_class_enc_hybrid: 0.4845 (0.4845)  loss_bbox_enc_hybrid: 0.0842 (0.0842)  loss_giou_enc_hybrid: 0.8501 (0.8501)  mem: 735  max mem: 19990
[2025-05-20 10:21:01 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:38:49 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5976  loss: 24.4123 (25.2340)  loss_class: 0.4724 (0.5757)  loss_bbox: 0.2049 (0.2829)  loss_giou: 0.2797 (0.3492)  loss_class_0: 0.5975 (0.6987)  loss_bbox_0: 0.1842 (0.2983)  loss_giou_0: 0.3527 (0.3686)  loss_class_1: 0.5186 (0.6182)  loss_bbox_1: 0.2014 (0.2809)  loss_giou_1: 0.3214 (0.3515)  loss_class_2: 0.4792 (0.5886)  loss_bbox_2: 0.1940 (0.2808)  loss_giou_2: 0.2987 (0.3506)  loss_class_3: 0.4748 (0.5859)  loss_bbox_3: 0.2156 (0.2786)  loss_giou_3: 0.2816 (0.3475)  loss_class_4: 0.4847 (0.5795)  loss_bbox_4: 0.2049 (0.2799)  loss_giou_4: 0.2768 (0.3486)  loss_class_enc: 1.0974 (0.9984)  loss_bbox_enc: 0.1825 (0.2886)  loss_giou_enc: 0.3985 (0.3884)  loss_class_dn: 0.3751 (0.3395)  loss_bbox_dn: 0.1795 (0.3677)  loss_giou_dn: 0.3063 (0.3769)  loss_class_dn_0: 0.4509 (0.4091)  loss_bbox_dn_0: 0.3184 (0.4721)  loss_giou_dn_0: 0.5044 (0.4890)  loss_class_dn_1: 0.3779 (0.3652)  loss_bbox_dn_1: 0.2106 (0.3938)  loss_giou_dn_1: 0.3389 (0.3972)  loss_class_dn_2: 0.3635 (0.3444)  loss_bbox_dn_2: 0.1841 (0.3791)  loss_giou_dn_2: 0.3022 (0.3826)  loss_class_dn_3: 0.3680 (0.3414)  loss_bbox_dn_3: 0.1816 (0.3696)  loss_giou_dn_3: 0.2890 (0.3776)  loss_class_dn_4: 0.3676 (0.3404)  loss_bbox_dn_4: 0.1803 (0.3687)  loss_giou_dn_4: 0.3180 (0.3771)  loss_class_hybrid: 0.5544 (0.6369)  loss_bbox_hybrid: 0.1634 (0.2711)  loss_giou_hybrid: 0.2881 (0.3440)  loss_class_0_hybrid: 0.6118 (0.6818)  loss_bbox_0_hybrid: 0.1762 (0.2921)  loss_giou_0_hybrid: 0.3821 (0.3693)  loss_class_1_hybrid: 0.6068 (0.6493)  loss_bbox_1_hybrid: 0.1913 (0.2765)  loss_giou_1_hybrid: 0.3167 (0.3516)  loss_class_2_hybrid: 0.5684 (0.6443)  loss_bbox_2_hybrid: 0.1704 (0.2718)  loss_giou_2_hybrid: 0.2913 (0.3470)  loss_class_3_hybrid: 0.5536 (0.6364)  loss_bbox_3_hybrid: 0.1664 (0.2727)  loss_giou_3_hybrid: 0.2918 (0.3458)  loss_class_4_hybrid: 0.5577 (0.6352)  loss_bbox_4_hybrid: 0.1630 (0.2718)  loss_giou_4_hybrid: 0.3035 (0.3448)  loss_class_enc_hybrid: 0.7272 (0.7940)  loss_bbox_enc_hybrid: 0.2264 (0.3342)  loss_giou_enc_hybrid: 0.4676 (0.4326)
[2025-05-20 10:38:49 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 10:38:49 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\pytorch_model.bin
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\optimizer.bin
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\scheduler.bin
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\sampler.bin
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\sampler_1.bin
[2025-05-20 10:38:49 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_50\random_states_0.pkl
[2025-05-20 10:38:49 det.__main__] INFO: Start evaluation
[2025-05-20 10:38:49 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1706 (0.1706)  evaluator_time: 0.0030 (0.0030)  time: 0.1946  data: 0.0200  mem: 726  max mem: 19990
[2025-05-20 10:38:51 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:21  model_time: 0.1754 (0.1748)  evaluator_time: 0.0030 (0.0033)  time: 0.1808  data: 0.0023  mem: 726  max mem: 19990
[2025-05-20 10:38:53 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1754 (0.1751)  evaluator_time: 0.0030 (0.0031)  time: 0.1793  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:38:55 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1750 (0.1752)  evaluator_time: 0.0030 (0.0029)  time: 0.1789  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:38:57 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:16  model_time: 0.1750 (0.1753)  evaluator_time: 0.0030 (0.0066)  time: 0.1865  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:38:58 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:14  model_time: 0.1750 (0.1752)  evaluator_time: 0.0030 (0.0060)  time: 0.1867  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:39:00 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:12  model_time: 0.1750 (0.1753)  evaluator_time: 0.0030 (0.0055)  time: 0.1791  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:02 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:10  model_time: 0.1750 (0.1752)  evaluator_time: 0.0030 (0.0051)  time: 0.1789  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:04 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:08  model_time: 0.1750 (0.1753)  evaluator_time: 0.0030 (0.0049)  time: 0.1794  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:06 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:06  model_time: 0.1750 (0.1753)  evaluator_time: 0.0030 (0.0047)  time: 0.1798  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:07 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:04  model_time: 0.1756 (0.1753)  evaluator_time: 0.0030 (0.0046)  time: 0.1795  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:39:09 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:02  model_time: 0.1750 (0.1753)  evaluator_time: 0.0030 (0.0045)  time: 0.1797  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:39:11 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:01  model_time: 0.1740 (0.1752)  evaluator_time: 0.0030 (0.0044)  time: 0.1787  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:39:13 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:59  model_time: 0.1744 (0.1752)  evaluator_time: 0.0030 (0.0043)  time: 0.1788  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:14 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:57  model_time: 0.1750 (0.1751)  evaluator_time: 0.0040 (0.0043)  time: 0.1795  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:39:16 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:55  model_time: 0.1745 (0.1752)  evaluator_time: 0.0040 (0.0042)  time: 0.1794  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:18 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1747 (0.1751)  evaluator_time: 0.0030 (0.0042)  time: 0.1796  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:39:20 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1744 (0.1751)  evaluator_time: 0.0030 (0.0042)  time: 0.1787  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:22 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:50  model_time: 0.1737 (0.1750)  evaluator_time: 0.0020 (0.0041)  time: 0.1773  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:23 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:48  model_time: 0.1730 (0.1749)  evaluator_time: 0.0030 (0.0041)  time: 0.1774  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:25 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:46  model_time: 0.1735 (0.1749)  evaluator_time: 0.0040 (0.0040)  time: 0.1783  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:39:27 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1740 (0.1748)  evaluator_time: 0.0030 (0.0040)  time: 0.1779  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:39:29 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1727 (0.1747)  evaluator_time: 0.0030 (0.0040)  time: 0.1777  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:39:31 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1720 (0.1746)  evaluator_time: 0.0030 (0.0039)  time: 0.1774  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:32 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:39  model_time: 0.1720 (0.1746)  evaluator_time: 0.0030 (0.0039)  time: 0.1770  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:34 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1724 (0.1745)  evaluator_time: 0.0020 (0.0039)  time: 0.1767  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:36 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1730 (0.1745)  evaluator_time: 0.0030 (0.0038)  time: 0.1771  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:39:38 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1740 (0.1745)  evaluator_time: 0.0030 (0.0038)  time: 0.1781  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:39 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1730 (0.1744)  evaluator_time: 0.0030 (0.0038)  time: 0.1775  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:39:41 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:30  model_time: 0.1726 (0.1744)  evaluator_time: 0.0030 (0.0038)  time: 0.1769  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:39:43 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1740 (0.1744)  evaluator_time: 0.0030 (0.0037)  time: 0.1776  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:45 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1740 (0.1744)  evaluator_time: 0.0030 (0.0037)  time: 0.1777  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:47 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1736 (0.1743)  evaluator_time: 0.0030 (0.0037)  time: 0.1778  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:48 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1740 (0.1743)  evaluator_time: 0.0030 (0.0037)  time: 0.1781  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:50 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:21  model_time: 0.1740 (0.1743)  evaluator_time: 0.0030 (0.0037)  time: 0.1779  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:52 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1736 (0.1743)  evaluator_time: 0.0030 (0.0037)  time: 0.1777  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:54 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1727 (0.1743)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:55 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1730 (0.1742)  evaluator_time: 0.0030 (0.0037)  time: 0.1770  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:39:57 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1730 (0.1742)  evaluator_time: 0.0030 (0.0037)  time: 0.1776  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:39:59 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1736 (0.1742)  evaluator_time: 0.0040 (0.0037)  time: 0.1793  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 10:40:01 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1730 (0.1742)  evaluator_time: 0.0040 (0.0037)  time: 0.1784  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:40:02 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1720 (0.1741)  evaluator_time: 0.0030 (0.0037)  time: 0.1760  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:40:04 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1720 (0.1741)  evaluator_time: 0.0030 (0.0037)  time: 0.1760  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:40:06 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1730 (0.1740)  evaluator_time: 0.0030 (0.0037)  time: 0.1767  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:40:08 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1730 (0.1740)  evaluator_time: 0.0030 (0.0037)  time: 0.1772  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:40:10 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1727 (0.1740)  evaluator_time: 0.0030 (0.0036)  time: 0.1769  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:40:11 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1720 (0.1740)  evaluator_time: 0.0030 (0.0036)  time: 0.1764  data: 0.0006  mem: 725  max mem: 19990
[2025-05-20 10:40:11 det.util.engine] INFO: Averaged stats: model_time: 0.1720 (0.1740)  evaluator_time: 0.0030 (0.0036)
[2025-05-20 10:40:11 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.697
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.390
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.537

[2025-05-20 10:40:11 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 3367  | 0.588  | 0.312 |
| Crescent_gap  | 48   | 48  | 5955  | 1.000  | 0.941 |
| Inclusion     | 41   | 82  | 10601 | 0.768  | 0.424 |
| Oil_spot      | 58   | 125 | 13456 | 0.928  | 0.699 |
| Punching      | 74   | 74  | 2339  | 0.973  | 0.956 |
| Rolled_pit    | 10   | 25  | 3037  | 0.760  | 0.444 |
| Silk_spot     | 134  | 150 | 75853 | 0.927  | 0.644 |
| Waist_folding | 24   | 26  | 6395  | 0.962  | 0.762 |
| Water_spot    | 68   | 78  | 8098  | 0.974  | 0.823 |
| Welding_line  | 99   | 99  | 7772  | 1.000  | 0.963 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.888  | 0.697 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 10:40:11 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:40:12 det.util.engine] INFO: Epoch: [51]  [0/1834]  eta: 0:19:57  lr: 0.000010  data_time: 0.0007  iter_time: 0.6529  loss: 32.1795 (32.1795)  loss_class: 0.9874 (0.9874)  loss_bbox: 0.2825 (0.2825)  loss_giou: 0.2507 (0.2507)  loss_class_0: 1.2353 (1.2353)  loss_bbox_0: 0.1785 (0.1785)  loss_giou_0: 0.2958 (0.2958)  loss_class_1: 0.8384 (0.8384)  loss_bbox_1: 0.2894 (0.2894)  loss_giou_1: 0.2863 (0.2863)  loss_class_2: 0.9321 (0.9321)  loss_bbox_2: 0.2554 (0.2554)  loss_giou_2: 0.2545 (0.2545)  loss_class_3: 1.0573 (1.0573)  loss_bbox_3: 0.2762 (0.2762)  loss_giou_3: 0.2454 (0.2454)  loss_class_4: 1.0838 (1.0838)  loss_bbox_4: 0.2784 (0.2784)  loss_giou_4: 0.2461 (0.2461)  loss_class_enc: 2.0869 (2.0869)  loss_bbox_enc: 0.5130 (0.5130)  loss_giou_enc: 0.6032 (0.6032)  loss_class_dn: 0.3981 (0.3981)  loss_bbox_dn: 0.3753 (0.3753)  loss_giou_dn: 0.3695 (0.3695)  loss_class_dn_0: 0.4609 (0.4609)  loss_bbox_dn_0: 0.5408 (0.5408)  loss_giou_dn_0: 0.4993 (0.4993)  loss_class_dn_1: 0.4024 (0.4024)  loss_bbox_dn_1: 0.5107 (0.5107)  loss_giou_dn_1: 0.4778 (0.4778)  loss_class_dn_2: 0.4151 (0.4151)  loss_bbox_dn_2: 0.4825 (0.4825)  loss_giou_dn_2: 0.4571 (0.4571)  loss_class_dn_3: 0.4015 (0.4015)  loss_bbox_dn_3: 0.4413 (0.4413)  loss_giou_dn_3: 0.4105 (0.4105)  loss_class_dn_4: 0.4018 (0.4018)  loss_bbox_dn_4: 0.3654 (0.3654)  loss_giou_dn_4: 0.3602 (0.3602)  loss_class_hybrid: 0.8949 (0.8949)  loss_bbox_hybrid: 0.3107 (0.3107)  loss_giou_hybrid: 0.3009 (0.3009)  loss_class_0_hybrid: 1.1859 (1.1859)  loss_bbox_0_hybrid: 0.3342 (0.3342)  loss_giou_0_hybrid: 0.3165 (0.3165)  loss_class_1_hybrid: 1.0171 (1.0171)  loss_bbox_1_hybrid: 0.2917 (0.2917)  loss_giou_1_hybrid: 0.3543 (0.3543)  loss_class_2_hybrid: 1.0629 (1.0629)  loss_bbox_2_hybrid: 0.3091 (0.3091)  loss_giou_2_hybrid: 0.3228 (0.3228)  loss_class_3_hybrid: 0.9921 (0.9921)  loss_bbox_3_hybrid: 0.3144 (0.3144)  loss_giou_3_hybrid: 0.3133 (0.3133)  loss_class_4_hybrid: 0.9186 (0.9186)  loss_bbox_4_hybrid: 0.3108 (0.3108)  loss_giou_4_hybrid: 0.2994 (0.2994)  loss_class_enc_hybrid: 1.0066 (1.0066)  loss_bbox_enc_hybrid: 0.5682 (0.5682)  loss_giou_enc_hybrid: 0.5086 (0.5086)  mem: 738  max mem: 19990
[2025-05-20 10:40:12 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:57:53 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.6164  loss: 24.6453 (24.5819)  loss_class: 0.4507 (0.5398)  loss_bbox: 0.1332 (0.2769)  loss_giou: 0.3197 (0.3436)  loss_class_0: 0.6463 (0.6859)  loss_bbox_0: 0.1166 (0.2932)  loss_giou_0: 0.3420 (0.3626)  loss_class_1: 0.5230 (0.5895)  loss_bbox_1: 0.1200 (0.2829)  loss_giou_1: 0.3749 (0.3476)  loss_class_2: 0.4495 (0.5670)  loss_bbox_2: 0.1100 (0.2757)  loss_giou_2: 0.3315 (0.3435)  loss_class_3: 0.4569 (0.5462)  loss_bbox_3: 0.1324 (0.2770)  loss_giou_3: 0.3169 (0.3441)  loss_class_4: 0.4480 (0.5378)  loss_bbox_4: 0.1220 (0.2770)  loss_giou_4: 0.3195 (0.3435)  loss_class_enc: 0.9514 (0.9722)  loss_bbox_enc: 0.1990 (0.2904)  loss_giou_enc: 0.4628 (0.3877)  loss_class_dn: 0.3934 (0.3364)  loss_bbox_dn: 0.1373 (0.3612)  loss_giou_dn: 0.4148 (0.3702)  loss_class_dn_0: 0.4578 (0.4051)  loss_bbox_dn_0: 0.2461 (0.4711)  loss_giou_dn_0: 0.6142 (0.4811)  loss_class_dn_1: 0.4326 (0.3613)  loss_bbox_dn_1: 0.1420 (0.3905)  loss_giou_dn_1: 0.4928 (0.3909)  loss_class_dn_2: 0.4034 (0.3406)  loss_bbox_dn_2: 0.1326 (0.3739)  loss_giou_dn_2: 0.4492 (0.3761)  loss_class_dn_3: 0.3994 (0.3383)  loss_bbox_dn_3: 0.1333 (0.3635)  loss_giou_dn_3: 0.4161 (0.3710)  loss_class_dn_4: 0.3900 (0.3372)  loss_bbox_dn_4: 0.1492 (0.3623)  loss_giou_dn_4: 0.4148 (0.3704)  loss_class_hybrid: 0.4859 (0.5927)  loss_bbox_hybrid: 0.1215 (0.2718)  loss_giou_hybrid: 0.3726 (0.3414)  loss_class_0_hybrid: 0.6154 (0.6528)  loss_bbox_0_hybrid: 0.1234 (0.2911)  loss_giou_0_hybrid: 0.3721 (0.3653)  loss_class_1_hybrid: 0.4936 (0.6092)  loss_bbox_1_hybrid: 0.1167 (0.2760)  loss_giou_1_hybrid: 0.3668 (0.3477)  loss_class_2_hybrid: 0.5032 (0.5981)  loss_bbox_2_hybrid: 0.1190 (0.2730)  loss_giou_2_hybrid: 0.3623 (0.3442)  loss_class_3_hybrid: 0.4949 (0.5930)  loss_bbox_3_hybrid: 0.1316 (0.2729)  loss_giou_3_hybrid: 0.3754 (0.3424)  loss_class_4_hybrid: 0.4788 (0.5895)  loss_bbox_4_hybrid: 0.1286 (0.2734)  loss_giou_4_hybrid: 0.3704 (0.3425)  loss_class_enc_hybrid: 0.7019 (0.7539)  loss_bbox_enc_hybrid: 0.2471 (0.3362)  loss_giou_enc_hybrid: 0.5043 (0.4295)
[2025-05-20 10:57:53 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 10:57:53 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\pytorch_model.bin
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\optimizer.bin
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\scheduler.bin
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\sampler.bin
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\sampler_1.bin
[2025-05-20 10:57:53 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_51\random_states_0.pkl
[2025-05-20 10:57:53 det.__main__] INFO: Start evaluation
[2025-05-20 10:57:54 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:37  model_time: 0.1750 (0.1750)  evaluator_time: 0.0030 (0.0030)  time: 0.2129  data: 0.0349  mem: 726  max mem: 19990
[2025-05-20 10:57:55 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1730 (0.1729)  evaluator_time: 0.0030 (0.0033)  time: 0.1798  data: 0.0034  mem: 726  max mem: 19990
[2025-05-20 10:57:57 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:21  model_time: 0.1728 (0.1729)  evaluator_time: 0.0030 (0.0107)  time: 0.1845  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:57:59 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:18  model_time: 0.1728 (0.1730)  evaluator_time: 0.0030 (0.0081)  time: 0.1844  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:01 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:15  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0069)  time: 0.1768  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:03 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:13  model_time: 0.1740 (0.1733)  evaluator_time: 0.0030 (0.0063)  time: 0.1781  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:04 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:11  model_time: 0.1737 (0.1733)  evaluator_time: 0.0030 (0.0057)  time: 0.1779  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:06 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:09  model_time: 0.1728 (0.1732)  evaluator_time: 0.0030 (0.0053)  time: 0.1767  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:08 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1727 (0.1732)  evaluator_time: 0.0030 (0.0051)  time: 0.1769  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:10 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0049)  time: 0.1773  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:11 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:04  model_time: 0.1731 (0.1733)  evaluator_time: 0.0030 (0.0048)  time: 0.1775  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:13 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:02  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0047)  time: 0.1776  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:15 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1724 (0.1732)  evaluator_time: 0.0030 (0.0045)  time: 0.1766  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:17 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0044)  time: 0.1761  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:19 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1725 (0.1732)  evaluator_time: 0.0040 (0.0044)  time: 0.1773  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:20 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1725 (0.1731)  evaluator_time: 0.0040 (0.0043)  time: 0.1775  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:22 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1716 (0.1730)  evaluator_time: 0.0040 (0.0043)  time: 0.1764  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:24 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1710 (0.1729)  evaluator_time: 0.0030 (0.0042)  time: 0.1757  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:26 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1716 (0.1728)  evaluator_time: 0.0030 (0.0042)  time: 0.1753  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:27 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1716 (0.1728)  evaluator_time: 0.0030 (0.0042)  time: 0.1757  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:29 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1720 (0.1727)  evaluator_time: 0.0030 (0.0041)  time: 0.1759  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:31 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1716 (0.1727)  evaluator_time: 0.0030 (0.0041)  time: 0.1758  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:33 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1716 (0.1726)  evaluator_time: 0.0030 (0.0041)  time: 0.1760  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:34 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1715 (0.1726)  evaluator_time: 0.0030 (0.0040)  time: 0.1761  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:36 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1716 (0.1726)  evaluator_time: 0.0030 (0.0040)  time: 0.1757  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:38 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1720 (0.1725)  evaluator_time: 0.0020 (0.0039)  time: 0.1754  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:40 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1720 (0.1725)  evaluator_time: 0.0030 (0.0039)  time: 0.1755  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:41 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1715 (0.1725)  evaluator_time: 0.0030 (0.0039)  time: 0.1755  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:43 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1716 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1754  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:45 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1712 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1756  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 10:58:47 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1710 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1754  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 10:58:48 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1712 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1749  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 10:58:50 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1720 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1760  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 10:58:52 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1740 (0.1724)  evaluator_time: 0.0030 (0.0037)  time: 0.1775  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:58:54 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1740 (0.1725)  evaluator_time: 0.0030 (0.0037)  time: 0.1778  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:56 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1730 (0.1725)  evaluator_time: 0.0030 (0.0037)  time: 0.1774  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:57 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1726 (0.1725)  evaluator_time: 0.0030 (0.0037)  time: 0.1770  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:58:59 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1730 (0.1725)  evaluator_time: 0.0030 (0.0037)  time: 0.1771  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:59:01 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1731 (0.1725)  evaluator_time: 0.0030 (0.0037)  time: 0.1772  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:59:03 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1730 (0.1725)  evaluator_time: 0.0040 (0.0037)  time: 0.1783  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:59:04 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1730 (0.1726)  evaluator_time: 0.0040 (0.0037)  time: 0.1787  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:59:06 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1730 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1771  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:59:08 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1721 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1768  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:59:10 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 10:59:11 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1727 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1775  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 10:59:13 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1727 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:59:14 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1770  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 10:59:14 det.util.engine] INFO: Averaged stats: model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 10:59:15 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.701
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541

[2025-05-20 10:59:15 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4565  | 0.647  | 0.367 |
| Crescent_gap  | 48   | 48  | 5037  | 1.000  | 0.937 |
| Inclusion     | 41   | 82  | 9992  | 0.768  | 0.378 |
| Oil_spot      | 58   | 125 | 17684 | 0.912  | 0.694 |
| Punching      | 74   | 74  | 2340  | 0.986  | 0.954 |
| Rolled_pit    | 10   | 25  | 2491  | 0.840  | 0.473 |
| Silk_spot     | 134  | 150 | 67070 | 0.913  | 0.640 |
| Waist_folding | 24   | 26  | 7255  | 0.962  | 0.755 |
| Water_spot    | 68   | 78  | 12629 | 0.974  | 0.844 |
| Welding_line  | 99   | 99  | 8207  | 1.000  | 0.970 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.900  | 0.701 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 10:59:15 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 10:59:16 det.util.engine] INFO: Epoch: [52]  [0/1834]  eta: 0:18:36  lr: 0.000010  data_time: 0.0011  iter_time: 0.6087  loss: 59.0954 (59.0954)  loss_class: 2.4817 (2.4817)  loss_bbox: 0.2129 (0.2129)  loss_giou: 0.2098 (0.2098)  loss_class_0: 2.4700 (2.4700)  loss_bbox_0: 0.1261 (0.1261)  loss_giou_0: 0.2054 (0.2054)  loss_class_1: 2.7129 (2.7129)  loss_bbox_1: 0.1542 (0.1542)  loss_giou_1: 0.1967 (0.1967)  loss_class_2: 2.4693 (2.4693)  loss_bbox_2: 0.1696 (0.1696)  loss_giou_2: 0.2327 (0.2327)  loss_class_3: 2.5593 (2.5593)  loss_bbox_3: 0.2152 (0.2152)  loss_giou_3: 0.2465 (0.2465)  loss_class_4: 1.5820 (1.5820)  loss_bbox_4: 0.5135 (0.5135)  loss_giou_4: 0.4668 (0.4668)  loss_class_enc: 2.2724 (2.2724)  loss_bbox_enc: 0.1852 (0.1852)  loss_giou_enc: 0.3743 (0.3743)  loss_class_dn: 0.4504 (0.4504)  loss_bbox_dn: 1.9998 (1.9998)  loss_giou_dn: 1.0664 (1.0664)  loss_class_dn_0: 0.5063 (0.5063)  loss_bbox_dn_0: 1.9314 (1.9314)  loss_giou_dn_0: 1.0683 (1.0683)  loss_class_dn_1: 0.5283 (0.5283)  loss_bbox_dn_1: 1.9379 (1.9379)  loss_giou_dn_1: 1.0654 (1.0654)  loss_class_dn_2: 0.4453 (0.4453)  loss_bbox_dn_2: 1.9850 (1.9850)  loss_giou_dn_2: 1.0687 (1.0687)  loss_class_dn_3: 0.4556 (0.4556)  loss_bbox_dn_3: 1.9856 (1.9856)  loss_giou_dn_3: 1.0633 (1.0633)  loss_class_dn_4: 0.4602 (0.4602)  loss_bbox_dn_4: 1.9936 (1.9936)  loss_giou_dn_4: 1.0663 (1.0663)  loss_class_hybrid: 2.0375 (2.0375)  loss_bbox_hybrid: 0.1905 (0.1905)  loss_giou_hybrid: 0.2815 (0.2815)  loss_class_0_hybrid: 2.0381 (2.0381)  loss_bbox_0_hybrid: 0.2437 (0.2437)  loss_giou_0_hybrid: 0.3532 (0.3532)  loss_class_1_hybrid: 2.1518 (2.1518)  loss_bbox_1_hybrid: 0.1778 (0.1778)  loss_giou_1_hybrid: 0.2841 (0.2841)  loss_class_2_hybrid: 2.0908 (2.0908)  loss_bbox_2_hybrid: 0.1774 (0.1774)  loss_giou_2_hybrid: 0.2852 (0.2852)  loss_class_3_hybrid: 2.1272 (2.1272)  loss_bbox_3_hybrid: 0.1823 (0.1823)  loss_giou_3_hybrid: 0.2742 (0.2742)  loss_class_4_hybrid: 2.1342 (2.1342)  loss_bbox_4_hybrid: 0.1759 (0.1759)  loss_giou_4_hybrid: 0.2712 (0.2712)  loss_class_enc_hybrid: 1.8493 (1.8493)  loss_bbox_enc_hybrid: 0.2542 (0.2542)  loss_giou_enc_hybrid: 0.3810 (0.3810)  mem: 741  max mem: 19990
[2025-05-20 10:59:16 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:17:00 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5469  loss: 20.2316 (25.1682)  loss_class: 0.3858 (0.5435)  loss_bbox: 0.1325 (0.2972)  loss_giou: 0.2313 (0.3571)  loss_class_0: 0.4699 (0.6864)  loss_bbox_0: 0.1357 (0.3072)  loss_giou_0: 0.2620 (0.3714)  loss_class_1: 0.4410 (0.6005)  loss_bbox_1: 0.2019 (0.2921)  loss_giou_1: 0.2938 (0.3594)  loss_class_2: 0.4488 (0.5707)  loss_bbox_2: 0.1647 (0.2925)  loss_giou_2: 0.2764 (0.3573)  loss_class_3: 0.3950 (0.5522)  loss_bbox_3: 0.1487 (0.2934)  loss_giou_3: 0.2716 (0.3567)  loss_class_4: 0.3999 (0.5427)  loss_bbox_4: 0.1388 (0.2951)  loss_giou_4: 0.2794 (0.3572)  loss_class_enc: 0.8370 (0.9805)  loss_bbox_enc: 0.1918 (0.2922)  loss_giou_enc: 0.3186 (0.3921)  loss_class_dn: 0.3369 (0.3443)  loss_bbox_dn: 0.1221 (0.3754)  loss_giou_dn: 0.2990 (0.3811)  loss_class_dn_0: 0.4394 (0.4138)  loss_bbox_dn_0: 0.3341 (0.4812)  loss_giou_dn_0: 0.4451 (0.4910)  loss_class_dn_1: 0.3719 (0.3698)  loss_bbox_dn_1: 0.2520 (0.4025)  loss_giou_dn_1: 0.3063 (0.4017)  loss_class_dn_2: 0.3470 (0.3482)  loss_bbox_dn_2: 0.1669 (0.3876)  loss_giou_dn_2: 0.2971 (0.3874)  loss_class_dn_3: 0.3360 (0.3462)  loss_bbox_dn_3: 0.1356 (0.3773)  loss_giou_dn_3: 0.2865 (0.3820)  loss_class_dn_4: 0.3374 (0.3454)  loss_bbox_dn_4: 0.1437 (0.3763)  loss_giou_dn_4: 0.2990 (0.3816)  loss_class_hybrid: 0.4369 (0.6024)  loss_bbox_hybrid: 0.1433 (0.2824)  loss_giou_hybrid: 0.2648 (0.3485)  loss_class_0_hybrid: 0.5406 (0.6469)  loss_bbox_0_hybrid: 0.1359 (0.3038)  loss_giou_0_hybrid: 0.3107 (0.3763)  loss_class_1_hybrid: 0.4421 (0.6143)  loss_bbox_1_hybrid: 0.1451 (0.2891)  loss_giou_1_hybrid: 0.2571 (0.3581)  loss_class_2_hybrid: 0.4461 (0.6099)  loss_bbox_2_hybrid: 0.1389 (0.2829)  loss_giou_2_hybrid: 0.2528 (0.3516)  loss_class_3_hybrid: 0.4411 (0.6005)  loss_bbox_3_hybrid: 0.1403 (0.2835)  loss_giou_3_hybrid: 0.2714 (0.3509)  loss_class_4_hybrid: 0.4363 (0.5996)  loss_bbox_4_hybrid: 0.1436 (0.2837)  loss_giou_4_hybrid: 0.2638 (0.3499)  loss_class_enc_hybrid: 0.7002 (0.7592)  loss_bbox_enc_hybrid: 0.2335 (0.3466)  loss_giou_enc_hybrid: 0.2984 (0.4382)
[2025-05-20 11:17:00 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 11:17:00 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\pytorch_model.bin
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\optimizer.bin
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\scheduler.bin
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\sampler.bin
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\sampler_1.bin
[2025-05-20 11:17:00 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_52\random_states_0.pkl
[2025-05-20 11:17:00 det.__main__] INFO: Start evaluation
[2025-05-20 11:17:01 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1750 (0.1750)  evaluator_time: 0.0040 (0.0040)  time: 0.1990  data: 0.0200  mem: 728  max mem: 19990
[2025-05-20 11:17:02 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:21  model_time: 0.1741 (0.1752)  evaluator_time: 0.0040 (0.0036)  time: 0.1813  data: 0.0025  mem: 728  max mem: 19990
[2025-05-20 11:17:04 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1727 (0.1740)  evaluator_time: 0.0030 (0.0033)  time: 0.1781  data: 0.0008  mem: 728  max mem: 19990
[2025-05-20 11:17:06 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1730 (0.1738)  evaluator_time: 0.0030 (0.0032)  time: 0.1769  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:08 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1730 (0.1738)  evaluator_time: 0.0030 (0.0031)  time: 0.1772  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:17:09 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0032)  time: 0.1772  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:11 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0032)  time: 0.1766  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:13 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1720 (0.1733)  evaluator_time: 0.0030 (0.0032)  time: 0.1765  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:15 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0032)  time: 0.1773  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:17 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0033)  time: 0.1773  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:17:18 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0004  mem: 728  max mem: 19990
[2025-05-20 11:17:20 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1720 (0.1732)  evaluator_time: 0.0036 (0.0034)  time: 0.1774  data: 0.0004  mem: 728  max mem: 19990
[2025-05-20 11:17:22 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:59  model_time: 0.1726 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1769  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:24 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1767  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:25 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1726 (0.1731)  evaluator_time: 0.0040 (0.0034)  time: 0.1777  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:27 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1781  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:29 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1721 (0.1730)  evaluator_time: 0.0040 (0.0035)  time: 0.1774  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:31 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:33 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1742 (0.1732)  evaluator_time: 0.0030 (0.0035)  time: 0.1784  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:34 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1748 (0.1732)  evaluator_time: 0.0040 (0.0035)  time: 0.1789  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:36 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1740 (0.1733)  evaluator_time: 0.0040 (0.0035)  time: 0.1781  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:17:38 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0035)  time: 0.1772  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:17:40 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1740 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1779  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:41 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1740 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1780  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:43 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1773  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:45 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1772  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:47 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1769  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:17:49 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1766  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:50 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1766  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:52 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:54 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1727 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1769  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:17:56 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1722 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1765  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:17:57 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1722 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1768  data: 0.0008  mem: 728  max mem: 19990
[2025-05-20 11:17:59 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:18:01 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:03 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1723 (0.1731)  evaluator_time: 0.0040 (0.0034)  time: 0.1773  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:04 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:18:06 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:08 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:18:10 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1730 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1782  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:18:12 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1730 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1785  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:18:13 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:15 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1732 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:18:17 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0005  mem: 728  max mem: 19990
[2025-05-20 11:18:19 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1726 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1769  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:20 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1764  data: 0.0007  mem: 728  max mem: 19990
[2025-05-20 11:18:22 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1760  data: 0.0006  mem: 728  max mem: 19990
[2025-05-20 11:18:22 det.util.engine] INFO: Averaged stats: model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0035)
[2025-05-20 11:18:22 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.692
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.310
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.379
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.351
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.556

[2025-05-20 11:18:22 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 5305  | 0.588  | 0.336 |
| Crescent_gap  | 48   | 48  | 6240  | 1.000  | 0.943 |
| Inclusion     | 41   | 82  | 13082 | 0.780  | 0.332 |
| Oil_spot      | 58   | 125 | 13997 | 0.904  | 0.679 |
| Punching      | 74   | 74  | 2914  | 0.986  | 0.960 |
| Rolled_pit    | 10   | 25  | 2405  | 0.720  | 0.479 |
| Silk_spot     | 134  | 150 | 61378 | 0.920  | 0.634 |
| Waist_folding | 24   | 26  | 5738  | 0.962  | 0.761 |
| Water_spot    | 68   | 78  | 14291 | 0.962  | 0.823 |
| Welding_line  | 99   | 99  | 11554 | 1.000  | 0.971 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.882  | 0.692 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 11:18:22 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:18:23 det.util.engine] INFO: Epoch: [53]  [0/1834]  eta: 0:18:43  lr: 0.000010  data_time: 0.0007  iter_time: 0.6125  loss: 12.6350 (12.6350)  loss_class: 0.2233 (0.2233)  loss_bbox: 0.1390 (0.1390)  loss_giou: 0.1215 (0.1215)  loss_class_0: 0.2768 (0.2768)  loss_bbox_0: 0.0953 (0.0953)  loss_giou_0: 0.1396 (0.1396)  loss_class_1: 0.2254 (0.2254)  loss_bbox_1: 0.1061 (0.1061)  loss_giou_1: 0.1253 (0.1253)  loss_class_2: 0.2397 (0.2397)  loss_bbox_2: 0.1277 (0.1277)  loss_giou_2: 0.1333 (0.1333)  loss_class_3: 0.2315 (0.2315)  loss_bbox_3: 0.1482 (0.1482)  loss_giou_3: 0.1179 (0.1179)  loss_class_4: 0.2315 (0.2315)  loss_bbox_4: 0.1436 (0.1436)  loss_giou_4: 0.1205 (0.1205)  loss_class_enc: 1.0522 (1.0522)  loss_bbox_enc: 0.2221 (0.2221)  loss_giou_enc: 0.2094 (0.2094)  loss_class_dn: 0.2364 (0.2364)  loss_bbox_dn: 0.1787 (0.1787)  loss_giou_dn: 0.1333 (0.1333)  loss_class_dn_0: 0.4223 (0.4223)  loss_bbox_dn_0: 0.4822 (0.4822)  loss_giou_dn_0: 0.2992 (0.2992)  loss_class_dn_1: 0.2978 (0.2978)  loss_bbox_dn_1: 0.2389 (0.2389)  loss_giou_dn_1: 0.1820 (0.1820)  loss_class_dn_2: 0.2648 (0.2648)  loss_bbox_dn_2: 0.1885 (0.1885)  loss_giou_dn_2: 0.1493 (0.1493)  loss_class_dn_3: 0.2581 (0.2581)  loss_bbox_dn_3: 0.1927 (0.1927)  loss_giou_dn_3: 0.1370 (0.1370)  loss_class_dn_4: 0.2432 (0.2432)  loss_bbox_dn_4: 0.1788 (0.1788)  loss_giou_dn_4: 0.1344 (0.1344)  loss_class_hybrid: 0.2139 (0.2139)  loss_bbox_hybrid: 0.1222 (0.1222)  loss_giou_hybrid: 0.1072 (0.1072)  loss_class_0_hybrid: 0.2658 (0.2658)  loss_bbox_0_hybrid: 0.1300 (0.1300)  loss_giou_0_hybrid: 0.1320 (0.1320)  loss_class_1_hybrid: 0.2161 (0.2161)  loss_bbox_1_hybrid: 0.0880 (0.0880)  loss_giou_1_hybrid: 0.1081 (0.1081)  loss_class_2_hybrid: 0.2383 (0.2383)  loss_bbox_2_hybrid: 0.1104 (0.1104)  loss_giou_2_hybrid: 0.1186 (0.1186)  loss_class_3_hybrid: 0.2325 (0.2325)  loss_bbox_3_hybrid: 0.1295 (0.1295)  loss_giou_3_hybrid: 0.1032 (0.1032)  loss_class_4_hybrid: 0.2283 (0.2283)  loss_bbox_4_hybrid: 0.1272 (0.1272)  loss_giou_4_hybrid: 0.1074 (0.1074)  loss_class_enc_hybrid: 0.7872 (0.7872)  loss_bbox_enc_hybrid: 0.2320 (0.2320)  loss_giou_enc_hybrid: 0.1895 (0.1895)  mem: 740  max mem: 19990
[2025-05-20 11:18:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:36:01 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5740  loss: 20.3069 (24.1693)  loss_class: 0.3827 (0.5405)  loss_bbox: 0.1578 (0.2744)  loss_giou: 0.2645 (0.3350)  loss_class_0: 0.5630 (0.6912)  loss_bbox_0: 0.1482 (0.2824)  loss_giou_0: 0.3109 (0.3504)  loss_class_1: 0.4366 (0.5826)  loss_bbox_1: 0.1493 (0.2732)  loss_giou_1: 0.2404 (0.3380)  loss_class_2: 0.3932 (0.5611)  loss_bbox_2: 0.1379 (0.2715)  loss_giou_2: 0.2358 (0.3355)  loss_class_3: 0.3790 (0.5467)  loss_bbox_3: 0.1594 (0.2720)  loss_giou_3: 0.2625 (0.3333)  loss_class_4: 0.3910 (0.5479)  loss_bbox_4: 0.1587 (0.2698)  loss_giou_4: 0.2612 (0.3331)  loss_class_enc: 1.0209 (0.9558)  loss_bbox_enc: 0.2241 (0.2841)  loss_giou_enc: 0.3455 (0.3755)  loss_class_dn: 0.3547 (0.3302)  loss_bbox_dn: 0.1248 (0.3497)  loss_giou_dn: 0.2744 (0.3600)  loss_class_dn_0: 0.4509 (0.3989)  loss_bbox_dn_0: 0.2184 (0.4574)  loss_giou_dn_0: 0.4226 (0.4725)  loss_class_dn_1: 0.3999 (0.3565)  loss_bbox_dn_1: 0.1365 (0.3774)  loss_giou_dn_1: 0.2984 (0.3817)  loss_class_dn_2: 0.3727 (0.3348)  loss_bbox_dn_2: 0.1292 (0.3613)  loss_giou_dn_2: 0.2568 (0.3668)  loss_class_dn_3: 0.3608 (0.3326)  loss_bbox_dn_3: 0.1232 (0.3519)  loss_giou_dn_3: 0.2660 (0.3610)  loss_class_dn_4: 0.3637 (0.3312)  loss_bbox_dn_4: 0.1234 (0.3506)  loss_giou_dn_4: 0.2629 (0.3603)  loss_class_hybrid: 0.4284 (0.6078)  loss_bbox_hybrid: 0.1129 (0.2604)  loss_giou_hybrid: 0.2660 (0.3270)  loss_class_0_hybrid: 0.5012 (0.6528)  loss_bbox_0_hybrid: 0.1166 (0.2799)  loss_giou_0_hybrid: 0.3079 (0.3519)  loss_class_1_hybrid: 0.4562 (0.6167)  loss_bbox_1_hybrid: 0.1408 (0.2654)  loss_giou_1_hybrid: 0.2950 (0.3352)  loss_class_2_hybrid: 0.4310 (0.6100)  loss_bbox_2_hybrid: 0.1645 (0.2607)  loss_giou_2_hybrid: 0.2879 (0.3300)  loss_class_3_hybrid: 0.4261 (0.6036)  loss_bbox_3_hybrid: 0.1193 (0.2629)  loss_giou_3_hybrid: 0.2752 (0.3295)  loss_class_4_hybrid: 0.4316 (0.6042)  loss_bbox_4_hybrid: 0.1439 (0.2617)  loss_giou_4_hybrid: 0.2702 (0.3282)  loss_class_enc_hybrid: 0.5957 (0.7500)  loss_bbox_enc_hybrid: 0.2573 (0.3249)  loss_giou_enc_hybrid: 0.4367 (0.4177)
[2025-05-20 11:36:01 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 11:36:01 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\pytorch_model.bin
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\optimizer.bin
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\scheduler.bin
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\sampler.bin
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\sampler_1.bin
[2025-05-20 11:36:01 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_53\random_states_0.pkl
[2025-05-20 11:36:01 det.__main__] INFO: Start evaluation
[2025-05-20 11:36:01 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1720 (0.1720)  evaluator_time: 0.0030 (0.0030)  time: 0.1990  data: 0.0240  mem: 727  max mem: 19990
[2025-05-20 11:36:03 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0032)  time: 0.1793  data: 0.0027  mem: 727  max mem: 19990
[2025-05-20 11:36:05 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0032)  time: 0.1771  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:07 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:18  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0079)  time: 0.1839  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:09 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:15  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0067)  time: 0.1838  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:36:11 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:13  model_time: 0.1730 (0.1730)  evaluator_time: 0.0030 (0.0062)  time: 0.1775  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:12 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:11  model_time: 0.1725 (0.1729)  evaluator_time: 0.0030 (0.0056)  time: 0.1771  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:36:14 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:09  model_time: 0.1720 (0.1729)  evaluator_time: 0.0030 (0.0053)  time: 0.1764  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:36:16 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1731 (0.1730)  evaluator_time: 0.0030 (0.0051)  time: 0.1774  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:18 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1733 (0.1730)  evaluator_time: 0.0030 (0.0048)  time: 0.1775  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:19 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1726 (0.1730)  evaluator_time: 0.0030 (0.0047)  time: 0.1771  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:21 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:02  model_time: 0.1714 (0.1728)  evaluator_time: 0.0030 (0.0046)  time: 0.1763  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:23 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1712 (0.1727)  evaluator_time: 0.0030 (0.0044)  time: 0.1756  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:25 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1715 (0.1726)  evaluator_time: 0.0030 (0.0044)  time: 0.1755  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:26 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1716 (0.1726)  evaluator_time: 0.0040 (0.0043)  time: 0.1761  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:28 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1720 (0.1725)  evaluator_time: 0.0040 (0.0043)  time: 0.1765  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:30 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1720 (0.1725)  evaluator_time: 0.0040 (0.0043)  time: 0.1767  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:36:32 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1715 (0.1724)  evaluator_time: 0.0030 (0.0042)  time: 0.1757  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:33 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1717 (0.1724)  evaluator_time: 0.0030 (0.0041)  time: 0.1754  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:35 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1715 (0.1723)  evaluator_time: 0.0030 (0.0041)  time: 0.1761  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:36:37 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1710 (0.1723)  evaluator_time: 0.0030 (0.0041)  time: 0.1758  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:39 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1715 (0.1722)  evaluator_time: 0.0030 (0.0040)  time: 0.1756  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:40 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1720 (0.1722)  evaluator_time: 0.0030 (0.0040)  time: 0.1759  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:42 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1712 (0.1722)  evaluator_time: 0.0030 (0.0040)  time: 0.1761  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:44 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1712 (0.1722)  evaluator_time: 0.0031 (0.0040)  time: 0.1758  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:46 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1718 (0.1721)  evaluator_time: 0.0030 (0.0039)  time: 0.1757  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:47 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1719 (0.1721)  evaluator_time: 0.0030 (0.0039)  time: 0.1759  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:49 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1719 (0.1721)  evaluator_time: 0.0030 (0.0039)  time: 0.1758  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:51 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1736 (0.1722)  evaluator_time: 0.0030 (0.0038)  time: 0.1774  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:53 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1750 (0.1723)  evaluator_time: 0.0030 (0.0038)  time: 0.1791  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:36:55 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1746 (0.1724)  evaluator_time: 0.0030 (0.0038)  time: 0.1786  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:56 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1740 (0.1725)  evaluator_time: 0.0030 (0.0038)  time: 0.1781  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:36:58 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1740 (0.1725)  evaluator_time: 0.0030 (0.0038)  time: 0.1784  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:37:00 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1749 (0.1726)  evaluator_time: 0.0030 (0.0037)  time: 0.1793  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:37:02 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1746 (0.1727)  evaluator_time: 0.0030 (0.0037)  time: 0.1791  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:37:04 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1740 (0.1727)  evaluator_time: 0.0030 (0.0037)  time: 0.1783  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:37:05 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1743 (0.1728)  evaluator_time: 0.0030 (0.0037)  time: 0.1785  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:37:07 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1750 (0.1728)  evaluator_time: 0.0030 (0.0037)  time: 0.1786  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:37:09 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1740 (0.1728)  evaluator_time: 0.0030 (0.0037)  time: 0.1782  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:37:11 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1736 (0.1729)  evaluator_time: 0.0040 (0.0037)  time: 0.1793  data: 0.0009  mem: 727  max mem: 19990
[2025-05-20 11:37:12 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1735 (0.1729)  evaluator_time: 0.0040 (0.0037)  time: 0.1794  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:37:14 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1730 (0.1729)  evaluator_time: 0.0030 (0.0037)  time: 0.1777  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:37:16 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0037)  time: 0.1781  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:37:18 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1741 (0.1730)  evaluator_time: 0.0030 (0.0037)  time: 0.1787  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:37:20 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1740 (0.1730)  evaluator_time: 0.0030 (0.0037)  time: 0.1781  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:37:21 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1726 (0.1730)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:37:23 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1730 (0.1730)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:37:23 det.util.engine] INFO: Averaged stats: model_time: 0.1730 (0.1730)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 11:37:23 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.33s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.698
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.434
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554

[2025-05-20 11:37:23 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4241  | 0.588  | 0.307 |
| Crescent_gap  | 48   | 48  | 7364  | 1.000  | 0.951 |
| Inclusion     | 41   | 82  | 9653  | 0.756  | 0.392 |
| Oil_spot      | 58   | 125 | 16833 | 0.928  | 0.711 |
| Punching      | 74   | 74  | 2473  | 1.000  | 0.991 |
| Rolled_pit    | 10   | 25  | 3884  | 0.880  | 0.401 |
| Silk_spot     | 134  | 150 | 60431 | 0.953  | 0.644 |
| Waist_folding | 24   | 26  | 8891  | 0.962  | 0.778 |
| Water_spot    | 68   | 78  | 14777 | 0.962  | 0.833 |
| Welding_line  | 99   | 99  | 8550  | 1.000  | 0.972 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.903  | 0.698 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 11:37:23 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:37:24 det.util.engine] INFO: Epoch: [54]  [0/1834]  eta: 0:19:12  lr: 0.000010  data_time: 0.0008  iter_time: 0.6285  loss: 15.8624 (15.8624)  loss_class: 0.3819 (0.3819)  loss_bbox: 0.0703 (0.0703)  loss_giou: 0.2497 (0.2497)  loss_class_0: 0.4215 (0.4215)  loss_bbox_0: 0.1332 (0.1332)  loss_giou_0: 0.3391 (0.3391)  loss_class_1: 0.3821 (0.3821)  loss_bbox_1: 0.0762 (0.0762)  loss_giou_1: 0.2939 (0.2939)  loss_class_2: 0.3748 (0.3748)  loss_bbox_2: 0.0729 (0.0729)  loss_giou_2: 0.2570 (0.2570)  loss_class_3: 0.3816 (0.3816)  loss_bbox_3: 0.0739 (0.0739)  loss_giou_3: 0.2587 (0.2587)  loss_class_4: 0.3681 (0.3681)  loss_bbox_4: 0.0736 (0.0736)  loss_giou_4: 0.2487 (0.2487)  loss_class_enc: 0.7586 (0.7586)  loss_bbox_enc: 0.0903 (0.0903)  loss_giou_enc: 0.1924 (0.1924)  loss_class_dn: 0.3516 (0.3516)  loss_bbox_dn: 0.0850 (0.0850)  loss_giou_dn: 0.2698 (0.2698)  loss_class_dn_0: 0.4321 (0.4321)  loss_bbox_dn_0: 0.1614 (0.1614)  loss_giou_dn_0: 0.4077 (0.4077)  loss_class_dn_1: 0.3705 (0.3705)  loss_bbox_dn_1: 0.0970 (0.0970)  loss_giou_dn_1: 0.2903 (0.2903)  loss_class_dn_2: 0.3386 (0.3386)  loss_bbox_dn_2: 0.0826 (0.0826)  loss_giou_dn_2: 0.2547 (0.2547)  loss_class_dn_3: 0.3568 (0.3568)  loss_bbox_dn_3: 0.0875 (0.0875)  loss_giou_dn_3: 0.2791 (0.2791)  loss_class_dn_4: 0.3570 (0.3570)  loss_bbox_dn_4: 0.0850 (0.0850)  loss_giou_dn_4: 0.2768 (0.2768)  loss_class_hybrid: 0.3932 (0.3932)  loss_bbox_hybrid: 0.0824 (0.0824)  loss_giou_hybrid: 0.2814 (0.2814)  loss_class_0_hybrid: 0.4401 (0.4401)  loss_bbox_0_hybrid: 0.1323 (0.1323)  loss_giou_0_hybrid: 0.3488 (0.3488)  loss_class_1_hybrid: 0.3830 (0.3830)  loss_bbox_1_hybrid: 0.0853 (0.0853)  loss_giou_1_hybrid: 0.2763 (0.2763)  loss_class_2_hybrid: 0.3774 (0.3774)  loss_bbox_2_hybrid: 0.0789 (0.0789)  loss_giou_2_hybrid: 0.2733 (0.2733)  loss_class_3_hybrid: 0.4100 (0.4100)  loss_bbox_3_hybrid: 0.0858 (0.0858)  loss_giou_3_hybrid: 0.2903 (0.2903)  loss_class_4_hybrid: 0.3928 (0.3928)  loss_bbox_4_hybrid: 0.0841 (0.0841)  loss_giou_4_hybrid: 0.2810 (0.2810)  loss_class_enc_hybrid: 0.6537 (0.6537)  loss_bbox_enc_hybrid: 0.1209 (0.1209)  loss_giou_enc_hybrid: 0.3095 (0.3095)  mem: 734  max mem: 19990
[2025-05-20 11:37:24 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:55:07 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.6201  loss: 27.6050 (24.6050)  loss_class: 0.4401 (0.5355)  loss_bbox: 0.1931 (0.2838)  loss_giou: 0.4035 (0.3504)  loss_class_0: 0.4936 (0.6853)  loss_bbox_0: 0.2210 (0.2920)  loss_giou_0: 0.4835 (0.3629)  loss_class_1: 0.4237 (0.5883)  loss_bbox_1: 0.2052 (0.2792)  loss_giou_1: 0.4102 (0.3504)  loss_class_2: 0.4441 (0.5608)  loss_bbox_2: 0.2007 (0.2792)  loss_giou_2: 0.3913 (0.3488)  loss_class_3: 0.4355 (0.5415)  loss_bbox_3: 0.1946 (0.2810)  loss_giou_3: 0.3871 (0.3490)  loss_class_4: 0.4321 (0.5398)  loss_bbox_4: 0.1980 (0.2813)  loss_giou_4: 0.3935 (0.3486)  loss_class_enc: 0.8877 (0.9738)  loss_bbox_enc: 0.2341 (0.2790)  loss_giou_enc: 0.3162 (0.3847)  loss_class_dn: 0.3722 (0.3349)  loss_bbox_dn: 0.1780 (0.3622)  loss_giou_dn: 0.3384 (0.3702)  loss_class_dn_0: 0.4623 (0.4053)  loss_bbox_dn_0: 0.2660 (0.4656)  loss_giou_dn_0: 0.5238 (0.4806)  loss_class_dn_1: 0.4026 (0.3602)  loss_bbox_dn_1: 0.1869 (0.3876)  loss_giou_dn_1: 0.3923 (0.3904)  loss_class_dn_2: 0.3746 (0.3389)  loss_bbox_dn_2: 0.1774 (0.3722)  loss_giou_dn_2: 0.3399 (0.3758)  loss_class_dn_3: 0.3736 (0.3369)  loss_bbox_dn_3: 0.1709 (0.3639)  loss_giou_dn_3: 0.3340 (0.3709)  loss_class_dn_4: 0.3693 (0.3358)  loss_bbox_dn_4: 0.1730 (0.3630)  loss_giou_dn_4: 0.3370 (0.3705)  loss_class_hybrid: 0.4899 (0.5988)  loss_bbox_hybrid: 0.1700 (0.2715)  loss_giou_hybrid: 0.3415 (0.3414)  loss_class_0_hybrid: 0.5499 (0.6538)  loss_bbox_0_hybrid: 0.1828 (0.2889)  loss_giou_0_hybrid: 0.3882 (0.3658)  loss_class_1_hybrid: 0.5200 (0.6198)  loss_bbox_1_hybrid: 0.1774 (0.2744)  loss_giou_1_hybrid: 0.3846 (0.3481)  loss_class_2_hybrid: 0.5062 (0.6034)  loss_bbox_2_hybrid: 0.1684 (0.2727)  loss_giou_2_hybrid: 0.3610 (0.3446)  loss_class_3_hybrid: 0.4910 (0.5949)  loss_bbox_3_hybrid: 0.1662 (0.2744)  loss_giou_3_hybrid: 0.3662 (0.3440)  loss_class_4_hybrid: 0.4921 (0.5969)  loss_bbox_4_hybrid: 0.1700 (0.2734)  loss_giou_4_hybrid: 0.3625 (0.3430)  loss_class_enc_hybrid: 0.8100 (0.7535)  loss_bbox_enc_hybrid: 0.2832 (0.3319)  loss_giou_enc_hybrid: 0.4745 (0.4295)
[2025-05-20 11:55:07 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 11:55:07 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\pytorch_model.bin
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\optimizer.bin
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\scheduler.bin
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\sampler.bin
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\sampler_1.bin
[2025-05-20 11:55:07 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_54\random_states_0.pkl
[2025-05-20 11:55:07 det.__main__] INFO: Start evaluation
[2025-05-20 11:55:07 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:31  model_time: 0.1736 (0.1736)  evaluator_time: 0.0040 (0.0040)  time: 0.1996  data: 0.0210  mem: 727  max mem: 19990
[2025-05-20 11:55:09 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1742 (0.1742)  evaluator_time: 0.0030 (0.0035)  time: 0.1804  data: 0.0025  mem: 727  max mem: 19990
[2025-05-20 11:55:11 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1750 (0.1743)  evaluator_time: 0.0030 (0.0033)  time: 0.1784  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:55:13 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1750 (0.1744)  evaluator_time: 0.0030 (0.0032)  time: 0.1783  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:14 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1743 (0.1743)  evaluator_time: 0.0030 (0.0031)  time: 0.1783  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:16 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:13  model_time: 0.1750 (0.1745)  evaluator_time: 0.0030 (0.0033)  time: 0.1789  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:18 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:11  model_time: 0.1750 (0.1745)  evaluator_time: 0.0030 (0.0032)  time: 0.1793  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:20 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:09  model_time: 0.1745 (0.1745)  evaluator_time: 0.0030 (0.0032)  time: 0.1786  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:22 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1730 (0.1742)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:23 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1720 (0.1741)  evaluator_time: 0.0030 (0.0033)  time: 0.1770  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:25 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1727 (0.1740)  evaluator_time: 0.0030 (0.0033)  time: 0.1775  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:27 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:02  model_time: 0.1727 (0.1739)  evaluator_time: 0.0030 (0.0033)  time: 0.1775  data: 0.0009  mem: 727  max mem: 19990
[2025-05-20 11:55:29 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1720 (0.1737)  evaluator_time: 0.0030 (0.0033)  time: 0.1767  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:30 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1727 (0.1738)  evaluator_time: 0.0030 (0.0033)  time: 0.1772  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:55:32 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1730 (0.1737)  evaluator_time: 0.0040 (0.0033)  time: 0.1783  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:34 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1730 (0.1737)  evaluator_time: 0.0040 (0.0034)  time: 0.1782  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:36 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1730 (0.1737)  evaluator_time: 0.0040 (0.0034)  time: 0.1781  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:38 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1736 (0.1737)  evaluator_time: 0.0030 (0.0034)  time: 0.1780  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:39 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1748 (0.1738)  evaluator_time: 0.0030 (0.0034)  time: 0.1788  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:41 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1736 (0.1737)  evaluator_time: 0.0030 (0.0034)  time: 0.1786  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:43 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1730 (0.1737)  evaluator_time: 0.0040 (0.0034)  time: 0.1775  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:45 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1732 (0.1737)  evaluator_time: 0.0030 (0.0034)  time: 0.1777  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:55:46 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1732 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1776  data: 0.0009  mem: 727  max mem: 19990
[2025-05-20 11:55:48 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1725 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:55:50 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1777  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:55:52 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:55:54 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1777  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:55:55 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1784  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:55:57 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:55:59 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1769  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:56:01 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1735 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:56:02 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1734 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:56:04 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1778  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:56:06 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1736 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1782  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:56:08 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1777  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:10 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1720 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:11 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:56:13 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:56:15 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:17 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1730 (0.1735)  evaluator_time: 0.0040 (0.0035)  time: 0.1787  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:56:18 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1730 (0.1735)  evaluator_time: 0.0040 (0.0035)  time: 0.1785  data: 0.0007  mem: 727  max mem: 19990
[2025-05-20 11:56:20 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:22 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1766  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:24 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1764  data: 0.0005  mem: 727  max mem: 19990
[2025-05-20 11:56:26 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1762  data: 0.0004  mem: 727  max mem: 19990
[2025-05-20 11:56:27 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1763  data: 0.0006  mem: 727  max mem: 19990
[2025-05-20 11:56:28 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1763  data: 0.0008  mem: 727  max mem: 19990
[2025-05-20 11:56:28 det.util.engine] INFO: Averaged stats: model_time: 0.1720 (0.1734)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 11:56:29 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.713
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.344
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.549

[2025-05-20 11:56:29 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4058  | 0.647  | 0.441 |
| Crescent_gap  | 48   | 48  | 7207  | 1.000  | 0.944 |
| Inclusion     | 41   | 82  | 11763 | 0.720  | 0.365 |
| Oil_spot      | 58   | 125 | 14756 | 0.928  | 0.693 |
| Punching      | 74   | 74  | 2993  | 0.986  | 0.954 |
| Rolled_pit    | 10   | 25  | 2908  | 0.840  | 0.468 |
| Silk_spot     | 134  | 150 | 60969 | 0.927  | 0.659 |
| Waist_folding | 24   | 26  | 7188  | 0.962  | 0.808 |
| Water_spot    | 68   | 78  | 14680 | 0.949  | 0.828 |
| Welding_line  | 99   | 99  | 10658 | 1.000  | 0.972 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.896  | 0.713 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 11:56:29 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 11:56:29 det.util.utils] INFO: the best ap model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap.pth
[2025-05-20 11:56:30 det.util.utils] INFO: the best ap50 model is saved to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\best_ap50.pth
[2025-05-20 11:56:30 det.util.engine] INFO: Epoch: [55]  [0/1834]  eta: 0:15:44  lr: 0.000010  data_time: 0.0077  iter_time: 0.5152  loss: 18.9454 (18.9454)  loss_class: 0.3153 (0.3153)  loss_bbox: 0.2180 (0.2180)  loss_giou: 0.2184 (0.2184)  loss_class_0: 0.5822 (0.5822)  loss_bbox_0: 0.4452 (0.4452)  loss_giou_0: 0.3645 (0.3645)  loss_class_1: 0.3338 (0.3338)  loss_bbox_1: 0.1676 (0.1676)  loss_giou_1: 0.2214 (0.2214)  loss_class_2: 0.3135 (0.3135)  loss_bbox_2: 0.1844 (0.1844)  loss_giou_2: 0.2077 (0.2077)  loss_class_3: 0.3154 (0.3154)  loss_bbox_3: 0.2175 (0.2175)  loss_giou_3: 0.2153 (0.2153)  loss_class_4: 0.3143 (0.3143)  loss_bbox_4: 0.2185 (0.2185)  loss_giou_4: 0.2147 (0.2147)  loss_class_enc: 0.5445 (0.5445)  loss_bbox_enc: 0.7352 (0.7352)  loss_giou_enc: 0.4724 (0.4724)  loss_class_dn: 0.3214 (0.3214)  loss_bbox_dn: 0.2148 (0.2148)  loss_giou_dn: 0.2299 (0.2299)  loss_class_dn_0: 0.4533 (0.4533)  loss_bbox_dn_0: 0.5790 (0.5790)  loss_giou_dn_0: 0.3940 (0.3940)  loss_class_dn_1: 0.3412 (0.3412)  loss_bbox_dn_1: 0.2623 (0.2623)  loss_giou_dn_1: 0.2451 (0.2451)  loss_class_dn_2: 0.3252 (0.3252)  loss_bbox_dn_2: 0.2242 (0.2242)  loss_giou_dn_2: 0.2330 (0.2330)  loss_class_dn_3: 0.3241 (0.3241)  loss_bbox_dn_3: 0.2319 (0.2319)  loss_giou_dn_3: 0.2314 (0.2314)  loss_class_dn_4: 0.3183 (0.3183)  loss_bbox_dn_4: 0.2185 (0.2185)  loss_giou_dn_4: 0.2283 (0.2283)  loss_class_hybrid: 0.3262 (0.3262)  loss_bbox_hybrid: 0.2009 (0.2009)  loss_giou_hybrid: 0.2171 (0.2171)  loss_class_0_hybrid: 0.4573 (0.4573)  loss_bbox_0_hybrid: 0.3258 (0.3258)  loss_giou_0_hybrid: 0.3429 (0.3429)  loss_class_1_hybrid: 0.3838 (0.3838)  loss_bbox_1_hybrid: 0.1425 (0.1425)  loss_giou_1_hybrid: 0.2114 (0.2114)  loss_class_2_hybrid: 0.3345 (0.3345)  loss_bbox_2_hybrid: 0.1694 (0.1694)  loss_giou_2_hybrid: 0.2080 (0.2080)  loss_class_3_hybrid: 0.3334 (0.3334)  loss_bbox_3_hybrid: 0.2025 (0.2025)  loss_giou_3_hybrid: 0.2135 (0.2135)  loss_class_4_hybrid: 0.3294 (0.3294)  loss_bbox_4_hybrid: 0.2000 (0.2000)  loss_giou_4_hybrid: 0.2118 (0.2118)  loss_class_enc_hybrid: 0.6076 (0.6076)  loss_bbox_enc_hybrid: 0.8246 (0.8246)  loss_giou_enc_hybrid: 0.5071 (0.5071)  mem: 734  max mem: 19990
[2025-05-20 11:56:30 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:14:09 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5555  loss: 12.8205 (24.5352)  loss_class: 0.2999 (0.5610)  loss_bbox: 0.0398 (0.2732)  loss_giou: 0.1189 (0.3381)  loss_class_0: 0.3973 (0.6797)  loss_bbox_0: 0.0572 (0.2934)  loss_giou_0: 0.1941 (0.3609)  loss_class_1: 0.3135 (0.5920)  loss_bbox_1: 0.0500 (0.2800)  loss_giou_1: 0.1759 (0.3467)  loss_class_2: 0.2857 (0.5787)  loss_bbox_2: 0.0402 (0.2717)  loss_giou_2: 0.1476 (0.3397)  loss_class_3: 0.3036 (0.5586)  loss_bbox_3: 0.0446 (0.2753)  loss_giou_3: 0.1302 (0.3406)  loss_class_4: 0.3005 (0.5624)  loss_bbox_4: 0.0417 (0.2731)  loss_giou_4: 0.1314 (0.3382)  loss_class_enc: 0.7226 (0.9371)  loss_bbox_enc: 0.1920 (0.2864)  loss_giou_enc: 0.2447 (0.3836)  loss_class_dn: 0.2870 (0.3313)  loss_bbox_dn: 0.0375 (0.3614)  loss_giou_dn: 0.1885 (0.3637)  loss_class_dn_0: 0.4093 (0.3997)  loss_bbox_dn_0: 0.1413 (0.4679)  loss_giou_dn_0: 0.3364 (0.4746)  loss_class_dn_1: 0.3283 (0.3559)  loss_bbox_dn_1: 0.0641 (0.3881)  loss_giou_dn_1: 0.1936 (0.3854)  loss_class_dn_2: 0.2819 (0.3357)  loss_bbox_dn_2: 0.0447 (0.3727)  loss_giou_dn_2: 0.1753 (0.3703)  loss_class_dn_3: 0.2943 (0.3336)  loss_bbox_dn_3: 0.0423 (0.3635)  loss_giou_dn_3: 0.1962 (0.3651)  loss_class_dn_4: 0.2846 (0.3327)  loss_bbox_dn_4: 0.0385 (0.3623)  loss_giou_dn_4: 0.1817 (0.3643)  loss_class_hybrid: 0.3223 (0.6079)  loss_bbox_hybrid: 0.0390 (0.2726)  loss_giou_hybrid: 0.1939 (0.3370)  loss_class_0_hybrid: 0.4436 (0.6430)  loss_bbox_0_hybrid: 0.0620 (0.3004)  loss_giou_0_hybrid: 0.1955 (0.3668)  loss_class_1_hybrid: 0.3245 (0.6192)  loss_bbox_1_hybrid: 0.0406 (0.2783)  loss_giou_1_hybrid: 0.1750 (0.3460)  loss_class_2_hybrid: 0.3170 (0.6061)  loss_bbox_2_hybrid: 0.0386 (0.2760)  loss_giou_2_hybrid: 0.1738 (0.3412)  loss_class_3_hybrid: 0.3175 (0.6014)  loss_bbox_3_hybrid: 0.0426 (0.2759)  loss_giou_3_hybrid: 0.1893 (0.3393)  loss_class_4_hybrid: 0.3272 (0.6039)  loss_bbox_4_hybrid: 0.0376 (0.2742)  loss_giou_4_hybrid: 0.1903 (0.3382)  loss_class_enc_hybrid: 0.6531 (0.7424)  loss_bbox_enc_hybrid: 0.1165 (0.3380)  loss_giou_enc_hybrid: 0.3154 (0.4288)
[2025-05-20 12:14:09 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 12:14:09 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\pytorch_model.bin
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\optimizer.bin
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\scheduler.bin
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\sampler.bin
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\sampler_1.bin
[2025-05-20 12:14:09 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_55\random_states_0.pkl
[2025-05-20 12:14:09 det.__main__] INFO: Start evaluation
[2025-05-20 12:14:10 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1720 (0.1720)  evaluator_time: 0.0040 (0.0040)  time: 0.1970  data: 0.0210  mem: 726  max mem: 19990
[2025-05-20 12:14:11 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1720 (0.1724)  evaluator_time: 0.0030 (0.0035)  time: 0.1786  data: 0.0024  mem: 726  max mem: 19990
[2025-05-20 12:14:13 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:17  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0033)  time: 0.1768  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:15 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:15  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0032)  time: 0.1766  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:14:17 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0031)  time: 0.1764  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:19 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0032)  time: 0.1777  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:20 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1721 (0.1728)  evaluator_time: 0.0030 (0.0032)  time: 0.1770  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:22 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1713 (0.1727)  evaluator_time: 0.0030 (0.0031)  time: 0.1755  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:14:24 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:06  model_time: 0.1716 (0.1726)  evaluator_time: 0.0030 (0.0032)  time: 0.1759  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:14:26 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1710 (0.1725)  evaluator_time: 0.0030 (0.0032)  time: 0.1756  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:27 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1710 (0.1723)  evaluator_time: 0.0030 (0.0032)  time: 0.1754  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:14:29 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1710 (0.1723)  evaluator_time: 0.0030 (0.0032)  time: 0.1756  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:14:31 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:59  model_time: 0.1716 (0.1722)  evaluator_time: 0.0030 (0.0032)  time: 0.1755  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 12:14:33 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1716 (0.1722)  evaluator_time: 0.0030 (0.0032)  time: 0.1757  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:34 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1715 (0.1721)  evaluator_time: 0.0030 (0.0032)  time: 0.1759  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:14:36 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1715 (0.1721)  evaluator_time: 0.0030 (0.0033)  time: 0.1759  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:38 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1715 (0.1721)  evaluator_time: 0.0030 (0.0033)  time: 0.1762  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:14:40 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1715 (0.1720)  evaluator_time: 0.0030 (0.0033)  time: 0.1758  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:41 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:48  model_time: 0.1719 (0.1720)  evaluator_time: 0.0030 (0.0033)  time: 0.1757  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:43 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1720 (0.1720)  evaluator_time: 0.0040 (0.0033)  time: 0.1763  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:45 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1720 (0.1720)  evaluator_time: 0.0040 (0.0034)  time: 0.1762  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 12:14:47 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1720 (0.1720)  evaluator_time: 0.0030 (0.0034)  time: 0.1761  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 12:14:48 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:41  model_time: 0.1720 (0.1721)  evaluator_time: 0.0030 (0.0034)  time: 0.1763  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:50 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1725 (0.1721)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:52 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1742 (0.1723)  evaluator_time: 0.0030 (0.0033)  time: 0.1787  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:14:54 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1750 (0.1724)  evaluator_time: 0.0030 (0.0033)  time: 0.1793  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:56 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:34  model_time: 0.1750 (0.1725)  evaluator_time: 0.0030 (0.0033)  time: 0.1798  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:14:57 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1752 (0.1726)  evaluator_time: 0.0030 (0.0033)  time: 0.1799  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:14:59 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1750 (0.1727)  evaluator_time: 0.0030 (0.0033)  time: 0.1796  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:15:01 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1760 (0.1729)  evaluator_time: 0.0030 (0.0033)  time: 0.1797  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:03 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1757 (0.1729)  evaluator_time: 0.0030 (0.0033)  time: 0.1795  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 12:15:05 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1757 (0.1730)  evaluator_time: 0.0030 (0.0033)  time: 0.1795  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:15:06 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1754 (0.1731)  evaluator_time: 0.0030 (0.0033)  time: 0.1798  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:15:08 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1746 (0.1732)  evaluator_time: 0.0030 (0.0033)  time: 0.1795  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:10 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1740 (0.1732)  evaluator_time: 0.0030 (0.0033)  time: 0.1789  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:12 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1740 (0.1732)  evaluator_time: 0.0030 (0.0033)  time: 0.1788  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 12:15:14 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1747 (0.1733)  evaluator_time: 0.0030 (0.0033)  time: 0.1794  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:15 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1750 (0.1734)  evaluator_time: 0.0030 (0.0033)  time: 0.1795  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:17 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1750 (0.1734)  evaluator_time: 0.0030 (0.0033)  time: 0.1791  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:15:19 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1750 (0.1735)  evaluator_time: 0.0040 (0.0034)  time: 0.1808  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 12:15:21 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1756 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1809  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 12:15:23 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1740 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1782  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:24 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0009  mem: 726  max mem: 19990
[2025-05-20 12:15:26 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1730 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1777  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 12:15:28 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1735 (0.1735)  evaluator_time: 0.0030 (0.0034)  time: 0.1780  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:30 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1787  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 12:15:31 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0034)  time: 0.1789  data: 0.0006  mem: 725  max mem: 19990
[2025-05-20 12:15:31 det.util.engine] INFO: Averaged stats: model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 12:15:32 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.30s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.706
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.323
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.186
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.564

[2025-05-20 12:15:32 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4133  | 0.647  | 0.372 |
| Crescent_gap  | 48   | 48  | 6461  | 1.000  | 0.936 |
| Inclusion     | 41   | 82  | 10239 | 0.732  | 0.392 |
| Oil_spot      | 58   | 125 | 15112 | 0.928  | 0.697 |
| Punching      | 74   | 74  | 2699  | 0.986  | 0.959 |
| Rolled_pit    | 10   | 25  | 2524  | 0.800  | 0.481 |
| Silk_spot     | 134  | 150 | 63179 | 0.920  | 0.657 |
| Waist_folding | 24   | 26  | 5704  | 0.962  | 0.801 |
| Water_spot    | 68   | 78  | 16435 | 0.962  | 0.806 |
| Welding_line  | 99   | 99  | 10727 | 1.000  | 0.961 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.894  | 0.706 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 12:15:32 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:15:32 det.util.engine] INFO: Epoch: [56]  [0/1834]  eta: 0:18:17  lr: 0.000010  data_time: 0.0010  iter_time: 0.5985  loss: 24.7683 (24.7683)  loss_class: 0.4449 (0.4449)  loss_bbox: 0.3558 (0.3558)  loss_giou: 0.4024 (0.4024)  loss_class_0: 0.5109 (0.5109)  loss_bbox_0: 0.3203 (0.3203)  loss_giou_0: 0.4536 (0.4536)  loss_class_1: 0.4510 (0.4510)  loss_bbox_1: 0.3841 (0.3841)  loss_giou_1: 0.4304 (0.4304)  loss_class_2: 0.4294 (0.4294)  loss_bbox_2: 0.3542 (0.3542)  loss_giou_2: 0.3880 (0.3880)  loss_class_3: 0.4468 (0.4468)  loss_bbox_3: 0.3501 (0.3501)  loss_giou_3: 0.4016 (0.4016)  loss_class_4: 0.4246 (0.4246)  loss_bbox_4: 0.3596 (0.3596)  loss_giou_4: 0.3998 (0.3998)  loss_class_enc: 1.1722 (1.1722)  loss_bbox_enc: 0.2872 (0.2872)  loss_giou_enc: 0.3493 (0.3493)  loss_class_dn: 0.4221 (0.4221)  loss_bbox_dn: 0.3004 (0.3004)  loss_giou_dn: 0.3834 (0.3834)  loss_class_dn_0: 0.5389 (0.5389)  loss_bbox_dn_0: 0.5073 (0.5073)  loss_giou_dn_0: 0.4915 (0.4915)  loss_class_dn_1: 0.4723 (0.4723)  loss_bbox_dn_1: 0.3695 (0.3695)  loss_giou_dn_1: 0.4296 (0.4296)  loss_class_dn_2: 0.4267 (0.4267)  loss_bbox_dn_2: 0.2914 (0.2914)  loss_giou_dn_2: 0.3692 (0.3692)  loss_class_dn_3: 0.4276 (0.4276)  loss_bbox_dn_3: 0.2966 (0.2966)  loss_giou_dn_3: 0.3810 (0.3810)  loss_class_dn_4: 0.4131 (0.4131)  loss_bbox_dn_4: 0.3069 (0.3069)  loss_giou_dn_4: 0.3824 (0.3824)  loss_class_hybrid: 0.4523 (0.4523)  loss_bbox_hybrid: 0.2981 (0.2981)  loss_giou_hybrid: 0.3945 (0.3945)  loss_class_0_hybrid: 0.4657 (0.4657)  loss_bbox_0_hybrid: 0.2966 (0.2966)  loss_giou_0_hybrid: 0.4561 (0.4561)  loss_class_1_hybrid: 0.4391 (0.4391)  loss_bbox_1_hybrid: 0.3011 (0.3011)  loss_giou_1_hybrid: 0.4257 (0.4257)  loss_class_2_hybrid: 0.4455 (0.4455)  loss_bbox_2_hybrid: 0.2876 (0.2876)  loss_giou_2_hybrid: 0.3876 (0.3876)  loss_class_3_hybrid: 0.4303 (0.4303)  loss_bbox_3_hybrid: 0.2938 (0.2938)  loss_giou_3_hybrid: 0.3970 (0.3970)  loss_class_4_hybrid: 0.4263 (0.4263)  loss_bbox_4_hybrid: 0.3043 (0.3043)  loss_giou_4_hybrid: 0.3965 (0.3965)  loss_class_enc_hybrid: 0.8138 (0.8138)  loss_bbox_enc_hybrid: 0.2918 (0.2918)  loss_giou_enc_hybrid: 0.4389 (0.4389)  mem: 736  max mem: 19990
[2025-05-20 12:15:32 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:33:19 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.6039  loss: 25.3045 (25.0637)  loss_class: 0.4030 (0.5696)  loss_bbox: 0.2089 (0.2734)  loss_giou: 0.3475 (0.3458)  loss_class_0: 0.6304 (0.7068)  loss_bbox_0: 0.1778 (0.2931)  loss_giou_0: 0.3892 (0.3678)  loss_class_1: 0.4268 (0.6170)  loss_bbox_1: 0.2026 (0.2784)  loss_giou_1: 0.3614 (0.3527)  loss_class_2: 0.4332 (0.5876)  loss_bbox_2: 0.2025 (0.2736)  loss_giou_2: 0.3546 (0.3479)  loss_class_3: 0.4206 (0.5761)  loss_bbox_3: 0.2045 (0.2752)  loss_giou_3: 0.3329 (0.3463)  loss_class_4: 0.4237 (0.5707)  loss_bbox_4: 0.2066 (0.2739)  loss_giou_4: 0.3473 (0.3459)  loss_class_enc: 0.9573 (0.9637)  loss_bbox_enc: 0.3166 (0.2930)  loss_giou_enc: 0.3359 (0.3926)  loss_class_dn: 0.3687 (0.3393)  loss_bbox_dn: 0.2155 (0.3704)  loss_giou_dn: 0.3140 (0.3770)  loss_class_dn_0: 0.4474 (0.4099)  loss_bbox_dn_0: 0.3772 (0.4748)  loss_giou_dn_0: 0.4447 (0.4878)  loss_class_dn_1: 0.4020 (0.3653)  loss_bbox_dn_1: 0.2210 (0.3970)  loss_giou_dn_1: 0.3594 (0.3977)  loss_class_dn_2: 0.3989 (0.3442)  loss_bbox_dn_2: 0.2217 (0.3809)  loss_giou_dn_2: 0.2943 (0.3829)  loss_class_dn_3: 0.3662 (0.3415)  loss_bbox_dn_3: 0.2134 (0.3729)  loss_giou_dn_3: 0.2923 (0.3780)  loss_class_dn_4: 0.3776 (0.3406)  loss_bbox_dn_4: 0.2152 (0.3715)  loss_giou_dn_4: 0.3100 (0.3773)  loss_class_hybrid: 0.4689 (0.6254)  loss_bbox_hybrid: 0.2132 (0.2681)  loss_giou_hybrid: 0.3181 (0.3444)  loss_class_0_hybrid: 0.5348 (0.6717)  loss_bbox_0_hybrid: 0.1941 (0.2944)  loss_giou_0_hybrid: 0.3091 (0.3740)  loss_class_1_hybrid: 0.5583 (0.6468)  loss_bbox_1_hybrid: 0.2043 (0.2718)  loss_giou_1_hybrid: 0.3635 (0.3509)  loss_class_2_hybrid: 0.5802 (0.6318)  loss_bbox_2_hybrid: 0.2061 (0.2689)  loss_giou_2_hybrid: 0.3252 (0.3467)  loss_class_3_hybrid: 0.4568 (0.6244)  loss_bbox_3_hybrid: 0.2017 (0.2703)  loss_giou_3_hybrid: 0.3165 (0.3456)  loss_class_4_hybrid: 0.4937 (0.6219)  loss_bbox_4_hybrid: 0.2067 (0.2693)  loss_giou_4_hybrid: 0.3140 (0.3452)  loss_class_enc_hybrid: 0.6711 (0.7562)  loss_bbox_enc_hybrid: 0.3592 (0.3383)  loss_giou_enc_hybrid: 0.4279 (0.4374)
[2025-05-20 12:33:19 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 12:33:20 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\pytorch_model.bin
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\optimizer.bin
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\scheduler.bin
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\sampler.bin
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\sampler_1.bin
[2025-05-20 12:33:20 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_56\random_states_0.pkl
[2025-05-20 12:33:20 det.__main__] INFO: Start evaluation
[2025-05-20 12:33:20 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:29  model_time: 0.1717 (0.1717)  evaluator_time: 0.0030 (0.0030)  time: 0.1957  data: 0.0210  mem: 734  max mem: 19990
[2025-05-20 12:33:22 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1720 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1787  data: 0.0025  mem: 734  max mem: 19990
[2025-05-20 12:33:24 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:17  model_time: 0.1721 (0.1729)  evaluator_time: 0.0030 (0.0032)  time: 0.1769  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:26 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0031)  time: 0.1771  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:27 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1738 (0.1730)  evaluator_time: 0.0030 (0.0031)  time: 0.1770  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:33:29 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1738 (0.1733)  evaluator_time: 0.0030 (0.0033)  time: 0.1778  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:31 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1740 (0.1734)  evaluator_time: 0.0030 (0.0032)  time: 0.1785  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:33 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1730 (0.1734)  evaluator_time: 0.0030 (0.0033)  time: 0.1779  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:35 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1723 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1778  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:36 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1735 (0.1734)  evaluator_time: 0.0030 (0.0034)  time: 0.1776  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:38 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1726 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1772  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:40 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1720 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:42 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:43 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:45 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:47 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1733 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1781  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:33:49 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1740 (0.1733)  evaluator_time: 0.0040 (0.0035)  time: 0.1787  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:51 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0035)  time: 0.1775  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:52 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0035)  time: 0.1767  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:33:54 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:33:56 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1723 (0.1732)  evaluator_time: 0.0040 (0.0035)  time: 0.1772  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:33:58 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1730 (0.1732)  evaluator_time: 0.0040 (0.0035)  time: 0.1772  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:33:59 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1725 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1769  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:01 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1726 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1770  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:03 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1731 (0.1732)  evaluator_time: 0.0030 (0.0035)  time: 0.1775  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:34:05 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1731 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1776  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:34:06 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1727 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:08 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1726 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:10 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1722 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1762  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:12 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1726 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:14 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1731 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1777  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:15 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1768  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:17 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1770  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:19 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:21 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:34:22 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1727 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1772  data: 0.0008  mem: 734  max mem: 19990
[2025-05-20 12:34:24 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1723 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1771  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:26 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1724 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1771  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:28 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:30 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1730 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1789  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:31 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1732 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1788  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:33 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1736 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1774  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:34:35 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1726 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1768  data: 0.0008  mem: 734  max mem: 19990
[2025-05-20 12:34:37 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1723 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1769  data: 0.0008  mem: 734  max mem: 19990
[2025-05-20 12:34:38 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1730 (0.1731)  evaluator_time: 0.0040 (0.0035)  time: 0.1774  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:34:40 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1777  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:34:41 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)  time: 0.1773  data: 0.0004  mem: 734  max mem: 19990
[2025-05-20 12:34:41 det.util.engine] INFO: Averaged stats: model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0035)
[2025-05-20 12:34:42 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.32s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.698
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.538

[2025-05-20 12:34:42 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4847  | 0.588  | 0.306 |
| Crescent_gap  | 48   | 48  | 5419  | 1.000  | 0.942 |
| Inclusion     | 41   | 82  | 12913 | 0.768  | 0.362 |
| Oil_spot      | 58   | 125 | 16550 | 0.920  | 0.708 |
| Punching      | 74   | 74  | 2905  | 1.000  | 0.989 |
| Rolled_pit    | 10   | 25  | 3017  | 0.760  | 0.442 |
| Silk_spot     | 134  | 150 | 61172 | 0.913  | 0.637 |
| Waist_folding | 24   | 26  | 4893  | 0.962  | 0.793 |
| Water_spot    | 68   | 78  | 12744 | 0.974  | 0.834 |
| Welding_line  | 99   | 99  | 12461 | 1.000  | 0.970 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.889  | 0.698 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 12:34:42 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:34:43 det.util.engine] INFO: Epoch: [57]  [0/1834]  eta: 0:19:12  lr: 0.000010  data_time: 0.0045  iter_time: 0.6286  loss: 20.7309 (20.7309)  loss_class: 0.4517 (0.4517)  loss_bbox: 0.1141 (0.1141)  loss_giou: 0.2693 (0.2693)  loss_class_0: 0.6242 (0.6242)  loss_bbox_0: 0.1122 (0.1122)  loss_giou_0: 0.2168 (0.2168)  loss_class_1: 0.4497 (0.4497)  loss_bbox_1: 0.0688 (0.0688)  loss_giou_1: 0.1800 (0.1800)  loss_class_2: 0.4421 (0.4421)  loss_bbox_2: 0.1074 (0.1074)  loss_giou_2: 0.2805 (0.2805)  loss_class_3: 0.4708 (0.4708)  loss_bbox_3: 0.1139 (0.1139)  loss_giou_3: 0.2850 (0.2850)  loss_class_4: 0.4564 (0.4564)  loss_bbox_4: 0.1016 (0.1016)  loss_giou_4: 0.2679 (0.2679)  loss_class_enc: 1.5849 (1.5849)  loss_bbox_enc: 0.0692 (0.0692)  loss_giou_enc: 0.4802 (0.4802)  loss_class_dn: 0.3760 (0.3760)  loss_bbox_dn: 0.1363 (0.1363)  loss_giou_dn: 0.2697 (0.2697)  loss_class_dn_0: 0.4633 (0.4633)  loss_bbox_dn_0: 0.5161 (0.5161)  loss_giou_dn_0: 0.6121 (0.6121)  loss_class_dn_1: 0.4110 (0.4110)  loss_bbox_dn_1: 0.2365 (0.2365)  loss_giou_dn_1: 0.3254 (0.3254)  loss_class_dn_2: 0.3886 (0.3886)  loss_bbox_dn_2: 0.1582 (0.1582)  loss_giou_dn_2: 0.3039 (0.3039)  loss_class_dn_3: 0.3837 (0.3837)  loss_bbox_dn_3: 0.1398 (0.1398)  loss_giou_dn_3: 0.2762 (0.2762)  loss_class_dn_4: 0.3677 (0.3677)  loss_bbox_dn_4: 0.1290 (0.1290)  loss_giou_dn_4: 0.2632 (0.2632)  loss_class_hybrid: 0.5201 (0.5201)  loss_bbox_hybrid: 0.1319 (0.1319)  loss_giou_hybrid: 0.2781 (0.2781)  loss_class_0_hybrid: 0.6190 (0.6190)  loss_bbox_0_hybrid: 0.2080 (0.2080)  loss_giou_0_hybrid: 0.2663 (0.2663)  loss_class_1_hybrid: 0.6137 (0.6137)  loss_bbox_1_hybrid: 0.1323 (0.1323)  loss_giou_1_hybrid: 0.2253 (0.2253)  loss_class_2_hybrid: 0.6226 (0.6226)  loss_bbox_2_hybrid: 0.1288 (0.1288)  loss_giou_2_hybrid: 0.2767 (0.2767)  loss_class_3_hybrid: 0.5298 (0.5298)  loss_bbox_3_hybrid: 0.1257 (0.1257)  loss_giou_3_hybrid: 0.2821 (0.2821)  loss_class_4_hybrid: 0.4955 (0.4955)  loss_bbox_4_hybrid: 0.1242 (0.1242)  loss_giou_4_hybrid: 0.2767 (0.2767)  loss_class_enc_hybrid: 0.8468 (0.8468)  loss_bbox_enc_hybrid: 0.4705 (0.4705)  loss_giou_enc_hybrid: 0.6535 (0.6535)  mem: 747  max mem: 19990
[2025-05-20 12:34:43 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:52:29 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5613  loss: 23.3294 (23.9683)  loss_class: 0.4251 (0.5218)  loss_bbox: 0.1350 (0.2720)  loss_giou: 0.2651 (0.3358)  loss_class_0: 0.5976 (0.6600)  loss_bbox_0: 0.1187 (0.2883)  loss_giou_0: 0.3678 (0.3560)  loss_class_1: 0.6144 (0.5757)  loss_bbox_1: 0.1562 (0.2710)  loss_giou_1: 0.3023 (0.3396)  loss_class_2: 0.5208 (0.5500)  loss_bbox_2: 0.1546 (0.2678)  loss_giou_2: 0.3145 (0.3356)  loss_class_3: 0.4280 (0.5307)  loss_bbox_3: 0.1388 (0.2709)  loss_giou_3: 0.3044 (0.3356)  loss_class_4: 0.4288 (0.5225)  loss_bbox_4: 0.1382 (0.2719)  loss_giou_4: 0.2816 (0.3360)  loss_class_enc: 1.0274 (0.9432)  loss_bbox_enc: 0.1314 (0.2836)  loss_giou_enc: 0.3282 (0.3772)  loss_class_dn: 0.3990 (0.3276)  loss_bbox_dn: 0.1269 (0.3530)  loss_giou_dn: 0.3738 (0.3574)  loss_class_dn_0: 0.4516 (0.4003)  loss_bbox_dn_0: 0.2645 (0.4616)  loss_giou_dn_0: 0.5177 (0.4686)  loss_class_dn_1: 0.4263 (0.3540)  loss_bbox_dn_1: 0.2311 (0.3831)  loss_giou_dn_1: 0.3977 (0.3798)  loss_class_dn_2: 0.4115 (0.3331)  loss_bbox_dn_2: 0.2104 (0.3643)  loss_giou_dn_2: 0.3671 (0.3639)  loss_class_dn_3: 0.4156 (0.3299)  loss_bbox_dn_3: 0.1798 (0.3557)  loss_giou_dn_3: 0.3801 (0.3588)  loss_class_dn_4: 0.4121 (0.3286)  loss_bbox_dn_4: 0.1286 (0.3542)  loss_giou_dn_4: 0.3619 (0.3579)  loss_class_hybrid: 0.5245 (0.5849)  loss_bbox_hybrid: 0.1144 (0.2602)  loss_giou_hybrid: 0.3201 (0.3283)  loss_class_0_hybrid: 0.5973 (0.6413)  loss_bbox_0_hybrid: 0.1182 (0.2851)  loss_giou_0_hybrid: 0.3522 (0.3549)  loss_class_1_hybrid: 0.5898 (0.6058)  loss_bbox_1_hybrid: 0.1243 (0.2660)  loss_giou_1_hybrid: 0.3357 (0.3363)  loss_class_2_hybrid: 0.5809 (0.5950)  loss_bbox_2_hybrid: 0.1188 (0.2619)  loss_giou_2_hybrid: 0.3246 (0.3312)  loss_class_3_hybrid: 0.5424 (0.5864)  loss_bbox_3_hybrid: 0.1174 (0.2618)  loss_giou_3_hybrid: 0.3281 (0.3300)  loss_class_4_hybrid: 0.5383 (0.5828)  loss_bbox_4_hybrid: 0.1181 (0.2615)  loss_giou_4_hybrid: 0.3076 (0.3294)  loss_class_enc_hybrid: 0.7722 (0.7431)  loss_bbox_enc_hybrid: 0.1820 (0.3284)  loss_giou_enc_hybrid: 0.3634 (0.4171)
[2025-05-20 12:52:29 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 12:52:29 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\pytorch_model.bin
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\optimizer.bin
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\scheduler.bin
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\sampler.bin
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\sampler_1.bin
[2025-05-20 12:52:30 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_57\random_states_0.pkl
[2025-05-20 12:52:30 det.__main__] INFO: Start evaluation
[2025-05-20 12:52:30 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:30  model_time: 0.1735 (0.1735)  evaluator_time: 0.0040 (0.0040)  time: 0.1985  data: 0.0200  mem: 734  max mem: 19990
[2025-05-20 12:52:32 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:19  model_time: 0.1712 (0.1715)  evaluator_time: 0.0030 (0.0035)  time: 0.1776  data: 0.0024  mem: 734  max mem: 19990
[2025-05-20 12:52:34 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:17  model_time: 0.1712 (0.1717)  evaluator_time: 0.0030 (0.0034)  time: 0.1759  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:52:36 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:15  model_time: 0.1714 (0.1717)  evaluator_time: 0.0030 (0.0033)  time: 0.1758  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:37 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:13  model_time: 0.1715 (0.1717)  evaluator_time: 0.0030 (0.0032)  time: 0.1752  data: 0.0004  mem: 734  max mem: 19990
[2025-05-20 12:52:39 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:11  model_time: 0.1713 (0.1716)  evaluator_time: 0.0030 (0.0034)  time: 0.1757  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:52:41 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1710 (0.1716)  evaluator_time: 0.0030 (0.0033)  time: 0.1758  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:52:43 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1716 (0.1716)  evaluator_time: 0.0030 (0.0033)  time: 0.1755  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:44 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:06  model_time: 0.1720 (0.1717)  evaluator_time: 0.0030 (0.0033)  time: 0.1758  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:52:46 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:04  model_time: 0.1720 (0.1717)  evaluator_time: 0.0030 (0.0033)  time: 0.1760  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:48 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1716 (0.1717)  evaluator_time: 0.0030 (0.0033)  time: 0.1762  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:50 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1716 (0.1717)  evaluator_time: 0.0030 (0.0034)  time: 0.1764  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:51 det.util.utils] INFO: Test:  [120/458]  eta: 0:00:59  model_time: 0.1720 (0.1717)  evaluator_time: 0.0030 (0.0033)  time: 0.1762  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:53 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:57  model_time: 0.1720 (0.1718)  evaluator_time: 0.0030 (0.0034)  time: 0.1765  data: 0.0004  mem: 734  max mem: 19990
[2025-05-20 12:52:55 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1724 (0.1719)  evaluator_time: 0.0040 (0.0034)  time: 0.1774  data: 0.0004  mem: 734  max mem: 19990
[2025-05-20 12:52:57 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:54  model_time: 0.1730 (0.1720)  evaluator_time: 0.0040 (0.0034)  time: 0.1779  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:52:59 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:52  model_time: 0.1730 (0.1721)  evaluator_time: 0.0030 (0.0035)  time: 0.1779  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:00 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:50  model_time: 0.1724 (0.1721)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:02 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1724 (0.1721)  evaluator_time: 0.0030 (0.0034)  time: 0.1766  data: 0.0008  mem: 734  max mem: 19990
[2025-05-20 12:53:04 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1723 (0.1722)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:06 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:45  model_time: 0.1723 (0.1722)  evaluator_time: 0.0040 (0.0034)  time: 0.1773  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:07 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:43  model_time: 0.1727 (0.1723)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:09 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1730 (0.1723)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:11 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1736 (0.1724)  evaluator_time: 0.0030 (0.0034)  time: 0.1779  data: 0.0009  mem: 734  max mem: 19990
[2025-05-20 12:53:13 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1740 (0.1724)  evaluator_time: 0.0030 (0.0034)  time: 0.1778  data: 0.0009  mem: 734  max mem: 19990
[2025-05-20 12:53:15 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:36  model_time: 0.1740 (0.1725)  evaluator_time: 0.0030 (0.0034)  time: 0.1778  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:16 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1731 (0.1725)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0003  mem: 734  max mem: 19990
[2025-05-20 12:53:18 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1730 (0.1725)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:20 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1730 (0.1725)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:22 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1730 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1769  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:23 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:27  model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1769  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:25 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1768  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:27 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1730 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1772  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:29 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1736 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:30 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1726 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1773  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:32 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1730 (0.1726)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:34 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1730 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1770  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:36 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1736 (0.1727)  evaluator_time: 0.0030 (0.0033)  time: 0.1770  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:38 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1737 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:39 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1737 (0.1727)  evaluator_time: 0.0040 (0.0034)  time: 0.1788  data: 0.0004  mem: 734  max mem: 19990
[2025-05-20 12:53:41 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1722 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1780  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:43 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1722 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1765  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:45 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1730 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:46 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1733 (0.1727)  evaluator_time: 0.0030 (0.0034)  time: 0.1776  data: 0.0008  mem: 734  max mem: 19990
[2025-05-20 12:53:48 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0034)  time: 0.1776  data: 0.0007  mem: 734  max mem: 19990
[2025-05-20 12:53:50 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0034)  time: 0.1775  data: 0.0006  mem: 734  max mem: 19990
[2025-05-20 12:53:51 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0034)  time: 0.1774  data: 0.0005  mem: 734  max mem: 19990
[2025-05-20 12:53:51 det.util.engine] INFO: Averaged stats: model_time: 0.1730 (0.1728)  evaluator_time: 0.0030 (0.0034)
[2025-05-20 12:53:52 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.31s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.702
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.056
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.169
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.366
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552

[2025-05-20 12:53:52 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4293  | 0.647  | 0.443 |
| Crescent_gap  | 48   | 48  | 6326  | 1.000  | 0.941 |
| Inclusion     | 41   | 82  | 11208 | 0.695  | 0.343 |
| Oil_spot      | 58   | 125 | 14612 | 0.912  | 0.695 |
| Punching      | 74   | 74  | 3239  | 1.000  | 0.991 |
| Rolled_pit    | 10   | 25  | 3388  | 0.800  | 0.427 |
| Silk_spot     | 134  | 150 | 61727 | 0.920  | 0.663 |
| Waist_folding | 24   | 26  | 8401  | 0.923  | 0.759 |
| Water_spot    | 68   | 78  | 11982 | 0.949  | 0.782 |
| Welding_line  | 99   | 99  | 11898 | 1.000  | 0.979 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.885  | 0.702 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 12:53:52 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 12:53:53 det.util.engine] INFO: Epoch: [58]  [0/1834]  eta: 0:16:33  lr: 0.000010  data_time: 0.0079  iter_time: 0.5420  loss: 15.5989 (15.5989)  loss_class: 0.4421 (0.4421)  loss_bbox: 0.0541 (0.0541)  loss_giou: 0.1555 (0.1555)  loss_class_0: 0.4933 (0.4933)  loss_bbox_0: 0.0775 (0.0775)  loss_giou_0: 0.2137 (0.2137)  loss_class_1: 0.5167 (0.5167)  loss_bbox_1: 0.0616 (0.0616)  loss_giou_1: 0.1939 (0.1939)  loss_class_2: 0.3781 (0.3781)  loss_bbox_2: 0.0442 (0.0442)  loss_giou_2: 0.1169 (0.1169)  loss_class_3: 0.4014 (0.4014)  loss_bbox_3: 0.0580 (0.0580)  loss_giou_3: 0.1504 (0.1504)  loss_class_4: 0.4014 (0.4014)  loss_bbox_4: 0.0596 (0.0596)  loss_giou_4: 0.1571 (0.1571)  loss_class_enc: 1.2405 (1.2405)  loss_bbox_enc: 0.1677 (0.1677)  loss_giou_enc: 0.5754 (0.5754)  loss_class_dn: 0.3899 (0.3899)  loss_bbox_dn: 0.0523 (0.0523)  loss_giou_dn: 0.1633 (0.1633)  loss_class_dn_0: 0.5194 (0.5194)  loss_bbox_dn_0: 0.1339 (0.1339)  loss_giou_dn_0: 0.4339 (0.4339)  loss_class_dn_1: 0.4200 (0.4200)  loss_bbox_dn_1: 0.0750 (0.0750)  loss_giou_dn_1: 0.2361 (0.2361)  loss_class_dn_2: 0.3388 (0.3388)  loss_bbox_dn_2: 0.0580 (0.0580)  loss_giou_dn_2: 0.1813 (0.1813)  loss_class_dn_3: 0.3636 (0.3636)  loss_bbox_dn_3: 0.0556 (0.0556)  loss_giou_dn_3: 0.1705 (0.1705)  loss_class_dn_4: 0.3550 (0.3550)  loss_bbox_dn_4: 0.0553 (0.0553)  loss_giou_dn_4: 0.1680 (0.1680)  loss_class_hybrid: 0.4920 (0.4920)  loss_bbox_hybrid: 0.0307 (0.0307)  loss_giou_hybrid: 0.1017 (0.1017)  loss_class_0_hybrid: 0.5192 (0.5192)  loss_bbox_0_hybrid: 0.0923 (0.0923)  loss_giou_0_hybrid: 0.2871 (0.2871)  loss_class_1_hybrid: 0.5250 (0.5250)  loss_bbox_1_hybrid: 0.0416 (0.0416)  loss_giou_1_hybrid: 0.1483 (0.1483)  loss_class_2_hybrid: 0.4128 (0.4128)  loss_bbox_2_hybrid: 0.0256 (0.0256)  loss_giou_2_hybrid: 0.1002 (0.1002)  loss_class_3_hybrid: 0.4194 (0.4194)  loss_bbox_3_hybrid: 0.0296 (0.0296)  loss_giou_3_hybrid: 0.1012 (0.1012)  loss_class_4_hybrid: 0.4719 (0.4719)  loss_bbox_4_hybrid: 0.0302 (0.0302)  loss_giou_4_hybrid: 0.0984 (0.0984)  loss_class_enc_hybrid: 0.7477 (0.7477)  loss_bbox_enc_hybrid: 0.2154 (0.2154)  loss_giou_enc_hybrid: 0.5794 (0.5794)  mem: 733  max mem: 19990
[2025-05-20 12:53:53 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 13:11:38 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5724  loss: 20.3727 (24.5332)  loss_class: 0.4215 (0.5265)  loss_bbox: 0.1012 (0.2845)  loss_giou: 0.2122 (0.3522)  loss_class_0: 0.5229 (0.6647)  loss_bbox_0: 0.1372 (0.2913)  loss_giou_0: 0.2583 (0.3670)  loss_class_1: 0.4468 (0.5749)  loss_bbox_1: 0.1381 (0.2842)  loss_giou_1: 0.2353 (0.3560)  loss_class_2: 0.4417 (0.5439)  loss_bbox_2: 0.1384 (0.2819)  loss_giou_2: 0.2545 (0.3544)  loss_class_3: 0.4306 (0.5364)  loss_bbox_3: 0.0980 (0.2810)  loss_giou_3: 0.2124 (0.3514)  loss_class_4: 0.4306 (0.5304)  loss_bbox_4: 0.1058 (0.2823)  loss_giou_4: 0.2116 (0.3511)  loss_class_enc: 0.8188 (0.9338)  loss_bbox_enc: 0.2055 (0.2924)  loss_giou_enc: 0.3562 (0.3953)  loss_class_dn: 0.4034 (0.3369)  loss_bbox_dn: 0.1496 (0.3491)  loss_giou_dn: 0.3586 (0.3711)  loss_class_dn_0: 0.4399 (0.4069)  loss_bbox_dn_0: 0.2088 (0.4537)  loss_giou_dn_0: 0.4714 (0.4802)  loss_class_dn_1: 0.4153 (0.3611)  loss_bbox_dn_1: 0.1541 (0.3761)  loss_giou_dn_1: 0.3459 (0.3912)  loss_class_dn_2: 0.4053 (0.3413)  loss_bbox_dn_2: 0.1442 (0.3590)  loss_giou_dn_2: 0.3498 (0.3769)  loss_class_dn_3: 0.4027 (0.3390)  loss_bbox_dn_3: 0.1481 (0.3513)  loss_giou_dn_3: 0.3549 (0.3720)  loss_class_dn_4: 0.4033 (0.3379)  loss_bbox_dn_4: 0.1506 (0.3500)  loss_giou_dn_4: 0.3580 (0.3713)  loss_class_hybrid: 0.4999 (0.6051)  loss_bbox_hybrid: 0.1476 (0.2699)  loss_giou_hybrid: 0.2831 (0.3460)  loss_class_0_hybrid: 0.4797 (0.6577)  loss_bbox_0_hybrid: 0.1707 (0.2905)  loss_giou_0_hybrid: 0.2914 (0.3710)  loss_class_1_hybrid: 0.4873 (0.6191)  loss_bbox_1_hybrid: 0.1546 (0.2737)  loss_giou_1_hybrid: 0.2960 (0.3532)  loss_class_2_hybrid: 0.4815 (0.6048)  loss_bbox_2_hybrid: 0.1477 (0.2724)  loss_giou_2_hybrid: 0.2818 (0.3493)  loss_class_3_hybrid: 0.4846 (0.6017)  loss_bbox_3_hybrid: 0.1510 (0.2718)  loss_giou_3_hybrid: 0.2847 (0.3477)  loss_class_4_hybrid: 0.4905 (0.6037)  loss_bbox_4_hybrid: 0.1488 (0.2706)  loss_giou_4_hybrid: 0.2821 (0.3463)  loss_class_enc_hybrid: 0.6313 (0.7528)  loss_bbox_enc_hybrid: 0.1956 (0.3325)  loss_giou_enc_hybrid: 0.4017 (0.4329)
[2025-05-20 13:11:38 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 13:11:38 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\pytorch_model.bin
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\optimizer.bin
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\scheduler.bin
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\sampler.bin
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\sampler_1.bin
[2025-05-20 13:11:38 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_58\random_states_0.pkl
[2025-05-20 13:11:38 det.__main__] INFO: Start evaluation
[2025-05-20 13:11:38 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:33  model_time: 0.1747 (0.1747)  evaluator_time: 0.0020 (0.0020)  time: 0.2048  data: 0.0270  mem: 726  max mem: 19990
[2025-05-20 13:11:40 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1730 (0.1731)  evaluator_time: 0.0030 (0.0033)  time: 0.1797  data: 0.0032  mem: 726  max mem: 19990
[2025-05-20 13:11:42 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:18  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0032)  time: 0.1771  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:11:44 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:16  model_time: 0.1740 (0.1734)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:11:45 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1731 (0.1734)  evaluator_time: 0.0030 (0.0031)  time: 0.1774  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:11:47 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1730 (0.1734)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:11:49 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0032)  time: 0.1785  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:11:51 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:09  model_time: 0.1740 (0.1736)  evaluator_time: 0.0030 (0.0032)  time: 0.1780  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:11:52 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1736 (0.1736)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0003  mem: 726  max mem: 19990
[2025-05-20 13:11:54 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1735 (0.1735)  evaluator_time: 0.0035 (0.0033)  time: 0.1776  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 13:11:56 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:03  model_time: 0.1721 (0.1734)  evaluator_time: 0.0040 (0.0033)  time: 0.1771  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:11:58 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:01  model_time: 0.1726 (0.1734)  evaluator_time: 0.0040 (0.0034)  time: 0.1771  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:00 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1727 (0.1734)  evaluator_time: 0.0030 (0.0033)  time: 0.1770  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 13:12:01 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1730 (0.1733)  evaluator_time: 0.0030 (0.0034)  time: 0.1771  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:03 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1725 (0.1733)  evaluator_time: 0.0040 (0.0034)  time: 0.1773  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:05 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:55  model_time: 0.1730 (0.1732)  evaluator_time: 0.0040 (0.0044)  time: 0.1851  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:07 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1730 (0.1733)  evaluator_time: 0.0040 (0.0044)  time: 0.1857  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:09 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1730 (0.1733)  evaluator_time: 0.0040 (0.0044)  time: 0.1779  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:10 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1722 (0.1732)  evaluator_time: 0.0030 (0.0043)  time: 0.1767  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 13:12:12 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1726 (0.1732)  evaluator_time: 0.0038 (0.0043)  time: 0.1772  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:14 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:46  model_time: 0.1736 (0.1732)  evaluator_time: 0.0040 (0.0042)  time: 0.1781  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:16 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1736 (0.1733)  evaluator_time: 0.0040 (0.0042)  time: 0.1780  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:17 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1735 (0.1733)  evaluator_time: 0.0040 (0.0042)  time: 0.1783  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:19 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1730 (0.1733)  evaluator_time: 0.0040 (0.0042)  time: 0.1779  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:21 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1720 (0.1732)  evaluator_time: 0.0030 (0.0041)  time: 0.1766  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:23 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1718 (0.1732)  evaluator_time: 0.0030 (0.0041)  time: 0.1758  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:25 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1716 (0.1731)  evaluator_time: 0.0030 (0.0041)  time: 0.1759  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:26 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1720 (0.1731)  evaluator_time: 0.0030 (0.0040)  time: 0.1762  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:28 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1724 (0.1731)  evaluator_time: 0.0030 (0.0040)  time: 0.1761  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:30 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1720 (0.1730)  evaluator_time: 0.0030 (0.0040)  time: 0.1760  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 13:12:32 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1720 (0.1730)  evaluator_time: 0.0030 (0.0039)  time: 0.1760  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:33 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1720 (0.1730)  evaluator_time: 0.0030 (0.0039)  time: 0.1758  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:35 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1720 (0.1729)  evaluator_time: 0.0030 (0.0039)  time: 0.1759  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:37 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1720 (0.1729)  evaluator_time: 0.0030 (0.0039)  time: 0.1761  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:39 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:20  model_time: 0.1710 (0.1729)  evaluator_time: 0.0040 (0.0039)  time: 0.1761  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:40 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1716 (0.1728)  evaluator_time: 0.0030 (0.0039)  time: 0.1763  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:42 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0039)  time: 0.1766  data: 0.0008  mem: 726  max mem: 19990
[2025-05-20 13:12:44 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0038)  time: 0.1763  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:46 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1720 (0.1728)  evaluator_time: 0.0030 (0.0038)  time: 0.1761  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:47 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1720 (0.1728)  evaluator_time: 0.0040 (0.0039)  time: 0.1777  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:49 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1720 (0.1728)  evaluator_time: 0.0040 (0.0039)  time: 0.1776  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:51 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1726 (0.1728)  evaluator_time: 0.0030 (0.0038)  time: 0.1773  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:53 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1740 (0.1728)  evaluator_time: 0.0030 (0.0038)  time: 0.1781  data: 0.0004  mem: 726  max mem: 19990
[2025-05-20 13:12:55 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1735 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1779  data: 0.0005  mem: 726  max mem: 19990
[2025-05-20 13:12:56 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1785  data: 0.0007  mem: 726  max mem: 19990
[2025-05-20 13:12:58 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1791  data: 0.0006  mem: 726  max mem: 19990
[2025-05-20 13:12:59 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0038)  time: 0.1789  data: 0.0005  mem: 725  max mem: 19990
[2025-05-20 13:12:59 det.util.engine] INFO: Averaged stats: model_time: 0.1740 (0.1729)  evaluator_time: 0.0030 (0.0038)
[2025-05-20 13:13:00 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.32s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.700
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.182
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.425
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.560

[2025-05-20 13:13:00 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4381  | 0.647  | 0.393 |
| Crescent_gap  | 48   | 48  | 4146  | 1.000  | 0.941 |
| Inclusion     | 41   | 82  | 13586 | 0.707  | 0.398 |
| Oil_spot      | 58   | 125 | 17373 | 0.920  | 0.689 |
| Punching      | 74   | 74  | 2377  | 1.000  | 0.990 |
| Rolled_pit    | 10   | 25  | 2696  | 0.760  | 0.395 |
| Silk_spot     | 134  | 150 | 57232 | 0.893  | 0.631 |
| Waist_folding | 24   | 26  | 6356  | 0.923  | 0.796 |
| Water_spot    | 68   | 78  | 13235 | 0.974  | 0.806 |
| Welding_line  | 99   | 99  | 15766 | 1.000  | 0.963 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.883  | 0.700 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 13:13:00 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 13:13:01 det.util.engine] INFO: Epoch: [59]  [0/1834]  eta: 0:19:18  lr: 0.000010  data_time: 0.0062  iter_time: 0.6316  loss: 35.2886 (35.2886)  loss_class: 0.3505 (0.3505)  loss_bbox: 0.9245 (0.9245)  loss_giou: 0.2876 (0.2876)  loss_class_0: 0.4089 (0.4089)  loss_bbox_0: 1.0532 (1.0532)  loss_giou_0: 0.3241 (0.3241)  loss_class_1: 0.3861 (0.3861)  loss_bbox_1: 1.1232 (1.1232)  loss_giou_1: 0.3405 (0.3405)  loss_class_2: 0.3619 (0.3619)  loss_bbox_2: 0.9091 (0.9091)  loss_giou_2: 0.2994 (0.2994)  loss_class_3: 0.3528 (0.3528)  loss_bbox_3: 0.8831 (0.8831)  loss_giou_3: 0.2857 (0.2857)  loss_class_4: 0.3550 (0.3550)  loss_bbox_4: 0.9108 (0.9108)  loss_giou_4: 0.2898 (0.2898)  loss_class_enc: 1.6410 (1.6410)  loss_bbox_enc: 0.3150 (0.3150)  loss_giou_enc: 0.1142 (0.1142)  loss_class_dn: 0.3779 (0.3779)  loss_bbox_dn: 1.0562 (1.0562)  loss_giou_dn: 0.3350 (0.3350)  loss_class_dn_0: 0.4783 (0.4783)  loss_bbox_dn_0: 1.2289 (1.2289)  loss_giou_dn_0: 0.4129 (0.4129)  loss_class_dn_1: 0.4272 (0.4272)  loss_bbox_dn_1: 1.3395 (1.3395)  loss_giou_dn_1: 0.4342 (0.4342)  loss_class_dn_2: 0.3989 (0.3989)  loss_bbox_dn_2: 1.1009 (1.1009)  loss_giou_dn_2: 0.3723 (0.3723)  loss_class_dn_3: 0.3820 (0.3820)  loss_bbox_dn_3: 1.0270 (1.0270)  loss_giou_dn_3: 0.3383 (0.3383)  loss_class_dn_4: 0.3838 (0.3838)  loss_bbox_dn_4: 1.0447 (1.0447)  loss_giou_dn_4: 0.3379 (0.3379)  loss_class_hybrid: 0.3585 (0.3585)  loss_bbox_hybrid: 0.9686 (0.9686)  loss_giou_hybrid: 0.3033 (0.3033)  loss_class_0_hybrid: 0.4680 (0.4680)  loss_bbox_0_hybrid: 0.9484 (0.9484)  loss_giou_0_hybrid: 0.3156 (0.3156)  loss_class_1_hybrid: 0.3938 (0.3938)  loss_bbox_1_hybrid: 1.1626 (1.1626)  loss_giou_1_hybrid: 0.3609 (0.3609)  loss_class_2_hybrid: 0.3733 (0.3733)  loss_bbox_2_hybrid: 0.9784 (0.9784)  loss_giou_2_hybrid: 0.3208 (0.3208)  loss_class_3_hybrid: 0.3591 (0.3591)  loss_bbox_3_hybrid: 0.9465 (0.9465)  loss_giou_3_hybrid: 0.3020 (0.3020)  loss_class_4_hybrid: 0.3596 (0.3596)  loss_bbox_4_hybrid: 0.9621 (0.9621)  loss_giou_4_hybrid: 0.3031 (0.3031)  loss_class_enc_hybrid: 0.9344 (0.9344)  loss_bbox_enc_hybrid: 0.5212 (0.5212)  loss_giou_enc_hybrid: 0.2560 (0.2560)  mem: 740  max mem: 19990
[2025-05-20 13:13:01 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 13:30:43 det.util.engine] INFO: Averaged stats: lr: 0.000010  data_time: 0.0007  iter_time: 0.5762  loss: 21.3947 (23.9384)  loss_class: 0.3926 (0.5280)  loss_bbox: 0.2087 (0.2657)  loss_giou: 0.2695 (0.3360)  loss_class_0: 0.5486 (0.6549)  loss_bbox_0: 0.2447 (0.2840)  loss_giou_0: 0.2567 (0.3535)  loss_class_1: 0.3696 (0.5743)  loss_bbox_1: 0.2414 (0.2698)  loss_giou_1: 0.2503 (0.3390)  loss_class_2: 0.3494 (0.5472)  loss_bbox_2: 0.2038 (0.2686)  loss_giou_2: 0.2651 (0.3370)  loss_class_3: 0.4069 (0.5370)  loss_bbox_3: 0.1955 (0.2660)  loss_giou_3: 0.2691 (0.3357)  loss_class_4: 0.3923 (0.5337)  loss_bbox_4: 0.2032 (0.2640)  loss_giou_4: 0.2715 (0.3342)  loss_class_enc: 0.9253 (0.9250)  loss_bbox_enc: 0.2010 (0.2849)  loss_giou_enc: 0.2955 (0.3799)  loss_class_dn: 0.3705 (0.3305)  loss_bbox_dn: 0.2433 (0.3472)  loss_giou_dn: 0.2675 (0.3593)  loss_class_dn_0: 0.4587 (0.4028)  loss_bbox_dn_0: 0.4076 (0.4524)  loss_giou_dn_0: 0.4284 (0.4674)  loss_class_dn_1: 0.3843 (0.3558)  loss_bbox_dn_1: 0.2703 (0.3750)  loss_giou_dn_1: 0.2907 (0.3799)  loss_class_dn_2: 0.3534 (0.3358)  loss_bbox_dn_2: 0.2518 (0.3571)  loss_giou_dn_2: 0.2689 (0.3656)  loss_class_dn_3: 0.3585 (0.3332)  loss_bbox_dn_3: 0.2498 (0.3495)  loss_giou_dn_3: 0.2753 (0.3607)  loss_class_dn_4: 0.3684 (0.3319)  loss_bbox_dn_4: 0.2423 (0.3482)  loss_giou_dn_4: 0.2715 (0.3599)  loss_class_hybrid: 0.4097 (0.5957)  loss_bbox_hybrid: 0.2173 (0.2570)  loss_giou_hybrid: 0.2756 (0.3310)  loss_class_0_hybrid: 0.5249 (0.6319)  loss_bbox_0_hybrid: 0.2157 (0.2848)  loss_giou_0_hybrid: 0.2922 (0.3582)  loss_class_1_hybrid: 0.4313 (0.6042)  loss_bbox_1_hybrid: 0.2330 (0.2643)  loss_giou_1_hybrid: 0.2633 (0.3391)  loss_class_2_hybrid: 0.4039 (0.5924)  loss_bbox_2_hybrid: 0.2299 (0.2616)  loss_giou_2_hybrid: 0.2645 (0.3357)  loss_class_3_hybrid: 0.4126 (0.5898)  loss_bbox_3_hybrid: 0.2241 (0.2613)  loss_giou_3_hybrid: 0.2746 (0.3341)  loss_class_4_hybrid: 0.4113 (0.5936)  loss_bbox_4_hybrid: 0.2182 (0.2586)  loss_giou_4_hybrid: 0.2689 (0.3325)  loss_class_enc_hybrid: 0.6821 (0.7360)  loss_bbox_enc_hybrid: 0.3003 (0.3279)  loss_giou_enc_hybrid: 0.3281 (0.4181)
[2025-05-20 13:30:43 accelerate.accelerator] WARNING: Deleting 1 checkpoints to make room for new checkpoint.
[2025-05-20 13:30:43 accelerate.accelerator] INFO: Saving current state to checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59
[2025-05-20 13:30:43 accelerate.checkpointing] INFO: Model weights saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\pytorch_model.bin
[2025-05-20 13:30:44 accelerate.checkpointing] INFO: Optimizer state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\optimizer.bin
[2025-05-20 13:30:44 accelerate.checkpointing] INFO: Scheduler state saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\scheduler.bin
[2025-05-20 13:30:44 accelerate.checkpointing] INFO: Sampler state for dataloader 0 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\sampler.bin
[2025-05-20 13:30:44 accelerate.checkpointing] INFO: Sampler state for dataloader 1 saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\sampler_1.bin
[2025-05-20 13:30:44 accelerate.checkpointing] INFO: Random states saved in checkpoints\relation_detr_resnet50_800_1333\train\2025-05-019-18_26_40\checkpoints\checkpoint_59\random_states_0.pkl
[2025-05-20 13:30:44 det.__main__] INFO: Start evaluation
[2025-05-20 13:30:44 det.util.utils] INFO: Test:  [  0/458]  eta: 0:01:33  model_time: 0.1816 (0.1816)  evaluator_time: 0.0040 (0.0040)  time: 0.2052  data: 0.0196  mem: 730  max mem: 19990
[2025-05-20 13:30:46 det.util.utils] INFO: Test:  [ 10/458]  eta: 0:01:20  model_time: 0.1725 (0.1731)  evaluator_time: 0.0030 (0.0034)  time: 0.1790  data: 0.0021  mem: 730  max mem: 19990
[2025-05-20 13:30:47 det.util.utils] INFO: Test:  [ 20/458]  eta: 0:01:17  model_time: 0.1720 (0.1726)  evaluator_time: 0.0030 (0.0032)  time: 0.1761  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:30:49 det.util.utils] INFO: Test:  [ 30/458]  eta: 0:01:15  model_time: 0.1720 (0.1725)  evaluator_time: 0.0030 (0.0031)  time: 0.1760  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:30:51 det.util.utils] INFO: Test:  [ 40/458]  eta: 0:01:14  model_time: 0.1730 (0.1729)  evaluator_time: 0.0030 (0.0031)  time: 0.1769  data: 0.0008  mem: 730  max mem: 19990
[2025-05-20 13:30:53 det.util.utils] INFO: Test:  [ 50/458]  eta: 0:01:12  model_time: 0.1740 (0.1731)  evaluator_time: 0.0030 (0.0032)  time: 0.1782  data: 0.0008  mem: 730  max mem: 19990
[2025-05-20 13:30:55 det.util.utils] INFO: Test:  [ 60/458]  eta: 0:01:10  model_time: 0.1740 (0.1732)  evaluator_time: 0.0030 (0.0032)  time: 0.1777  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:30:56 det.util.utils] INFO: Test:  [ 70/458]  eta: 0:01:08  model_time: 0.1731 (0.1732)  evaluator_time: 0.0030 (0.0031)  time: 0.1772  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:30:58 det.util.utils] INFO: Test:  [ 80/458]  eta: 0:01:07  model_time: 0.1730 (0.1732)  evaluator_time: 0.0030 (0.0032)  time: 0.1774  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:00 det.util.utils] INFO: Test:  [ 90/458]  eta: 0:01:05  model_time: 0.1726 (0.1732)  evaluator_time: 0.0030 (0.0047)  time: 0.1840  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:02 det.util.utils] INFO: Test:  [100/458]  eta: 0:01:04  model_time: 0.1740 (0.1733)  evaluator_time: 0.0030 (0.0046)  time: 0.1850  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:31:04 det.util.utils] INFO: Test:  [110/458]  eta: 0:01:02  model_time: 0.1750 (0.1734)  evaluator_time: 0.0030 (0.0046)  time: 0.1793  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:31:05 det.util.utils] INFO: Test:  [120/458]  eta: 0:01:00  model_time: 0.1750 (0.1736)  evaluator_time: 0.0030 (0.0044)  time: 0.1791  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:07 det.util.utils] INFO: Test:  [130/458]  eta: 0:00:58  model_time: 0.1750 (0.1737)  evaluator_time: 0.0030 (0.0044)  time: 0.1791  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:09 det.util.utils] INFO: Test:  [140/458]  eta: 0:00:56  model_time: 0.1745 (0.1737)  evaluator_time: 0.0030 (0.0043)  time: 0.1790  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:11 det.util.utils] INFO: Test:  [150/458]  eta: 0:00:55  model_time: 0.1745 (0.1738)  evaluator_time: 0.0040 (0.0043)  time: 0.1794  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:13 det.util.utils] INFO: Test:  [160/458]  eta: 0:00:53  model_time: 0.1750 (0.1739)  evaluator_time: 0.0040 (0.0043)  time: 0.1801  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:14 det.util.utils] INFO: Test:  [170/458]  eta: 0:00:51  model_time: 0.1745 (0.1739)  evaluator_time: 0.0030 (0.0042)  time: 0.1790  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:16 det.util.utils] INFO: Test:  [180/458]  eta: 0:00:49  model_time: 0.1740 (0.1740)  evaluator_time: 0.0030 (0.0041)  time: 0.1778  data: 0.0008  mem: 730  max mem: 19990
[2025-05-20 13:31:18 det.util.utils] INFO: Test:  [190/458]  eta: 0:00:47  model_time: 0.1740 (0.1739)  evaluator_time: 0.0030 (0.0041)  time: 0.1779  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:20 det.util.utils] INFO: Test:  [200/458]  eta: 0:00:46  model_time: 0.1740 (0.1740)  evaluator_time: 0.0040 (0.0040)  time: 0.1782  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:21 det.util.utils] INFO: Test:  [210/458]  eta: 0:00:44  model_time: 0.1737 (0.1739)  evaluator_time: 0.0030 (0.0040)  time: 0.1778  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:23 det.util.utils] INFO: Test:  [220/458]  eta: 0:00:42  model_time: 0.1734 (0.1739)  evaluator_time: 0.0040 (0.0040)  time: 0.1773  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:25 det.util.utils] INFO: Test:  [230/458]  eta: 0:00:40  model_time: 0.1726 (0.1738)  evaluator_time: 0.0030 (0.0040)  time: 0.1771  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:27 det.util.utils] INFO: Test:  [240/458]  eta: 0:00:38  model_time: 0.1720 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1762  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:29 det.util.utils] INFO: Test:  [250/458]  eta: 0:00:37  model_time: 0.1720 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1764  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:30 det.util.utils] INFO: Test:  [260/458]  eta: 0:00:35  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1770  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:31:32 det.util.utils] INFO: Test:  [270/458]  eta: 0:00:33  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0039)  time: 0.1773  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:31:34 det.util.utils] INFO: Test:  [280/458]  eta: 0:00:31  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0038)  time: 0.1771  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:36 det.util.utils] INFO: Test:  [290/458]  eta: 0:00:29  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0038)  time: 0.1770  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:37 det.util.utils] INFO: Test:  [300/458]  eta: 0:00:28  model_time: 0.1732 (0.1736)  evaluator_time: 0.0030 (0.0038)  time: 0.1774  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:39 det.util.utils] INFO: Test:  [310/458]  eta: 0:00:26  model_time: 0.1731 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:41 det.util.utils] INFO: Test:  [320/458]  eta: 0:00:24  model_time: 0.1725 (0.1736)  evaluator_time: 0.0030 (0.0037)  time: 0.1773  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:43 det.util.utils] INFO: Test:  [330/458]  eta: 0:00:22  model_time: 0.1730 (0.1736)  evaluator_time: 0.0030 (0.0037)  time: 0.1774  data: 0.0008  mem: 730  max mem: 19990
[2025-05-20 13:31:44 det.util.utils] INFO: Test:  [340/458]  eta: 0:00:21  model_time: 0.1736 (0.1736)  evaluator_time: 0.0030 (0.0037)  time: 0.1778  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:46 det.util.utils] INFO: Test:  [350/458]  eta: 0:00:19  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1782  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:48 det.util.utils] INFO: Test:  [360/458]  eta: 0:00:17  model_time: 0.1736 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1784  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:50 det.util.utils] INFO: Test:  [370/458]  eta: 0:00:15  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1780  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:31:52 det.util.utils] INFO: Test:  [380/458]  eta: 0:00:13  model_time: 0.1731 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1771  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:31:53 det.util.utils] INFO: Test:  [390/458]  eta: 0:00:12  model_time: 0.1730 (0.1737)  evaluator_time: 0.0040 (0.0037)  time: 0.1785  data: 0.0002  mem: 730  max mem: 19990
[2025-05-20 13:31:55 det.util.utils] INFO: Test:  [400/458]  eta: 0:00:10  model_time: 0.1735 (0.1737)  evaluator_time: 0.0036 (0.0037)  time: 0.1790  data: 0.0003  mem: 730  max mem: 19990
[2025-05-20 13:31:57 det.util.utils] INFO: Test:  [410/458]  eta: 0:00:08  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1780  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:31:59 det.util.utils] INFO: Test:  [420/458]  eta: 0:00:06  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1779  data: 0.0007  mem: 730  max mem: 19990
[2025-05-20 13:32:01 det.util.utils] INFO: Test:  [430/458]  eta: 0:00:04  model_time: 0.1732 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1776  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:32:02 det.util.utils] INFO: Test:  [440/458]  eta: 0:00:03  model_time: 0.1730 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1778  data: 0.0005  mem: 730  max mem: 19990
[2025-05-20 13:32:04 det.util.utils] INFO: Test:  [450/458]  eta: 0:00:01  model_time: 0.1738 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1785  data: 0.0004  mem: 730  max mem: 19990
[2025-05-20 13:32:05 det.util.utils] INFO: Test:  [457/458]  eta: 0:00:00  model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)  time: 0.1787  data: 0.0006  mem: 730  max mem: 19990
[2025-05-20 13:32:05 det.util.engine] INFO: Averaged stats: model_time: 0.1740 (0.1737)  evaluator_time: 0.0030 (0.0037)
[2025-05-20 13:32:06 det.util.engine] INFO: Accumulating evaluation results...
DONE (t=0.32s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.694
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552

[2025-05-20 13:32:06 det.util.engine] INFO: 
+---------------+------+-----+-------+--------+-------+
| class         | imgs | gts | dets  | recall | ap    |
+---------------+------+-----+-------+--------+-------+
| Crease        | 9    | 17  | 4096  | 0.588  | 0.389 |
| Crescent_gap  | 48   | 48  | 4595  | 1.000  | 0.942 |
| Inclusion     | 41   | 82  | 9178  | 0.756  | 0.370 |
| Oil_spot      | 58   | 125 | 20469 | 0.912  | 0.667 |
| Punching      | 74   | 74  | 2120  | 1.000  | 0.992 |
| Rolled_pit    | 10   | 25  | 3215  | 0.880  | 0.394 |
| Silk_spot     | 134  | 150 | 63263 | 0.913  | 0.633 |
| Waist_folding | 24   | 26  | 7561  | 0.962  | 0.763 |
| Water_spot    | 68   | 78  | 11348 | 0.974  | 0.816 |
| Welding_line  | 99   | 99  | 11154 | 1.000  | 0.977 |
+---------------+------+-----+-------+--------+-------+
| mean results  |      |     |       | 0.899  | 0.694 |
+---------------+------+-----+-------+--------+-------+
[2025-05-20 13:32:06 accelerate.tracking] DEBUG: Successfully logged to TensorBoard
[2025-05-20 13:32:06 det.__main__] INFO: Training time: 19:05:24
[2025-05-20 13:32:06 accelerate.tracking] DEBUG: TensorBoard writer closed
